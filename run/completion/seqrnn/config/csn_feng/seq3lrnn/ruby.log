nohup: ignoring input
[2021-04-06 01:32:52]    INFO >> Load arguments in /home/wanyao/yang/naturalcc-dev/run/completion/seqrnn/config/csn_feng/seq3lrnn/ruby.yml (train.py:291, cli_main())
[2021-04-06 01:32:52]    INFO >> {'criterion': 'completion_cross_entropy', 'optimizer': 'torch_adam', 'lr_scheduler': 'fixed', 'tokenizer': None, 'bpe': None, 'common': {'no_progress_bar': 0, 'log_interval': 500, 'log_format': 'simple', 'tensorboard_logdir': '', 'memory_efficient_fp16': 0, 'fp16_no_flatten_grads': 0, 'fp16_init_scale': 128, 'fp16_scale_window': None, 'fp16_scale_tolerance': 0.0, 'min_loss_scale': 0.0001, 'threshold_loss_scale': None, 'empty_cache_freq': 0, 'task': 'completion', 'seed': 666, 'cpu': 0, 'fp16': 0, 'fp16_opt_level': '01', 'server_ip': '', 'server_port': ''}, 'dataset': {'num_workers': 3, 'skip_invalid_size_inputs_valid_test': 0, 'max_tokens': 100000.0, 'max_sentences': 32, 'required_batch_size_multiple': 8, 'dataset_impl': 'mmap', 'train_subset': 'train', 'valid_subset': 'valid', 'validate_interval': 1, 'fixed_validation_seed': None, 'disable_validation': 0, 'max_tokens_valid': None, 'max_sentences_valid': 64, 'curriculum': 5, 'n_ctx': 1000, 'gen_subset': 'test', 'num_shards': 1, 'shard_id': 0}, 'distributed_training': {'distributed_world_size': 4, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': None, 'distributed_port': -1, 'device_id': 0, 'distributed_no_spawn': 0, 'ddp_backend': 'c10d', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': None, 'find_unused_parameters': 0, 'fast_stat_sync': 0, 'broadcast_buffers': 0, 'global_sync_iter': 50, 'warmup_iterations': 500, 'local_rank': -1}, 'task': {'data': '/mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby', 'target_lang': 'code_tokens', 'max_target_positions': 513, 'add_bos_token': 0, 'eval_bleu': 0, 'eval_bleu_detok': 'space', 'eval_bleu_detok_args': None, 'eval_tokenized_bleu': 0, 'eval_bleu_remove_bpe': None, 'eval_bleu_args': None, 'eval_bleu_print_samples': 0, 'eval_accuracy': 1, 'eval_mrr': 1}, 'model': {'arch': 'completion_seqrnn', 'dropout': 0.1, 'decoder_embed_dim': 300, 'decoder_embed_path': None, 'decoder_freeze_embed': None, 'decoder_hidden_size': 300, 'decoder_layers': 3, 'decoder_out_embed_dim': 300, 'decoder_attention': 0, 'adaptive_softmax_cutoff': None, 'share_decoder_input_output_embed': 0, 'share_all_embeddings': 0, 'encoder_dropout_in': 0.1, 'encoder_dropout_out': 0.1, 'decoder_dropout_in': 0.1, 'decoder_dropout_out': 0.1, 'max_target_positions': 513, 'shared_embedding': 1}, 'optimization': {'max_epoch': 100, 'max_update': 0, 'clip_norm': 25, 'update_freq': [1], 'lrs': [0.001], 'min_lr': -1, 'use_bmuf': 0, 'force_anneal': None, 'warmup_updates': 0, 'end_learning_rate': 0.0, 'power': 1.0, 'total_num_update': 125000, 'sentence_avg': None, 'adam': {'adam_betas': '(0.9, 0.999)', 'adam_eps': 1e-08, 'weight_decay': 0.0, 'use_old_adam': 0}, 'weight_decay': 0.0, 'adam_epsilon': 1e-08, 'max_grad_norm': 1.0, 'num_train_epochs': 5, 'max_steps': -1, 'warmup_steps': 0, 'gradient_accumulation_steps': 1, 'label_smoothing': 0.1, 'distill_temp': 0.6, 'kd_loss_weight': 0.25}, 'kd': {'gen_topk': 5, 'distill_topk': 5}, 'checkpoint': {'save_dir': '/mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq3lrnn/checkpoints', 'restore_file': 'checkpoint_last.pt', 'reset_dataloader': None, 'reset_lr_scheduler': None, 'reset_meters': None, 'reset_optimizer': None, 'optimizer_overrides': '{}', 'save_interval': 1, 'save_interval_updates': 0, 'keep_interval_updates': 0, 'keep_last_epochs': -1, 'keep_best_checkpoints': -1, 'no_save': 0, 'no_epoch_checkpoints': 1, 'no_last_checkpoints': 0, 'no_save_optimizer_state': None, 'best_checkpoint_metric': 'loss', 'maximize_best_checkpoint_metric': 0, 'patience': 5, 'should_continue': 0, 'model_name_or_path': None, 'cache_dir': None, 'logging_steps': 500, 'save_steps': 2000, 'save_total_limit': 2, 'overwrite_output_dir': 0, 'overwrite_cache': 0}, 'eval': {'path': '/mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq3lrnn/checkpoints/checkpoint_best.pt', 'model_overrides': '{}', 'checkpoint_suffix': '', 'predict_type': 'leaf_ids', 'max_sentences_eval': 64}} (train.py:293, cli_main())
[2021-04-06 01:32:54]    INFO >> distributed init (rank 1): tcp://localhost:16966 (distributed_utils.py:84, distributed_init())
[2021-04-06 01:32:54]    INFO >> distributed init (rank 2): tcp://localhost:16966 (distributed_utils.py:84, distributed_init())
[2021-04-06 01:32:54]    INFO >> distributed init (rank 3): tcp://localhost:16966 (distributed_utils.py:84, distributed_init())
[2021-04-06 01:32:54]    INFO >> distributed init (rank 0): tcp://localhost:16966 (distributed_utils.py:84, distributed_init())
[2021-04-06 01:32:55]    INFO >> Added key: store_based_barrier_key:1 to store for rank: 1 (distributed_c10d.py:187, _store_based_barrier())
[2021-04-06 01:32:55]    INFO >> Added key: store_based_barrier_key:1 to store for rank: 2 (distributed_c10d.py:187, _store_based_barrier())
[2021-04-06 01:32:55]    INFO >> Added key: store_based_barrier_key:1 to store for rank: 3 (distributed_c10d.py:187, _store_based_barrier())
[2021-04-06 01:32:55]    INFO >> Added key: store_based_barrier_key:1 to store for rank: 0 (distributed_c10d.py:187, _store_based_barrier())
[2021-04-06 01:32:55]    INFO >> initialized host node14 as rank 0 (distributed_utils.py:93, distributed_init())
[2021-04-06 01:32:55]    INFO >> initialized host node14 as rank 1 (distributed_utils.py:93, distributed_init())
[2021-04-06 01:32:55]    INFO >> initialized host node14 as rank 3 (distributed_utils.py:93, distributed_init())
[2021-04-06 01:32:55]    INFO >> initialized host node14 as rank 2 (distributed_utils.py:93, distributed_init())
[2021-04-06 01:33:01]    INFO >> {'criterion': 'completion_cross_entropy', 'optimizer': 'torch_adam', 'lr_scheduler': 'fixed', 'tokenizer': None, 'bpe': None, 'common': {'no_progress_bar': 0, 'log_interval': 500, 'log_format': 'simple', 'tensorboard_logdir': '', 'memory_efficient_fp16': 0, 'fp16_no_flatten_grads': 0, 'fp16_init_scale': 128, 'fp16_scale_window': None, 'fp16_scale_tolerance': 0.0, 'min_loss_scale': 0.0001, 'threshold_loss_scale': None, 'empty_cache_freq': 0, 'task': 'completion', 'seed': 666, 'cpu': 0, 'fp16': 0, 'fp16_opt_level': '01', 'server_ip': '', 'server_port': ''}, 'dataset': {'num_workers': 3, 'skip_invalid_size_inputs_valid_test': 0, 'max_tokens': 100000.0, 'max_sentences': 32, 'required_batch_size_multiple': 8, 'dataset_impl': 'mmap', 'train_subset': 'train', 'valid_subset': 'valid', 'validate_interval': 1, 'fixed_validation_seed': None, 'disable_validation': 0, 'max_tokens_valid': None, 'max_sentences_valid': 64, 'curriculum': 5, 'n_ctx': 1000, 'gen_subset': 'test', 'num_shards': 1, 'shard_id': 0}, 'distributed_training': {'distributed_world_size': 4, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': 'tcp://localhost:16966', 'distributed_port': -1, 'device_id': 0, 'distributed_no_spawn': 0, 'ddp_backend': 'c10d', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': None, 'find_unused_parameters': 0, 'fast_stat_sync': 0, 'broadcast_buffers': 0, 'global_sync_iter': 50, 'warmup_iterations': 500, 'local_rank': -1}, 'task': {'data': '/mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby', 'target_lang': 'code_tokens', 'max_target_positions': 513, 'add_bos_token': 0, 'eval_bleu': 0, 'eval_bleu_detok': 'space', 'eval_bleu_detok_args': None, 'eval_tokenized_bleu': 0, 'eval_bleu_remove_bpe': None, 'eval_bleu_args': None, 'eval_bleu_print_samples': 0, 'eval_accuracy': 1, 'eval_mrr': 1}, 'model': {'arch': 'completion_seqrnn', 'dropout': 0.1, 'decoder_embed_dim': 300, 'decoder_embed_path': None, 'decoder_freeze_embed': None, 'decoder_hidden_size': 300, 'decoder_layers': 3, 'decoder_out_embed_dim': 300, 'decoder_attention': 0, 'adaptive_softmax_cutoff': None, 'share_decoder_input_output_embed': 0, 'share_all_embeddings': 0, 'encoder_dropout_in': 0.1, 'encoder_dropout_out': 0.1, 'decoder_dropout_in': 0.1, 'decoder_dropout_out': 0.1, 'max_target_positions': 513, 'shared_embedding': 1}, 'optimization': {'max_epoch': 100, 'max_update': 0, 'clip_norm': 25, 'update_freq': [1], 'lrs': [0.001], 'min_lr': -1, 'use_bmuf': 0, 'force_anneal': None, 'warmup_updates': 0, 'end_learning_rate': 0.0, 'power': 1.0, 'total_num_update': 125000, 'sentence_avg': None, 'adam': {'adam_betas': '(0.9, 0.999)', 'adam_eps': 1e-08, 'weight_decay': 0.0, 'use_old_adam': 0}, 'weight_decay': 0.0, 'adam_epsilon': 1e-08, 'max_grad_norm': 1.0, 'num_train_epochs': 5, 'max_steps': -1, 'warmup_steps': 0, 'gradient_accumulation_steps': 1, 'label_smoothing': 0.1, 'distill_temp': 0.6, 'kd_loss_weight': 0.25}, 'kd': {'gen_topk': 5, 'distill_topk': 5}, 'checkpoint': {'save_dir': '/mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq3lrnn/checkpoints', 'restore_file': 'checkpoint_last.pt', 'reset_dataloader': None, 'reset_lr_scheduler': None, 'reset_meters': None, 'reset_optimizer': None, 'optimizer_overrides': '{}', 'save_interval': 1, 'save_interval_updates': 0, 'keep_interval_updates': 0, 'keep_last_epochs': -1, 'keep_best_checkpoints': -1, 'no_save': 0, 'no_epoch_checkpoints': 1, 'no_last_checkpoints': 0, 'no_save_optimizer_state': None, 'best_checkpoint_metric': 'loss', 'maximize_best_checkpoint_metric': 0, 'patience': 5, 'should_continue': 0, 'model_name_or_path': None, 'cache_dir': None, 'logging_steps': 500, 'save_steps': 2000, 'save_total_limit': 2, 'overwrite_output_dir': 0, 'overwrite_cache': 0}, 'eval': {'path': '/mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq3lrnn/checkpoints/checkpoint_best.pt', 'model_overrides': '{}', 'checkpoint_suffix': '', 'predict_type': 'leaf_ids', 'max_sentences_eval': 64}} (train.py:201, single_main())
[2021-04-06 01:33:01]    INFO >> [code_tokens] dictionary: 50000 types (completion.py:103, setup_task())
[2021-04-06 01:33:01]    INFO >> loaded 1400 examples from: /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/valid.code_tokens (completion.py:43, load_token_dataset())
[2021-04-06 01:33:01]    INFO >> SeqRNNModel(
  (decoder): LSTMDecoder(
    (embed_tokens): Embedding(50000, 300, padding_idx=0)
    (rnn): LSTM(300, 300, num_layers=3, batch_first=True, dropout=0.1)
    (fc_out): Linear(in_features=300, out_features=50000, bias=True)
  )
) (train.py:212, single_main())
[2021-04-06 01:33:01]    INFO >> model completion_seqrnn, criterion CompletionCrossEntropyCriterion (train.py:213, single_main())
[2021-04-06 01:33:01]    INFO >> num. model params: 17217200 (num. trained: 17217200) (train.py:214, single_main())
[2021-04-06 01:33:02]    INFO >> training on 4 GPUs (train.py:221, single_main())
[2021-04-06 01:33:02]    INFO >> max tokens per GPU = 100000.0 and max sentences per GPU = 32 (train.py:222, single_main())
[2021-04-06 01:33:02]    INFO >> no existing checkpoint found /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq3lrnn/checkpoints/checkpoint_last.pt (ncc_trainers.py:270, load_checkpoint())
[2021-04-06 01:33:02]    INFO >> loading train data for epoch 1 (ncc_trainers.py:285, get_train_iterator())
[2021-04-06 01:33:02]    INFO >> loaded 24927 examples from: /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/train.code_tokens (completion.py:43, load_token_dataset())
/home/wanyao/anaconda3/envs/py38-1.8/lib/python3.8/site-packages/torch/nn/parallel/distributed.py:425: UserWarning: The `check_reduction` argument in `DistributedDataParallel` module is deprecated. Please avoid using it.
  warnings.warn(
[2021-04-06 01:33:02]    INFO >> NOTE: your device may support faster training with fp16 (ncc_trainers.py:155, _setup_optimizer())
/home/wanyao/anaconda3/envs/py38-1.8/lib/python3.8/site-packages/torch/nn/parallel/distributed.py:425: UserWarning: The `check_reduction` argument in `DistributedDataParallel` module is deprecated. Please avoid using it.
  warnings.warn(
/home/wanyao/anaconda3/envs/py38-1.8/lib/python3.8/site-packages/torch/nn/parallel/distributed.py:425: UserWarning: The `check_reduction` argument in `DistributedDataParallel` module is deprecated. Please avoid using it.
  warnings.warn(
/home/wanyao/anaconda3/envs/py38-1.8/lib/python3.8/site-packages/torch/nn/parallel/distributed.py:425: UserWarning: The `check_reduction` argument in `DistributedDataParallel` module is deprecated. Please avoid using it.
  warnings.warn(
/home/wanyao/yang/naturalcc-dev/ncc/utils/gradient_clip/fairseq_clip.py:56: UserWarning: amp_C fused kernels unavailable, disabling multi_tensor_l2norm; you may get better performance by installing NVIDIA's apex library
  warnings.warn(
[2021-04-06 01:33:08]    INFO >> Reducer buckets have been rebuilt in this iteration. (distributed.py:693, forward())
/home/wanyao/yang/naturalcc-dev/ncc/utils/gradient_clip/fairseq_clip.py:56: UserWarning: amp_C fused kernels unavailable, disabling multi_tensor_l2norm; you may get better performance by installing NVIDIA's apex library
  warnings.warn(
[2021-04-06 01:33:08]    INFO >> Reducer buckets have been rebuilt in this iteration. (distributed.py:693, forward())
/home/wanyao/yang/naturalcc-dev/ncc/utils/gradient_clip/fairseq_clip.py:56: UserWarning: amp_C fused kernels unavailable, disabling multi_tensor_l2norm; you may get better performance by installing NVIDIA's apex library
  warnings.warn(
[2021-04-06 01:33:08]    INFO >> Reducer buckets have been rebuilt in this iteration. (distributed.py:693, forward())
/home/wanyao/yang/naturalcc-dev/ncc/utils/gradient_clip/fairseq_clip.py:56: UserWarning: amp_C fused kernels unavailable, disabling multi_tensor_l2norm; you may get better performance by installing NVIDIA's apex library
  warnings.warn(
[2021-04-06 01:33:08]    INFO >> Reducer buckets have been rebuilt in this iteration. (distributed.py:693, forward())
[2021-04-06 01:33:52]    INFO >> epoch 001 | loss 7.614 | accuracy 0 | mrr 0 | ppl 195.9 | wps 35193.3 | ups 4.37 | wpb 8045.7 | bsz 127.8 | num_updates 195 | lr 0.001 | gnorm 0.566 | clip 0 | train_wall 44 | wall 51 (progress_bar.py:269, print())
[2021-04-06 01:34:02]    INFO >> epoch 001 | valid on 'valid' subset | loss 7.11 | accuracy 0.139694 | mrr 0.260172 | ppl 138.12 | wps 25956.5 | wpb 14868.2 | bsz 233.3 | num_updates 195 (progress_bar.py:269, print())
[2021-04-06 01:34:03]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq3lrnn/checkpoints/checkpoint_best.pt (epoch 1 @ 195 updates, score 7.11) (writing took 0.772367 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-06 01:34:51]    INFO >> epoch 002 | loss 7.076 | accuracy 0 | mrr 0 | ppl 134.94 | wps 26642.7 | ups 3.31 | wpb 8045.7 | bsz 127.8 | num_updates 390 | lr 0.001 | gnorm 0.368 | clip 0 | train_wall 42 | wall 110 (progress_bar.py:269, print())
[2021-04-06 01:34:59]    INFO >> epoch 002 | valid on 'valid' subset | loss 6.962 | accuracy 0.172931 | mrr 0.296704 | ppl 124.68 | wps 37666.3 | wpb 14868.2 | bsz 233.3 | num_updates 390 | best_loss 6.962 (progress_bar.py:269, print())
[2021-04-06 01:35:10]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq3lrnn/checkpoints/checkpoint_best.pt (epoch 2 @ 390 updates, score 6.962) (writing took 10.429390 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-06 01:35:39]    INFO >> epoch 003:    110 / 195 loss=7.22, accuracy=0, mrr=0, ppl=149.03, wps=26585.2, ups=3.3, wpb=8044.8, bsz=127.9, num_updates=500, lr=0.001, gnorm=0.458, clip=0, train_wall=109, wall=158 (progress_bar.py:260, log())
[2021-04-06 01:35:58]    INFO >> epoch 003 | loss 6.518 | accuracy 0 | mrr 0 | ppl 91.64 | wps 23461 | ups 2.92 | wpb 8045.7 | bsz 127.8 | num_updates 585 | lr 0.001 | gnorm 0.439 | clip 0 | train_wall 42 | wall 177 (progress_bar.py:269, print())
[2021-04-06 01:36:06]    INFO >> epoch 003 | valid on 'valid' subset | loss 6.067 | accuracy 0.283088 | mrr 0.397335 | ppl 67.06 | wps 39096.8 | wpb 14868.2 | bsz 233.3 | num_updates 585 | best_loss 6.067 (progress_bar.py:269, print())
[2021-04-06 01:36:17]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq3lrnn/checkpoints/checkpoint_best.pt (epoch 3 @ 585 updates, score 6.067) (writing took 10.601589 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-06 01:37:05]    INFO >> epoch 004 | loss 5.812 | accuracy 0 | mrr 0 | ppl 56.18 | wps 23520.3 | ups 2.92 | wpb 8045.7 | bsz 127.8 | num_updates 780 | lr 0.001 | gnorm 0.458 | clip 0 | train_wall 41 | wall 243 (progress_bar.py:269, print())
[2021-04-06 01:37:13]    INFO >> epoch 004 | valid on 'valid' subset | loss 5.671 | accuracy 0.340997 | mrr 0.447987 | ppl 50.96 | wps 39391.4 | wpb 14868.2 | bsz 233.3 | num_updates 780 | best_loss 5.671 (progress_bar.py:269, print())
[2021-04-06 01:37:23]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq3lrnn/checkpoints/checkpoint_best.pt (epoch 4 @ 780 updates, score 5.671) (writing took 10.456013 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-06 01:38:11]    INFO >> epoch 005 | loss 5.49 | accuracy 0 | mrr 0 | ppl 44.95 | wps 23603.1 | ups 2.93 | wpb 8045.7 | bsz 127.8 | num_updates 975 | lr 0.001 | gnorm 0.454 | clip 0 | train_wall 41 | wall 310 (progress_bar.py:269, print())
[2021-04-06 01:38:19]    INFO >> epoch 005 | valid on 'valid' subset | loss 5.413 | accuracy 0.370736 | mrr 0.475747 | ppl 42.6 | wps 39924.1 | wpb 14868.2 | bsz 233.3 | num_updates 975 | best_loss 5.413 (progress_bar.py:269, print())
[2021-04-06 01:38:30]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq3lrnn/checkpoints/checkpoint_best.pt (epoch 5 @ 975 updates, score 5.413) (writing took 10.506247 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-06 01:38:41]    INFO >> epoch 006:     25 / 195 loss=5.725, accuracy=0, mrr=0, ppl=52.91, wps=22114, ups=2.75, wpb=8042.6, bsz=127.8, num_updates=1000, lr=0.001, gnorm=0.453, clip=0, train_wall=106, wall=339 (progress_bar.py:260, log())
[2021-04-06 01:39:18]    INFO >> epoch 006 | loss 5.235 | accuracy 0 | mrr 0 | ppl 37.66 | wps 23462.4 | ups 2.92 | wpb 8045.7 | bsz 127.8 | num_updates 1170 | lr 0.001 | gnorm 0.412 | clip 0 | train_wall 42 | wall 377 (progress_bar.py:269, print())
[2021-04-06 01:39:26]    INFO >> epoch 006 | valid on 'valid' subset | loss 5.22 | accuracy 0.384759 | mrr 0.49308 | ppl 37.28 | wps 39899.6 | wpb 14868.2 | bsz 233.3 | num_updates 1170 | best_loss 5.22 (progress_bar.py:269, print())
[2021-04-06 01:39:37]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq3lrnn/checkpoints/checkpoint_best.pt (epoch 6 @ 1170 updates, score 5.22) (writing took 10.488066 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-06 01:40:25]    INFO >> epoch 007 | loss 5.024 | accuracy 0 | mrr 0 | ppl 32.54 | wps 23439.5 | ups 2.91 | wpb 8045.7 | bsz 127.8 | num_updates 1365 | lr 0.001 | gnorm 0.389 | clip 0 | train_wall 42 | wall 444 (progress_bar.py:269, print())
[2021-04-06 01:40:33]    INFO >> epoch 007 | valid on 'valid' subset | loss 5.046 | accuracy 0.406663 | mrr 0.513306 | ppl 33.03 | wps 40683.4 | wpb 14868.2 | bsz 233.3 | num_updates 1365 | best_loss 5.046 (progress_bar.py:269, print())
[2021-04-06 01:40:43]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq3lrnn/checkpoints/checkpoint_best.pt (epoch 7 @ 1365 updates, score 5.046) (writing took 10.429826 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-06 01:41:18]    INFO >> epoch 008:    135 / 195 loss=5.048, accuracy=0, mrr=0, ppl=33.08, wps=25595.8, ups=3.18, wpb=8057.1, bsz=127.9, num_updates=1500, lr=0.001, gnorm=0.394, clip=0, train_wall=107, wall=497 (progress_bar.py:260, log())
[2021-04-06 01:41:32]    INFO >> epoch 008 | loss 4.838 | accuracy 0 | mrr 0 | ppl 28.6 | wps 23632.8 | ups 2.94 | wpb 8045.7 | bsz 127.8 | num_updates 1560 | lr 0.001 | gnorm 0.375 | clip 0 | train_wall 41 | wall 510 (progress_bar.py:269, print())
[2021-04-06 01:41:40]    INFO >> epoch 008 | valid on 'valid' subset | loss 4.906 | accuracy 0.419195 | mrr 0.52567 | ppl 29.98 | wps 37309.7 | wpb 14868.2 | bsz 233.3 | num_updates 1560 | best_loss 4.906 (progress_bar.py:269, print())
[2021-04-06 01:41:50]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq3lrnn/checkpoints/checkpoint_best.pt (epoch 8 @ 1560 updates, score 4.906) (writing took 10.426791 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-06 01:42:38]    INFO >> epoch 009 | loss 4.686 | accuracy 0 | mrr 0 | ppl 25.74 | wps 23617.1 | ups 2.94 | wpb 8045.7 | bsz 127.8 | num_updates 1755 | lr 0.001 | gnorm 0.359 | clip 0 | train_wall 41 | wall 576 (progress_bar.py:269, print())
[2021-04-06 01:42:46]    INFO >> epoch 009 | valid on 'valid' subset | loss 4.776 | accuracy 0.429676 | mrr 0.536885 | ppl 27.39 | wps 39220.4 | wpb 14868.2 | bsz 233.3 | num_updates 1755 | best_loss 4.776 (progress_bar.py:269, print())
[2021-04-06 01:42:57]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq3lrnn/checkpoints/checkpoint_best.pt (epoch 9 @ 1755 updates, score 4.776) (writing took 10.548680 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-06 01:43:45]    INFO >> epoch 010 | loss 4.55 | accuracy 0 | mrr 0 | ppl 23.43 | wps 23340 | ups 2.9 | wpb 8045.7 | bsz 127.8 | num_updates 1950 | lr 0.001 | gnorm 0.336 | clip 0 | train_wall 42 | wall 644 (progress_bar.py:269, print())
[2021-04-06 01:43:53]    INFO >> epoch 010 | valid on 'valid' subset | loss 4.677 | accuracy 0.433802 | mrr 0.542497 | ppl 25.58 | wps 38939.7 | wpb 14868.2 | bsz 233.3 | num_updates 1950 | best_loss 4.677 (progress_bar.py:269, print())
[2021-04-06 01:44:04]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq3lrnn/checkpoints/checkpoint_best.pt (epoch 10 @ 1950 updates, score 4.677) (writing took 10.564312 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-06 01:44:20]    INFO >> epoch 011:     50 / 195 loss=4.622, accuracy=0, mrr=0, ppl=24.62, wps=22099.5, ups=2.75, wpb=8045.7, bsz=127.8, num_updates=2000, lr=0.001, gnorm=0.351, clip=0, train_wall=107, wall=679 (progress_bar.py:260, log())
[2021-04-06 01:44:52]    INFO >> epoch 011 | loss 4.432 | accuracy 0 | mrr 0 | ppl 21.58 | wps 23634.8 | ups 2.94 | wpb 8045.7 | bsz 127.8 | num_updates 2145 | lr 0.001 | gnorm 0.319 | clip 0 | train_wall 41 | wall 710 (progress_bar.py:269, print())
[2021-04-06 01:45:00]    INFO >> epoch 011 | valid on 'valid' subset | loss 4.591 | accuracy 0.444148 | mrr 0.550917 | ppl 24.11 | wps 40741.9 | wpb 14868.2 | bsz 233.3 | num_updates 2145 | best_loss 4.591 (progress_bar.py:269, print())
[2021-04-06 01:45:10]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq3lrnn/checkpoints/checkpoint_best.pt (epoch 11 @ 2145 updates, score 4.591) (writing took 10.488577 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-06 01:45:59]    INFO >> epoch 012 | loss 4.327 | accuracy 0 | mrr 0 | ppl 20.07 | wps 23296.2 | ups 2.9 | wpb 8045.7 | bsz 127.8 | num_updates 2340 | lr 0.001 | gnorm 0.309 | clip 0 | train_wall 42 | wall 777 (progress_bar.py:269, print())
[2021-04-06 01:46:07]    INFO >> epoch 012 | valid on 'valid' subset | loss 4.53 | accuracy 0.447937 | mrr 0.555619 | ppl 23.1 | wps 39341.5 | wpb 14868.2 | bsz 233.3 | num_updates 2340 | best_loss 4.53 (progress_bar.py:269, print())
[2021-04-06 01:46:18]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq3lrnn/checkpoints/checkpoint_best.pt (epoch 12 @ 2340 updates, score 4.53) (writing took 10.509897 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-06 01:46:58]    INFO >> epoch 013:    160 / 195 loss=4.327, accuracy=0, mrr=0, ppl=20.07, wps=25509.2, ups=3.18, wpb=8033.5, bsz=127.9, num_updates=2500, lr=0.001, gnorm=0.307, clip=0, train_wall=107, wall=836 (progress_bar.py:260, log())
[2021-04-06 01:47:06]    INFO >> epoch 013 | loss 4.233 | accuracy 0 | mrr 0 | ppl 18.8 | wps 23396.9 | ups 2.91 | wpb 8045.7 | bsz 127.8 | num_updates 2535 | lr 0.001 | gnorm 0.301 | clip 0 | train_wall 42 | wall 844 (progress_bar.py:269, print())
[2021-04-06 01:47:14]    INFO >> epoch 013 | valid on 'valid' subset | loss 4.475 | accuracy 0.450403 | mrr 0.559006 | ppl 22.23 | wps 39111.8 | wpb 14868.2 | bsz 233.3 | num_updates 2535 | best_loss 4.475 (progress_bar.py:269, print())
[2021-04-06 01:47:24]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq3lrnn/checkpoints/checkpoint_best.pt (epoch 13 @ 2535 updates, score 4.475) (writing took 10.499657 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-06 01:48:13]    INFO >> epoch 014 | loss 4.146 | accuracy 0 | mrr 0 | ppl 17.71 | wps 23486.1 | ups 2.92 | wpb 8045.7 | bsz 127.8 | num_updates 2730 | lr 0.001 | gnorm 0.295 | clip 0 | train_wall 42 | wall 911 (progress_bar.py:269, print())
[2021-04-06 01:48:21]    INFO >> epoch 014 | valid on 'valid' subset | loss 4.421 | accuracy 0.455963 | mrr 0.564241 | ppl 21.43 | wps 38562.8 | wpb 14868.2 | bsz 233.3 | num_updates 2730 | best_loss 4.421 (progress_bar.py:269, print())
[2021-04-06 01:48:31]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq3lrnn/checkpoints/checkpoint_best.pt (epoch 14 @ 2730 updates, score 4.421) (writing took 10.156470 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-06 01:49:19]    INFO >> epoch 015 | loss 4.067 | accuracy 0 | mrr 0 | ppl 16.76 | wps 23548 | ups 2.93 | wpb 8045.7 | bsz 127.8 | num_updates 2925 | lr 0.001 | gnorm 0.296 | clip 0 | train_wall 42 | wall 978 (progress_bar.py:269, print())
[2021-04-06 01:49:27]    INFO >> epoch 015 | valid on 'valid' subset | loss 4.389 | accuracy 0.457544 | mrr 0.566433 | ppl 20.95 | wps 39831.7 | wpb 14868.2 | bsz 233.3 | num_updates 2925 | best_loss 4.389 (progress_bar.py:269, print())
[2021-04-06 01:49:37]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq3lrnn/checkpoints/checkpoint_best.pt (epoch 15 @ 2925 updates, score 4.389) (writing took 10.074675 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-06 01:50:00]    INFO >> epoch 016:     75 / 195 loss=4.099, accuracy=0, mrr=0, ppl=17.14, wps=22128.4, ups=2.74, wpb=8063.7, bsz=127.8, num_updates=3000, lr=0.001, gnorm=0.293, clip=0, train_wall=108, wall=1018 (progress_bar.py:260, log())
[2021-04-06 01:50:26]    INFO >> epoch 016 | loss 3.994 | accuracy 0 | mrr 0 | ppl 15.94 | wps 23686.2 | ups 2.94 | wpb 8045.7 | bsz 127.8 | num_updates 3120 | lr 0.001 | gnorm 0.298 | clip 0 | train_wall 42 | wall 1044 (progress_bar.py:269, print())
[2021-04-06 01:50:34]    INFO >> epoch 016 | valid on 'valid' subset | loss 4.351 | accuracy 0.460054 | mrr 0.569349 | ppl 20.41 | wps 40335.9 | wpb 14868.2 | bsz 233.3 | num_updates 3120 | best_loss 4.351 (progress_bar.py:269, print())
[2021-04-06 01:50:44]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq3lrnn/checkpoints/checkpoint_best.pt (epoch 16 @ 3120 updates, score 4.351) (writing took 10.386244 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-06 01:51:33]    INFO >> epoch 017 | loss 3.927 | accuracy 0 | mrr 0 | ppl 15.21 | wps 23412.7 | ups 2.91 | wpb 8045.7 | bsz 127.8 | num_updates 3315 | lr 0.001 | gnorm 0.298 | clip 0 | train_wall 42 | wall 1111 (progress_bar.py:269, print())
[2021-04-06 01:51:41]    INFO >> epoch 017 | valid on 'valid' subset | loss 4.321 | accuracy 0.461635 | mrr 0.571834 | ppl 19.99 | wps 38564.4 | wpb 14868.2 | bsz 233.3 | num_updates 3315 | best_loss 4.321 (progress_bar.py:269, print())
[2021-04-06 01:51:51]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq3lrnn/checkpoints/checkpoint_best.pt (epoch 17 @ 3315 updates, score 4.321) (writing took 10.608082 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-06 01:52:37]    INFO >> epoch 018:    185 / 195 loss=3.916, accuracy=0, mrr=0, ppl=15.09, wps=25630.7, ups=3.19, wpb=8029.2, bsz=127.9, num_updates=3500, lr=0.001, gnorm=0.302, clip=0, train_wall=106, wall=1175 (progress_bar.py:260, log())
[2021-04-06 01:52:39]    INFO >> epoch 018 | loss 3.863 | accuracy 0 | mrr 0 | ppl 14.55 | wps 23519.1 | ups 2.92 | wpb 8045.7 | bsz 127.8 | num_updates 3510 | lr 0.001 | gnorm 0.3 | clip 0 | train_wall 41 | wall 1178 (progress_bar.py:269, print())
[2021-04-06 01:52:47]    INFO >> epoch 018 | valid on 'valid' subset | loss 4.29 | accuracy 0.464852 | mrr 0.574862 | ppl 19.56 | wps 39431 | wpb 14868.2 | bsz 233.3 | num_updates 3510 | best_loss 4.29 (progress_bar.py:269, print())
[2021-04-06 01:52:58]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq3lrnn/checkpoints/checkpoint_best.pt (epoch 18 @ 3510 updates, score 4.29) (writing took 10.437361 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-06 01:53:46]    INFO >> epoch 019 | loss 3.8 | accuracy 0 | mrr 0 | ppl 13.93 | wps 23497.1 | ups 2.92 | wpb 8045.7 | bsz 127.8 | num_updates 3705 | lr 0.001 | gnorm 0.293 | clip 0 | train_wall 42 | wall 1245 (progress_bar.py:269, print())
[2021-04-06 01:53:54]    INFO >> epoch 019 | valid on 'valid' subset | loss 4.264 | accuracy 0.465659 | mrr 0.576706 | ppl 19.22 | wps 37995.9 | wpb 14868.2 | bsz 233.3 | num_updates 3705 | best_loss 4.264 (progress_bar.py:269, print())
[2021-04-06 01:54:05]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq3lrnn/checkpoints/checkpoint_best.pt (epoch 19 @ 3705 updates, score 4.264) (writing took 10.668416 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-06 01:54:54]    INFO >> epoch 020 | loss 3.741 | accuracy 0 | mrr 0 | ppl 13.37 | wps 23261.5 | ups 2.89 | wpb 8045.7 | bsz 127.8 | num_updates 3900 | lr 0.001 | gnorm 0.301 | clip 0 | train_wall 42 | wall 1312 (progress_bar.py:269, print())
[2021-04-06 01:55:02]    INFO >> epoch 020 | valid on 'valid' subset | loss 4.24 | accuracy 0.466993 | mrr 0.578446 | ppl 18.9 | wps 38378.5 | wpb 14868.2 | bsz 233.3 | num_updates 3900 | best_loss 4.24 (progress_bar.py:269, print())
[2021-04-06 01:55:12]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq3lrnn/checkpoints/checkpoint_best.pt (epoch 20 @ 3900 updates, score 4.24) (writing took 10.905284 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-06 01:55:40]    INFO >> epoch 021:    100 / 195 loss=3.753, accuracy=0, mrr=0, ppl=13.48, wps=21950.9, ups=2.72, wpb=8062.6, bsz=127.8, num_updates=4000, lr=0.001, gnorm=0.295, clip=0, train_wall=108, wall=1359 (progress_bar.py:260, log())
[2021-04-06 01:56:01]    INFO >> epoch 021 | loss 3.681 | accuracy 0 | mrr 0 | ppl 12.83 | wps 23236.1 | ups 2.89 | wpb 8045.7 | bsz 127.8 | num_updates 4095 | lr 0.001 | gnorm 0.287 | clip 0 | train_wall 42 | wall 1380 (progress_bar.py:269, print())
[2021-04-06 01:56:09]    INFO >> epoch 021 | valid on 'valid' subset | loss 4.218 | accuracy 0.468921 | mrr 0.580449 | ppl 18.61 | wps 39690.5 | wpb 14868.2 | bsz 233.3 | num_updates 4095 | best_loss 4.218 (progress_bar.py:269, print())
[2021-04-06 01:56:20]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq3lrnn/checkpoints/checkpoint_best.pt (epoch 21 @ 4095 updates, score 4.218) (writing took 10.588753 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-06 01:57:08]    INFO >> epoch 022 | loss 3.626 | accuracy 0 | mrr 0 | ppl 12.34 | wps 23353.9 | ups 2.9 | wpb 8045.7 | bsz 127.8 | num_updates 4290 | lr 0.001 | gnorm 0.297 | clip 0 | train_wall 42 | wall 1447 (progress_bar.py:269, print())
[2021-04-06 01:57:16]    INFO >> epoch 022 | valid on 'valid' subset | loss 4.213 | accuracy 0.46845 | mrr 0.581018 | ppl 18.54 | wps 39225.3 | wpb 14868.2 | bsz 233.3 | num_updates 4290 | best_loss 4.213 (progress_bar.py:269, print())
[2021-04-06 01:57:27]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq3lrnn/checkpoints/checkpoint_best.pt (epoch 22 @ 4290 updates, score 4.213) (writing took 10.519359 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-06 01:58:15]    INFO >> epoch 023 | loss 3.569 | accuracy 0 | mrr 0 | ppl 11.87 | wps 23472 | ups 2.92 | wpb 8045.7 | bsz 127.8 | num_updates 4485 | lr 0.001 | gnorm 0.29 | clip 0 | train_wall 42 | wall 1514 (progress_bar.py:269, print())
[2021-04-06 01:58:23]    INFO >> epoch 023 | valid on 'valid' subset | loss 4.184 | accuracy 0.470748 | mrr 0.583367 | ppl 18.18 | wps 37846.3 | wpb 14868.2 | bsz 233.3 | num_updates 4485 | best_loss 4.184 (progress_bar.py:269, print())
[2021-04-06 01:58:34]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq3lrnn/checkpoints/checkpoint_best.pt (epoch 23 @ 4485 updates, score 4.184) (writing took 10.592001 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-06 01:58:43]    INFO >> epoch 024:     15 / 195 loss=3.612, accuracy=0, mrr=0, ppl=12.22, wps=22022.1, ups=2.74, wpb=8029.1, bsz=127.8, num_updates=4500, lr=0.001, gnorm=0.292, clip=0, train_wall=107, wall=1541 (progress_bar.py:260, log())
[2021-04-06 01:59:22]    INFO >> epoch 024 | loss 3.517 | accuracy 0 | mrr 0 | ppl 11.45 | wps 23409.1 | ups 2.91 | wpb 8045.7 | bsz 127.8 | num_updates 4680 | lr 0.001 | gnorm 0.311 | clip 0 | train_wall 42 | wall 1581 (progress_bar.py:269, print())
[2021-04-06 01:59:30]    INFO >> epoch 024 | valid on 'valid' subset | loss 4.171 | accuracy 0.472733 | mrr 0.585125 | ppl 18.02 | wps 39963.3 | wpb 14868.2 | bsz 233.3 | num_updates 4680 | best_loss 4.171 (progress_bar.py:269, print())
[2021-04-06 01:59:41]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq3lrnn/checkpoints/checkpoint_best.pt (epoch 24 @ 4680 updates, score 4.171) (writing took 10.694575 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-06 02:00:30]    INFO >> epoch 025 | loss 3.463 | accuracy 0 | mrr 0 | ppl 11.03 | wps 23303 | ups 2.9 | wpb 8045.7 | bsz 127.8 | num_updates 4875 | lr 0.001 | gnorm 0.3 | clip 0 | train_wall 42 | wall 1648 (progress_bar.py:269, print())
[2021-04-06 02:00:37]    INFO >> epoch 025 | valid on 'valid' subset | loss 4.163 | accuracy 0.472407 | mrr 0.585603 | ppl 17.91 | wps 39818.5 | wpb 14868.2 | bsz 233.3 | num_updates 4875 | best_loss 4.163 (progress_bar.py:269, print())
[2021-04-06 02:00:48]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq3lrnn/checkpoints/checkpoint_best.pt (epoch 25 @ 4875 updates, score 4.163) (writing took 10.904371 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-06 02:01:21]    INFO >> epoch 026:    125 / 195 loss=3.47, accuracy=0, mrr=0, ppl=11.08, wps=25355.2, ups=3.15, wpb=8057.5, bsz=127.9, num_updates=5000, lr=0.001, gnorm=0.301, clip=0, train_wall=108, wall=1700 (progress_bar.py:260, log())
[2021-04-06 02:01:37]    INFO >> epoch 026 | loss 3.41 | accuracy 0 | mrr 0 | ppl 10.63 | wps 23305.3 | ups 2.9 | wpb 8045.7 | bsz 127.8 | num_updates 5070 | lr 0.001 | gnorm 0.29 | clip 0 | train_wall 42 | wall 1715 (progress_bar.py:269, print())
[2021-04-06 02:01:45]    INFO >> epoch 026 | valid on 'valid' subset | loss 4.153 | accuracy 0.472744 | mrr 0.58615 | ppl 17.78 | wps 40007.8 | wpb 14868.2 | bsz 233.3 | num_updates 5070 | best_loss 4.153 (progress_bar.py:269, print())
[2021-04-06 02:01:55]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq3lrnn/checkpoints/checkpoint_best.pt (epoch 26 @ 5070 updates, score 4.153) (writing took 10.414193 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-06 02:02:43]    INFO >> epoch 027 | loss 3.365 | accuracy 0 | mrr 0 | ppl 10.3 | wps 23621.7 | ups 2.94 | wpb 8045.7 | bsz 127.8 | num_updates 5265 | lr 0.001 | gnorm 0.311 | clip 0 | train_wall 41 | wall 1782 (progress_bar.py:269, print())
[2021-04-06 02:02:51]    INFO >> epoch 027 | valid on 'valid' subset | loss 4.136 | accuracy 0.474649 | mrr 0.587695 | ppl 17.59 | wps 39444.2 | wpb 14868.2 | bsz 233.3 | num_updates 5265 | best_loss 4.136 (progress_bar.py:269, print())
[2021-04-06 02:03:02]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq3lrnn/checkpoints/checkpoint_best.pt (epoch 27 @ 5265 updates, score 4.136) (writing took 10.531567 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-06 02:03:50]    INFO >> epoch 028 | loss 3.315 | accuracy 0 | mrr 0 | ppl 9.95 | wps 23499.3 | ups 2.92 | wpb 8045.7 | bsz 127.8 | num_updates 5460 | lr 0.001 | gnorm 0.302 | clip 0 | train_wall 42 | wall 1848 (progress_bar.py:269, print())
[2021-04-06 02:03:58]    INFO >> epoch 028 | valid on 'valid' subset | loss 4.137 | accuracy 0.475591 | mrr 0.588553 | ppl 17.59 | wps 38374.8 | wpb 14868.2 | bsz 233.3 | num_updates 5460 | best_loss 4.136 (progress_bar.py:269, print())
[2021-04-06 02:04:04]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq3lrnn/checkpoints/checkpoint_last.pt (epoch 28 @ 5460 updates, score 4.137) (writing took 5.564012 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-06 02:04:18]    INFO >> epoch 029:     40 / 195 loss=3.341, accuracy=0, mrr=0, ppl=10.13, wps=22763.8, ups=2.83, wpb=8049.3, bsz=127.8, num_updates=5500, lr=0.001, gnorm=0.304, clip=0, train_wall=107, wall=1877 (progress_bar.py:260, log())
[2021-04-06 02:04:52]    INFO >> epoch 029 | loss 3.267 | accuracy 0 | mrr 0 | ppl 9.63 | wps 25276.7 | ups 3.14 | wpb 8045.7 | bsz 127.8 | num_updates 5655 | lr 0.001 | gnorm 0.299 | clip 0 | train_wall 42 | wall 1911 (progress_bar.py:269, print())
[2021-04-06 02:05:00]    INFO >> epoch 029 | valid on 'valid' subset | loss 4.131 | accuracy 0.473797 | mrr 0.588097 | ppl 17.52 | wps 39057.4 | wpb 14868.2 | bsz 233.3 | num_updates 5655 | best_loss 4.131 (progress_bar.py:269, print())
[2021-04-06 02:05:11]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq3lrnn/checkpoints/checkpoint_best.pt (epoch 29 @ 5655 updates, score 4.131) (writing took 10.517249 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-06 02:05:59]    INFO >> epoch 030 | loss 3.221 | accuracy 0 | mrr 0 | ppl 9.32 | wps 23443.7 | ups 2.91 | wpb 8045.7 | bsz 127.8 | num_updates 5850 | lr 0.001 | gnorm 0.296 | clip 0 | train_wall 42 | wall 1977 (progress_bar.py:269, print())
[2021-04-06 02:06:07]    INFO >> epoch 030 | valid on 'valid' subset | loss 4.137 | accuracy 0.476039 | mrr 0.589275 | ppl 17.59 | wps 38237.2 | wpb 14868.2 | bsz 233.3 | num_updates 5850 | best_loss 4.131 (progress_bar.py:269, print())
[2021-04-06 02:06:13]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq3lrnn/checkpoints/checkpoint_last.pt (epoch 30 @ 5850 updates, score 4.137) (writing took 5.731696 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-06 02:06:51]    INFO >> epoch 031:    150 / 195 loss=3.223, accuracy=0, mrr=0, ppl=9.34, wps=26266, ups=3.27, wpb=8038.9, bsz=127.9, num_updates=6000, lr=0.001, gnorm=0.3, clip=0, train_wall=107, wall=2030 (progress_bar.py:260, log())
[2021-04-06 02:07:01]    INFO >> epoch 031 | loss 3.177 | accuracy 0 | mrr 0 | ppl 9.04 | wps 25219.7 | ups 3.13 | wpb 8045.7 | bsz 127.8 | num_updates 6045 | lr 0.001 | gnorm 0.302 | clip 0 | train_wall 42 | wall 2040 (progress_bar.py:269, print())
[2021-04-06 02:07:09]    INFO >> epoch 031 | valid on 'valid' subset | loss 4.146 | accuracy 0.473865 | mrr 0.588013 | ppl 17.7 | wps 39488.4 | wpb 14868.2 | bsz 233.3 | num_updates 6045 | best_loss 4.131 (progress_bar.py:269, print())
[2021-04-06 02:07:15]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq3lrnn/checkpoints/checkpoint_last.pt (epoch 31 @ 6045 updates, score 4.146) (writing took 5.632698 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-06 02:08:03]    INFO >> epoch 032 | loss 3.135 | accuracy 0 | mrr 0 | ppl 8.78 | wps 25261.8 | ups 3.14 | wpb 8045.7 | bsz 127.8 | num_updates 6240 | lr 0.001 | gnorm 0.311 | clip 0 | train_wall 42 | wall 2102 (progress_bar.py:269, print())
[2021-04-06 02:08:11]    INFO >> epoch 032 | valid on 'valid' subset | loss 4.137 | accuracy 0.475703 | mrr 0.589497 | ppl 17.6 | wps 39324.3 | wpb 14868.2 | bsz 233.3 | num_updates 6240 | best_loss 4.131 (progress_bar.py:269, print())
[2021-04-06 02:08:17]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq3lrnn/checkpoints/checkpoint_last.pt (epoch 32 @ 6240 updates, score 4.137) (writing took 5.584266 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-06 02:09:06]    INFO >> epoch 033 | loss 3.093 | accuracy 0 | mrr 0 | ppl 8.53 | wps 25181.9 | ups 3.13 | wpb 8045.7 | bsz 127.8 | num_updates 6435 | lr 0.001 | gnorm 0.311 | clip 0 | train_wall 42 | wall 2164 (progress_bar.py:269, print())
[2021-04-06 02:09:14]    INFO >> epoch 033 | valid on 'valid' subset | loss 4.142 | accuracy 0.475266 | mrr 0.58949 | ppl 17.66 | wps 39533.9 | wpb 14868.2 | bsz 233.3 | num_updates 6435 | best_loss 4.131 (progress_bar.py:269, print())
[2021-04-06 02:09:19]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq3lrnn/checkpoints/checkpoint_last.pt (epoch 33 @ 6435 updates, score 4.142) (writing took 5.483616 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-06 02:09:39]    INFO >> epoch 034:     65 / 195 loss=3.11, accuracy=0, mrr=0, ppl=8.63, wps=23972.3, ups=2.98, wpb=8046.8, bsz=127.8, num_updates=6500, lr=0.001, gnorm=0.309, clip=0, train_wall=107, wall=2198 (progress_bar.py:260, log())
[2021-04-06 02:10:08]    INFO >> epoch 034 | loss 3.052 | accuracy 0 | mrr 0 | ppl 8.29 | wps 25336.5 | ups 3.15 | wpb 8045.7 | bsz 127.8 | num_updates 6630 | lr 0.001 | gnorm 0.308 | clip 0 | train_wall 42 | wall 2226 (progress_bar.py:269, print())
[2021-04-06 02:10:16]    INFO >> epoch 034 | valid on 'valid' subset | loss 4.147 | accuracy 0.477295 | mrr 0.590156 | ppl 17.71 | wps 39924 | wpb 14868.2 | bsz 233.3 | num_updates 6630 | best_loss 4.131 (progress_bar.py:269, print())
[2021-04-06 02:10:21]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq3lrnn/checkpoints/checkpoint_last.pt (epoch 34 @ 6630 updates, score 4.147) (writing took 5.637354 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-06 02:10:21]    INFO >> early stop since valid performance hasn't improved for last 5 runs (train.py:176, should_stop_early())
[2021-04-06 02:10:21]    INFO >> early stop since valid performance hasn't improved for last 5 runs (train.py:259, single_main())
[2021-04-06 02:10:21]    INFO >> done training in 2239.5 seconds (train.py:271, single_main())
