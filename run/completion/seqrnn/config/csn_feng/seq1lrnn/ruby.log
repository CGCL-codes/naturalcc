[2021-04-06 00:48:16]    INFO >> Load arguments in /home/wanyao/yang/naturalcc-dev/run/completion/seqrnn/config/csn_feng/seq1lrnn/ruby.yml (train.py:291, cli_main())
[2021-04-06 00:48:16]    INFO >> {'criterion': 'completion_cross_entropy', 'optimizer': 'torch_adam', 'lr_scheduler': 'fixed', 'tokenizer': None, 'bpe': None, 'common': {'no_progress_bar': 0, 'log_interval': 500, 'log_format': 'simple', 'tensorboard_logdir': '', 'memory_efficient_fp16': 0, 'fp16_no_flatten_grads': 0, 'fp16_init_scale': 128, 'fp16_scale_window': None, 'fp16_scale_tolerance': 0.0, 'min_loss_scale': 0.0001, 'threshold_loss_scale': None, 'empty_cache_freq': 0, 'task': 'completion', 'seed': 666, 'cpu': 0, 'fp16': 0, 'fp16_opt_level': '01', 'server_ip': '', 'server_port': ''}, 'dataset': {'num_workers': 3, 'skip_invalid_size_inputs_valid_test': 0, 'max_tokens': 100000.0, 'max_sentences': 64, 'required_batch_size_multiple': 8, 'dataset_impl': 'mmap', 'train_subset': 'train', 'valid_subset': 'valid', 'validate_interval': 1, 'fixed_validation_seed': None, 'disable_validation': 0, 'max_tokens_valid': None, 'max_sentences_valid': 64, 'curriculum': 5, 'n_ctx': 1000, 'gen_subset': 'test', 'num_shards': 1, 'shard_id': 0}, 'distributed_training': {'distributed_world_size': 4, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': None, 'distributed_port': -1, 'device_id': 0, 'distributed_no_spawn': 0, 'ddp_backend': 'c10d', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': None, 'find_unused_parameters': 0, 'fast_stat_sync': 0, 'broadcast_buffers': 0, 'global_sync_iter': 50, 'warmup_iterations': 500, 'local_rank': -1}, 'task': {'data': '/mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby', 'target_lang': 'code_tokens', 'max_target_positions': 513, 'add_bos_token': 0, 'eval_bleu': 0, 'eval_bleu_detok': 'space', 'eval_bleu_detok_args': None, 'eval_tokenized_bleu': 0, 'eval_bleu_remove_bpe': None, 'eval_bleu_args': None, 'eval_bleu_print_samples': 0, 'eval_accuracy': 1, 'eval_mrr': 1}, 'model': {'arch': 'completion_seqrnn', 'dropout': 0.1, 'decoder_embed_dim': 300, 'decoder_embed_path': None, 'decoder_freeze_embed': None, 'decoder_hidden_size': 300, 'decoder_layers': 1, 'decoder_out_embed_dim': 300, 'decoder_attention': 0, 'adaptive_softmax_cutoff': None, 'share_decoder_input_output_embed': 0, 'share_all_embeddings': 0, 'encoder_dropout_in': 0.1, 'encoder_dropout_out': 0.1, 'decoder_dropout_in': 0.1, 'decoder_dropout_out': 0.1, 'max_target_positions': 513, 'shared_embedding': 1}, 'optimization': {'max_epoch': 100, 'max_update': 0, 'clip_norm': 25, 'update_freq': [1], 'lrs': [0.001], 'min_lr': -1, 'use_bmuf': 0, 'force_anneal': None, 'warmup_updates': 0, 'end_learning_rate': 0.0, 'power': 1.0, 'total_num_update': 125000, 'sentence_avg': None, 'adam': {'adam_betas': '(0.9, 0.999)', 'adam_eps': 1e-08, 'weight_decay': 0.0, 'use_old_adam': 0}, 'weight_decay': 0.0, 'adam_epsilon': 1e-08, 'max_grad_norm': 1.0, 'num_train_epochs': 5, 'max_steps': -1, 'warmup_steps': 0, 'gradient_accumulation_steps': 1, 'label_smoothing': 0.1, 'distill_temp': 0.6, 'kd_loss_weight': 0.25}, 'kd': {'gen_topk': 5, 'distill_topk': 5}, 'checkpoint': {'save_dir': '/mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq1lrnn/checkpoints', 'restore_file': 'checkpoint_last.pt', 'reset_dataloader': None, 'reset_lr_scheduler': None, 'reset_meters': None, 'reset_optimizer': None, 'optimizer_overrides': '{}', 'save_interval': 1, 'save_interval_updates': 0, 'keep_interval_updates': 0, 'keep_last_epochs': -1, 'keep_best_checkpoints': -1, 'no_save': 0, 'no_epoch_checkpoints': 1, 'no_last_checkpoints': 0, 'no_save_optimizer_state': None, 'best_checkpoint_metric': 'loss', 'maximize_best_checkpoint_metric': 0, 'patience': 5, 'should_continue': 0, 'model_name_or_path': None, 'cache_dir': None, 'logging_steps': 500, 'save_steps': 2000, 'save_total_limit': 2, 'overwrite_output_dir': 0, 'overwrite_cache': 0}, 'eval': {'path': '/mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq1lrnn/checkpoints/checkpoint_best.pt', 'model_overrides': '{}', 'checkpoint_suffix': '', 'predict_type': 'leaf_ids', 'max_sentences_eval': 64}} (train.py:293, cli_main())
[2021-04-06 00:48:18]    INFO >> distributed init (rank 2): tcp://localhost:16712 (distributed_utils.py:84, distributed_init())
[2021-04-06 00:48:18]    INFO >> distributed init (rank 0): tcp://localhost:16712 (distributed_utils.py:84, distributed_init())
[2021-04-06 00:48:18]    INFO >> distributed init (rank 3): tcp://localhost:16712 (distributed_utils.py:84, distributed_init())
[2021-04-06 00:48:18]    INFO >> Added key: store_based_barrier_key:1 to store for rank: 3 (distributed_c10d.py:187, _store_based_barrier())
[2021-04-06 00:48:18]    INFO >> distributed init (rank 1): tcp://localhost:16712 (distributed_utils.py:84, distributed_init())
[2021-04-06 00:48:18]    INFO >> Added key: store_based_barrier_key:1 to store for rank: 1 (distributed_c10d.py:187, _store_based_barrier())
[2021-04-06 00:48:19]    INFO >> Added key: store_based_barrier_key:1 to store for rank: 2 (distributed_c10d.py:187, _store_based_barrier())
[2021-04-06 00:48:19]    INFO >> Added key: store_based_barrier_key:1 to store for rank: 0 (distributed_c10d.py:187, _store_based_barrier())
[2021-04-06 00:48:19]    INFO >> initialized host node14 as rank 0 (distributed_utils.py:93, distributed_init())
[2021-04-06 00:48:19]    INFO >> initialized host node14 as rank 2 (distributed_utils.py:93, distributed_init())
[2021-04-06 00:48:19]    INFO >> initialized host node14 as rank 1 (distributed_utils.py:93, distributed_init())
[2021-04-06 00:48:19]    INFO >> initialized host node14 as rank 3 (distributed_utils.py:93, distributed_init())
[2021-04-06 00:48:24]    INFO >> {'criterion': 'completion_cross_entropy', 'optimizer': 'torch_adam', 'lr_scheduler': 'fixed', 'tokenizer': None, 'bpe': None, 'common': {'no_progress_bar': 0, 'log_interval': 500, 'log_format': 'simple', 'tensorboard_logdir': '', 'memory_efficient_fp16': 0, 'fp16_no_flatten_grads': 0, 'fp16_init_scale': 128, 'fp16_scale_window': None, 'fp16_scale_tolerance': 0.0, 'min_loss_scale': 0.0001, 'threshold_loss_scale': None, 'empty_cache_freq': 0, 'task': 'completion', 'seed': 666, 'cpu': 0, 'fp16': 0, 'fp16_opt_level': '01', 'server_ip': '', 'server_port': ''}, 'dataset': {'num_workers': 3, 'skip_invalid_size_inputs_valid_test': 0, 'max_tokens': 100000.0, 'max_sentences': 64, 'required_batch_size_multiple': 8, 'dataset_impl': 'mmap', 'train_subset': 'train', 'valid_subset': 'valid', 'validate_interval': 1, 'fixed_validation_seed': None, 'disable_validation': 0, 'max_tokens_valid': None, 'max_sentences_valid': 64, 'curriculum': 5, 'n_ctx': 1000, 'gen_subset': 'test', 'num_shards': 1, 'shard_id': 0}, 'distributed_training': {'distributed_world_size': 4, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': 'tcp://localhost:16712', 'distributed_port': -1, 'device_id': 0, 'distributed_no_spawn': 0, 'ddp_backend': 'c10d', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': None, 'find_unused_parameters': 0, 'fast_stat_sync': 0, 'broadcast_buffers': 0, 'global_sync_iter': 50, 'warmup_iterations': 500, 'local_rank': -1}, 'task': {'data': '/mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby', 'target_lang': 'code_tokens', 'max_target_positions': 513, 'add_bos_token': 0, 'eval_bleu': 0, 'eval_bleu_detok': 'space', 'eval_bleu_detok_args': None, 'eval_tokenized_bleu': 0, 'eval_bleu_remove_bpe': None, 'eval_bleu_args': None, 'eval_bleu_print_samples': 0, 'eval_accuracy': 1, 'eval_mrr': 1}, 'model': {'arch': 'completion_seqrnn', 'dropout': 0.1, 'decoder_embed_dim': 300, 'decoder_embed_path': None, 'decoder_freeze_embed': None, 'decoder_hidden_size': 300, 'decoder_layers': 1, 'decoder_out_embed_dim': 300, 'decoder_attention': 0, 'adaptive_softmax_cutoff': None, 'share_decoder_input_output_embed': 0, 'share_all_embeddings': 0, 'encoder_dropout_in': 0.1, 'encoder_dropout_out': 0.1, 'decoder_dropout_in': 0.1, 'decoder_dropout_out': 0.1, 'max_target_positions': 513, 'shared_embedding': 1}, 'optimization': {'max_epoch': 100, 'max_update': 0, 'clip_norm': 25, 'update_freq': [1], 'lrs': [0.001], 'min_lr': -1, 'use_bmuf': 0, 'force_anneal': None, 'warmup_updates': 0, 'end_learning_rate': 0.0, 'power': 1.0, 'total_num_update': 125000, 'sentence_avg': None, 'adam': {'adam_betas': '(0.9, 0.999)', 'adam_eps': 1e-08, 'weight_decay': 0.0, 'use_old_adam': 0}, 'weight_decay': 0.0, 'adam_epsilon': 1e-08, 'max_grad_norm': 1.0, 'num_train_epochs': 5, 'max_steps': -1, 'warmup_steps': 0, 'gradient_accumulation_steps': 1, 'label_smoothing': 0.1, 'distill_temp': 0.6, 'kd_loss_weight': 0.25}, 'kd': {'gen_topk': 5, 'distill_topk': 5}, 'checkpoint': {'save_dir': '/mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq1lrnn/checkpoints', 'restore_file': 'checkpoint_last.pt', 'reset_dataloader': None, 'reset_lr_scheduler': None, 'reset_meters': None, 'reset_optimizer': None, 'optimizer_overrides': '{}', 'save_interval': 1, 'save_interval_updates': 0, 'keep_interval_updates': 0, 'keep_last_epochs': -1, 'keep_best_checkpoints': -1, 'no_save': 0, 'no_epoch_checkpoints': 1, 'no_last_checkpoints': 0, 'no_save_optimizer_state': None, 'best_checkpoint_metric': 'loss', 'maximize_best_checkpoint_metric': 0, 'patience': 5, 'should_continue': 0, 'model_name_or_path': None, 'cache_dir': None, 'logging_steps': 500, 'save_steps': 2000, 'save_total_limit': 2, 'overwrite_output_dir': 0, 'overwrite_cache': 0}, 'eval': {'path': '/mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq1lrnn/checkpoints/checkpoint_best.pt', 'model_overrides': '{}', 'checkpoint_suffix': '', 'predict_type': 'leaf_ids', 'max_sentences_eval': 64}} (train.py:201, single_main())
[2021-04-06 00:48:24]    INFO >> [code_tokens] dictionary: 50000 types (completion.py:103, setup_task())
[2021-04-06 00:48:24]    INFO >> loaded 1400 examples from: /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/valid.code_tokens (completion.py:43, load_token_dataset())
/home/wanyao/anaconda3/envs/py38-1.8/lib/python3.8/site-packages/torch/nn/modules/rnn.py:60: UserWarning: dropout option adds dropout after all but last recurrent layer, so non-zero dropout expects num_layers greater than 1, but got dropout=0.1 and num_layers=1
  warnings.warn("dropout option adds dropout after all but last "
[2021-04-06 00:48:25]    INFO >> SeqRNNModel(
  (decoder): LSTMDecoder(
    (embed_tokens): Embedding(50000, 300, padding_idx=0)
    (rnn): LSTM(300, 300, batch_first=True, dropout=0.1)
    (fc_out): Linear(in_features=300, out_features=50000, bias=True)
  )
) (train.py:212, single_main())
[2021-04-06 00:48:25]    INFO >> model completion_seqrnn, criterion CompletionCrossEntropyCriterion (train.py:213, single_main())
[2021-04-06 00:48:25]    INFO >> num. model params: 15772400 (num. trained: 15772400) (train.py:214, single_main())
[2021-04-06 00:48:25]    INFO >> training on 4 GPUs (train.py:221, single_main())
[2021-04-06 00:48:25]    INFO >> max tokens per GPU = 100000.0 and max sentences per GPU = 64 (train.py:222, single_main())
[2021-04-06 00:48:25]    INFO >> no existing checkpoint found /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq1lrnn/checkpoints/checkpoint_last.pt (ncc_trainers.py:270, load_checkpoint())
[2021-04-06 00:48:25]    INFO >> loading train data for epoch 1 (ncc_trainers.py:285, get_train_iterator())
[2021-04-06 00:48:25]    INFO >> loaded 24927 examples from: /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/train.code_tokens (completion.py:43, load_token_dataset())
/home/wanyao/anaconda3/envs/py38-1.8/lib/python3.8/site-packages/torch/nn/parallel/distributed.py:425: UserWarning: The `check_reduction` argument in `DistributedDataParallel` module is deprecated. Please avoid using it.
  warnings.warn(
[2021-04-06 00:48:25]    INFO >> NOTE: your device may support faster training with fp16 (ncc_trainers.py:155, _setup_optimizer())
/home/wanyao/anaconda3/envs/py38-1.8/lib/python3.8/site-packages/torch/nn/modules/rnn.py:60: UserWarning: dropout option adds dropout after all but last recurrent layer, so non-zero dropout expects num_layers greater than 1, but got dropout=0.1 and num_layers=1
  warnings.warn("dropout option adds dropout after all but last "
/home/wanyao/anaconda3/envs/py38-1.8/lib/python3.8/site-packages/torch/nn/parallel/distributed.py:425: UserWarning: The `check_reduction` argument in `DistributedDataParallel` module is deprecated. Please avoid using it.
  warnings.warn(
/home/wanyao/anaconda3/envs/py38-1.8/lib/python3.8/site-packages/torch/nn/modules/rnn.py:60: UserWarning: dropout option adds dropout after all but last recurrent layer, so non-zero dropout expects num_layers greater than 1, but got dropout=0.1 and num_layers=1
  warnings.warn("dropout option adds dropout after all but last "
/home/wanyao/anaconda3/envs/py38-1.8/lib/python3.8/site-packages/torch/nn/parallel/distributed.py:425: UserWarning: The `check_reduction` argument in `DistributedDataParallel` module is deprecated. Please avoid using it.
  warnings.warn(
/home/wanyao/anaconda3/envs/py38-1.8/lib/python3.8/site-packages/torch/nn/modules/rnn.py:60: UserWarning: dropout option adds dropout after all but last recurrent layer, so non-zero dropout expects num_layers greater than 1, but got dropout=0.1 and num_layers=1
  warnings.warn("dropout option adds dropout after all but last "
/home/wanyao/anaconda3/envs/py38-1.8/lib/python3.8/site-packages/torch/nn/parallel/distributed.py:425: UserWarning: The `check_reduction` argument in `DistributedDataParallel` module is deprecated. Please avoid using it.
  warnings.warn(
/home/wanyao/yang/naturalcc-dev/ncc/utils/gradient_clip/fairseq_clip.py:56: UserWarning: amp_C fused kernels unavailable, disabling multi_tensor_l2norm; you may get better performance by installing NVIDIA's apex library
  warnings.warn(
[2021-04-06 00:48:32]    INFO >> Reducer buckets have been rebuilt in this iteration. (distributed.py:693, forward())
/home/wanyao/yang/naturalcc-dev/ncc/utils/gradient_clip/fairseq_clip.py:56: UserWarning: amp_C fused kernels unavailable, disabling multi_tensor_l2norm; you may get better performance by installing NVIDIA's apex library
  warnings.warn(
[2021-04-06 00:48:32]    INFO >> Reducer buckets have been rebuilt in this iteration. (distributed.py:693, forward())
/home/wanyao/yang/naturalcc-dev/ncc/utils/gradient_clip/fairseq_clip.py:56: UserWarning: amp_C fused kernels unavailable, disabling multi_tensor_l2norm; you may get better performance by installing NVIDIA's apex library
  warnings.warn(
[2021-04-06 00:48:32]    INFO >> Reducer buckets have been rebuilt in this iteration. (distributed.py:693, forward())
/home/wanyao/yang/naturalcc-dev/ncc/utils/gradient_clip/fairseq_clip.py:56: UserWarning: amp_C fused kernels unavailable, disabling multi_tensor_l2norm; you may get better performance by installing NVIDIA's apex library
  warnings.warn(
[2021-04-06 00:48:32]    INFO >> Reducer buckets have been rebuilt in this iteration. (distributed.py:693, forward())
[2021-04-06 00:49:08]    INFO >> epoch 001 | loss 8.271 | accuracy 0 | mrr 0 | ppl 308.92 | wps 42972.4 | ups 2.68 | wpb 16009.3 | bsz 254.4 | num_updates 98 | lr 0.001 | gnorm 0.608 | clip 0 | train_wall 36 | wall 43 (progress_bar.py:269, print())
[2021-04-06 00:49:16]    INFO >> epoch 001 | valid on 'valid' subset | loss 7.067 | accuracy 0.189745 | mrr 0.287097 | ppl 134.09 | wps 42649.3 | wpb 14868.2 | bsz 233.3 | num_updates 98 (progress_bar.py:269, print())
[2021-04-06 00:49:17]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq1lrnn/checkpoints/checkpoint_best.pt (epoch 1 @ 98 updates, score 7.067) (writing took 0.702790 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-06 00:49:53]    INFO >> epoch 002 | loss 6.644 | accuracy 0 | mrr 0 | ppl 99.98 | wps 35363.4 | ups 2.21 | wpb 16009.3 | bsz 254.4 | num_updates 196 | lr 0.001 | gnorm 0.376 | clip 0 | train_wall 29 | wall 87 (progress_bar.py:269, print())
[2021-04-06 00:50:00]    INFO >> epoch 002 | valid on 'valid' subset | loss 6.245 | accuracy 0.280824 | mrr 0.384558 | ppl 75.82 | wps 43609.8 | wpb 14868.2 | bsz 233.3 | num_updates 196 | best_loss 6.245 (progress_bar.py:269, print())
[2021-04-06 00:50:10]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq1lrnn/checkpoints/checkpoint_best.pt (epoch 2 @ 196 updates, score 6.245) (writing took 9.274371 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-06 00:50:46]    INFO >> epoch 003 | loss 5.932 | accuracy 0 | mrr 0 | ppl 61.06 | wps 29535.5 | ups 1.84 | wpb 16009.3 | bsz 254.4 | num_updates 294 | lr 0.001 | gnorm 0.278 | clip 0 | train_wall 29 | wall 141 (progress_bar.py:269, print())
[2021-04-06 00:50:54]    INFO >> epoch 003 | valid on 'valid' subset | loss 5.682 | accuracy 0.340851 | mrr 0.446783 | ppl 51.33 | wps 41313.4 | wpb 14868.2 | bsz 233.3 | num_updates 294 | best_loss 5.682 (progress_bar.py:269, print())
[2021-04-06 00:51:03]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq1lrnn/checkpoints/checkpoint_best.pt (epoch 3 @ 294 updates, score 5.682) (writing took 9.850649 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-06 00:51:39]    INFO >> epoch 004 | loss 5.49 | accuracy 0 | mrr 0 | ppl 44.95 | wps 29205.7 | ups 1.82 | wpb 16009.3 | bsz 254.4 | num_updates 392 | lr 0.001 | gnorm 0.332 | clip 0 | train_wall 29 | wall 194 (progress_bar.py:269, print())
[2021-04-06 00:51:47]    INFO >> epoch 004 | valid on 'valid' subset | loss 5.393 | accuracy 0.367138 | mrr 0.473951 | ppl 42.02 | wps 42530.6 | wpb 14868.2 | bsz 233.3 | num_updates 392 | best_loss 5.393 (progress_bar.py:269, print())
[2021-04-06 00:51:57]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq1lrnn/checkpoints/checkpoint_best.pt (epoch 4 @ 392 updates, score 5.393) (writing took 9.718300 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-06 00:52:33]    INFO >> epoch 005 | loss 5.218 | accuracy 0 | mrr 0 | ppl 37.22 | wps 29343.5 | ups 1.83 | wpb 16009.3 | bsz 254.4 | num_updates 490 | lr 0.001 | gnorm 0.369 | clip 0 | train_wall 29 | wall 248 (progress_bar.py:269, print())
[2021-04-06 00:52:41]    INFO >> epoch 005 | valid on 'valid' subset | loss 5.182 | accuracy 0.385432 | mrr 0.494247 | ppl 36.3 | wps 43317.1 | wpb 14868.2 | bsz 233.3 | num_updates 490 | best_loss 5.182 (progress_bar.py:269, print())
[2021-04-06 00:52:50]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq1lrnn/checkpoints/checkpoint_best.pt (epoch 5 @ 490 updates, score 5.182) (writing took 9.607752 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-06 00:52:59]    INFO >> epoch 006:     10 / 98 loss=6.285, accuracy=0, mrr=0, ppl=77.99, wps=29928.1, ups=1.87, wpb=16016.8, bsz=254.4, num_updates=500, lr=0.001, gnorm=0.393, clip=0, train_wall=157, wall=274 (progress_bar.py:260, log())
[2021-04-06 00:53:28]    INFO >> epoch 006 | loss 5.002 | accuracy 0 | mrr 0 | ppl 32.04 | wps 28513.8 | ups 1.78 | wpb 16009.3 | bsz 254.4 | num_updates 588 | lr 0.001 | gnorm 0.383 | clip 0 | train_wall 31 | wall 303 (progress_bar.py:269, print())
[2021-04-06 00:53:36]    INFO >> epoch 006 | valid on 'valid' subset | loss 5.028 | accuracy 0.400655 | mrr 0.509098 | ppl 32.64 | wps 43278.8 | wpb 14868.2 | bsz 233.3 | num_updates 588 | best_loss 5.028 (progress_bar.py:269, print())
[2021-04-06 00:53:45]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq1lrnn/checkpoints/checkpoint_best.pt (epoch 6 @ 588 updates, score 5.028) (writing took 9.785743 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-06 00:54:23]    INFO >> epoch 007 | loss 4.835 | accuracy 0 | mrr 0 | ppl 28.53 | wps 28507 | ups 1.78 | wpb 16009.3 | bsz 254.4 | num_updates 686 | lr 0.001 | gnorm 0.372 | clip 0 | train_wall 31 | wall 358 (progress_bar.py:269, print())
[2021-04-06 00:54:31]    INFO >> epoch 007 | valid on 'valid' subset | loss 4.918 | accuracy 0.410855 | mrr 0.51922 | ppl 30.22 | wps 41602.8 | wpb 14868.2 | bsz 233.3 | num_updates 686 | best_loss 4.918 (progress_bar.py:269, print())
[2021-04-06 00:54:40]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq1lrnn/checkpoints/checkpoint_best.pt (epoch 7 @ 686 updates, score 4.918) (writing took 9.651635 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-06 00:55:17]    INFO >> epoch 008 | loss 4.704 | accuracy 0 | mrr 0 | ppl 26.07 | wps 28970.3 | ups 1.81 | wpb 16009.3 | bsz 254.4 | num_updates 784 | lr 0.001 | gnorm 0.364 | clip 0 | train_wall 30 | wall 412 (progress_bar.py:269, print())
[2021-04-06 00:55:25]    INFO >> epoch 008 | valid on 'valid' subset | loss 4.833 | accuracy 0.418388 | mrr 0.526999 | ppl 28.51 | wps 42734.3 | wpb 14868.2 | bsz 233.3 | num_updates 784 | best_loss 4.833 (progress_bar.py:269, print())
[2021-04-06 00:55:34]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq1lrnn/checkpoints/checkpoint_best.pt (epoch 8 @ 784 updates, score 4.833) (writing took 9.592831 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-06 00:56:11]    INFO >> epoch 009 | loss 4.601 | accuracy 0 | mrr 0 | ppl 24.27 | wps 29037.7 | ups 1.81 | wpb 16009.3 | bsz 254.4 | num_updates 882 | lr 0.001 | gnorm 0.368 | clip 0 | train_wall 30 | wall 466 (progress_bar.py:269, print())
[2021-04-06 00:56:19]    INFO >> epoch 009 | valid on 'valid' subset | loss 4.759 | accuracy 0.422738 | mrr 0.5325 | ppl 27.07 | wps 41804.8 | wpb 14868.2 | bsz 233.3 | num_updates 882 | best_loss 4.759 (progress_bar.py:269, print())
[2021-04-06 00:56:29]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq1lrnn/checkpoints/checkpoint_best.pt (epoch 9 @ 882 updates, score 4.759) (writing took 9.561276 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-06 00:57:05]    INFO >> epoch 010 | loss 4.507 | accuracy 0 | mrr 0 | ppl 22.74 | wps 28946.5 | ups 1.81 | wpb 16009.3 | bsz 254.4 | num_updates 980 | lr 0.001 | gnorm 0.286 | clip 0 | train_wall 30 | wall 520 (progress_bar.py:269, print())
[2021-04-06 00:57:13]    INFO >> epoch 010 | valid on 'valid' subset | loss 4.701 | accuracy 0.428802 | mrr 0.538192 | ppl 26.01 | wps 42151.2 | wpb 14868.2 | bsz 233.3 | num_updates 980 | best_loss 4.701 (progress_bar.py:269, print())
[2021-04-06 00:57:23]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq1lrnn/checkpoints/checkpoint_best.pt (epoch 10 @ 980 updates, score 4.701) (writing took 9.721661 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-06 00:57:35]    INFO >> epoch 011:     20 / 98 loss=4.712, accuracy=0, mrr=0, ppl=26.2, wps=29024.5, ups=1.81, wpb=16012, bsz=254.4, num_updates=1000, lr=0.001, gnorm=0.358, clip=0, train_wall=155, wall=550 (progress_bar.py:260, log())
[2021-04-06 00:58:00]    INFO >> epoch 011 | loss 4.429 | accuracy 0 | mrr 0 | ppl 21.54 | wps 28892.1 | ups 1.8 | wpb 16009.3 | bsz 254.4 | num_updates 1078 | lr 0.001 | gnorm 0.345 | clip 0 | train_wall 30 | wall 575 (progress_bar.py:269, print())
[2021-04-06 00:58:07]    INFO >> epoch 011 | valid on 'valid' subset | loss 4.652 | accuracy 0.431268 | mrr 0.541471 | ppl 25.14 | wps 41344.6 | wpb 14868.2 | bsz 233.3 | num_updates 1078 | best_loss 4.652 (progress_bar.py:269, print())
[2021-04-06 00:58:17]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq1lrnn/checkpoints/checkpoint_best.pt (epoch 11 @ 1078 updates, score 4.652) (writing took 9.650374 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-06 00:58:53]    INFO >> epoch 012 | loss 4.355 | accuracy 0 | mrr 0 | ppl 20.46 | wps 29214 | ups 1.82 | wpb 16009.3 | bsz 254.4 | num_updates 1176 | lr 0.001 | gnorm 0.287 | clip 0 | train_wall 30 | wall 628 (progress_bar.py:269, print())
[2021-04-06 00:59:01]    INFO >> epoch 012 | valid on 'valid' subset | loss 4.606 | accuracy 0.434194 | mrr 0.545148 | ppl 24.36 | wps 41827.3 | wpb 14868.2 | bsz 233.3 | num_updates 1176 | best_loss 4.606 (progress_bar.py:269, print())
[2021-04-06 00:59:11]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq1lrnn/checkpoints/checkpoint_best.pt (epoch 12 @ 1176 updates, score 4.606) (writing took 9.517029 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-06 00:59:47]    INFO >> epoch 013 | loss 4.288 | accuracy 0 | mrr 0 | ppl 19.53 | wps 29236 | ups 1.83 | wpb 16009.3 | bsz 254.4 | num_updates 1274 | lr 0.001 | gnorm 0.292 | clip 0 | train_wall 30 | wall 682 (progress_bar.py:269, print())
[2021-04-06 00:59:55]    INFO >> epoch 013 | valid on 'valid' subset | loss 4.565 | accuracy 0.437635 | mrr 0.548675 | ppl 23.67 | wps 41741.5 | wpb 14868.2 | bsz 233.3 | num_updates 1274 | best_loss 4.565 (progress_bar.py:269, print())
[2021-04-06 01:00:04]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq1lrnn/checkpoints/checkpoint_best.pt (epoch 13 @ 1274 updates, score 4.565) (writing took 9.609763 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-06 01:00:41]    INFO >> epoch 014 | loss 4.223 | accuracy 0 | mrr 0 | ppl 18.67 | wps 29072.4 | ups 1.82 | wpb 16009.3 | bsz 254.4 | num_updates 1372 | lr 0.001 | gnorm 0.293 | clip 0 | train_wall 30 | wall 736 (progress_bar.py:269, print())
[2021-04-06 01:00:49]    INFO >> epoch 014 | valid on 'valid' subset | loss 4.53 | accuracy 0.439776 | mrr 0.551454 | ppl 23.11 | wps 41375.9 | wpb 14868.2 | bsz 233.3 | num_updates 1372 | best_loss 4.53 (progress_bar.py:269, print())
[2021-04-06 01:00:59]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq1lrnn/checkpoints/checkpoint_best.pt (epoch 14 @ 1372 updates, score 4.53) (writing took 9.719186 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-06 01:01:36]    INFO >> epoch 015 | loss 4.162 | accuracy 0 | mrr 0 | ppl 17.9 | wps 28723.7 | ups 1.79 | wpb 16009.3 | bsz 254.4 | num_updates 1470 | lr 0.001 | gnorm 0.269 | clip 0 | train_wall 30 | wall 791 (progress_bar.py:269, print())
[2021-04-06 01:01:43]    INFO >> epoch 015 | valid on 'valid' subset | loss 4.495 | accuracy 0.441245 | mrr 0.553782 | ppl 22.54 | wps 42965 | wpb 14868.2 | bsz 233.3 | num_updates 1470 | best_loss 4.495 (progress_bar.py:269, print())
[2021-04-06 01:01:53]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq1lrnn/checkpoints/checkpoint_best.pt (epoch 15 @ 1470 updates, score 4.495) (writing took 9.553666 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-06 01:02:08]    INFO >> epoch 016:     30 / 98 loss=4.273, accuracy=0, mrr=0, ppl=19.34, wps=29285.1, ups=1.83, wpb=15997.9, bsz=254.3, num_updates=1500, lr=0.001, gnorm=0.292, clip=0, train_wall=153, wall=823 (progress_bar.py:260, log())
[2021-04-06 01:02:29]    INFO >> epoch 016 | loss 4.105 | accuracy 0 | mrr 0 | ppl 17.21 | wps 29249.7 | ups 1.83 | wpb 16009.3 | bsz 254.4 | num_updates 1568 | lr 0.001 | gnorm 0.286 | clip 0 | train_wall 30 | wall 844 (progress_bar.py:269, print())
[2021-04-06 01:02:37]    INFO >> epoch 016 | valid on 'valid' subset | loss 4.464 | accuracy 0.444406 | mrr 0.557308 | ppl 22.07 | wps 41954.7 | wpb 14868.2 | bsz 233.3 | num_updates 1568 | best_loss 4.464 (progress_bar.py:269, print())
[2021-04-06 01:02:47]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq1lrnn/checkpoints/checkpoint_best.pt (epoch 16 @ 1568 updates, score 4.464) (writing took 9.572585 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-06 01:03:23]    INFO >> epoch 017 | loss 4.049 | accuracy 0 | mrr 0 | ppl 16.56 | wps 29224.4 | ups 1.83 | wpb 16009.3 | bsz 254.4 | num_updates 1666 | lr 0.001 | gnorm 0.305 | clip 0 | train_wall 30 | wall 898 (progress_bar.py:269, print())
[2021-04-06 01:03:31]    INFO >> epoch 017 | valid on 'valid' subset | loss 4.439 | accuracy 0.445998 | mrr 0.558903 | ppl 21.69 | wps 40846.5 | wpb 14868.2 | bsz 233.3 | num_updates 1666 | best_loss 4.439 (progress_bar.py:269, print())
[2021-04-06 01:03:40]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq1lrnn/checkpoints/checkpoint_best.pt (epoch 17 @ 1666 updates, score 4.439) (writing took 9.575872 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-06 01:04:17]    INFO >> epoch 018 | loss 3.994 | accuracy 0 | mrr 0 | ppl 15.94 | wps 29012.3 | ups 1.81 | wpb 16009.3 | bsz 254.4 | num_updates 1764 | lr 0.001 | gnorm 0.289 | clip 0 | train_wall 30 | wall 952 (progress_bar.py:269, print())
[2021-04-06 01:04:25]    INFO >> epoch 018 | valid on 'valid' subset | loss 4.413 | accuracy 0.447825 | mrr 0.56112 | ppl 21.3 | wps 42877.8 | wpb 14868.2 | bsz 233.3 | num_updates 1764 | best_loss 4.413 (progress_bar.py:269, print())
[2021-04-06 01:04:34]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq1lrnn/checkpoints/checkpoint_best.pt (epoch 18 @ 1764 updates, score 4.413) (writing took 9.562829 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-06 01:05:11]    INFO >> epoch 019 | loss 3.942 | accuracy 0 | mrr 0 | ppl 15.37 | wps 29142 | ups 1.82 | wpb 16009.3 | bsz 254.4 | num_updates 1862 | lr 0.001 | gnorm 0.295 | clip 0 | train_wall 30 | wall 1006 (progress_bar.py:269, print())
[2021-04-06 01:05:19]    INFO >> epoch 019 | valid on 'valid' subset | loss 4.389 | accuracy 0.448699 | mrr 0.562114 | ppl 20.96 | wps 41545.2 | wpb 14868.2 | bsz 233.3 | num_updates 1862 | best_loss 4.389 (progress_bar.py:269, print())
[2021-04-06 01:05:28]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq1lrnn/checkpoints/checkpoint_best.pt (epoch 19 @ 1862 updates, score 4.389) (writing took 9.604711 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-06 01:06:05]    INFO >> epoch 020 | loss 3.892 | accuracy 0 | mrr 0 | ppl 14.85 | wps 28981.5 | ups 1.81 | wpb 16009.3 | bsz 254.4 | num_updates 1960 | lr 0.001 | gnorm 0.308 | clip 0 | train_wall 30 | wall 1060 (progress_bar.py:269, print())
[2021-04-06 01:06:13]    INFO >> epoch 020 | valid on 'valid' subset | loss 4.361 | accuracy 0.450829 | mrr 0.564897 | ppl 20.55 | wps 42252.1 | wpb 14868.2 | bsz 233.3 | num_updates 1960 | best_loss 4.361 (progress_bar.py:269, print())
[2021-04-06 01:06:23]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq1lrnn/checkpoints/checkpoint_best.pt (epoch 20 @ 1960 updates, score 4.361) (writing took 9.682189 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-06 01:06:40]    INFO >> epoch 021:     40 / 98 loss=3.977, accuracy=0, mrr=0, ppl=15.75, wps=29412.9, ups=1.84, wpb=16012, bsz=254.5, num_updates=2000, lr=0.001, gnorm=0.295, clip=0, train_wall=152, wall=1095 (progress_bar.py:260, log())
[2021-04-06 01:06:59]    INFO >> epoch 021 | loss 3.842 | accuracy 0 | mrr 0 | ppl 14.34 | wps 29125.6 | ups 1.82 | wpb 16009.3 | bsz 254.4 | num_updates 2058 | lr 0.001 | gnorm 0.304 | clip 0 | train_wall 30 | wall 1114 (progress_bar.py:269, print())
[2021-04-06 01:07:07]    INFO >> epoch 021 | valid on 'valid' subset | loss 4.342 | accuracy 0.452309 | mrr 0.566667 | ppl 20.28 | wps 41812.8 | wpb 14868.2 | bsz 233.3 | num_updates 2058 | best_loss 4.342 (progress_bar.py:269, print())
[2021-04-06 01:07:16]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq1lrnn/checkpoints/checkpoint_best.pt (epoch 21 @ 2058 updates, score 4.342) (writing took 9.569432 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-06 01:07:53]    INFO >> epoch 022 | loss 3.794 | accuracy 0 | mrr 0 | ppl 13.87 | wps 29146 | ups 1.82 | wpb 16009.3 | bsz 254.4 | num_updates 2156 | lr 0.001 | gnorm 0.295 | clip 0 | train_wall 30 | wall 1168 (progress_bar.py:269, print())
[2021-04-06 01:08:00]    INFO >> epoch 022 | valid on 'valid' subset | loss 4.318 | accuracy 0.453374 | mrr 0.568001 | ppl 19.94 | wps 42471.9 | wpb 14868.2 | bsz 233.3 | num_updates 2156 | best_loss 4.318 (progress_bar.py:269, print())
[2021-04-06 01:08:10]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq1lrnn/checkpoints/checkpoint_best.pt (epoch 22 @ 2156 updates, score 4.318) (writing took 9.655667 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-06 01:08:46]    INFO >> epoch 023 | loss 3.747 | accuracy 0 | mrr 0 | ppl 13.43 | wps 29180.8 | ups 1.82 | wpb 16009.3 | bsz 254.4 | num_updates 2254 | lr 0.001 | gnorm 0.286 | clip 0 | train_wall 30 | wall 1221 (progress_bar.py:269, print())
[2021-04-06 01:08:54]    INFO >> epoch 023 | valid on 'valid' subset | loss 4.3 | accuracy 0.453486 | mrr 0.568967 | ppl 19.7 | wps 41631 | wpb 14868.2 | bsz 233.3 | num_updates 2254 | best_loss 4.3 (progress_bar.py:269, print())
[2021-04-06 01:09:04]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq1lrnn/checkpoints/checkpoint_best.pt (epoch 23 @ 2254 updates, score 4.3) (writing took 9.658255 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-06 01:09:40]    INFO >> epoch 024 | loss 3.701 | accuracy 0 | mrr 0 | ppl 13 | wps 29047 | ups 1.81 | wpb 16009.3 | bsz 254.4 | num_updates 2352 | lr 0.001 | gnorm 0.28 | clip 0 | train_wall 30 | wall 1275 (progress_bar.py:269, print())
[2021-04-06 01:09:48]    INFO >> epoch 024 | valid on 'valid' subset | loss 4.284 | accuracy 0.456378 | mrr 0.571342 | ppl 19.48 | wps 43700.3 | wpb 14868.2 | bsz 233.3 | num_updates 2352 | best_loss 4.284 (progress_bar.py:269, print())
[2021-04-06 01:09:58]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq1lrnn/checkpoints/checkpoint_best.pt (epoch 24 @ 2352 updates, score 4.284) (writing took 9.594017 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-06 01:10:34]    INFO >> epoch 025 | loss 3.658 | accuracy 0 | mrr 0 | ppl 12.62 | wps 29294.6 | ups 1.83 | wpb 16009.3 | bsz 254.4 | num_updates 2450 | lr 0.001 | gnorm 0.307 | clip 0 | train_wall 30 | wall 1329 (progress_bar.py:269, print())
[2021-04-06 01:10:42]    INFO >> epoch 025 | valid on 'valid' subset | loss 4.271 | accuracy 0.456512 | mrr 0.571728 | ppl 19.31 | wps 40949.7 | wpb 14868.2 | bsz 233.3 | num_updates 2450 | best_loss 4.271 (progress_bar.py:269, print())
[2021-04-06 01:10:52]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq1lrnn/checkpoints/checkpoint_best.pt (epoch 25 @ 2450 updates, score 4.271) (writing took 9.667049 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-06 01:11:13]    INFO >> epoch 026:     50 / 98 loss=3.728, accuracy=0, mrr=0, ppl=13.25, wps=29379.3, ups=1.83, wpb=16015.5, bsz=254.4, num_updates=2500, lr=0.001, gnorm=0.297, clip=0, train_wall=152, wall=1368 (progress_bar.py:260, log())
[2021-04-06 01:11:28]    INFO >> epoch 026 | loss 3.613 | accuracy 0 | mrr 0 | ppl 12.23 | wps 29022.4 | ups 1.81 | wpb 16009.3 | bsz 254.4 | num_updates 2548 | lr 0.001 | gnorm 0.299 | clip 0 | train_wall 30 | wall 1383 (progress_bar.py:269, print())
[2021-04-06 01:11:36]    INFO >> epoch 026 | valid on 'valid' subset | loss 4.249 | accuracy 0.45723 | mrr 0.573166 | ppl 19.02 | wps 40178.4 | wpb 14868.2 | bsz 233.3 | num_updates 2548 | best_loss 4.249 (progress_bar.py:269, print())
[2021-04-06 01:11:45]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq1lrnn/checkpoints/checkpoint_best.pt (epoch 26 @ 2548 updates, score 4.249) (writing took 9.511603 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-06 01:12:22]    INFO >> epoch 027 | loss 3.57 | accuracy 0 | mrr 0 | ppl 11.87 | wps 29079.8 | ups 1.82 | wpb 16009.3 | bsz 254.4 | num_updates 2646 | lr 0.001 | gnorm 0.321 | clip 0 | train_wall 30 | wall 1437 (progress_bar.py:269, print())
[2021-04-06 01:12:30]    INFO >> epoch 027 | valid on 'valid' subset | loss 4.24 | accuracy 0.457644 | mrr 0.573738 | ppl 18.89 | wps 42831.9 | wpb 14868.2 | bsz 233.3 | num_updates 2646 | best_loss 4.24 (progress_bar.py:269, print())
[2021-04-06 01:12:39]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq1lrnn/checkpoints/checkpoint_best.pt (epoch 27 @ 2646 updates, score 4.24) (writing took 9.665376 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-06 01:13:16]    INFO >> epoch 028 | loss 3.527 | accuracy 0 | mrr 0 | ppl 11.52 | wps 29285.6 | ups 1.83 | wpb 16009.3 | bsz 254.4 | num_updates 2744 | lr 0.001 | gnorm 0.305 | clip 0 | train_wall 30 | wall 1491 (progress_bar.py:269, print())
[2021-04-06 01:13:23]    INFO >> epoch 028 | valid on 'valid' subset | loss 4.223 | accuracy 0.459303 | mrr 0.575083 | ppl 18.67 | wps 41662.2 | wpb 14868.2 | bsz 233.3 | num_updates 2744 | best_loss 4.223 (progress_bar.py:269, print())
[2021-04-06 01:13:33]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq1lrnn/checkpoints/checkpoint_best.pt (epoch 28 @ 2744 updates, score 4.223) (writing took 9.561740 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-06 01:14:09]    INFO >> epoch 029 | loss 3.485 | accuracy 0 | mrr 0 | ppl 11.2 | wps 29190 | ups 1.82 | wpb 16009.3 | bsz 254.4 | num_updates 2842 | lr 0.001 | gnorm 0.327 | clip 0 | train_wall 30 | wall 1544 (progress_bar.py:269, print())
[2021-04-06 01:14:17]    INFO >> epoch 029 | valid on 'valid' subset | loss 4.213 | accuracy 0.458272 | mrr 0.575156 | ppl 18.55 | wps 43531.7 | wpb 14868.2 | bsz 233.3 | num_updates 2842 | best_loss 4.213 (progress_bar.py:269, print())
[2021-04-06 01:14:27]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq1lrnn/checkpoints/checkpoint_best.pt (epoch 29 @ 2842 updates, score 4.213) (writing took 9.699181 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-06 01:15:03]    INFO >> epoch 030 | loss 3.444 | accuracy 0 | mrr 0 | ppl 10.88 | wps 29339.2 | ups 1.83 | wpb 16009.3 | bsz 254.4 | num_updates 2940 | lr 0.001 | gnorm 0.304 | clip 0 | train_wall 29 | wall 1598 (progress_bar.py:269, print())
[2021-04-06 01:15:11]    INFO >> epoch 030 | valid on 'valid' subset | loss 4.205 | accuracy 0.460324 | mrr 0.577072 | ppl 18.44 | wps 41874.4 | wpb 14868.2 | bsz 233.3 | num_updates 2940 | best_loss 4.205 (progress_bar.py:269, print())
[2021-04-06 01:15:20]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq1lrnn/checkpoints/checkpoint_best.pt (epoch 30 @ 2940 updates, score 4.205) (writing took 9.395771 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-06 01:15:44]    INFO >> epoch 031:     60 / 98 loss=3.505, accuracy=0, mrr=0, ppl=11.36, wps=29504.1, ups=1.84, wpb=16015.6, bsz=254.3, num_updates=3000, lr=0.001, gnorm=0.32, clip=0, train_wall=151, wall=1639 (progress_bar.py:260, log())
[2021-04-06 01:15:56]    INFO >> epoch 031 | loss 3.411 | accuracy 0 | mrr 0 | ppl 10.64 | wps 29385.5 | ups 1.84 | wpb 16009.3 | bsz 254.4 | num_updates 3038 | lr 0.001 | gnorm 0.344 | clip 0 | train_wall 30 | wall 1651 (progress_bar.py:269, print())
[2021-04-06 01:16:04]    INFO >> epoch 031 | valid on 'valid' subset | loss 4.191 | accuracy 0.461265 | mrr 0.577968 | ppl 18.26 | wps 41867 | wpb 14868.2 | bsz 233.3 | num_updates 3038 | best_loss 4.191 (progress_bar.py:269, print())
[2021-04-06 01:16:13]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq1lrnn/checkpoints/checkpoint_best.pt (epoch 31 @ 3038 updates, score 4.191) (writing took 9.359875 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-06 01:16:50]    INFO >> epoch 032 | loss 3.366 | accuracy 0 | mrr 0 | ppl 10.31 | wps 29069.6 | ups 1.82 | wpb 16009.3 | bsz 254.4 | num_updates 3136 | lr 0.001 | gnorm 0.304 | clip 0 | train_wall 30 | wall 1705 (progress_bar.py:269, print())
[2021-04-06 01:16:58]    INFO >> epoch 032 | valid on 'valid' subset | loss 4.185 | accuracy 0.461075 | mrr 0.578329 | ppl 18.19 | wps 41834.7 | wpb 14868.2 | bsz 233.3 | num_updates 3136 | best_loss 4.185 (progress_bar.py:269, print())
[2021-04-06 01:17:08]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq1lrnn/checkpoints/checkpoint_best.pt (epoch 32 @ 3136 updates, score 4.185) (writing took 9.602420 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-06 01:17:44]    INFO >> epoch 033 | loss 3.328 | accuracy 0 | mrr 0 | ppl 10.04 | wps 28989.1 | ups 1.81 | wpb 16009.3 | bsz 254.4 | num_updates 3234 | lr 0.001 | gnorm 0.307 | clip 0 | train_wall 30 | wall 1759 (progress_bar.py:269, print())
[2021-04-06 01:17:52]    INFO >> epoch 033 | valid on 'valid' subset | loss 4.176 | accuracy 0.462397 | mrr 0.579632 | ppl 18.07 | wps 41750.9 | wpb 14868.2 | bsz 233.3 | num_updates 3234 | best_loss 4.176 (progress_bar.py:269, print())
[2021-04-06 01:18:02]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq1lrnn/checkpoints/checkpoint_best.pt (epoch 33 @ 3234 updates, score 4.176) (writing took 9.553845 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-06 01:18:38]    INFO >> epoch 034 | loss 3.291 | accuracy 0 | mrr 0 | ppl 9.79 | wps 29188.3 | ups 1.82 | wpb 16009.3 | bsz 254.4 | num_updates 3332 | lr 0.001 | gnorm 0.309 | clip 0 | train_wall 30 | wall 1813 (progress_bar.py:269, print())
[2021-04-06 01:18:46]    INFO >> epoch 034 | valid on 'valid' subset | loss 4.174 | accuracy 0.460806 | mrr 0.579066 | ppl 18.06 | wps 39559.4 | wpb 14868.2 | bsz 233.3 | num_updates 3332 | best_loss 4.174 (progress_bar.py:269, print())
[2021-04-06 01:18:56]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq1lrnn/checkpoints/checkpoint_best.pt (epoch 34 @ 3332 updates, score 4.174) (writing took 9.868373 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-06 01:19:32]    INFO >> epoch 035 | loss 3.255 | accuracy 0 | mrr 0 | ppl 9.55 | wps 28895.6 | ups 1.8 | wpb 16009.3 | bsz 254.4 | num_updates 3430 | lr 0.001 | gnorm 0.303 | clip 0 | train_wall 30 | wall 1867 (progress_bar.py:269, print())
[2021-04-06 01:19:40]    INFO >> epoch 035 | valid on 'valid' subset | loss 4.167 | accuracy 0.462319 | mrr 0.580021 | ppl 17.97 | wps 41979.1 | wpb 14868.2 | bsz 233.3 | num_updates 3430 | best_loss 4.167 (progress_bar.py:269, print())
[2021-04-06 01:19:50]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq1lrnn/checkpoints/checkpoint_best.pt (epoch 35 @ 3430 updates, score 4.167) (writing took 9.689202 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-06 01:20:17]    INFO >> epoch 036:     70 / 98 loss=3.304, accuracy=0, mrr=0, ppl=9.88, wps=29317.3, ups=1.83, wpb=16016.8, bsz=254.4, num_updates=3500, lr=0.001, gnorm=0.303, clip=0, train_wall=153, wall=1912 (progress_bar.py:260, log())
[2021-04-06 01:20:26]    INFO >> epoch 036 | loss 3.22 | accuracy 0 | mrr 0 | ppl 9.32 | wps 29100.8 | ups 1.82 | wpb 16009.3 | bsz 254.4 | num_updates 3528 | lr 0.001 | gnorm 0.307 | clip 0 | train_wall 30 | wall 1921 (progress_bar.py:269, print())
[2021-04-06 01:20:34]    INFO >> epoch 036 | valid on 'valid' subset | loss 4.169 | accuracy 0.462352 | mrr 0.580217 | ppl 17.99 | wps 39374.1 | wpb 14868.2 | bsz 233.3 | num_updates 3528 | best_loss 4.167 (progress_bar.py:269, print())
[2021-04-06 01:20:39]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq1lrnn/checkpoints/checkpoint_last.pt (epoch 36 @ 3528 updates, score 4.169) (writing took 5.156313 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-06 01:21:16]    INFO >> epoch 037 | loss 3.187 | accuracy 0 | mrr 0 | ppl 9.11 | wps 31683 | ups 1.98 | wpb 16009.3 | bsz 254.4 | num_updates 3626 | lr 0.001 | gnorm 0.329 | clip 0 | train_wall 30 | wall 1971 (progress_bar.py:269, print())
[2021-04-06 01:21:24]    INFO >> epoch 037 | valid on 'valid' subset | loss 4.162 | accuracy 0.46298 | mrr 0.580996 | ppl 17.9 | wps 41861.7 | wpb 14868.2 | bsz 233.3 | num_updates 3626 | best_loss 4.162 (progress_bar.py:269, print())
[2021-04-06 01:21:33]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq1lrnn/checkpoints/checkpoint_best.pt (epoch 37 @ 3626 updates, score 4.162) (writing took 9.671156 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-06 01:22:10]    INFO >> epoch 038 | loss 3.154 | accuracy 0 | mrr 0 | ppl 8.9 | wps 28981.9 | ups 1.81 | wpb 16009.3 | bsz 254.4 | num_updates 3724 | lr 0.001 | gnorm 0.304 | clip 0 | train_wall 30 | wall 2025 (progress_bar.py:269, print())
[2021-04-06 01:22:18]    INFO >> epoch 038 | valid on 'valid' subset | loss 4.158 | accuracy 0.462969 | mrr 0.581049 | ppl 17.85 | wps 39716.9 | wpb 14868.2 | bsz 233.3 | num_updates 3724 | best_loss 4.158 (progress_bar.py:269, print())
[2021-04-06 01:22:28]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq1lrnn/checkpoints/checkpoint_best.pt (epoch 38 @ 3724 updates, score 4.158) (writing took 9.792462 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-06 01:23:04]    INFO >> epoch 039 | loss 3.122 | accuracy 0 | mrr 0 | ppl 8.7 | wps 28955.6 | ups 1.81 | wpb 16009.3 | bsz 254.4 | num_updates 3822 | lr 0.001 | gnorm 0.326 | clip 0 | train_wall 30 | wall 2079 (progress_bar.py:269, print())
[2021-04-06 01:23:12]    INFO >> epoch 039 | valid on 'valid' subset | loss 4.159 | accuracy 0.463608 | mrr 0.581586 | ppl 17.86 | wps 40577.1 | wpb 14868.2 | bsz 233.3 | num_updates 3822 | best_loss 4.158 (progress_bar.py:269, print())
[2021-04-06 01:23:17]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq1lrnn/checkpoints/checkpoint_last.pt (epoch 39 @ 3822 updates, score 4.159) (writing took 5.150561 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-06 01:23:54]    INFO >> epoch 040 | loss 3.09 | accuracy 0 | mrr 0 | ppl 8.51 | wps 31485.2 | ups 1.97 | wpb 16009.3 | bsz 254.4 | num_updates 3920 | lr 0.001 | gnorm 0.306 | clip 0 | train_wall 30 | wall 2129 (progress_bar.py:269, print())
[2021-04-06 01:24:02]    INFO >> epoch 040 | valid on 'valid' subset | loss 4.162 | accuracy 0.463451 | mrr 0.581717 | ppl 17.9 | wps 42767.6 | wpb 14868.2 | bsz 233.3 | num_updates 3920 | best_loss 4.158 (progress_bar.py:269, print())
[2021-04-06 01:24:07]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq1lrnn/checkpoints/checkpoint_last.pt (epoch 40 @ 3920 updates, score 4.162) (writing took 5.110406 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-06 01:24:37]    INFO >> epoch 041:     80 / 98 loss=3.131, accuracy=0, mrr=0, ppl=8.76, wps=30798.4, ups=1.93, wpb=15998.6, bsz=254.4, num_updates=4000, lr=0.001, gnorm=0.318, clip=0, train_wall=152, wall=2172 (progress_bar.py:260, log())
[2021-04-06 01:24:43]    INFO >> epoch 041 | loss 3.061 | accuracy 0 | mrr 0 | ppl 8.35 | wps 31861.3 | ups 1.99 | wpb 16009.3 | bsz 254.4 | num_updates 4018 | lr 0.001 | gnorm 0.329 | clip 0 | train_wall 30 | wall 2178 (progress_bar.py:269, print())
[2021-04-06 01:24:51]    INFO >> epoch 041 | valid on 'valid' subset | loss 4.161 | accuracy 0.463103 | mrr 0.581738 | ppl 17.89 | wps 41258.5 | wpb 14868.2 | bsz 233.3 | num_updates 4018 | best_loss 4.158 (progress_bar.py:269, print())
[2021-04-06 01:24:56]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq1lrnn/checkpoints/checkpoint_last.pt (epoch 41 @ 4018 updates, score 4.161) (writing took 5.141316 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-06 01:25:33]    INFO >> epoch 042 | loss 3.03 | accuracy 0 | mrr 0 | ppl 8.17 | wps 31632.9 | ups 1.98 | wpb 16009.3 | bsz 254.4 | num_updates 4116 | lr 0.001 | gnorm 0.316 | clip 0 | train_wall 30 | wall 2228 (progress_bar.py:269, print())
[2021-04-06 01:25:41]    INFO >> epoch 042 | valid on 'valid' subset | loss 4.162 | accuracy 0.462308 | mrr 0.581323 | ppl 17.9 | wps 41800 | wpb 14868.2 | bsz 233.3 | num_updates 4116 | best_loss 4.158 (progress_bar.py:269, print())
[2021-04-06 01:25:46]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq1lrnn/checkpoints/checkpoint_last.pt (epoch 42 @ 4116 updates, score 4.162) (writing took 5.343949 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-06 01:26:23]    INFO >> epoch 043 | loss 3.002 | accuracy 0 | mrr 0 | ppl 8.01 | wps 31407 | ups 1.96 | wpb 16009.3 | bsz 254.4 | num_updates 4214 | lr 0.001 | gnorm 0.34 | clip 0 | train_wall 30 | wall 2278 (progress_bar.py:269, print())
[2021-04-06 01:26:31]    INFO >> epoch 043 | valid on 'valid' subset | loss 4.162 | accuracy 0.461725 | mrr 0.580636 | ppl 17.9 | wps 42204.5 | wpb 14868.2 | bsz 233.3 | num_updates 4214 | best_loss 4.158 (progress_bar.py:269, print())
[2021-04-06 01:26:36]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/ruby/seq1lrnn/checkpoints/checkpoint_last.pt (epoch 43 @ 4214 updates, score 4.162) (writing took 5.270386 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-04-06 01:26:36]    INFO >> early stop since valid performance hasn't improved for last 5 runs (train.py:176, should_stop_early())
[2021-04-06 01:26:36]    INFO >> early stop since valid performance hasn't improved for last 5 runs (train.py:259, single_main())
[2021-04-06 01:26:36]    INFO >> done training in 2290.6 seconds (train.py:271, single_main())
