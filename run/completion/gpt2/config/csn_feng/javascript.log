nohup: ignoring input
[2021-05-31 16:43:18]    INFO >> Load arguments in /home/wanyao/yang/naturalcc-dev/run/completion/gpt2/config/csn_feng/javascript.yml (train.py:291, cli_main())
[2021-05-31 16:43:18]    INFO >> {'criterion': 'completion_cross_entropy', 'optimizer': 'torch_adam', 'lr_scheduler': 'fixed', 'tokenizer': None, 'bpe': None, 'common': {'no_progress_bar': 0, 'log_interval': 500, 'log_format': 'simple', 'tensorboard_logdir': '', 'memory_efficient_fp16': 0, 'fp16_no_flatten_grads': 0, 'fp16_init_scale': 128, 'fp16_scale_window': None, 'fp16_scale_tolerance': 0.0, 'min_loss_scale': 0.0001, 'threshold_loss_scale': None, 'empty_cache_freq': 0, 'task': 'completion', 'seed': 666, 'cpu': 0, 'fp16': 0, 'fp16_opt_level': '01', 'server_ip': '', 'server_port': ''}, 'dataset': {'num_workers': 3, 'skip_invalid_size_inputs_valid_test': 0, 'max_tokens': 100000.0, 'max_sentences': 32, 'required_batch_size_multiple': 1, 'dataset_impl': 'mmap', 'train_subset': 'train', 'valid_subset': 'valid', 'validate_interval': 1, 'fixed_validation_seed': None, 'disable_validation': 0, 'max_tokens_valid': None, 'max_sentences_valid': 32, 'curriculum': 5, 'gen_subset': 'test', 'num_shards': 1, 'shard_id': 0, 'truncate_target': 1}, 'distributed_training': {'distributed_world_size': 1, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': None, 'distributed_port': -1, 'device_id': 0, 'distributed_no_spawn': 0, 'ddp_backend': 'no_c10d', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': None, 'find_unused_parameters': 0, 'fast_stat_sync': 0, 'broadcast_buffers': 0, 'global_sync_iter': 50, 'warmup_iterations': 500, 'local_rank': -1}, 'task': {'data': '/mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/javascript', 'target_lang': 'code_tokens', 'max_target_positions': 256, 'add_bos_token': 0, 'eval_bleu': 0, 'eval_bleu_detok': 'space', 'eval_bleu_detok_args': None, 'eval_tokenized_bleu': 0, 'eval_bleu_remove_bpe': None, 'eval_bleu_args': None, 'eval_bleu_print_samples': 0, 'eval_mrr': 1}, 'model': {'arch': 'completion_gpt2', 'dropout': 0.5, 'decoder_embed_dim': 300, 'decoder_hidden_size': 300, 'decoder_layers': 6, 'decoder_attention_heads': 6, 'max_target_positions': 256, 'activation_fn': 'gelu', 'decoder_ffn_embed_dim': 1200}, 'optimization': {'max_epoch': 100, 'max_update': 0, 'clip_norm': 25, 'update_freq': [1], 'lrs': [0.001], 'min_lr': -1, 'use_bmuf': 0, 'force_anneal': None, 'warmup_updates': 0, 'end_learning_rate': 0.0, 'power': 1.0, 'total_num_update': 1000000, 'sentence_avg': None, 'adam': {'adam_betas': '(0.9, 0.999)', 'adam_eps': 1e-08, 'weight_decay': 0.0, 'use_old_adam': 0}, 'weight_decay': 0.0, 'adam_epsilon': 1e-08, 'max_grad_norm': 1.0, 'num_train_epochs': 5, 'max_steps': -1, 'warmup_steps': 0, 'gradient_accumulation_steps': 1}, 'checkpoint': {'save_dir': '/mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/javascript/gpt2/checkpoints', 'restore_file': 'checkpoint_best.pt', 'reset_dataloader': None, 'reset_lr_scheduler': None, 'reset_meters': None, 'reset_optimizer': None, 'optimizer_overrides': '{}', 'save_interval': 1, 'save_interval_updates': 500, 'keep_interval_updates': 0, 'keep_last_epochs': -1, 'keep_best_checkpoints': -1, 'no_save': 0, 'no_epoch_checkpoints': 1, 'no_last_checkpoints': 0, 'no_save_optimizer_state': None, 'best_checkpoint_metric': 'mrr', 'maximize_best_checkpoint_metric': 1, 'patience': 3, 'should_continue': 0, 'model_name_or_path': None, 'cache_dir': None, 'logging_steps': 500, 'save_steps': 2000, 'save_total_limit': 2, 'overwrite_output_dir': 0, 'overwrite_cache': 0}, 'eval': {'path': '/mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/javascript/gpt2/checkpoints/checkpoint_best.pt', 'model_overrides': '{}', 'checkpoint_suffix': '', 'max_sentences_eval': 64}, 'kd': {'gen_topk': 5, 'distill_topk': 3}} (train.py:293, cli_main())
[2021-05-31 16:43:18]    INFO >> single GPU training... (train.py:322, cli_main())
[2021-05-31 16:43:18]    INFO >> {'criterion': 'completion_cross_entropy', 'optimizer': 'torch_adam', 'lr_scheduler': 'fixed', 'tokenizer': None, 'bpe': None, 'common': {'no_progress_bar': 0, 'log_interval': 500, 'log_format': 'simple', 'tensorboard_logdir': '', 'memory_efficient_fp16': 0, 'fp16_no_flatten_grads': 0, 'fp16_init_scale': 128, 'fp16_scale_window': None, 'fp16_scale_tolerance': 0.0, 'min_loss_scale': 0.0001, 'threshold_loss_scale': None, 'empty_cache_freq': 0, 'task': 'completion', 'seed': 666, 'cpu': 0, 'fp16': 0, 'fp16_opt_level': '01', 'server_ip': '', 'server_port': ''}, 'dataset': {'num_workers': 3, 'skip_invalid_size_inputs_valid_test': 0, 'max_tokens': 100000.0, 'max_sentences': 32, 'required_batch_size_multiple': 1, 'dataset_impl': 'mmap', 'train_subset': 'train', 'valid_subset': 'valid', 'validate_interval': 1, 'fixed_validation_seed': None, 'disable_validation': 0, 'max_tokens_valid': None, 'max_sentences_valid': 32, 'curriculum': 5, 'gen_subset': 'test', 'num_shards': 1, 'shard_id': 0, 'truncate_target': 1}, 'distributed_training': {'distributed_world_size': 1, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': None, 'distributed_port': -1, 'device_id': 0, 'distributed_no_spawn': 0, 'ddp_backend': 'no_c10d', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': None, 'find_unused_parameters': 0, 'fast_stat_sync': 0, 'broadcast_buffers': 0, 'global_sync_iter': 50, 'warmup_iterations': 500, 'local_rank': -1}, 'task': {'data': '/mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/javascript', 'target_lang': 'code_tokens', 'max_target_positions': 256, 'add_bos_token': 0, 'eval_bleu': 0, 'eval_bleu_detok': 'space', 'eval_bleu_detok_args': None, 'eval_tokenized_bleu': 0, 'eval_bleu_remove_bpe': None, 'eval_bleu_args': None, 'eval_bleu_print_samples': 0, 'eval_mrr': 1}, 'model': {'arch': 'completion_gpt2', 'dropout': 0.5, 'decoder_embed_dim': 300, 'decoder_hidden_size': 300, 'decoder_layers': 6, 'decoder_attention_heads': 6, 'max_target_positions': 256, 'activation_fn': 'gelu', 'decoder_ffn_embed_dim': 1200}, 'optimization': {'max_epoch': 100, 'max_update': 0, 'clip_norm': 25, 'update_freq': [1], 'lrs': [0.001], 'min_lr': -1, 'use_bmuf': 0, 'force_anneal': None, 'warmup_updates': 0, 'end_learning_rate': 0.0, 'power': 1.0, 'total_num_update': 1000000, 'sentence_avg': None, 'adam': {'adam_betas': '(0.9, 0.999)', 'adam_eps': 1e-08, 'weight_decay': 0.0, 'use_old_adam': 0}, 'weight_decay': 0.0, 'adam_epsilon': 1e-08, 'max_grad_norm': 1.0, 'num_train_epochs': 5, 'max_steps': -1, 'warmup_steps': 0, 'gradient_accumulation_steps': 1}, 'checkpoint': {'save_dir': '/mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/javascript/gpt2/checkpoints', 'restore_file': 'checkpoint_best.pt', 'reset_dataloader': None, 'reset_lr_scheduler': None, 'reset_meters': None, 'reset_optimizer': None, 'optimizer_overrides': '{}', 'save_interval': 1, 'save_interval_updates': 500, 'keep_interval_updates': 0, 'keep_last_epochs': -1, 'keep_best_checkpoints': -1, 'no_save': 0, 'no_epoch_checkpoints': 1, 'no_last_checkpoints': 0, 'no_save_optimizer_state': None, 'best_checkpoint_metric': 'mrr', 'maximize_best_checkpoint_metric': 1, 'patience': 3, 'should_continue': 0, 'model_name_or_path': None, 'cache_dir': None, 'logging_steps': 500, 'save_steps': 2000, 'save_total_limit': 2, 'overwrite_output_dir': 0, 'overwrite_cache': 0}, 'eval': {'path': '/mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/javascript/gpt2/checkpoints/checkpoint_best.pt', 'model_overrides': '{}', 'checkpoint_suffix': '', 'max_sentences_eval': 64}, 'kd': {'gen_topk': 5, 'distill_topk': 3}} (train.py:201, single_main())
[2021-05-31 16:43:18]    INFO >> [code_tokens] dictionary: 50000 types (completion.py:103, setup_task())
[2021-05-31 16:43:18]    INFO >> Truncate dataset into max length: 256 (completion.py:42, load_token_dataset())
[2021-05-31 16:43:18]    INFO >> loaded 3885 examples from: /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/javascript/valid.code_tokens (completion.py:43, load_token_dataset())
[2021-05-31 16:43:19]    INFO >> GPT2(
  (decoder): TransformerDecoder(
    (embed_tokens): Embedding(50000, 300, padding_idx=0)
    (layers): ModuleList(
      (0): TransformerDecoderLayer(
        (in_layer_norm): LayerNorm((300,), eps=1e-08, elementwise_affine=True)
        (attention): MultiheadAttention(
          (k_proj): Linear(in_features=300, out_features=300, bias=True)
          (v_proj): Linear(in_features=300, out_features=300, bias=True)
          (q_proj): Linear(in_features=300, out_features=300, bias=True)
          (out_proj): Linear(in_features=300, out_features=300, bias=True)
        )
        (ff_layer_norm): LayerNorm((300,), eps=1e-08, elementwise_affine=True)
        (fc1): Linear(in_features=300, out_features=1200, bias=True)
        (fc2): Linear(in_features=1200, out_features=300, bias=True)
      )
      (1): TransformerDecoderLayer(
        (in_layer_norm): LayerNorm((300,), eps=1e-08, elementwise_affine=True)
        (attention): MultiheadAttention(
          (k_proj): Linear(in_features=300, out_features=300, bias=True)
          (v_proj): Linear(in_features=300, out_features=300, bias=True)
          (q_proj): Linear(in_features=300, out_features=300, bias=True)
          (out_proj): Linear(in_features=300, out_features=300, bias=True)
        )
        (ff_layer_norm): LayerNorm((300,), eps=1e-08, elementwise_affine=True)
        (fc1): Linear(in_features=300, out_features=1200, bias=True)
        (fc2): Linear(in_features=1200, out_features=300, bias=True)
      )
      (2): TransformerDecoderLayer(
        (in_layer_norm): LayerNorm((300,), eps=1e-08, elementwise_affine=True)
        (attention): MultiheadAttention(
          (k_proj): Linear(in_features=300, out_features=300, bias=True)
          (v_proj): Linear(in_features=300, out_features=300, bias=True)
          (q_proj): Linear(in_features=300, out_features=300, bias=True)
          (out_proj): Linear(in_features=300, out_features=300, bias=True)
        )
        (ff_layer_norm): LayerNorm((300,), eps=1e-08, elementwise_affine=True)
        (fc1): Linear(in_features=300, out_features=1200, bias=True)
        (fc2): Linear(in_features=1200, out_features=300, bias=True)
      )
      (3): TransformerDecoderLayer(
        (in_layer_norm): LayerNorm((300,), eps=1e-08, elementwise_affine=True)
        (attention): MultiheadAttention(
          (k_proj): Linear(in_features=300, out_features=300, bias=True)
          (v_proj): Linear(in_features=300, out_features=300, bias=True)
          (q_proj): Linear(in_features=300, out_features=300, bias=True)
          (out_proj): Linear(in_features=300, out_features=300, bias=True)
        )
        (ff_layer_norm): LayerNorm((300,), eps=1e-08, elementwise_affine=True)
        (fc1): Linear(in_features=300, out_features=1200, bias=True)
        (fc2): Linear(in_features=1200, out_features=300, bias=True)
      )
      (4): TransformerDecoderLayer(
        (in_layer_norm): LayerNorm((300,), eps=1e-08, elementwise_affine=True)
        (attention): MultiheadAttention(
          (k_proj): Linear(in_features=300, out_features=300, bias=True)
          (v_proj): Linear(in_features=300, out_features=300, bias=True)
          (q_proj): Linear(in_features=300, out_features=300, bias=True)
          (out_proj): Linear(in_features=300, out_features=300, bias=True)
        )
        (ff_layer_norm): LayerNorm((300,), eps=1e-08, elementwise_affine=True)
        (fc1): Linear(in_features=300, out_features=1200, bias=True)
        (fc2): Linear(in_features=1200, out_features=300, bias=True)
      )
      (5): TransformerDecoderLayer(
        (in_layer_norm): LayerNorm((300,), eps=1e-08, elementwise_affine=True)
        (attention): MultiheadAttention(
          (k_proj): Linear(in_features=300, out_features=300, bias=True)
          (v_proj): Linear(in_features=300, out_features=300, bias=True)
          (q_proj): Linear(in_features=300, out_features=300, bias=True)
          (out_proj): Linear(in_features=300, out_features=300, bias=True)
        )
        (ff_layer_norm): LayerNorm((300,), eps=1e-08, elementwise_affine=True)
        (fc1): Linear(in_features=300, out_features=1200, bias=True)
        (fc2): Linear(in_features=1200, out_features=300, bias=True)
      )
    )
    (out_layer_norm): LayerNorm((300,), eps=1e-08, elementwise_affine=True)
  )
) (train.py:212, single_main())
[2021-05-31 16:43:19]    INFO >> model completion_gpt2, criterion CompletionCrossEntropyCriterion (train.py:213, single_main())
[2021-05-31 16:43:19]    INFO >> num. model params: 21894150 (num. trained: 21894150) (train.py:214, single_main())
[2021-05-31 16:43:31]    INFO >> training on 1 GPUs (train.py:221, single_main())
[2021-05-31 16:43:31]    INFO >> max tokens per GPU = 100000.0 and max sentences per GPU = 32 (train.py:222, single_main())
[2021-05-31 16:43:31]    INFO >> no existing checkpoint found checkpoint_best.pt (ncc_trainers.py:270, load_checkpoint())
[2021-05-31 16:43:31]    INFO >> loading train data for epoch 1 (ncc_trainers.py:285, get_train_iterator())
[2021-05-31 16:43:31]    INFO >> Truncate dataset into max length: 256 (completion.py:42, load_token_dataset())
[2021-05-31 16:43:31]    INFO >> loaded 58025 examples from: /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/javascript/train.code_tokens (completion.py:43, load_token_dataset())
[2021-05-31 16:43:31]    INFO >> NOTE: your device may support faster training with fp16 (ncc_trainers.py:155, _setup_optimizer())
/home/wanyao/yang/naturalcc-dev/ncc/utils/gradient_clip/fairseq_clip.py:56: UserWarning: amp_C fused kernels unavailable, disabling multi_tensor_l2norm; you may get better performance by installing NVIDIA's apex library
  warnings.warn(
[2021-05-31 16:46:40]    INFO >> epoch 001:    500 / 1814 loss=4.952, accuracy=0, mrr=0, ppl=30.96, wps=9287.8, ups=2.75, wpb=3374.5, bsz=32, num_updates=500, lr=0.001, gnorm=0.972, clip=0, train_wall=180, wall=189 (progress_bar.py:260, log())
[2021-05-31 16:47:14]    INFO >> epoch 001 | valid on 'valid' subset | loss 4.225 | accuracy 0.451988 | mrr 0.56973 | ppl 18.7 | wps 15118.5 | wpb 3288.5 | bsz 31.8 | num_updates 500 (progress_bar.py:269, print())
[2021-05-31 16:47:16]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/javascript/gpt2/checkpoints/checkpoint_1_500.pt (epoch 1 @ 500 updates, score 0.56973) (writing took 1.147937 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-05-31 16:50:17]    INFO >> epoch 001:   1000 / 1814 loss=3.836, accuracy=0, mrr=0, ppl=14.28, wps=7735.7, ups=2.31, wpb=3348.1, bsz=32, num_updates=1000, lr=0.001, gnorm=0.809, clip=0, train_wall=180, wall=406 (progress_bar.py:260, log())
[2021-05-31 16:50:51]    INFO >> epoch 001 | valid on 'valid' subset | loss 3.624 | accuracy 0.504974 | mrr 0.620825 | ppl 12.33 | wps 14917.5 | wpb 3288.5 | bsz 31.8 | num_updates 1000 | best_mrr 0.620825 (progress_bar.py:269, print())
[2021-05-31 16:51:04]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/javascript/gpt2/checkpoints/checkpoint_1_1000.pt (epoch 1 @ 1000 updates, score 0.620825) (writing took 13.199241 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-05-31 16:54:05]    INFO >> epoch 001:   1500 / 1814 loss=3.38, accuracy=0, mrr=0, ppl=10.41, wps=7291.8, ups=2.19, wpb=3333.7, bsz=32, num_updates=1500, lr=0.001, gnorm=0.745, clip=0, train_wall=180, wall=635 (progress_bar.py:260, log())
[2021-05-31 16:54:39]    INFO >> epoch 001 | valid on 'valid' subset | loss 3.298 | accuracy 0.536497 | mrr 0.649544 | ppl 9.83 | wps 14949.5 | wpb 3288.5 | bsz 31.8 | num_updates 1500 | best_mrr 0.649544 (progress_bar.py:269, print())
[2021-05-31 16:55:02]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/javascript/gpt2/checkpoints/checkpoint_1_1500.pt (epoch 1 @ 1500 updates, score 0.649544) (writing took 22.512756 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-05-31 16:56:55]    INFO >> epoch 001 | loss 3.901 | accuracy 0 | mrr 0 | ppl 14.94 | wps 7611.2 | ups 2.28 | wpb 3342.9 | bsz 32 | num_updates 1814 | lr 0.001 | gnorm 0.823 | clip 0 | train_wall 653 | wall 804 (progress_bar.py:269, print())
[2021-05-31 16:57:29]    INFO >> epoch 001 | valid on 'valid' subset | loss 3.188 | accuracy 0.542045 | mrr 0.656983 | ppl 9.11 | wps 14980.9 | wpb 3288.5 | bsz 31.8 | num_updates 1814 | best_mrr 0.656983 (progress_bar.py:269, print())
[2021-05-31 16:57:42]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/javascript/gpt2/checkpoints/checkpoint_best.pt (epoch 1 @ 1814 updates, score 0.656983) (writing took 12.666802 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-05-31 16:58:56]    INFO >> epoch 002:    186 / 1814 loss=3.079, accuracy=0, mrr=0, ppl=8.45, wps=5694.1, ups=1.72, wpb=3316.2, bsz=32, num_updates=2000, lr=0.001, gnorm=0.727, clip=0, train_wall=179, wall=926 (progress_bar.py:260, log())
[2021-05-31 16:59:30]    INFO >> epoch 002 | valid on 'valid' subset | loss 3.1 | accuracy 0.550368 | mrr 0.66496 | ppl 8.57 | wps 14970.6 | wpb 3288.5 | bsz 31.8 | num_updates 2000 | best_mrr 0.66496 (progress_bar.py:269, print())
[2021-05-31 16:59:44]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/javascript/gpt2/checkpoints/checkpoint_2_2000.pt (epoch 2 @ 2000 updates, score 0.66496) (writing took 13.058406 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-05-31 17:02:44]    INFO >> epoch 002:    686 / 1814 loss=2.855, accuracy=0, mrr=0, ppl=7.24, wps=7400.5, ups=2.2, wpb=3368.3, bsz=32, num_updates=2500, lr=0.001, gnorm=0.687, clip=0, train_wall=179, wall=1153 (progress_bar.py:260, log())
[2021-05-31 17:03:18]    INFO >> epoch 002 | valid on 'valid' subset | loss 2.951 | accuracy 0.569079 | mrr 0.679649 | ppl 7.73 | wps 15038 | wpb 3288.5 | bsz 31.8 | num_updates 2500 | best_mrr 0.679649 (progress_bar.py:269, print())
[2021-05-31 17:03:32]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/javascript/gpt2/checkpoints/checkpoint_2_2500.pt (epoch 2 @ 2500 updates, score 0.679649) (writing took 13.526493 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-05-31 17:06:32]    INFO >> epoch 002:   1186 / 1814 loss=2.671, accuracy=0, mrr=0, ppl=6.37, wps=7388.4, ups=2.2, wpb=3364.7, bsz=32, num_updates=3000, lr=0.001, gnorm=0.668, clip=0, train_wall=179, wall=1381 (progress_bar.py:260, log())
[2021-05-31 17:07:06]    INFO >> epoch 002 | valid on 'valid' subset | loss 2.831 | accuracy 0.580752 | mrr 0.690391 | ppl 7.12 | wps 14825 | wpb 3288.5 | bsz 31.8 | num_updates 3000 | best_mrr 0.690391 (progress_bar.py:269, print())
[2021-05-31 17:07:23]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/javascript/gpt2/checkpoints/checkpoint_2_3000.pt (epoch 2 @ 3000 updates, score 0.690391) (writing took 17.360030 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-05-31 17:10:24]    INFO >> epoch 002:   1686 / 1814 loss=2.552, accuracy=0, mrr=0, ppl=5.87, wps=7127.8, ups=2.15, wpb=3313.3, bsz=32, num_updates=3500, lr=0.001, gnorm=0.649, clip=0, train_wall=180, wall=1613 (progress_bar.py:260, log())
[2021-05-31 17:10:58]    INFO >> epoch 002 | valid on 'valid' subset | loss 2.778 | accuracy 0.584087 | mrr 0.693767 | ppl 6.86 | wps 15131.8 | wpb 3288.5 | bsz 31.8 | num_updates 3500 | best_mrr 0.693767 (progress_bar.py:269, print())
[2021-05-31 17:11:15]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/javascript/gpt2/checkpoints/checkpoint_2_3500.pt (epoch 2 @ 3500 updates, score 0.693767) (writing took 17.180328 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-05-31 17:12:01]    INFO >> epoch 002 | loss 2.708 | accuracy 0 | mrr 0 | ppl 6.53 | wps 6698 | ups 2 | wpb 3342.9 | bsz 32 | num_updates 3628 | lr 0.001 | gnorm 0.671 | clip 0 | train_wall 650 | wall 1710 (progress_bar.py:269, print())
[2021-05-31 17:12:30]    INFO >> epoch 002 | valid on 'valid' subset | loss 2.751 | accuracy 0.58784 | mrr 0.69692 | ppl 6.73 | wps 18130.2 | wpb 3288.5 | bsz 31.8 | num_updates 3628 | best_mrr 0.69692 (progress_bar.py:269, print())
[2021-05-31 17:13:00]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/javascript/gpt2/checkpoints/checkpoint_best.pt (epoch 2 @ 3628 updates, score 0.69692) (writing took 30.289997 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-05-31 17:15:22]    INFO >> epoch 003:    372 / 1814 loss=2.435, accuracy=0, mrr=0, ppl=5.41, wps=5619.2, ups=1.68, wpb=3347.1, bsz=32, num_updates=4000, lr=0.001, gnorm=0.636, clip=0, train_wall=178, wall=1911 (progress_bar.py:260, log())
[2021-05-31 17:15:56]    INFO >> epoch 003 | valid on 'valid' subset | loss 2.731 | accuracy 0.592252 | mrr 0.700588 | ppl 6.64 | wps 14961.4 | wpb 3288.5 | bsz 31.8 | num_updates 4000 | best_mrr 0.700588 (progress_bar.py:269, print())
[2021-05-31 17:16:25]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/javascript/gpt2/checkpoints/checkpoint_3_4000.pt (epoch 3 @ 4000 updates, score 0.700588) (writing took 28.797463 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-05-31 17:19:26]    INFO >> epoch 003:    872 / 1814 loss=2.346, accuracy=0, mrr=0, ppl=5.08, wps=6874.7, ups=2.05, wpb=3355.5, bsz=32, num_updates=4500, lr=0.001, gnorm=0.621, clip=0, train_wall=180, wall=2155 (progress_bar.py:260, log())
[2021-05-31 17:20:00]    INFO >> epoch 003 | valid on 'valid' subset | loss 2.686 | accuracy 0.597045 | mrr 0.704384 | ppl 6.43 | wps 14858.4 | wpb 3288.5 | bsz 31.8 | num_updates 4500 | best_mrr 0.704384 (progress_bar.py:269, print())
[2021-05-31 17:20:35]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/javascript/gpt2/checkpoints/checkpoint_3_4500.pt (epoch 3 @ 4500 updates, score 0.704384) (writing took 34.783536 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-05-31 17:23:36]    INFO >> epoch 003:   1372 / 1814 loss=2.284, accuracy=0, mrr=0, ppl=4.87, wps=6674.3, ups=2, wpb=3336.1, bsz=32, num_updates=5000, lr=0.001, gnorm=0.608, clip=0, train_wall=180, wall=2405 (progress_bar.py:260, log())
[2021-05-31 17:24:10]    INFO >> epoch 003 | valid on 'valid' subset | loss 2.673 | accuracy 0.600021 | mrr 0.706817 | ppl 6.38 | wps 14909 | wpb 3288.5 | bsz 31.8 | num_updates 5000 | best_mrr 0.706817 (progress_bar.py:269, print())
[2021-05-31 17:24:36]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/javascript/gpt2/checkpoints/checkpoint_3_5000.pt (epoch 3 @ 5000 updates, score 0.706817) (writing took 26.159745 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-05-31 17:27:15]    INFO >> epoch 003 | loss 2.314 | accuracy 0 | mrr 0 | ppl 4.97 | wps 6630.5 | ups 1.98 | wpb 3342.9 | bsz 32 | num_updates 5442 | lr 0.001 | gnorm 0.611 | clip 0 | train_wall 651 | wall 2624 (progress_bar.py:269, print())
[2021-05-31 17:27:49]    INFO >> epoch 003 | valid on 'valid' subset | loss 2.648 | accuracy 0.601973 | mrr 0.708306 | ppl 6.27 | wps 14834.6 | wpb 3288.5 | bsz 31.8 | num_updates 5442 | best_mrr 0.708306 (progress_bar.py:269, print())
[2021-05-31 17:28:07]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/javascript/gpt2/checkpoints/checkpoint_best.pt (epoch 3 @ 5442 updates, score 0.708306) (writing took 17.164301 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-05-31 17:28:34]    INFO >> epoch 004:     58 / 1814 loss=2.212, accuracy=0, mrr=0, ppl=4.63, wps=5554.7, ups=1.68, wpb=3316.2, bsz=32, num_updates=5500, lr=0.001, gnorm=0.585, clip=0, train_wall=178, wall=2704 (progress_bar.py:260, log())
[2021-05-31 17:29:08]    INFO >> epoch 004 | valid on 'valid' subset | loss 2.652 | accuracy 0.603421 | mrr 0.708929 | ppl 6.29 | wps 15036 | wpb 3288.5 | bsz 31.8 | num_updates 5500 | best_mrr 0.708929 (progress_bar.py:269, print())
[2021-05-31 17:29:22]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/javascript/gpt2/checkpoints/checkpoint_4_5500.pt (epoch 4 @ 5500 updates, score 0.708929) (writing took 13.274770 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-05-31 17:32:20]    INFO >> epoch 004:    558 / 1814 loss=2.164, accuracy=0, mrr=0, ppl=4.48, wps=7486.6, ups=2.22, wpb=3371.8, bsz=32, num_updates=6000, lr=0.001, gnorm=0.584, clip=0, train_wall=177, wall=2929 (progress_bar.py:260, log())
[2021-05-31 17:32:53]    INFO >> epoch 004 | valid on 'valid' subset | loss 2.641 | accuracy 0.605428 | mrr 0.711137 | ppl 6.24 | wps 14962 | wpb 3288.5 | bsz 31.8 | num_updates 6000 | best_mrr 0.711137 (progress_bar.py:269, print())
[2021-05-31 17:33:07]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/javascript/gpt2/checkpoints/checkpoint_4_6000.pt (epoch 4 @ 6000 updates, score 0.711137) (writing took 13.186275 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-05-31 17:36:06]    INFO >> epoch 004:   1058 / 1814 loss=2.107, accuracy=0, mrr=0, ppl=4.31, wps=7406, ups=2.21, wpb=3355.7, bsz=32, num_updates=6500, lr=0.001, gnorm=0.568, clip=0, train_wall=178, wall=3155 (progress_bar.py:260, log())
[2021-05-31 17:36:40]    INFO >> epoch 004 | valid on 'valid' subset | loss 2.627 | accuracy 0.606923 | mrr 0.712725 | ppl 6.18 | wps 14859.8 | wpb 3288.5 | bsz 31.8 | num_updates 6500 | best_mrr 0.712725 (progress_bar.py:269, print())
[2021-05-31 17:36:54]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/javascript/gpt2/checkpoints/checkpoint_4_6500.pt (epoch 4 @ 6500 updates, score 0.712725) (writing took 13.667548 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-05-31 17:39:54]    INFO >> epoch 004:   1558 / 1814 loss=2.08, accuracy=0, mrr=0, ppl=4.23, wps=7292, ups=2.19, wpb=3325.7, bsz=32, num_updates=7000, lr=0.001, gnorm=0.571, clip=0, train_wall=179, wall=3384 (progress_bar.py:260, log())
[2021-05-31 17:40:28]    INFO >> epoch 004 | valid on 'valid' subset | loss 2.635 | accuracy 0.604937 | mrr 0.710698 | ppl 6.21 | wps 14993.3 | wpb 3288.5 | bsz 31.8 | num_updates 7000 | best_mrr 0.712725 (progress_bar.py:269, print())
[2021-05-31 17:40:35]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/javascript/gpt2/checkpoints/checkpoint_4_7000.pt (epoch 4 @ 7000 updates, score 0.710698) (writing took 7.380875 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-05-31 17:42:04]    INFO >> epoch 004 | loss 2.109 | accuracy 0 | mrr 0 | ppl 4.31 | wps 6826.2 | ups 2.04 | wpb 3342.9 | bsz 32 | num_updates 7256 | lr 0.001 | gnorm 0.573 | clip 0 | train_wall 642 | wall 3513 (progress_bar.py:269, print())
[2021-05-31 17:42:38]    INFO >> epoch 004 | valid on 'valid' subset | loss 2.631 | accuracy 0.607287 | mrr 0.712881 | ppl 6.19 | wps 14918.2 | wpb 3288.5 | bsz 31.8 | num_updates 7256 | best_mrr 0.712881 (progress_bar.py:269, print())
[2021-05-31 17:42:50]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/javascript/gpt2/checkpoints/checkpoint_best.pt (epoch 4 @ 7256 updates, score 0.712881) (writing took 12.762145 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-05-31 17:44:25]    INFO >> epoch 005:    244 / 1814 loss=2.033, accuracy=0, mrr=0, ppl=4.09, wps=6146.3, ups=1.85, wpb=3326.5, bsz=32, num_updates=7500, lr=0.001, gnorm=0.557, clip=0, train_wall=174, wall=3654 (progress_bar.py:260, log())
[2021-05-31 17:44:59]    INFO >> epoch 005 | valid on 'valid' subset | loss 2.618 | accuracy 0.611333 | mrr 0.715679 | ppl 6.14 | wps 14917.1 | wpb 3288.5 | bsz 31.8 | num_updates 7500 | best_mrr 0.715679 (progress_bar.py:269, print())
[2021-05-31 17:45:15]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/javascript/gpt2/checkpoints/checkpoint_5_7500.pt (epoch 5 @ 7500 updates, score 0.715679) (writing took 16.089612 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-05-31 17:48:16]    INFO >> epoch 005:    744 / 1814 loss=2, accuracy=0, mrr=0, ppl=4, wps=7269.6, ups=2.17, wpb=3356.6, bsz=32, num_updates=8000, lr=0.001, gnorm=0.566, clip=0, train_wall=180, wall=3885 (progress_bar.py:260, log())
[2021-05-31 17:48:50]    INFO >> epoch 005 | valid on 'valid' subset | loss 2.637 | accuracy 0.605268 | mrr 0.711511 | ppl 6.22 | wps 14973.1 | wpb 3288.5 | bsz 31.8 | num_updates 8000 | best_mrr 0.715679 (progress_bar.py:269, print())
[2021-05-31 17:48:57]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/javascript/gpt2/checkpoints/checkpoint_5_8000.pt (epoch 5 @ 8000 updates, score 0.711511) (writing took 7.163370 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-05-31 17:51:57]    INFO >> epoch 005:   1244 / 1814 loss=1.967, accuracy=0, mrr=0, ppl=3.91, wps=7601.1, ups=2.26, wpb=3363.4, bsz=32, num_updates=8500, lr=0.001, gnorm=0.551, clip=0, train_wall=179, wall=4106 (progress_bar.py:260, log())
[2021-05-31 17:52:31]    INFO >> epoch 005 | valid on 'valid' subset | loss 2.618 | accuracy 0.611043 | mrr 0.715143 | ppl 6.14 | wps 14968.7 | wpb 3288.5 | bsz 31.8 | num_updates 8500 | best_mrr 0.715679 (progress_bar.py:269, print())
[2021-05-31 17:52:38]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/javascript/gpt2/checkpoints/checkpoint_5_8500.pt (epoch 5 @ 8500 updates, score 0.715143) (writing took 7.004810 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-05-31 17:55:38]    INFO >> epoch 005:   1744 / 1814 loss=1.937, accuracy=0, mrr=0, ppl=3.83, wps=7471.2, ups=2.26, wpb=3309, bsz=32, num_updates=9000, lr=0.001, gnorm=0.555, clip=0, train_wall=179, wall=4328 (progress_bar.py:260, log())
[2021-05-31 17:56:12]    INFO >> epoch 005 | valid on 'valid' subset | loss 2.645 | accuracy 0.612594 | mrr 0.715722 | ppl 6.25 | wps 14991.2 | wpb 3288.5 | bsz 31.8 | num_updates 9000 | best_mrr 0.715722 (progress_bar.py:269, print())
[2021-05-31 17:56:25]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/javascript/gpt2/checkpoints/checkpoint_5_9000.pt (epoch 5 @ 9000 updates, score 0.715722) (writing took 13.001235 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-05-31 17:56:50]    INFO >> epoch 005 | loss 1.975 | accuracy 0 | mrr 0 | ppl 3.93 | wps 6837.2 | ups 2.05 | wpb 3342.9 | bsz 32 | num_updates 9070 | lr 0.001 | gnorm 0.557 | clip 0 | train_wall 649 | wall 4400 (progress_bar.py:269, print())
[2021-05-31 17:57:24]    INFO >> epoch 005 | valid on 'valid' subset | loss 2.642 | accuracy 0.610542 | mrr 0.71454 | ppl 6.24 | wps 14934 | wpb 3288.5 | bsz 31.8 | num_updates 9070 | best_mrr 0.715722 (progress_bar.py:269, print())
[2021-05-31 17:57:33]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/javascript/gpt2/checkpoints/checkpoint_last.pt (epoch 5 @ 9070 updates, score 0.71454) (writing took 8.415806 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-05-31 18:00:15]    INFO >> epoch 006:    430 / 1814 loss=1.873, accuracy=0, mrr=0, ppl=3.66, wps=6039.4, ups=1.81, wpb=3339.9, bsz=31.9, num_updates=9500, lr=0.001, gnorm=0.529, clip=0, train_wall=179, wall=4604 (progress_bar.py:260, log())
[2021-05-31 18:00:49]    INFO >> epoch 006 | valid on 'valid' subset | loss 2.617 | accuracy 0.61648 | mrr 0.719302 | ppl 6.13 | wps 14928.1 | wpb 3288.5 | bsz 31.8 | num_updates 9500 | best_mrr 0.719302 (progress_bar.py:269, print())
[2021-05-31 18:01:13]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/javascript/gpt2/checkpoints/checkpoint_6_9500.pt (epoch 6 @ 9500 updates, score 0.719302) (writing took 24.123338 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-05-31 18:04:14]    INFO >> epoch 006:    930 / 1814 loss=1.896, accuracy=0, mrr=0, ppl=3.72, wps=7008.4, ups=2.09, wpb=3352.5, bsz=32, num_updates=10000, lr=0.001, gnorm=0.512, clip=0, train_wall=180, wall=4843 (progress_bar.py:260, log())
[2021-05-31 18:04:48]    INFO >> epoch 006 | valid on 'valid' subset | loss 2.574 | accuracy 0.619259 | mrr 0.721299 | ppl 5.96 | wps 14917.5 | wpb 3288.5 | bsz 31.8 | num_updates 10000 | best_mrr 0.721299 (progress_bar.py:269, print())
[2021-05-31 18:05:08]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/javascript/gpt2/checkpoints/checkpoint_6_10000.pt (epoch 6 @ 10000 updates, score 0.721299) (writing took 19.592129 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-05-31 18:08:08]    INFO >> epoch 006:   1430 / 1814 loss=1.911, accuracy=0, mrr=0, ppl=3.76, wps=7097.9, ups=2.13, wpb=3325.9, bsz=32, num_updates=10500, lr=0.001, gnorm=0.505, clip=0, train_wall=180, wall=5078 (progress_bar.py:260, log())
[2021-05-31 18:08:42]    INFO >> epoch 006 | valid on 'valid' subset | loss 2.555 | accuracy 0.621953 | mrr 0.72373 | ppl 5.87 | wps 14904 | wpb 3288.5 | bsz 31.8 | num_updates 10500 | best_mrr 0.72373 (progress_bar.py:269, print())
[2021-05-31 18:08:55]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/javascript/gpt2/checkpoints/checkpoint_6_10500.pt (epoch 6 @ 10500 updates, score 0.72373) (writing took 12.914467 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-05-31 18:11:10]    INFO >> epoch 006 | loss 1.895 | accuracy 0 | mrr 0 | ppl 3.72 | wps 7055.1 | ups 2.11 | wpb 3342.9 | bsz 32 | num_updates 10884 | lr 0.001 | gnorm 0.509 | clip 0 | train_wall 647 | wall 5259 (progress_bar.py:269, print())
[2021-05-31 18:11:44]    INFO >> epoch 006 | valid on 'valid' subset | loss 2.548 | accuracy 0.621816 | mrr 0.723962 | ppl 5.85 | wps 14933.9 | wpb 3288.5 | bsz 31.8 | num_updates 10884 | best_mrr 0.723962 (progress_bar.py:269, print())
[2021-05-31 18:11:57]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/javascript/gpt2/checkpoints/checkpoint_best.pt (epoch 6 @ 10884 updates, score 0.723962) (writing took 12.931868 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-05-31 18:12:47]    INFO >> epoch 007:    116 / 1814 loss=1.869, accuracy=0, mrr=0, ppl=3.65, wps=6009, ups=1.8, wpb=3343.1, bsz=32, num_updates=11000, lr=0.001, gnorm=0.495, clip=0, train_wall=175, wall=5356 (progress_bar.py:260, log())
[2021-05-31 18:13:21]    INFO >> epoch 007 | valid on 'valid' subset | loss 2.588 | accuracy 0.620191 | mrr 0.722368 | ppl 6.01 | wps 14928.4 | wpb 3288.5 | bsz 31.8 | num_updates 11000 | best_mrr 0.723962 (progress_bar.py:269, print())
[2021-05-31 18:13:32]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/javascript/gpt2/checkpoints/checkpoint_7_11000.pt (epoch 7 @ 11000 updates, score 0.722368) (writing took 10.964860 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-05-31 18:16:31]    INFO >> epoch 007:    616 / 1814 loss=1.757, accuracy=0, mrr=0, ppl=3.38, wps=7428.2, ups=2.22, wpb=3340.8, bsz=32, num_updates=11500, lr=0.001, gnorm=0.503, clip=0, train_wall=179, wall=5581 (progress_bar.py:260, log())
[2021-05-31 18:17:05]    INFO >> epoch 007 | valid on 'valid' subset | loss 2.613 | accuracy 0.618092 | mrr 0.720596 | ppl 6.12 | wps 14966.8 | wpb 3288.5 | bsz 31.8 | num_updates 11500 | best_mrr 0.723962 (progress_bar.py:269, print())
[2021-05-31 18:17:13]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/javascript/gpt2/checkpoints/checkpoint_7_11500.pt (epoch 7 @ 11500 updates, score 0.720596) (writing took 7.396263 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-05-31 18:20:13]    INFO >> epoch 007:   1116 / 1814 loss=1.794, accuracy=0, mrr=0, ppl=3.47, wps=7523.8, ups=2.26, wpb=3329, bsz=32, num_updates=12000, lr=0.001, gnorm=0.503, clip=0, train_wall=179, wall=5802 (progress_bar.py:260, log())
[2021-05-31 18:20:47]    INFO >> epoch 007 | valid on 'valid' subset | loss 2.583 | accuracy 0.6231 | mrr 0.724147 | ppl 5.99 | wps 14922.4 | wpb 3288.5 | bsz 31.8 | num_updates 12000 | best_mrr 0.724147 (progress_bar.py:269, print())
[2021-05-31 18:21:00]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/javascript/gpt2/checkpoints/checkpoint_7_12000.pt (epoch 7 @ 12000 updates, score 0.724147) (writing took 13.841952 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-05-31 18:24:02]    INFO >> epoch 007:   1616 / 1814 loss=1.817, accuracy=0, mrr=0, ppl=3.52, wps=7318.9, ups=2.18, wpb=3349.8, bsz=32, num_updates=12500, lr=0.001, gnorm=0.489, clip=0, train_wall=180, wall=6031 (progress_bar.py:260, log())
[2021-05-31 18:24:35]    INFO >> epoch 007 | valid on 'valid' subset | loss 2.57 | accuracy 0.621053 | mrr 0.723085 | ppl 5.94 | wps 15045.6 | wpb 3288.5 | bsz 31.8 | num_updates 12500 | best_mrr 0.724147 (progress_bar.py:269, print())
[2021-05-31 18:24:42]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/javascript/gpt2/checkpoints/checkpoint_7_12500.pt (epoch 7 @ 12500 updates, score 0.723085) (writing took 7.135239 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-05-31 18:25:54]    INFO >> epoch 007 | loss 1.79 | accuracy 0 | mrr 0 | ppl 3.46 | wps 6856.3 | ups 2.05 | wpb 3342.9 | bsz 32 | num_updates 12698 | lr 0.001 | gnorm 0.497 | clip 0 | train_wall 651 | wall 6144 (progress_bar.py:269, print())
[2021-05-31 18:26:28]    INFO >> epoch 007 | valid on 'valid' subset | loss 2.56 | accuracy 0.62298 | mrr 0.724445 | ppl 5.9 | wps 15001.7 | wpb 3288.5 | bsz 31.8 | num_updates 12698 | best_mrr 0.724445 (progress_bar.py:269, print())
[2021-05-31 18:26:41]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/javascript/gpt2/checkpoints/checkpoint_best.pt (epoch 7 @ 12698 updates, score 0.724445) (writing took 12.763790 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-05-31 18:28:37]    INFO >> epoch 008:    302 / 1814 loss=1.715, accuracy=0, mrr=0, ppl=3.28, wps=6077.2, ups=1.82, wpb=3343.4, bsz=32, num_updates=13000, lr=0.001, gnorm=0.495, clip=0, train_wall=179, wall=6306 (progress_bar.py:260, log())
[2021-05-31 18:29:11]    INFO >> epoch 008 | valid on 'valid' subset | loss 2.638 | accuracy 0.618833 | mrr 0.720702 | ppl 6.23 | wps 14973.7 | wpb 3288.5 | bsz 31.8 | num_updates 13000 | best_mrr 0.724445 (progress_bar.py:269, print())
[2021-05-31 18:29:18]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/javascript/gpt2/checkpoints/checkpoint_8_13000.pt (epoch 8 @ 13000 updates, score 0.720702) (writing took 7.107562 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-05-31 18:32:18]    INFO >> epoch 008:    802 / 1814 loss=1.688, accuracy=0, mrr=0, ppl=3.22, wps=7548.9, ups=2.26, wpb=3338.6, bsz=32, num_updates=13500, lr=0.001, gnorm=0.501, clip=0, train_wall=179, wall=6527 (progress_bar.py:260, log())
[2021-05-31 18:32:52]    INFO >> epoch 008 | valid on 'valid' subset | loss 2.628 | accuracy 0.620181 | mrr 0.721593 | ppl 6.18 | wps 14940.2 | wpb 3288.5 | bsz 31.8 | num_updates 13500 | best_mrr 0.724445 (progress_bar.py:269, print())
[2021-05-31 18:33:03]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/javascript/gpt2/checkpoints/checkpoint_8_13500.pt (epoch 8 @ 13500 updates, score 0.721593) (writing took 10.811739 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-05-31 18:36:03]    INFO >> epoch 008:   1302 / 1814 loss=1.713, accuracy=0, mrr=0, ppl=3.28, wps=7418.7, ups=2.22, wpb=3345.2, bsz=32, num_updates=14000, lr=0.001, gnorm=0.493, clip=0, train_wall=179, wall=6752 (progress_bar.py:260, log())
[2021-05-31 18:36:37]    INFO >> epoch 008 | valid on 'valid' subset | loss 2.616 | accuracy 0.621542 | mrr 0.72303 | ppl 6.13 | wps 14882.2 | wpb 3288.5 | bsz 31.8 | num_updates 14000 | best_mrr 0.724445 (progress_bar.py:269, print())
[2021-05-31 18:36:45]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/javascript/gpt2/checkpoints/checkpoint_8_14000.pt (epoch 8 @ 14000 updates, score 0.72303) (writing took 7.274731 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-05-31 18:39:45]    INFO >> epoch 008:   1802 / 1814 loss=1.74, accuracy=0, mrr=0, ppl=3.34, wps=7551.7, ups=2.25, wpb=3353.5, bsz=32, num_updates=14500, lr=0.001, gnorm=0.486, clip=0, train_wall=180, wall=6975 (progress_bar.py:260, log())
[2021-05-31 18:40:19]    INFO >> epoch 008 | valid on 'valid' subset | loss 2.593 | accuracy 0.62463 | mrr 0.725121 | ppl 6.03 | wps 14934.3 | wpb 3288.5 | bsz 31.8 | num_updates 14500 | best_mrr 0.725121 (progress_bar.py:269, print())
[2021-05-31 18:40:33]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/javascript/gpt2/checkpoints/checkpoint_8_14500.pt (epoch 8 @ 14500 updates, score 0.725121) (writing took 13.555273 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-05-31 18:40:38]    INFO >> epoch 008 | loss 1.703 | accuracy 0 | mrr 0 | ppl 3.26 | wps 6865.9 | ups 2.05 | wpb 3342.9 | bsz 32 | num_updates 14512 | lr 0.001 | gnorm 0.495 | clip 0 | train_wall 650 | wall 7027 (progress_bar.py:269, print())
[2021-05-31 18:41:12]    INFO >> epoch 008 | valid on 'valid' subset | loss 2.585 | accuracy 0.624107 | mrr 0.725008 | ppl 6 | wps 14810.4 | wpb 3288.5 | bsz 31.8 | num_updates 14512 | best_mrr 0.725121 (progress_bar.py:269, print())
[2021-05-31 18:41:25]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/javascript/gpt2/checkpoints/checkpoint_last.pt (epoch 8 @ 14512 updates, score 0.725008) (writing took 12.597413 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-05-31 18:44:28]    INFO >> epoch 009:    488 / 1814 loss=1.586, accuracy=0, mrr=0, ppl=3, wps=5938.8, ups=1.77, wpb=3357.1, bsz=32, num_updates=15000, lr=0.001, gnorm=0.497, clip=0, train_wall=179, wall=7257 (progress_bar.py:260, log())
[2021-05-31 18:45:02]    INFO >> epoch 009 | valid on 'valid' subset | loss 2.661 | accuracy 0.620301 | mrr 0.721354 | ppl 6.32 | wps 15091 | wpb 3288.5 | bsz 31.8 | num_updates 15000 | best_mrr 0.725121 (progress_bar.py:269, print())
[2021-05-31 18:45:16]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/javascript/gpt2/checkpoints/checkpoint_9_15000.pt (epoch 9 @ 15000 updates, score 0.721354) (writing took 13.874243 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-05-31 18:48:16]    INFO >> epoch 009:    988 / 1814 loss=1.623, accuracy=0, mrr=0, ppl=3.08, wps=7316.1, ups=2.19, wpb=3340.9, bsz=32, num_updates=15500, lr=0.001, gnorm=0.499, clip=0, train_wall=179, wall=7486 (progress_bar.py:260, log())
[2021-05-31 18:48:50]    INFO >> epoch 009 | valid on 'valid' subset | loss 2.667 | accuracy 0.619675 | mrr 0.72061 | ppl 6.35 | wps 14966.2 | wpb 3288.5 | bsz 31.8 | num_updates 15500 | best_mrr 0.725121 (progress_bar.py:269, print())
[2021-05-31 18:49:04]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/javascript/gpt2/checkpoints/checkpoint_9_15500.pt (epoch 9 @ 15500 updates, score 0.72061) (writing took 13.986052 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-05-31 18:52:05]    INFO >> epoch 009:   1488 / 1814 loss=1.643, accuracy=0, mrr=0, ppl=3.12, wps=7312.1, ups=2.18, wpb=3348.7, bsz=32, num_updates=16000, lr=0.001, gnorm=0.495, clip=0, train_wall=180, wall=7715 (progress_bar.py:260, log())
[2021-05-31 18:52:39]    INFO >> epoch 009 | valid on 'valid' subset | loss 2.65 | accuracy 0.621081 | mrr 0.721859 | ppl 6.28 | wps 14913.5 | wpb 3288.5 | bsz 31.8 | num_updates 16000 | best_mrr 0.725121 (progress_bar.py:269, print())
[2021-05-31 18:52:46]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/javascript/gpt2/checkpoints/checkpoint_9_16000.pt (epoch 9 @ 16000 updates, score 0.721859) (writing took 6.888711 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-05-31 18:54:45]    INFO >> epoch 009 | loss 1.624 | accuracy 0 | mrr 0 | ppl 3.08 | wps 7157.8 | ups 2.14 | wpb 3342.9 | bsz 32 | num_updates 16326 | lr 0.001 | gnorm 0.495 | clip 0 | train_wall 652 | wall 7874 (progress_bar.py:269, print())
[2021-05-31 18:55:19]    INFO >> epoch 009 | valid on 'valid' subset | loss 2.652 | accuracy 0.622305 | mrr 0.72281 | ppl 6.29 | wps 14993.2 | wpb 3288.5 | bsz 31.8 | num_updates 16326 | best_mrr 0.725121 (progress_bar.py:269, print())
[2021-05-31 18:55:26]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/javascript/gpt2/checkpoints/checkpoint_last.pt (epoch 9 @ 16326 updates, score 0.72281) (writing took 6.919362 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-05-31 18:56:36]    INFO >> epoch 010:    174 / 1814 loss=1.598, accuracy=0, mrr=0, ppl=3.03, wps=6132.4, ups=1.85, wpb=3320, bsz=32, num_updates=16500, lr=0.001, gnorm=0.492, clip=0, train_wall=180, wall=7985 (progress_bar.py:260, log())
[2021-05-31 18:57:10]    INFO >> epoch 010 | valid on 'valid' subset | loss 2.713 | accuracy 0.619872 | mrr 0.720582 | ppl 6.56 | wps 14920.5 | wpb 3288.5 | bsz 31.8 | num_updates 16500 | best_mrr 0.725121 (progress_bar.py:269, print())
[2021-05-31 18:57:23]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/javascript/gpt2/checkpoints/checkpoint_10_16500.pt (epoch 10 @ 16500 updates, score 0.720582) (writing took 12.656440 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-05-31 19:00:23]    INFO >> epoch 010:    674 / 1814 loss=1.523, accuracy=0, mrr=0, ppl=2.87, wps=7400.4, ups=2.2, wpb=3356.2, bsz=32, num_updates=17000, lr=0.001, gnorm=0.506, clip=0, train_wall=179, wall=8212 (progress_bar.py:260, log())
[2021-05-31 19:00:57]    INFO >> epoch 010 | valid on 'valid' subset | loss 2.708 | accuracy 0.620612 | mrr 0.721043 | ppl 6.53 | wps 14784.4 | wpb 3288.5 | bsz 31.8 | num_updates 17000 | best_mrr 0.725121 (progress_bar.py:269, print())
[2021-05-31 19:01:04]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/javascript/gpt2/checkpoints/checkpoint_10_17000.pt (epoch 10 @ 17000 updates, score 0.721043) (writing took 7.312658 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-05-31 19:04:04]    INFO >> epoch 010:   1174 / 1814 loss=1.554, accuracy=0, mrr=0, ppl=2.94, wps=7530, ups=2.26, wpb=3330.7, bsz=32, num_updates=17500, lr=0.001, gnorm=0.505, clip=0, train_wall=179, wall=8433 (progress_bar.py:260, log())
[2021-05-31 19:04:38]    INFO >> epoch 010 | valid on 'valid' subset | loss 2.708 | accuracy 0.620296 | mrr 0.72056 | ppl 6.53 | wps 14992.5 | wpb 3288.5 | bsz 31.8 | num_updates 17500 | best_mrr 0.725121 (progress_bar.py:269, print())
[2021-05-31 19:04:45]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/javascript/gpt2/checkpoints/checkpoint_10_17500.pt (epoch 10 @ 17500 updates, score 0.72056) (writing took 7.314444 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-05-31 19:07:46]    INFO >> epoch 010:   1674 / 1814 loss=1.578, accuracy=0, mrr=0, ppl=2.99, wps=7515, ups=2.26, wpb=3331, bsz=32, num_updates=18000, lr=0.001, gnorm=0.496, clip=0, train_wall=179, wall=8655 (progress_bar.py:260, log())
[2021-05-31 19:08:20]    INFO >> epoch 010 | valid on 'valid' subset | loss 2.682 | accuracy 0.620423 | mrr 0.721377 | ppl 6.42 | wps 14904.8 | wpb 3288.5 | bsz 31.8 | num_updates 18000 | best_mrr 0.725121 (progress_bar.py:269, print())
[2021-05-31 19:08:27]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/javascript/gpt2/checkpoints/checkpoint_10_18000.pt (epoch 10 @ 18000 updates, score 0.721377) (writing took 7.187986 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-05-31 19:09:18]    INFO >> epoch 010 | loss 1.549 | accuracy 0 | mrr 0 | ppl 2.93 | wps 6943.1 | ups 2.08 | wpb 3342.9 | bsz 32 | num_updates 18140 | lr 0.001 | gnorm 0.501 | clip 0 | train_wall 650 | wall 8748 (progress_bar.py:269, print())
[2021-05-31 19:09:49]    INFO >> epoch 010 | valid on 'valid' subset | loss 2.694 | accuracy 0.623065 | mrr 0.72283 | ppl 6.47 | wps 16968.1 | wpb 3288.5 | bsz 31.8 | num_updates 18140 | best_mrr 0.725121 (progress_bar.py:269, print())
[2021-05-31 19:10:01]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/javascript/gpt2/checkpoints/checkpoint_last.pt (epoch 10 @ 18140 updates, score 0.72283) (writing took 11.555460 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-05-31 19:12:18]    INFO >> epoch 011:    360 / 1814 loss=1.473, accuracy=0, mrr=0, ppl=2.78, wps=6173.4, ups=1.83, wpb=3368.2, bsz=32, num_updates=18500, lr=0.001, gnorm=0.505, clip=0, train_wall=180, wall=8928 (progress_bar.py:260, log())
[2021-05-31 19:12:52]    INFO >> epoch 011 | valid on 'valid' subset | loss 2.802 | accuracy 0.616819 | mrr 0.717256 | ppl 6.97 | wps 15013 | wpb 3288.5 | bsz 31.8 | num_updates 18500 | best_mrr 0.725121 (progress_bar.py:269, print())
[2021-05-31 19:13:00]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/javascript/gpt2/checkpoints/checkpoint_11_18500.pt (epoch 11 @ 18500 updates, score 0.717256) (writing took 7.491499 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-05-31 19:16:01]    INFO >> epoch 011:    860 / 1814 loss=1.468, accuracy=0, mrr=0, ppl=2.77, wps=7544, ups=2.25, wpb=3353.6, bsz=32, num_updates=19000, lr=0.001, gnorm=0.511, clip=0, train_wall=179, wall=9150 (progress_bar.py:260, log())
[2021-05-31 19:16:35]    INFO >> epoch 011 | valid on 'valid' subset | loss 2.769 | accuracy 0.619383 | mrr 0.71961 | ppl 6.81 | wps 14923.7 | wpb 3288.5 | bsz 31.8 | num_updates 19000 | best_mrr 0.725121 (progress_bar.py:269, print())
[2021-05-31 19:16:42]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/javascript/gpt2/checkpoints/checkpoint_11_19000.pt (epoch 11 @ 19000 updates, score 0.71961) (writing took 7.166902 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-05-31 19:19:42]    INFO >> epoch 011:   1360 / 1814 loss=1.503, accuracy=0, mrr=0, ppl=2.83, wps=7501.2, ups=2.26, wpb=3320.2, bsz=32, num_updates=19500, lr=0.001, gnorm=0.513, clip=0, train_wall=179, wall=9371 (progress_bar.py:260, log())
[2021-05-31 19:20:16]    INFO >> epoch 011 | valid on 'valid' subset | loss 2.754 | accuracy 0.617536 | mrr 0.718341 | ppl 6.75 | wps 14942.9 | wpb 3288.5 | bsz 31.8 | num_updates 19500 | best_mrr 0.725121 (progress_bar.py:269, print())
[2021-05-31 19:20:23]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/javascript/gpt2/checkpoints/checkpoint_11_19500.pt (epoch 11 @ 19500 updates, score 0.718341) (writing took 7.121033 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-05-31 19:23:08]    INFO >> epoch 011 | loss 1.481 | accuracy 0 | mrr 0 | ppl 2.79 | wps 7312.1 | ups 2.19 | wpb 3342.9 | bsz 32 | num_updates 19954 | lr 0.001 | gnorm 0.508 | clip 0 | train_wall 651 | wall 9577 (progress_bar.py:269, print())
[2021-05-31 19:23:42]    INFO >> epoch 011 | valid on 'valid' subset | loss 2.733 | accuracy 0.620839 | mrr 0.721076 | ppl 6.65 | wps 14834.3 | wpb 3288.5 | bsz 31.8 | num_updates 19954 | best_mrr 0.725121 (progress_bar.py:269, print())
[2021-05-31 19:23:48]    INFO >> saved checkpoint /mnt/wanyao/ncc_data/codexglue/code_to_text/completion/data-mmap/javascript/gpt2/checkpoints/checkpoint_last.pt (epoch 11 @ 19954 updates, score 0.721076) (writing took 6.654228 seconds) (checkpoint_utils.py:79, save_checkpoint())
[2021-05-31 19:23:48]    INFO >> early stop since valid performance hasn't improved for last 3 runs (train.py:176, should_stop_early())
[2021-05-31 19:23:48]    INFO >> early stop since valid performance hasn't improved for last 3 runs (train.py:259, single_main())
[2021-05-31 19:23:48]    INFO >> done training in 9617.4 seconds (train.py:271, single_main())
