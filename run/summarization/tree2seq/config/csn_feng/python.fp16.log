nohup: ignoring input
[2020-12-27 03:28:11]    INFO >> Load arguments in /home/wanyao/yang/naturalcc-dev/run/summarization/tree2seq/config/csn_feng/python.fp16.yml (train.py:299, cli_main())
[2020-12-27 03:28:11]    INFO >> {'criterion': 'cross_entropy', 'optimizer': 'adam', 'lr_scheduler': 'fixed', 'tokenizer': None, 'bpe': None, 'common': {'no_progress_bar': 0, 'log_interval': 50, 'log_format': 'simple', 'tensorboard_logdir': '', 'memory_efficient_fp16': 1, 'fp16_no_flatten_grads': 1, 'fp16_init_scale': 128, 'fp16_scale_window': None, 'fp16_scale_tolerance': 0.0, 'min_loss_scale': 0.0001, 'threshold_loss_scale': None, 'empty_cache_freq': 0, 'task': 'graph_summarization', 'seed': 1, 'cpu': 0, 'fp16': 1, 'fp16_opt_level': '01', 'server_ip': '', 'server_port': ''}, 'dataset': {'num_workers': 0, 'skip_invalid_size_inputs_valid_test': 1, 'max_tokens': None, 'max_sentences': 128, 'required_batch_size_multiple': 8, 'dataset_impl': 'mmap', 'train_subset': 'train', 'valid_subset': 'valid', 'validate_interval': 1, 'fixed_validation_seed': None, 'disable_validation': 0, 'max_tokens_valid': None, 'max_sentences_valid': 512, 'curriculum': 0, 'gen_subset': 'test', 'num_shards': 1, 'shard_id': 0}, 'distributed_training': {'distributed_world_size': 4, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': None, 'distributed_port': -1, 'device_id': 0, 'distributed_no_spawn': 0, 'ddp_backend': 'no_c10d', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': None, 'find_unused_parameters': 0, 'fast_stat_sync': 0, 'broadcast_buffers': 0, 'global_sync_iter': 50, 'warmup_iterations': 500, 'local_rank': -1, 'block_momentum': 0.875, 'block_lr': 1, 'use_nbm': 0, 'average_sync': 0}, 'task': {'data': '/home/wanyao/.ncc/code_search_net_feng/sum_bin_ast/python/data-mmap', 'source_lang': 'bin_ast', 'target_lang': 'docstring_tokens', 'load_alignments': 0, 'left_pad_source': 0, 'left_pad_target': 0, 'max_source_positions': 512, 'max_target_positions': 30, 'upsample_primary': 1, 'truncate_source': 0, 'truncate_target': 1, 'append_eos_to_target': 1, 'eval_bleu': 1, 'eval_bleu_detok': 'space', 'eval_bleu_detok_args': None, 'eval_tokenized_bleu': 0, 'eval_bleu_remove_bpe': None, 'eval_bleu_args': None, 'eval_bleu_print_samples': 0}, 'model': {'arch': 'nary_tree2seq', 'encoder_embed_dim': 512, 'encoder_embed': None, 'encoder_freeze_embed': 0, 'encoder_hidden_size': 512, 'encoder_layers': 1, 'encoder_bidirectional': 0, 'decoder_embed_dim': 512, 'decoder_embed': None, 'decoder_freeze_embed': None, 'decoder_hidden_size': 512, 'decoder_layers': 1, 'decoder_out_embed_dim': 512, 'decoder_attention': 1, 'adaptive_softmax_cutoff': None, 'share_decoder_input_output_embed': 0, 'share_all_embeddings': 0, 'encoder_dropout_in': 0.1, 'encoder_dropout_out': 0.2, 'decoder_dropout_in': 0.1, 'decoder_dropout_out': 0.2, 'max_source_positions': 512, 'max_target_positions': 30}, 'optimization': {'max_epoch': 100, 'max_update': 0, 'clip_norm': 25, 'update_freq': [1], 'lr': [0.0004], 'min_lr': -1, 'use_bmuf': 0, 'force_anneal': 0, 'warmup_updates': 0, 'lr_shrink': 0.98, 'sentence_avg': 1, 'adam': {'adam_betas': '(0.9, 0.999)', 'adam_eps': 1e-08, 'weight_decay': 0.0, 'use_old_adam': 0}, 'weight_decay': 0.0, 'adam_epsilon': 1e-08, 'max_grad_norm': 1.0, 'num_train_epochs': 5, 'max_steps': -1, 'warmup_steps': 0, 'gradient_accumulation_steps': 1}, 'checkpoint': {'restore_file': 'checkpoint_last.pt', 'reset_dataloader': None, 'reset_lr_scheduler': None, 'reset_meters': None, 'reset_optimizer': None, 'optimizer_overrides': '{}', 'save_interval': 1, 'save_interval_updates': 0, 'keep_interval_updates': 0, 'keep_last_epochs': -1, 'keep_best_checkpoints': -1, 'no_save': 0, 'no_epoch_checkpoints': 1, 'no_last_checkpoints': 0, 'no_save_optimizer_state': None, 'best_checkpoint_metric': 'bleu', 'maximize_best_checkpoint_metric': 1, 'patience': 10, 'save_dir': '/home/wanyao/.ncc/code_search_net_feng/sum_bin_ast/python/data-mmap/nary_tree2seq/checkpoints', 'should_continue': 0, 'model_name_or_path': None, 'cache_dir': None, 'logging_steps': 500, 'save_steps': 2000, 'save_total_limit': 2, 'overwrite_output_dir': 0, 'overwrite_cache': 0}, 'eval': {'path': '/home/wanyao/.ncc/code_search_net_feng/sum_bin_ast/python/data-mmap/nary_tree2seq/checkpoints/checkpoint_best.pt', 'result_path': None, 'remove_bpe': None, 'quiet': 0, 'model_overrides': '{}', 'max_sentences': 2048, 'beam': 1, 'nbest': 1, 'max_len_a': 0, 'max_len_b': 30, 'min_len': 1, 'match_source_len': 0, 'no_early_stop': 0, 'unnormalized': 0, 'no_beamable_mm': 0, 'lenpen': 1, 'unkpen': 0, 'replace_unk': None, 'sacrebleu': 0, 'score_reference': 0, 'prefix_size': 0, 'no_repeat_ngram_size': 0, 'sampling': 0, 'sampling_topk': -1, 'sampling_topp': -1, 'temperature': 1.0, 'diverse_beam_groups': -1, 'diverse_beam_strength': 0.5, 'diversity_rate': -1.0, 'print_alignment': 0, 'print_step': 0, 'iter_decode_eos_penalty': 0.0, 'iter_decode_max_iter': 10, 'iter_decode_force_max_iter': 0, 'iter_decode_with_beam': 1, 'iter_decode_with_external_reranker': 0, 'retain_iter_history': 0, 'decoding_format': None, 'nltk_bleu': 1, 'rouge': 1}} (train.py:301, cli_main())
[2020-12-27 03:28:16]    INFO >> distributed init (rank 0): tcp://localhost:15671 (distributed_utils.py:89, distributed_init())
[2020-12-27 03:28:17]    INFO >> distributed init (rank 3): tcp://localhost:15671 (distributed_utils.py:89, distributed_init())
[2020-12-27 03:28:17]    INFO >> initialized host node14 as rank 3 (distributed_utils.py:98, distributed_init())
[2020-12-27 03:28:17]    INFO >> distributed init (rank 2): tcp://localhost:15671 (distributed_utils.py:89, distributed_init())
[2020-12-27 03:28:17]    INFO >> initialized host node14 as rank 2 (distributed_utils.py:98, distributed_init())
[2020-12-27 03:28:17]    INFO >> distributed init (rank 1): tcp://localhost:15671 (distributed_utils.py:89, distributed_init())
[2020-12-27 03:28:17]    INFO >> initialized host node14 as rank 1 (distributed_utils.py:98, distributed_init())
[2020-12-27 03:28:17]    INFO >> initialized host node14 as rank 0 (distributed_utils.py:98, distributed_init())
[2020-12-27 03:28:23]    INFO >> [bin_ast] dictionary: 50000 types (graph_summarization.py:169, setup_task())
[2020-12-27 03:28:23]    INFO >> [docstring_tokens] dictionary: 23256 types (graph_summarization.py:170, setup_task())
[2020-12-27 03:28:26]    INFO >> truncate valid.docstring_tokens to 30 (graph_summarization.py:96, load_langpair_dataset())
[2020-12-27 03:28:26]    INFO >> loaded 13914 examples from: /home/wanyao/.ncc/code_search_net_feng/sum_bin_ast/python/data-mmap/valid.bin_ast (graph_summarization.py:117, load_langpair_dataset())
[2020-12-27 03:28:26]    INFO >> loaded 13914 examples from: /home/wanyao/.ncc/code_search_net_feng/sum_bin_ast/python/data-mmap/valid.docstring_tokens (graph_summarization.py:118, load_langpair_dataset())
[2020-12-27 03:28:27]    INFO >> NaryTree2SeqModel(
  (encoder): NaryTreeLSTMEncoder(
    (embed_tokens): Embedding(50000, 512, padding_idx=0)
    (lstm): NaryTreeLSTMCell(
      (W_iou): Linear(in_features=512, out_features=1536, bias=False)
      (U_iou): Linear(in_features=1024, out_features=1536, bias=False)
      (U_f): Linear(in_features=1024, out_features=1024, bias=True)
    )
  )
  (decoder): LSTMDecoder(
    (embed_tokens): Embedding(23256, 512, padding_idx=0)
    (layers): ModuleList(
      (0): LSTMCell(1024, 512)
    )
    (attention): AttentionLayer(
      (input_proj): Linear(in_features=512, out_features=512, bias=False)
      (output_proj): Linear(in_features=1024, out_features=512, bias=False)
    )
    (fc_out): Linear(in_features=512, out_features=23256, bias=True)
  )
) (train.py:220, single_main())
[2020-12-27 03:28:27]    INFO >> model nary_tree2seq, criterion CrossEntropyCriterion (train.py:221, single_main())
[2020-12-27 03:28:27]    INFO >> num. model params: 56784088 (num. trained: 56784088) (train.py:224, single_main())
[2020-12-27 03:28:27]    INFO >> training on 4 GPUs (train.py:229, single_main())
[2020-12-27 03:28:27]    INFO >> max tokens per GPU = None and max sentences per GPU = 128 (train.py:232, single_main())
[2020-12-27 03:28:27]    INFO >> no existing checkpoint found /home/wanyao/.ncc/code_search_net_feng/sum_bin_ast/python/data-mmap/nary_tree2seq/checkpoints/checkpoint_last.pt (ncc_trainer.py:267, load_checkpoint())
[2020-12-27 03:28:27]    INFO >> loading train data for epoch 1 (ncc_trainer.py:281, get_train_iterator())
[2020-12-27 03:29:19]    INFO >> truncate train.docstring_tokens to 30 (graph_summarization.py:96, load_langpair_dataset())
[2020-12-27 03:29:19]    INFO >> loaded 251820 examples from: /home/wanyao/.ncc/code_search_net_feng/sum_bin_ast/python/data-mmap/train.bin_ast (graph_summarization.py:117, load_langpair_dataset())
[2020-12-27 03:29:19]    INFO >> loaded 251820 examples from: /home/wanyao/.ncc/code_search_net_feng/sum_bin_ast/python/data-mmap/train.docstring_tokens (graph_summarization.py:118, load_langpair_dataset())
[2020-12-27 03:29:20]    INFO >> using FusedAdam (adam.py:39, __init__())
[2020-12-27 03:30:09]    INFO >> epoch 001:     50 / 492 loss=120.427, nll_loss=9.896, bleu=0, ppl=952.45, wps=7558.7, ups=1.21, wpb=6231, bsz=512, num_updates=50, lr=0.0004, gnorm=9.602, clip=0, loss_scale=128, train_wall=47, wall=102 (progress_bar.py:262, log())
[2020-12-27 03:30:50]    INFO >> epoch 001:    100 / 492 loss=102.189, nll_loss=8.425, bleu=0, ppl=343.8, wps=7612.1, ups=1.23, wpb=6209.9, bsz=512, num_updates=100, lr=0.0004, gnorm=4.43, clip=0, loss_scale=128, train_wall=39, wall=142 (progress_bar.py:262, log())
[2020-12-27 03:31:31]    INFO >> epoch 001:    150 / 492 loss=98.327, nll_loss=8.099, bleu=0, ppl=274.21, wps=7486.1, ups=1.2, wpb=6215.9, bsz=512, num_updates=150, lr=0.0004, gnorm=4.275, clip=0, loss_scale=128, train_wall=39, wall=184 (progress_bar.py:262, log())
[2020-12-27 03:32:10]    INFO >> epoch 001:    200 / 492 loss=95.777, nll_loss=7.879, bleu=0, ppl=235.48, wps=8132.3, ups=1.31, wpb=6223.5, bsz=512, num_updates=200, lr=0.0004, gnorm=4.544, clip=0, loss_scale=128, train_wall=36, wall=222 (progress_bar.py:262, log())
[2020-12-27 03:32:51]    INFO >> epoch 001:    250 / 492 loss=93.454, nll_loss=7.707, bleu=0, ppl=208.99, wps=7436.3, ups=1.2, wpb=6208.2, bsz=512, num_updates=250, lr=0.0004, gnorm=4.552, clip=0, loss_scale=128, train_wall=40, wall=264 (progress_bar.py:262, log())
[2020-12-27 03:33:29]    INFO >> epoch 001:    300 / 492 loss=92.166, nll_loss=7.582, bleu=0, ppl=191.57, wps=8155.1, ups=1.31, wpb=6203.6, bsz=510.3, num_updates=300, lr=0.0004, gnorm=4.115, clip=0, loss_scale=128, train_wall=36, wall=302 (progress_bar.py:262, log())
[2020-12-27 03:34:09]    INFO >> epoch 001:    350 / 492 loss=91.188, nll_loss=7.467, bleu=0, ppl=176.95, wps=7949, ups=1.27, wpb=6252.4, bsz=512, num_updates=350, lr=0.0004, gnorm=4.471, clip=0, loss_scale=128, train_wall=37, wall=341 (progress_bar.py:262, log())
[2020-12-27 03:34:47]    INFO >> epoch 001:    400 / 492 loss=88.999, nll_loss=7.34, bleu=0, ppl=162.03, wps=8076, ups=1.3, wpb=6208, bsz=512, num_updates=400, lr=0.0004, gnorm=4.592, clip=0, loss_scale=128, train_wall=36, wall=380 (progress_bar.py:262, log())
[2020-12-27 03:35:27]    INFO >> epoch 001:    450 / 492 loss=87.636, nll_loss=7.23, bleu=0, ppl=150.09, wps=7803.5, ups=1.26, wpb=6206.3, bsz=512, num_updates=450, lr=0.0004, gnorm=4.639, clip=0, loss_scale=128, train_wall=38, wall=420 (progress_bar.py:262, log())
[2020-12-27 03:36:01]    INFO >> epoch 001 | loss 95.844 | nll_loss 7.891 | bleu 0 | ppl 237.35 | wps 7777 | ups 1.25 | wpb 6216.8 | bsz 511.8 | num_updates 492 | lr 0.0004 | gnorm 4.971 | clip 0 | loss_scale 128 | train_wall 379 | wall 454 (progress_bar.py:269, print())
[2020-12-27 03:36:17]    INFO >> epoch 001 | valid on 'valid' subset | loss 87.785 | nll_loss 7.032 | bleu 12.756035493795713 | ppl 130.87 | wps 10669.3 | wpb 24814 | bsz 1987.7 | num_updates 492 (progress_bar.py:269, print())
[2020-12-27 03:36:20]    INFO >> saved checkpoint /home/wanyao/.ncc/code_search_net_feng/sum_bin_ast/python/data-mmap/nary_tree2seq/checkpoints/checkpoint_best.pt (epoch 1 @ 492 updates, score 12.756035493795713) (writing took 2.2252620104700327 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2020-12-27 03:36:27]    INFO >> epoch 002:      8 / 492 loss=86.363, nll_loss=7.132, bleu=0, ppl=140.26, wps=5165.7, ups=0.83, wpb=6200, bsz=512, num_updates=500, lr=0.0004, gnorm=4.589, clip=0, loss_scale=128, train_wall=39, wall=480 (progress_bar.py:262, log())
[2020-12-27 03:37:09]    INFO >> epoch 002:     58 / 492 loss=85.543, nll_loss=7.006, bleu=0, ppl=128.54, wps=7503, ups=1.2, wpb=6251.5, bsz=512, num_updates=550, lr=0.0004, gnorm=4.849, clip=0, loss_scale=128, train_wall=39, wall=521 (progress_bar.py:262, log())
[2020-12-27 03:37:48]    INFO >> epoch 002:    108 / 492 loss=83.761, nll_loss=6.919, bleu=0, ppl=121.04, wps=7967.1, ups=1.29, wpb=6198, bsz=512, num_updates=600, lr=0.0004, gnorm=4.589, clip=0, loss_scale=128, train_wall=37, wall=560 (progress_bar.py:262, log())
[2020-12-27 03:38:25]    INFO >> epoch 002:    158 / 492 loss=83.041, nll_loss=6.835, bleu=0, ppl=114.15, wps=8209.3, ups=1.32, wpb=6220.6, bsz=512, num_updates=650, lr=0.0004, gnorm=4.779, clip=0, loss_scale=128, train_wall=36, wall=598 (progress_bar.py:262, log())
[2020-12-27 03:39:06]    INFO >> epoch 002:    208 / 492 loss=82.739, nll_loss=6.778, bleu=0, ppl=109.71, wps=7732.9, ups=1.24, wpb=6250.4, bsz=512, num_updates=700, lr=0.0004, gnorm=4.648, clip=0, loss_scale=128, train_wall=38, wall=638 (progress_bar.py:262, log())
[2020-12-27 03:39:45]    INFO >> epoch 002:    258 / 492 loss=81.809, nll_loss=6.723, bleu=0, ppl=105.62, wps=8041, ups=1.29, wpb=6230.5, bsz=512, num_updates=750, lr=0.0004, gnorm=4.616, clip=0, loss_scale=128, train_wall=37, wall=677 (progress_bar.py:262, log())
[2020-12-27 03:40:24]    INFO >> epoch 002:    308 / 492 loss=81.259, nll_loss=6.678, bleu=0, ppl=102.39, wps=7869, ups=1.26, wpb=6230.2, bsz=512, num_updates=800, lr=0.0004, gnorm=4.664, clip=0, loss_scale=128, train_wall=37, wall=717 (progress_bar.py:262, log())
[2020-12-27 03:41:04]    INFO >> epoch 002:    358 / 492 loss=79.743, nll_loss=6.605, bleu=0, ppl=97.31, wps=7786, ups=1.26, wpb=6161.6, bsz=510.3, num_updates=850, lr=0.0004, gnorm=4.697, clip=0, loss_scale=128, train_wall=37, wall=756 (progress_bar.py:262, log())
[2020-12-27 03:41:43]    INFO >> epoch 002:    408 / 492 loss=79.553, nll_loss=6.545, bleu=0, ppl=93.39, wps=8030.4, ups=1.29, wpb=6223, bsz=512, num_updates=900, lr=0.0004, gnorm=4.676, clip=0, loss_scale=128, train_wall=37, wall=795 (progress_bar.py:262, log())
[2020-12-27 03:42:20]    INFO >> epoch 002:    458 / 492 loss=78.598, nll_loss=6.488, bleu=0, ppl=89.75, wps=8250, ups=1.33, wpb=6202.6, bsz=512, num_updates=950, lr=0.0004, gnorm=4.598, clip=0, loss_scale=128, train_wall=35, wall=833 (progress_bar.py:262, log())
[2020-12-27 03:42:47]    INFO >> epoch 002 | loss 81.573 | nll_loss 6.716 | bleu 0 | ppl 105.12 | wps 7542.6 | ups 1.21 | wpb 6216.8 | bsz 511.8 | num_updates 984 | lr 0.0004 | gnorm 4.688 | clip 0 | loss_scale 128 | train_wall 366 | wall 859 (progress_bar.py:269, print())
[2020-12-27 03:43:03]    INFO >> epoch 002 | valid on 'valid' subset | loss 80.581 | nll_loss 6.455 | bleu 13.988203733718816 | ppl 87.72 | wps 10833.6 | wpb 24814 | bsz 1987.7 | num_updates 984 | best_bleu 13.988203733718816 (progress_bar.py:269, print())
[2020-12-27 03:43:07]    INFO >> saved checkpoint /home/wanyao/.ncc/code_search_net_feng/sum_bin_ast/python/data-mmap/nary_tree2seq/checkpoints/checkpoint_best.pt (epoch 2 @ 984 updates, score 13.988203733718816) (writing took 4.0201694294810295 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2020-12-27 03:43:21]    INFO >> epoch 003:     16 / 492 loss=77.801, nll_loss=6.415, bleu=0, ppl=85.31, wps=5087.7, ups=0.82, wpb=6209.8, bsz=512, num_updates=1000, lr=0.000392, gnorm=4.559, clip=0, loss_scale=128, train_wall=39, wall=894 (progress_bar.py:262, log())
[2020-12-27 03:44:02]    INFO >> epoch 003:     66 / 492 loss=76.025, nll_loss=6.288, bleu=0, ppl=78.13, wps=7648.7, ups=1.24, wpb=6190.6, bsz=512, num_updates=1050, lr=0.000392, gnorm=4.752, clip=0, loss_scale=128, train_wall=38, wall=934 (progress_bar.py:262, log())
[2020-12-27 03:44:41]    INFO >> epoch 003:    116 / 492 loss=75.829, nll_loss=6.256, bleu=0, ppl=76.44, wps=7838.5, ups=1.26, wpb=6205.7, bsz=512, num_updates=1100, lr=0.000392, gnorm=4.79, clip=0, loss_scale=128, train_wall=37, wall=974 (progress_bar.py:262, log())
[2020-12-27 03:45:21]    INFO >> epoch 003:    166 / 492 loss=75.856, nll_loss=6.242, bleu=0, ppl=75.7, wps=7780.5, ups=1.25, wpb=6221.9, bsz=512, num_updates=1150, lr=0.000392, gnorm=4.765, clip=0, loss_scale=128, train_wall=38, wall=1014 (progress_bar.py:262, log())
[2020-12-27 03:45:59]    INFO >> epoch 003:    216 / 492 loss=75.406, nll_loss=6.189, bleu=0, ppl=72.98, wps=8157.6, ups=1.31, wpb=6237.7, bsz=512, num_updates=1200, lr=0.000392, gnorm=4.644, clip=0, loss_scale=128, train_wall=36, wall=1052 (progress_bar.py:262, log())
[2020-12-27 03:46:38]    INFO >> epoch 003:    266 / 492 loss=75.051, nll_loss=6.169, bleu=0, ppl=71.95, wps=8057.1, ups=1.3, wpb=6208.5, bsz=510.3, num_updates=1250, lr=0.000392, gnorm=4.636, clip=0, loss_scale=128, train_wall=36, wall=1090 (progress_bar.py:262, log())
[2020-12-27 03:47:16]    INFO >> epoch 003:    316 / 492 loss=74.478, nll_loss=6.132, bleu=0, ppl=70.11, wps=8169, ups=1.31, wpb=6219.1, bsz=512, num_updates=1300, lr=0.000392, gnorm=4.684, clip=0, loss_scale=128, train_wall=36, wall=1129 (progress_bar.py:262, log())
[2020-12-27 03:47:54]    INFO >> epoch 003:    366 / 492 loss=74.518, nll_loss=6.093, bleu=0, ppl=68.25, wps=8209.2, ups=1.31, wpb=6262, bsz=512, num_updates=1350, lr=0.000392, gnorm=4.742, clip=0, loss_scale=128, train_wall=36, wall=1167 (progress_bar.py:262, log())
[2020-12-27 03:48:32]    INFO >> epoch 003:    416 / 492 loss=73.197, nll_loss=6.062, bleu=0, ppl=66.81, wps=8077.8, ups=1.31, wpb=6182.2, bsz=512, num_updates=1400, lr=0.000392, gnorm=4.541, clip=0, loss_scale=128, train_wall=36, wall=1205 (progress_bar.py:262, log())
[2020-12-27 03:49:11]    INFO >> epoch 003:    466 / 492 loss=73.447, nll_loss=6.051, bleu=0, ppl=66.28, wps=7961, ups=1.28, wpb=6215.1, bsz=512, num_updates=1450, lr=0.000392, gnorm=4.602, clip=0, loss_scale=128, train_wall=37, wall=1244 (progress_bar.py:262, log())
[2020-12-27 03:49:34]    INFO >> epoch 003 | loss 74.855 | nll_loss 6.163 | bleu 0 | ppl 71.65 | wps 7503.8 | ups 1.21 | wpb 6216.8 | bsz 511.8 | num_updates 1476 | lr 0.000392 | gnorm 4.681 | clip 0 | loss_scale 128 | train_wall 366 | wall 1267 (progress_bar.py:269, print())
[2020-12-27 03:49:50]    INFO >> epoch 003 | valid on 'valid' subset | loss 76.686 | nll_loss 6.143 | bleu 14.494552611048142 | ppl 70.67 | wps 11100.8 | wpb 24814 | bsz 1987.7 | num_updates 1476 | best_bleu 14.494552611048142 (progress_bar.py:269, print())
[2020-12-27 03:49:54]    INFO >> saved checkpoint /home/wanyao/.ncc/code_search_net_feng/sum_bin_ast/python/data-mmap/nary_tree2seq/checkpoints/checkpoint_best.pt (epoch 3 @ 1476 updates, score 14.494552611048142) (writing took 4.034909611567855 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2020-12-27 03:50:13]    INFO >> epoch 004:     24 / 492 loss=72.353, nll_loss=5.946, bleu=0, ppl=61.65, wps=5043.3, ups=0.81, wpb=6230.1, bsz=512, num_updates=1500, lr=0.00038416, gnorm=4.675, clip=0, loss_scale=128, train_wall=40, wall=1306 (progress_bar.py:262, log())
[2020-12-27 03:50:54]    INFO >> epoch 004:     74 / 492 loss=70.825, nll_loss=5.85, bleu=0, ppl=57.67, wps=7667.7, ups=1.24, wpb=6198.9, bsz=512, num_updates=1550, lr=0.00038416, gnorm=4.756, clip=0, loss_scale=128, train_wall=38, wall=1346 (progress_bar.py:262, log())
[2020-12-27 03:51:34]    INFO >> epoch 004:    124 / 492 loss=70.535, nll_loss=5.821, bleu=0, ppl=56.53, wps=7628, ups=1.23, wpb=6183.7, bsz=510.3, num_updates=1600, lr=0.00038416, gnorm=4.789, clip=0, loss_scale=128, train_wall=38, wall=1387 (progress_bar.py:262, log())
[2020-12-27 03:52:12]    INFO >> epoch 004:    174 / 492 loss=70.625, nll_loss=5.82, bleu=0, ppl=56.49, wps=8225.2, ups=1.32, wpb=6213.3, bsz=512, num_updates=1650, lr=0.00038416, gnorm=4.799, clip=0, loss_scale=128, train_wall=36, wall=1425 (progress_bar.py:262, log())
[2020-12-27 03:52:50]    INFO >> epoch 004:    224 / 492 loss=70.863, nll_loss=5.806, bleu=0, ppl=55.94, wps=8177.3, ups=1.31, wpb=6249.1, bsz=512, num_updates=1700, lr=0.00038416, gnorm=4.881, clip=0, loss_scale=128, train_wall=36, wall=1463 (progress_bar.py:262, log())
[2020-12-27 03:53:29]    INFO >> epoch 004:    274 / 492 loss=70.531, nll_loss=5.787, bleu=0, ppl=55.21, wps=8127.4, ups=1.3, wpb=6240.2, bsz=512, num_updates=1750, lr=0.00038416, gnorm=4.763, clip=0, loss_scale=128, train_wall=36, wall=1501 (progress_bar.py:262, log())
[2020-12-27 03:54:08]    INFO >> epoch 004:    324 / 492 loss=69.758, nll_loss=5.759, bleu=0, ppl=54.17, wps=7967.1, ups=1.28, wpb=6201.4, bsz=512, num_updates=1800, lr=0.00038416, gnorm=4.858, clip=0, loss_scale=128, train_wall=37, wall=1540 (progress_bar.py:262, log())
[2020-12-27 03:54:47]    INFO >> epoch 004:    374 / 492 loss=69.612, nll_loss=5.735, bleu=0, ppl=53.25, wps=7945.4, ups=1.28, wpb=6215, bsz=512, num_updates=1850, lr=0.00038416, gnorm=4.711, clip=0, loss_scale=128, train_wall=37, wall=1579 (progress_bar.py:262, log())
[2020-12-27 03:55:25]    INFO >> epoch 004:    424 / 492 loss=69.487, nll_loss=5.719, bleu=0, ppl=52.69, wps=8124.6, ups=1.31, wpb=6220.4, bsz=512, num_updates=1900, lr=0.00038416, gnorm=4.76, clip=0, loss_scale=128, train_wall=36, wall=1617 (progress_bar.py:262, log())
[2020-12-27 03:56:03]    INFO >> epoch 004:    474 / 492 loss=69.367, nll_loss=5.708, bleu=0, ppl=52.26, wps=8207.2, ups=1.32, wpb=6222.5, bsz=512, num_updates=1950, lr=0.00038416, gnorm=4.753, clip=0, loss_scale=128, train_wall=36, wall=1655 (progress_bar.py:262, log())
[2020-12-27 03:56:18]    INFO >> epoch 004 | loss 70.196 | nll_loss 5.779 | bleu 0 | ppl 54.92 | wps 7569.5 | ups 1.22 | wpb 6216.8 | bsz 511.8 | num_updates 1968 | lr 0.00038416 | gnorm 4.774 | clip 0 | loss_scale 128 | train_wall 363 | wall 1671 (progress_bar.py:269, print())
[2020-12-27 03:56:35]    INFO >> epoch 004 | valid on 'valid' subset | loss 74.268 | nll_loss 5.949 | bleu 14.86067997298981 | ppl 61.79 | wps 10047 | wpb 24814 | bsz 1987.7 | num_updates 1968 | best_bleu 14.86067997298981 (progress_bar.py:269, print())
[2020-12-27 03:56:39]    INFO >> saved checkpoint /home/wanyao/.ncc/code_search_net_feng/sum_bin_ast/python/data-mmap/nary_tree2seq/checkpoints/checkpoint_best.pt (epoch 4 @ 1968 updates, score 14.86067997298981) (writing took 4.065484882332385 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2020-12-27 03:57:06]    INFO >> epoch 005:     32 / 492 loss=67.931, nll_loss=5.581, bleu=0, ppl=47.88, wps=4956.5, ups=0.8, wpb=6231.5, bsz=512, num_updates=2000, lr=0.000376477, gnorm=4.747, clip=0, loss_scale=128, train_wall=40, wall=1718 (progress_bar.py:262, log())
[2020-12-27 03:57:46]    INFO >> epoch 005:     82 / 492 loss=67.209, nll_loss=5.522, bleu=0, ppl=45.94, wps=7816.5, ups=1.25, wpb=6232.1, bsz=512, num_updates=2050, lr=0.000376477, gnorm=5.011, clip=0, loss_scale=128, train_wall=38, wall=1758 (progress_bar.py:262, log())
[2020-12-27 03:58:25]    INFO >> epoch 005:    132 / 492 loss=66.96, nll_loss=5.516, bleu=0, ppl=45.76, wps=7903.4, ups=1.27, wpb=6215.1, bsz=512, num_updates=2100, lr=0.000376477, gnorm=5.003, clip=0, loss_scale=128, train_wall=37, wall=1797 (progress_bar.py:262, log())
[2020-12-27 03:59:04]    INFO >> epoch 005:    182 / 492 loss=67.038, nll_loss=5.517, bleu=0, ppl=45.78, wps=7907.2, ups=1.27, wpb=6221.6, bsz=512, num_updates=2150, lr=0.000376477, gnorm=4.948, clip=0, loss_scale=128, train_wall=37, wall=1837 (progress_bar.py:262, log())
[2020-12-27 03:59:43]    INFO >> epoch 005:    232 / 492 loss=66.884, nll_loss=5.493, bleu=0, ppl=45.04, wps=8082.8, ups=1.3, wpb=6213.8, bsz=510.3, num_updates=2200, lr=0.000376477, gnorm=4.975, clip=0, loss_scale=128, train_wall=36, wall=1875 (progress_bar.py:262, log())
[2020-12-27 04:00:21]    INFO >> epoch 005:    282 / 492 loss=66.591, nll_loss=5.482, bleu=0, ppl=44.7, wps=8047.2, ups=1.29, wpb=6219.3, bsz=512, num_updates=2250, lr=0.000376477, gnorm=4.915, clip=0, loss_scale=128, train_wall=36, wall=1914 (progress_bar.py:262, log())
[2020-12-27 04:00:59]    INFO >> epoch 005:    332 / 492 loss=66.416, nll_loss=5.477, bleu=0, ppl=44.55, wps=8165.8, ups=1.32, wpb=6208.2, bsz=512, num_updates=2300, lr=0.000376477, gnorm=4.984, clip=0, loss_scale=128, train_wall=36, wall=1952 (progress_bar.py:262, log())
[2020-12-27 04:01:38]    INFO >> epoch 005:    382 / 492 loss=66.115, nll_loss=5.454, bleu=0, ppl=43.84, wps=8032.4, ups=1.29, wpb=6206.2, bsz=512, num_updates=2350, lr=0.000376477, gnorm=5.183, clip=0, loss_scale=128, train_wall=36, wall=1990 (progress_bar.py:262, log())
[2020-12-27 04:02:16]    INFO >> epoch 005:    432 / 492 loss=66.028, nll_loss=5.473, bleu=0, ppl=44.41, wps=8164.7, ups=1.32, wpb=6177.1, bsz=512, num_updates=2400, lr=0.000376477, gnorm=5.027, clip=0, loss_scale=128, train_wall=36, wall=2028 (progress_bar.py:262, log())
[2020-12-27 04:02:55]    INFO >> epoch 005:    482 / 492 loss=66.316, nll_loss=5.445, bleu=0, ppl=43.56, wps=7901, ups=1.27, wpb=6235.8, bsz=512, num_updates=2450, lr=0.000376477, gnorm=5.018, clip=0, loss_scale=128, train_wall=37, wall=2068 (progress_bar.py:262, log())
[2020-12-27 04:03:04]    INFO >> epoch 005 | loss 66.646 | nll_loss 5.487 | bleu 0 | ppl 44.85 | wps 7541.2 | ups 1.21 | wpb 6216.8 | bsz 511.8 | num_updates 2460 | lr 0.000376477 | gnorm 4.99 | clip 0 | loss_scale 128 | train_wall 363 | wall 2077 (progress_bar.py:269, print())
[2020-12-27 04:03:21]    INFO >> epoch 005 | valid on 'valid' subset | loss 72.81 | nll_loss 5.832 | bleu 15.082301771080008 | ppl 56.98 | wps 9721.9 | wpb 24814 | bsz 1987.7 | num_updates 2460 | best_bleu 15.082301771080008 (progress_bar.py:269, print())
[2020-12-27 04:03:25]    INFO >> saved checkpoint /home/wanyao/.ncc/code_search_net_feng/sum_bin_ast/python/data-mmap/nary_tree2seq/checkpoints/checkpoint_best.pt (epoch 5 @ 2460 updates, score 15.082301771080008) (writing took 4.07571401912719 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2020-12-27 04:03:57]    INFO >> epoch 006:     40 / 492 loss=64.181, nll_loss=5.285, bleu=0, ppl=38.98, wps=5022.6, ups=0.81, wpb=6218.2, bsz=512, num_updates=2500, lr=0.000368947, gnorm=5.06, clip=0, loss_scale=128, train_wall=38, wall=2130 (progress_bar.py:262, log())
[2020-12-27 04:04:35]    INFO >> epoch 006:     90 / 492 loss=63.625, nll_loss=5.249, bleu=0, ppl=38.03, wps=8094.9, ups=1.3, wpb=6206, bsz=512, num_updates=2550, lr=0.000368947, gnorm=5.078, clip=0, loss_scale=128, train_wall=36, wall=2168 (progress_bar.py:262, log())
[2020-12-27 04:05:14]    INFO >> epoch 006:    140 / 492 loss=64.349, nll_loss=5.272, bleu=0, ppl=38.64, wps=8009.1, ups=1.28, wpb=6249.3, bsz=512, num_updates=2600, lr=0.000368947, gnorm=5.21, clip=0, loss_scale=128, train_wall=37, wall=2207 (progress_bar.py:262, log())
[2020-12-27 04:05:53]    INFO >> epoch 006:    190 / 492 loss=63.77, nll_loss=5.259, bleu=0, ppl=38.3, wps=7964.4, ups=1.29, wpb=6187.8, bsz=510.3, num_updates=2650, lr=0.000368947, gnorm=5.224, clip=0, loss_scale=128, train_wall=37, wall=2246 (progress_bar.py:262, log())
[2020-12-27 04:06:33]    INFO >> epoch 006:    240 / 492 loss=63.903, nll_loss=5.254, bleu=0, ppl=38.17, wps=7891.5, ups=1.27, wpb=6227, bsz=512, num_updates=2700, lr=0.000368947, gnorm=5.326, clip=0, loss_scale=128, train_wall=37, wall=2285 (progress_bar.py:262, log())
[2020-12-27 04:07:11]    INFO >> epoch 006:    290 / 492 loss=63.661, nll_loss=5.253, bleu=0, ppl=38.13, wps=8203.9, ups=1.32, wpb=6205, bsz=512, num_updates=2750, lr=0.000368947, gnorm=5.283, clip=0, loss_scale=128, train_wall=36, wall=2323 (progress_bar.py:262, log())
[2020-12-27 04:07:50]    INFO >> epoch 006:    340 / 492 loss=63.417, nll_loss=5.247, bleu=0, ppl=37.97, wps=7899.6, ups=1.28, wpb=6188.6, bsz=512, num_updates=2800, lr=0.000368947, gnorm=5.354, clip=0, loss_scale=128, train_wall=37, wall=2362 (progress_bar.py:262, log())
[2020-12-27 04:08:30]    INFO >> epoch 006:    390 / 492 loss=63.715, nll_loss=5.247, bleu=0, ppl=37.96, wps=7760.9, ups=1.25, wpb=6217.8, bsz=512, num_updates=2850, lr=0.000368947, gnorm=5.221, clip=0, loss_scale=128, train_wall=38, wall=2402 (progress_bar.py:262, log())
[2020-12-27 04:09:11]    INFO >> epoch 006:    440 / 492 loss=63.663, nll_loss=5.223, bleu=0, ppl=37.36, wps=7490.2, ups=1.2, wpb=6240.4, bsz=512, num_updates=2900, lr=0.000368947, gnorm=5.274, clip=0, loss_scale=128, train_wall=39, wall=2444 (progress_bar.py:262, log())
[2020-12-27 04:09:51]    INFO >> epoch 006:    490 / 492 loss=63.473, nll_loss=5.216, bleu=0, ppl=37.16, wps=7935.6, ups=1.27, wpb=6231.1, bsz=512, num_updates=2950, lr=0.000368947, gnorm=5.205, clip=0, loss_scale=128, train_wall=37, wall=2483 (progress_bar.py:262, log())
[2020-12-27 04:09:52]    INFO >> epoch 006 | loss 63.726 | nll_loss 5.247 | bleu 0 | ppl 37.96 | wps 7491.9 | ups 1.21 | wpb 6216.8 | bsz 511.8 | num_updates 2952 | lr 0.000368947 | gnorm 5.23 | clip 0 | loss_scale 128 | train_wall 365 | wall 2485 (progress_bar.py:269, print())
[2020-12-27 04:10:10]    INFO >> epoch 006 | valid on 'valid' subset | loss 71.96 | nll_loss 5.764 | bleu 15.135874824405011 | ppl 54.35 | wps 9319.3 | wpb 24814 | bsz 1987.7 | num_updates 2952 | best_bleu 15.135874824405011 (progress_bar.py:269, print())
[2020-12-27 04:10:14]    INFO >> saved checkpoint /home/wanyao/.ncc/code_search_net_feng/sum_bin_ast/python/data-mmap/nary_tree2seq/checkpoints/checkpoint_best.pt (epoch 6 @ 2952 updates, score 15.135874824405011) (writing took 4.05941822566092 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2020-12-27 04:10:51]    INFO >> epoch 007:     48 / 492 loss=61.043, nll_loss=5.031, bleu=0, ppl=32.68, wps=5123.7, ups=0.82, wpb=6212.9, bsz=512, num_updates=3000, lr=0.000361568, gnorm=5.41, clip=0, loss_scale=128, train_wall=36, wall=2544 (progress_bar.py:262, log())
[2020-12-27 04:11:30]    INFO >> epoch 007:     98 / 492 loss=60.924, nll_loss=5.031, bleu=0, ppl=32.69, wps=7990.1, ups=1.29, wpb=6200.6, bsz=512, num_updates=3050, lr=0.000361568, gnorm=5.415, clip=0, loss_scale=128, train_wall=37, wall=2583 (progress_bar.py:262, log())
[2020-12-27 04:12:08]    INFO >> epoch 007:    148 / 492 loss=61.36, nll_loss=5.044, bleu=0, ppl=32.99, wps=8164.9, ups=1.31, wpb=6228.4, bsz=512, num_updates=3100, lr=0.000361568, gnorm=5.438, clip=0, loss_scale=128, train_wall=36, wall=2621 (progress_bar.py:262, log())
[2020-12-27 04:12:48]    INFO >> epoch 007:    198 / 492 loss=61.277, nll_loss=5.047, bleu=0, ppl=33.05, wps=7837.9, ups=1.26, wpb=6216.9, bsz=512, num_updates=3150, lr=0.000361568, gnorm=5.515, clip=0, loss_scale=128, train_wall=38, wall=2661 (progress_bar.py:262, log())
[2020-12-27 04:13:26]    INFO >> epoch 007:    248 / 492 loss=61.904, nll_loss=5.075, bleu=0, ppl=33.71, wps=8136.2, ups=1.3, wpb=6245.3, bsz=512, num_updates=3200, lr=0.000361568, gnorm=5.491, clip=0, loss_scale=128, train_wall=36, wall=2699 (progress_bar.py:262, log())
[2020-12-27 04:14:05]    INFO >> epoch 007:    298 / 492 loss=61.092, nll_loss=5.048, bleu=0, ppl=33.09, wps=7925.7, ups=1.28, wpb=6196.1, bsz=512, num_updates=3250, lr=0.000361568, gnorm=5.47, clip=0, loss_scale=128, train_wall=37, wall=2738 (progress_bar.py:262, log())
[2020-12-27 04:14:46]    INFO >> epoch 007:    348 / 492 loss=61.252, nll_loss=5.041, bleu=0, ppl=32.93, wps=7587, ups=1.22, wpb=6200.4, bsz=510.3, num_updates=3300, lr=0.000361568, gnorm=5.396, clip=0, loss_scale=128, train_wall=39, wall=2779 (progress_bar.py:262, log())
[2020-12-27 04:15:25]    INFO >> epoch 007:    398 / 492 loss=61.554, nll_loss=5.05, bleu=0, ppl=33.13, wps=8012.5, ups=1.28, wpb=6240.8, bsz=512, num_updates=3350, lr=0.000361568, gnorm=5.415, clip=0, loss_scale=128, train_wall=37, wall=2818 (progress_bar.py:262, log())
[2020-12-27 04:16:04]    INFO >> epoch 007:    448 / 492 loss=61.05, nll_loss=5.027, bleu=0, ppl=32.6, wps=8034.7, ups=1.29, wpb=6218.2, bsz=512, num_updates=3400, lr=0.000361568, gnorm=5.43, clip=0, loss_scale=128, train_wall=37, wall=2856 (progress_bar.py:262, log())
[2020-12-27 04:16:38]    INFO >> epoch 007 | loss 61.237 | nll_loss 5.042 | bleu 0 | ppl 32.94 | wps 7533.9 | ups 1.21 | wpb 6216.8 | bsz 511.8 | num_updates 3444 | lr 0.000361568 | gnorm 5.445 | clip 0 | loss_scale 128 | train_wall 363 | wall 2891 (progress_bar.py:269, print())
[2020-12-27 04:16:59]    INFO >> epoch 007 | valid on 'valid' subset | loss 71.404 | nll_loss 5.72 | bleu 15.141938062902689 | ppl 52.7 | wps 7827.5 | wpb 24814 | bsz 1987.7 | num_updates 3444 | best_bleu 15.141938062902689 (progress_bar.py:269, print())
[2020-12-27 04:17:03]    INFO >> saved checkpoint /home/wanyao/.ncc/code_search_net_feng/sum_bin_ast/python/data-mmap/nary_tree2seq/checkpoints/checkpoint_best.pt (epoch 7 @ 3444 updates, score 15.141938062902689) (writing took 4.1082321386784315 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2020-12-27 04:17:07]    INFO >> epoch 008:      6 / 492 loss=60.69, nll_loss=5, bleu=0, ppl=32.01, wps=4891, ups=0.79, wpb=6214.1, bsz=512, num_updates=3450, lr=0.000354337, gnorm=5.449, clip=0, loss_scale=128, train_wall=36, wall=2920 (progress_bar.py:262, log())
[2020-12-27 04:17:46]    INFO >> epoch 008:     56 / 492 loss=58.791, nll_loss=4.849, bleu=0, ppl=28.83, wps=8102.4, ups=1.31, wpb=6207.3, bsz=512, num_updates=3500, lr=0.000354337, gnorm=5.46, clip=0, loss_scale=128, train_wall=36, wall=2958 (progress_bar.py:262, log())
[2020-12-27 04:18:23]    INFO >> epoch 008:    106 / 492 loss=59.305, nll_loss=4.867, bleu=0, ppl=29.19, wps=8247.1, ups=1.33, wpb=6218, bsz=510.3, num_updates=3550, lr=0.000354337, gnorm=5.744, clip=0, loss_scale=128, train_wall=36, wall=2996 (progress_bar.py:262, log())
[2020-12-27 04:19:03]    INFO >> epoch 008:    156 / 492 loss=59.085, nll_loss=4.86, bleu=0, ppl=29.04, wps=7785.2, ups=1.25, wpb=6224.5, bsz=512, num_updates=3600, lr=0.000354337, gnorm=5.703, clip=0, loss_scale=128, train_wall=38, wall=3036 (progress_bar.py:262, log())
[2020-12-27 04:19:42]    INFO >> epoch 008:    206 / 492 loss=58.723, nll_loss=4.839, bleu=0, ppl=28.62, wps=8107.8, ups=1.3, wpb=6213.3, bsz=512, num_updates=3650, lr=0.000354337, gnorm=5.694, clip=0, loss_scale=128, train_wall=36, wall=3074 (progress_bar.py:262, log())
[2020-12-27 04:20:20]    INFO >> epoch 008:    256 / 492 loss=58.989, nll_loss=4.863, bleu=0, ppl=29.11, wps=8073.1, ups=1.3, wpb=6210.1, bsz=512, num_updates=3700, lr=0.000354337, gnorm=5.716, clip=0, loss_scale=128, train_wall=36, wall=3113 (progress_bar.py:262, log())
[2020-12-27 04:21:00]    INFO >> epoch 008:    306 / 492 loss=59.334, nll_loss=4.867, bleu=0, ppl=29.17, wps=7804.5, ups=1.25, wpb=6242.5, bsz=512, num_updates=3750, lr=0.000354337, gnorm=5.712, clip=0, loss_scale=128, train_wall=38, wall=3153 (progress_bar.py:262, log())
[2020-12-27 04:21:39]    INFO >> epoch 008:    356 / 492 loss=58.548, nll_loss=4.846, bleu=0, ppl=28.76, wps=7974.6, ups=1.29, wpb=6185.7, bsz=512, num_updates=3800, lr=0.000354337, gnorm=5.664, clip=0, loss_scale=128, train_wall=37, wall=3192 (progress_bar.py:262, log())
[2020-12-27 04:22:18]    INFO >> epoch 008:    406 / 492 loss=58.626, nll_loss=4.854, bleu=0, ppl=28.92, wps=8032, ups=1.3, wpb=6184.2, bsz=512, num_updates=3850, lr=0.000354337, gnorm=5.663, clip=0, loss_scale=128, train_wall=36, wall=3230 (progress_bar.py:262, log())
[2020-12-27 04:22:58]    INFO >> epoch 008:    456 / 492 loss=59.628, nll_loss=4.873, bleu=0, ppl=29.31, wps=7764.3, ups=1.24, wpb=6264.9, bsz=512, num_updates=3900, lr=0.000354337, gnorm=5.784, clip=0, loss_scale=128, train_wall=38, wall=3270 (progress_bar.py:262, log())
[2020-12-27 04:23:26]    INFO >> epoch 008 | loss 59.02 | nll_loss 4.859 | bleu 0 | ppl 29.02 | wps 7508.4 | ups 1.21 | wpb 6216.8 | bsz 511.8 | num_updates 3936 | lr 0.000354337 | gnorm 5.682 | clip 0 | loss_scale 128 | train_wall 361 | wall 3298 (progress_bar.py:269, print())
[2020-12-27 04:23:47]    INFO >> epoch 008 | valid on 'valid' subset | loss 71.07 | nll_loss 5.693 | bleu 15.133895760387446 | ppl 51.73 | wps 7846.1 | wpb 24814 | bsz 1987.7 | num_updates 3936 | best_bleu 15.141938062902689 (progress_bar.py:269, print())
[2020-12-27 04:23:49]    INFO >> saved checkpoint /home/wanyao/.ncc/code_search_net_feng/sum_bin_ast/python/data-mmap/nary_tree2seq/checkpoints/checkpoint_last.pt (epoch 8 @ 3936 updates, score 15.133895760387446) (writing took 2.619795735925436 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2020-12-27 04:23:59]    INFO >> epoch 009:     14 / 492 loss=58.586, nll_loss=4.823, bleu=0, ppl=28.31, wps=5093.7, ups=0.82, wpb=6218.8, bsz=512, num_updates=3950, lr=0.00034725, gnorm=5.726, clip=0, loss_scale=128, train_wall=35, wall=3331 (progress_bar.py:262, log())
[2020-12-27 04:24:37]    INFO >> epoch 009:     64 / 492 loss=56.772, nll_loss=4.671, bleu=0, ppl=25.48, wps=8175.3, ups=1.31, wpb=6222.6, bsz=512, num_updates=4000, lr=0.00034725, gnorm=5.818, clip=0, loss_scale=128, train_wall=36, wall=3369 (progress_bar.py:262, log())
[2020-12-27 04:25:16]    INFO >> epoch 009:    114 / 492 loss=57.064, nll_loss=4.681, bleu=0, ppl=25.66, wps=8003.6, ups=1.28, wpb=6241, bsz=512, num_updates=4050, lr=0.00034725, gnorm=5.939, clip=0, loss_scale=128, train_wall=37, wall=3408 (progress_bar.py:262, log())
[2020-12-27 04:25:54]    INFO >> epoch 009:    164 / 492 loss=56.714, nll_loss=4.686, bleu=0, ppl=25.74, wps=8093, ups=1.31, wpb=6196.8, bsz=512, num_updates=4100, lr=0.00034725, gnorm=6.006, clip=0, loss_scale=140.8, train_wall=36, wall=3447 (progress_bar.py:262, log())
[2020-12-27 04:26:35]    INFO >> epoch 009:    214 / 492 loss=57.59, nll_loss=4.734, bleu=0, ppl=26.61, wps=7561.9, ups=1.21, wpb=6228.4, bsz=512, num_updates=4150, lr=0.00034725, gnorm=6.154, clip=0, loss_scale=256, train_wall=39, wall=3488 (progress_bar.py:262, log())
[2020-12-27 04:27:15]    INFO >> epoch 009:    264 / 492 loss=57.705, nll_loss=4.755, bleu=0, ppl=27.01, wps=7819.4, ups=1.26, wpb=6192.7, bsz=510.3, num_updates=4200, lr=0.00034725, gnorm=6.079, clip=0, loss_scale=256, train_wall=37, wall=3528 (progress_bar.py:262, log())
[2020-12-27 04:27:53]    INFO >> epoch 009:    314 / 492 loss=58.21, nll_loss=4.788, bleu=0, ppl=27.63, wps=8145.2, ups=1.31, wpb=6224.4, bsz=512, num_updates=4250, lr=0.00034725, gnorm=5.953, clip=0, loss_scale=256, train_wall=36, wall=3566 (progress_bar.py:262, log())
[2020-12-27 04:28:32]    INFO >> epoch 009:    364 / 492 loss=57.535, nll_loss=4.765, bleu=0, ppl=27.2, wps=7951, ups=1.29, wpb=6181.8, bsz=512, num_updates=4300, lr=0.00034725, gnorm=5.953, clip=0, loss_scale=256, train_wall=37, wall=3605 (progress_bar.py:262, log())
[2020-12-27 04:29:13]    INFO >> epoch 009:    414 / 492 loss=58.092, nll_loss=4.77, bleu=0, ppl=27.28, wps=7542, ups=1.21, wpb=6235.8, bsz=512, num_updates=4350, lr=0.00034725, gnorm=5.961, clip=0, loss_scale=256, train_wall=39, wall=3646 (progress_bar.py:262, log())
[2020-12-27 04:29:52]    INFO >> epoch 009:    464 / 492 loss=57.857, nll_loss=4.767, bleu=0, ppl=27.23, wps=7965.9, ups=1.28, wpb=6213.8, bsz=512, num_updates=4400, lr=0.00034725, gnorm=5.883, clip=0, loss_scale=256, train_wall=37, wall=3685 (progress_bar.py:262, log())
[2020-12-27 04:30:12]    INFO >> epoch 009 | loss 57.527 | nll_loss 4.736 | bleu 0 | ppl 26.65 | wps 7519.2 | ups 1.21 | wpb 6216.8 | bsz 511.8 | num_updates 4428 | lr 0.00034725 | gnorm 5.965 | clip 0 | loss_scale 214.634 | train_wall 362 | wall 3705 (progress_bar.py:269, print())
[2020-12-27 04:30:34]    INFO >> epoch 009 | valid on 'valid' subset | loss 70.983 | nll_loss 5.686 | bleu 15.080216408598817 | ppl 51.48 | wps 7680.2 | wpb 24814 | bsz 1987.7 | num_updates 4428 | best_bleu 15.141938062902689 (progress_bar.py:269, print())
[2020-12-27 04:30:36]    INFO >> saved checkpoint /home/wanyao/.ncc/code_search_net_feng/sum_bin_ast/python/data-mmap/nary_tree2seq/checkpoints/checkpoint_last.pt (epoch 9 @ 4428 updates, score 15.080216408598817) (writing took 2.5916292751207948 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2020-12-27 04:30:52]    INFO >> epoch 010:     22 / 492 loss=56.886, nll_loss=4.68, bleu=0, ppl=25.63, wps=5217.9, ups=0.84, wpb=6224.1, bsz=512, num_updates=4450, lr=0.000340305, gnorm=5.967, clip=0, loss_scale=256, train_wall=34, wall=3745 (progress_bar.py:262, log())
[2020-12-27 04:31:31]    INFO >> epoch 010:     72 / 492 loss=55.197, nll_loss=4.53, bleu=0, ppl=23.11, wps=7962.4, ups=1.28, wpb=6238, bsz=512, num_updates=4500, lr=0.000340305, gnorm=5.999, clip=0, loss_scale=256, train_wall=37, wall=3784 (progress_bar.py:262, log())
[2020-12-27 04:32:10]    INFO >> epoch 010:    122 / 492 loss=54.62, nll_loss=4.52, bleu=0, ppl=22.95, wps=7939, ups=1.28, wpb=6186.4, bsz=512, num_updates=4550, lr=0.000340305, gnorm=6.044, clip=0, loss_scale=256, train_wall=37, wall=3823 (progress_bar.py:262, log())
[2020-12-27 04:32:49]    INFO >> epoch 010:    172 / 492 loss=55.129, nll_loss=4.538, bleu=0, ppl=23.22, wps=8069.5, ups=1.3, wpb=6220.6, bsz=512, num_updates=4600, lr=0.000340305, gnorm=6.128, clip=0, loss_scale=256, train_wall=36, wall=3861 (progress_bar.py:262, log())
[2020-12-27 04:33:29]    INFO >> epoch 010:    222 / 492 loss=55.185, nll_loss=4.543, bleu=0, ppl=23.31, wps=7734.5, ups=1.24, wpb=6219.1, bsz=512, num_updates=4650, lr=0.000340305, gnorm=6.047, clip=0, loss_scale=256, train_wall=38, wall=3902 (progress_bar.py:262, log())
[2020-12-27 04:34:08]    INFO >> epoch 010:    272 / 492 loss=55.551, nll_loss=4.553, bleu=0, ppl=23.48, wps=8035.8, ups=1.29, wpb=6246.3, bsz=512, num_updates=4700, lr=0.000340305, gnorm=6.11, clip=0, loss_scale=256, train_wall=37, wall=3940 (progress_bar.py:262, log())
[2020-12-27 04:34:47]    INFO >> epoch 010:    322 / 492 loss=55.243, nll_loss=4.56, bleu=0, ppl=23.58, wps=8002.8, ups=1.29, wpb=6203, bsz=512, num_updates=4750, lr=0.000340305, gnorm=6.175, clip=0, loss_scale=256, train_wall=37, wall=3979 (progress_bar.py:262, log())
[2020-12-27 04:35:27]    INFO >> epoch 010:    372 / 492 loss=54.927, nll_loss=4.547, bleu=0, ppl=23.38, wps=7705.9, ups=1.25, wpb=6184.8, bsz=512, num_updates=4800, lr=0.000340305, gnorm=6.099, clip=0, loss_scale=256, train_wall=38, wall=4019 (progress_bar.py:262, log())
[2020-12-27 04:36:07]    INFO >> epoch 010:    422 / 492 loss=55.254, nll_loss=4.542, bleu=0, ppl=23.3, wps=7824, ups=1.26, wpb=6228.5, bsz=512, num_updates=4850, lr=0.000340305, gnorm=6.087, clip=0, loss_scale=256, train_wall=38, wall=4059 (progress_bar.py:262, log())
[2020-12-27 04:36:44]    INFO >> epoch 010:    472 / 492 loss=55.937, nll_loss=4.577, bleu=0, ppl=23.87, wps=8360.2, ups=1.34, wpb=6237, bsz=510.3, num_updates=4900, lr=0.000340305, gnorm=6.14, clip=0, loss_scale=256, train_wall=35, wall=4096 (progress_bar.py:262, log())
[2020-12-27 04:36:58]    INFO >> epoch 010 | loss 55.226 | nll_loss 4.547 | bleu 0 | ppl 23.37 | wps 7536.9 | ups 1.21 | wpb 6216.8 | bsz 511.8 | num_updates 4920 | lr 0.000340305 | gnorm 6.083 | clip 0 | loss_scale 256 | train_wall 361 | wall 4111 (progress_bar.py:269, print())
[2020-12-27 04:37:16]    INFO >> epoch 010 | valid on 'valid' subset | loss 70.861 | nll_loss 5.676 | bleu 15.24070769972488 | ppl 51.14 | wps 9483 | wpb 24814 | bsz 1987.7 | num_updates 4920 | best_bleu 15.24070769972488 (progress_bar.py:269, print())
[2020-12-27 04:37:20]    INFO >> saved checkpoint /home/wanyao/.ncc/code_search_net_feng/sum_bin_ast/python/data-mmap/nary_tree2seq/checkpoints/checkpoint_best.pt (epoch 10 @ 4920 updates, score 15.24070769972488) (writing took 4.092368858866394 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2020-12-27 04:37:42]    INFO >> epoch 011:     30 / 492 loss=54.093, nll_loss=4.433, bleu=0, ppl=21.59, wps=5356.2, ups=0.86, wpb=6248.2, bsz=512, num_updates=4950, lr=0.000333499, gnorm=6.078, clip=0, loss_scale=256, train_wall=34, wall=4155 (progress_bar.py:262, log())
[2020-12-27 04:38:21]    INFO >> epoch 011:     80 / 492 loss=52.446, nll_loss=4.326, bleu=0, ppl=20.06, wps=7924.7, ups=1.28, wpb=6207.3, bsz=512, num_updates=5000, lr=0.000333499, gnorm=6.17, clip=0, loss_scale=256, train_wall=37, wall=4194 (progress_bar.py:262, log())
[2020-12-27 04:39:00]    INFO >> epoch 011:    130 / 492 loss=52.647, nll_loss=4.334, bleu=0, ppl=20.17, wps=8084.6, ups=1.3, wpb=6219, bsz=512, num_updates=5050, lr=0.000333499, gnorm=6.269, clip=0, loss_scale=256, train_wall=36, wall=4232 (progress_bar.py:262, log())
[2020-12-27 04:39:37]    INFO >> epoch 011:    180 / 492 loss=52.988, nll_loss=4.358, bleu=0, ppl=20.51, wps=8384.2, ups=1.35, wpb=6224.6, bsz=512, num_updates=5100, lr=0.000333499, gnorm=6.384, clip=0, loss_scale=256, train_wall=35, wall=4269 (progress_bar.py:262, log())
[2020-12-27 04:40:15]    INFO >> epoch 011:    230 / 492 loss=53.137, nll_loss=4.373, bleu=0, ppl=20.72, wps=8094.1, ups=1.3, wpb=6221.8, bsz=512, num_updates=5150, lr=0.000333499, gnorm=6.346, clip=0, loss_scale=256, train_wall=36, wall=4308 (progress_bar.py:262, log())
[2020-12-27 04:40:55]    INFO >> epoch 011:    280 / 492 loss=53.294, nll_loss=4.373, bleu=0, ppl=20.72, wps=7871.4, ups=1.27, wpb=6219.7, bsz=510.3, num_updates=5200, lr=0.000333499, gnorm=6.424, clip=0, loss_scale=256, train_wall=37, wall=4347 (progress_bar.py:262, log())
[2020-12-27 04:41:34]    INFO >> epoch 011:    330 / 492 loss=53.038, nll_loss=4.375, bleu=0, ppl=20.75, wps=7931.8, ups=1.28, wpb=6207.2, bsz=512, num_updates=5250, lr=0.000333499, gnorm=6.336, clip=0, loss_scale=256, train_wall=37, wall=4387 (progress_bar.py:262, log())
[2020-12-27 04:42:14]    INFO >> epoch 011:    380 / 492 loss=53.181, nll_loss=4.381, bleu=0, ppl=20.84, wps=7837.3, ups=1.26, wpb=6214.5, bsz=512, num_updates=5300, lr=0.000333499, gnorm=6.384, clip=0, loss_scale=256, train_wall=37, wall=4426 (progress_bar.py:262, log())
[2020-12-27 04:42:51]    INFO >> epoch 011:    430 / 492 loss=52.715, nll_loss=4.358, bleu=0, ppl=20.51, wps=8187.2, ups=1.32, wpb=6193, bsz=512, num_updates=5350, lr=0.000333499, gnorm=6.344, clip=0, loss_scale=256, train_wall=36, wall=4464 (progress_bar.py:262, log())
[2020-12-27 04:43:31]    INFO >> epoch 011:    480 / 492 loss=53.308, nll_loss=4.395, bleu=0, ppl=21.04, wps=7928.9, ups=1.28, wpb=6210, bsz=512, num_updates=5400, lr=0.000333499, gnorm=6.321, clip=0, loss_scale=256, train_wall=37, wall=4503 (progress_bar.py:262, log())
[2020-12-27 04:43:40]    INFO >> epoch 011 | loss 52.997 | nll_loss 4.363 | bleu 0 | ppl 20.58 | wps 7608.1 | ups 1.22 | wpb 6216.8 | bsz 511.8 | num_updates 5412 | lr 0.000333499 | gnorm 6.316 | clip 0 | loss_scale 256 | train_wall 359 | wall 4513 (progress_bar.py:269, print())
[2020-12-27 04:43:56]    INFO >> epoch 011 | valid on 'valid' subset | loss 71.035 | nll_loss 5.69 | bleu 15.146365491568709 | ppl 51.63 | wps 10914.5 | wpb 24814 | bsz 1987.7 | num_updates 5412 | best_bleu 15.24070769972488 (progress_bar.py:269, print())
[2020-12-27 04:43:59]    INFO >> saved checkpoint /home/wanyao/.ncc/code_search_net_feng/sum_bin_ast/python/data-mmap/nary_tree2seq/checkpoints/checkpoint_last.pt (epoch 11 @ 5412 updates, score 15.146365491568709) (writing took 2.6297881361097097 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2020-12-27 04:44:29]    INFO >> epoch 012:     38 / 492 loss=51.159, nll_loss=4.215, bleu=0, ppl=18.57, wps=5362.2, ups=0.86, wpb=6214.1, bsz=512, num_updates=5450, lr=0.000326829, gnorm=6.284, clip=0, loss_scale=256, train_wall=37, wall=4561 (progress_bar.py:262, log())
[2020-12-27 04:45:09]    INFO >> epoch 012:     88 / 492 loss=50.933, nll_loss=4.182, bleu=0, ppl=18.15, wps=7742.6, ups=1.24, wpb=6235.3, bsz=512, num_updates=5500, lr=0.000326829, gnorm=6.451, clip=0, loss_scale=256, train_wall=38, wall=4601 (progress_bar.py:262, log())
[2020-12-27 04:45:47]    INFO >> epoch 012:    138 / 492 loss=51.31, nll_loss=4.213, bleu=0, ppl=18.55, wps=8141.6, ups=1.31, wpb=6234.9, bsz=512, num_updates=5550, lr=0.000326829, gnorm=6.533, clip=0, loss_scale=256, train_wall=36, wall=4640 (progress_bar.py:262, log())
[2020-12-27 04:46:26]    INFO >> epoch 012:    188 / 492 loss=51.145, nll_loss=4.204, bleu=0, ppl=18.43, wps=7963, ups=1.28, wpb=6229.2, bsz=512, num_updates=5600, lr=0.000326829, gnorm=6.584, clip=0, loss_scale=256, train_wall=37, wall=4679 (progress_bar.py:262, log())
[2020-12-27 04:47:05]    INFO >> epoch 012:    238 / 492 loss=50.969, nll_loss=4.217, bleu=0, ppl=18.6, wps=8054.3, ups=1.3, wpb=6188.1, bsz=512, num_updates=5650, lr=0.000326829, gnorm=6.559, clip=0, loss_scale=256, train_wall=36, wall=4717 (progress_bar.py:262, log())
[2020-12-27 04:47:43]    INFO >> epoch 012:    288 / 492 loss=51.213, nll_loss=4.222, bleu=0, ppl=18.66, wps=8054.4, ups=1.3, wpb=6189.8, bsz=510.3, num_updates=5700, lr=0.000326829, gnorm=6.616, clip=0, loss_scale=256, train_wall=36, wall=4756 (progress_bar.py:262, log())
[2020-12-27 04:48:22]    INFO >> epoch 012:    338 / 492 loss=51.667, nll_loss=4.251, bleu=0, ppl=19.04, wps=8045.7, ups=1.29, wpb=6223.1, bsz=512, num_updates=5750, lr=0.000326829, gnorm=6.649, clip=0, loss_scale=256, train_wall=36, wall=4794 (progress_bar.py:262, log())
[2020-12-27 04:49:00]    INFO >> epoch 012:    388 / 492 loss=51.66, nll_loss=4.242, bleu=0, ppl=18.93, wps=8118.6, ups=1.3, wpb=6234.6, bsz=512, num_updates=5800, lr=0.000326829, gnorm=6.643, clip=0, loss_scale=256, train_wall=36, wall=4833 (progress_bar.py:262, log())
[2020-12-27 04:49:38]    INFO >> epoch 012:    438 / 492 loss=51.448, nll_loss=4.242, bleu=0, ppl=18.92, wps=8115.3, ups=1.31, wpb=6210, bsz=512, num_updates=5850, lr=0.000326829, gnorm=6.706, clip=0, loss_scale=256, train_wall=36, wall=4871 (progress_bar.py:262, log())
[2020-12-27 04:50:17]    INFO >> epoch 012:    488 / 492 loss=51.312, nll_loss=4.239, bleu=0, ppl=18.88, wps=7957.8, ups=1.28, wpb=6197.9, bsz=512, num_updates=5900, lr=0.000326829, gnorm=6.675, clip=0, loss_scale=256, train_wall=37, wall=4910 (progress_bar.py:262, log())
[2020-12-27 04:50:21]    INFO >> epoch 012 | loss 51.24 | nll_loss 4.219 | bleu 0 | ppl 18.62 | wps 7633.1 | ups 1.23 | wpb 6216.8 | bsz 511.8 | num_updates 5904 | lr 0.000326829 | gnorm 6.577 | clip 0 | loss_scale 256 | train_wall 361 | wall 4914 (progress_bar.py:269, print())
[2020-12-27 04:50:42]    INFO >> epoch 012 | valid on 'valid' subset | loss 71.361 | nll_loss 5.716 | bleu 15.333145882068267 | ppl 52.58 | wps 7809.7 | wpb 24814 | bsz 1987.7 | num_updates 5904 | best_bleu 15.333145882068267 (progress_bar.py:269, print())
[2020-12-27 04:50:46]    INFO >> saved checkpoint /home/wanyao/.ncc/code_search_net_feng/sum_bin_ast/python/data-mmap/nary_tree2seq/checkpoints/checkpoint_best.pt (epoch 12 @ 5904 updates, score 15.333145882068267) (writing took 4.1331819063052535 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2020-12-27 04:51:22]    INFO >> epoch 013:     46 / 492 loss=49.475, nll_loss=4.061, bleu=0, ppl=16.69, wps=4791.7, ups=0.77, wpb=6217.7, bsz=510.3, num_updates=5950, lr=0.000320293, gnorm=6.556, clip=0, loss_scale=256, train_wall=38, wall=4975 (progress_bar.py:262, log())
[2020-12-27 04:52:01]    INFO >> epoch 013:     96 / 492 loss=49.029, nll_loss=4.047, bleu=0, ppl=16.53, wps=8074.9, ups=1.3, wpb=6202.8, bsz=512, num_updates=6000, lr=0.000320293, gnorm=6.686, clip=0, loss_scale=256, train_wall=36, wall=5013 (progress_bar.py:262, log())
[2020-12-27 04:52:02]    INFO >> NOTE: overflow detected, setting loss scale to: 128.0 (ncc_trainer.py:458, train_step())
[2020-12-27 04:52:41]    INFO >> epoch 013:    147 / 492 loss=49.146, nll_loss=4.05, bleu=0, ppl=16.56, wps=7762.9, ups=1.25, wpb=6213.6, bsz=512, num_updates=6050, lr=0.000320293, gnorm=6.641, clip=0, loss_scale=128, train_wall=38, wall=5053 (progress_bar.py:262, log())
[2020-12-27 04:53:21]    INFO >> epoch 013:    197 / 492 loss=48.991, nll_loss=4.05, bleu=0, ppl=16.56, wps=7680.7, ups=1.24, wpb=6194.2, bsz=512, num_updates=6100, lr=0.000320293, gnorm=6.597, clip=0, loss_scale=128, train_wall=38, wall=5094 (progress_bar.py:262, log())
[2020-12-27 04:53:59]    INFO >> epoch 013:    247 / 492 loss=49.105, nll_loss=4.051, bleu=0, ppl=16.58, wps=8154.9, ups=1.31, wpb=6206.2, bsz=512, num_updates=6150, lr=0.000320293, gnorm=6.585, clip=0, loss_scale=128, train_wall=36, wall=5132 (progress_bar.py:262, log())
[2020-12-27 04:54:38]    INFO >> epoch 013:    297 / 492 loss=49.218, nll_loss=4.057, bleu=0, ppl=16.64, wps=7891.3, ups=1.27, wpb=6211.7, bsz=512, num_updates=6200, lr=0.000320293, gnorm=6.669, clip=0, loss_scale=128, train_wall=37, wall=5171 (progress_bar.py:262, log())
[2020-12-27 04:55:16]    INFO >> epoch 013:    347 / 492 loss=49.298, nll_loss=4.052, bleu=0, ppl=16.58, wps=8201, ups=1.32, wpb=6229.6, bsz=512, num_updates=6250, lr=0.000320293, gnorm=6.717, clip=0, loss_scale=128, train_wall=36, wall=5209 (progress_bar.py:262, log())
[2020-12-27 04:55:57]    INFO >> epoch 013:    397 / 492 loss=49.394, nll_loss=4.073, bleu=0, ppl=16.83, wps=7715, ups=1.24, wpb=6208.6, bsz=512, num_updates=6300, lr=0.000320293, gnorm=6.731, clip=0, loss_scale=128, train_wall=38, wall=5249 (progress_bar.py:262, log())
[2020-12-27 04:56:37]    INFO >> epoch 013:    447 / 492 loss=49.671, nll_loss=4.076, bleu=0, ppl=16.87, wps=7696.5, ups=1.23, wpb=6238.7, bsz=512, num_updates=6350, lr=0.000320293, gnorm=6.694, clip=0, loss_scale=128, train_wall=38, wall=5290 (progress_bar.py:262, log())
[2020-12-27 04:57:11]    INFO >> epoch 013 | loss 49.264 | nll_loss 4.056 | bleu 0 | ppl 16.63 | wps 7446.9 | ups 1.2 | wpb 6216.7 | bsz 511.8 | num_updates 6395 | lr 0.000320293 | gnorm 6.658 | clip 0 | loss_scale 152.976 | train_wall 364 | wall 5323 (progress_bar.py:269, print())
[2020-12-27 04:57:29]    INFO >> epoch 013 | valid on 'valid' subset | loss 71.63 | nll_loss 5.738 | bleu 15.195025531884905 | ppl 53.37 | wps 9064.1 | wpb 24814 | bsz 1987.7 | num_updates 6395 | best_bleu 15.333145882068267 (progress_bar.py:269, print())
[2020-12-27 04:57:32]    INFO >> saved checkpoint /home/wanyao/.ncc/code_search_net_feng/sum_bin_ast/python/data-mmap/nary_tree2seq/checkpoints/checkpoint_last.pt (epoch 13 @ 6395 updates, score 15.195025531884905) (writing took 2.622817099094391 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2020-12-27 04:57:35]    INFO >> epoch 014:      5 / 492 loss=49.406, nll_loss=4.049, bleu=0, ppl=16.55, wps=5375.4, ups=0.86, wpb=6247.3, bsz=512, num_updates=6400, lr=0.000313887, gnorm=6.697, clip=0, loss_scale=128, train_wall=35, wall=5348 (progress_bar.py:262, log())
[2020-12-27 04:58:14]    INFO >> epoch 014:     55 / 492 loss=47.15, nll_loss=3.916, bleu=0, ppl=15.09, wps=8046.1, ups=1.31, wpb=6164.7, bsz=512, num_updates=6450, lr=0.000313887, gnorm=6.568, clip=0, loss_scale=128, train_wall=36, wall=5386 (progress_bar.py:262, log())
[2020-12-27 04:58:52]    INFO >> epoch 014:    105 / 492 loss=47.94, nll_loss=3.946, bleu=0, ppl=15.41, wps=8043, ups=1.29, wpb=6220.8, bsz=512, num_updates=6500, lr=0.000313887, gnorm=6.783, clip=0, loss_scale=128, train_wall=37, wall=5425 (progress_bar.py:262, log())
[2020-12-27 04:59:32]    INFO >> epoch 014:    155 / 492 loss=48.38, nll_loss=3.954, bleu=0, ppl=15.5, wps=7840.9, ups=1.25, wpb=6264.1, bsz=512, num_updates=6550, lr=0.000313887, gnorm=6.799, clip=0, loss_scale=128, train_wall=38, wall=5465 (progress_bar.py:262, log())
[2020-12-27 05:00:11]    INFO >> epoch 014:    205 / 492 loss=48.34, nll_loss=3.96, bleu=0, ppl=15.56, wps=8042.5, ups=1.29, wpb=6250.7, bsz=512, num_updates=6600, lr=0.000313887, gnorm=6.865, clip=0, loss_scale=128, train_wall=37, wall=5504 (progress_bar.py:262, log())
[2020-12-27 05:00:53]    INFO >> epoch 014:    255 / 492 loss=47.779, nll_loss=3.944, bleu=0, ppl=15.39, wps=7376.8, ups=1.19, wpb=6202, bsz=512, num_updates=6650, lr=0.000313887, gnorm=6.848, clip=0, loss_scale=128, train_wall=40, wall=5546 (progress_bar.py:262, log())
[2020-12-27 05:01:32]    INFO >> epoch 014:    305 / 492 loss=48.212, nll_loss=3.965, bleu=0, ppl=15.61, wps=7979.2, ups=1.28, wpb=6226, bsz=512, num_updates=6700, lr=0.000313887, gnorm=6.918, clip=0, loss_scale=128, train_wall=37, wall=5585 (progress_bar.py:262, log())
[2020-12-27 05:02:10]    INFO >> epoch 014:    355 / 492 loss=48.665, nll_loss=3.996, bleu=0, ppl=15.96, wps=8175.6, ups=1.31, wpb=6234.8, bsz=512, num_updates=6750, lr=0.000313887, gnorm=7.002, clip=0, loss_scale=128, train_wall=36, wall=5623 (progress_bar.py:262, log())
[2020-12-27 05:02:49]    INFO >> epoch 014:    405 / 492 loss=48.46, nll_loss=3.992, bleu=0, ppl=15.91, wps=7971.2, ups=1.29, wpb=6195.5, bsz=510.3, num_updates=6800, lr=0.000313887, gnorm=6.974, clip=0, loss_scale=128, train_wall=37, wall=5662 (progress_bar.py:262, log())
[2020-12-27 05:03:28]    INFO >> epoch 014:    455 / 492 loss=48.568, nll_loss=3.983, bleu=0, ppl=15.81, wps=8064.9, ups=1.29, wpb=6243.7, bsz=512, num_updates=6850, lr=0.000313887, gnorm=7.059, clip=0, loss_scale=128, train_wall=37, wall=5700 (progress_bar.py:262, log())
[2020-12-27 05:03:54]    INFO >> epoch 014 | loss 48.139 | nll_loss 3.963 | bleu 0 | ppl 15.6 | wps 7584.6 | ups 1.22 | wpb 6216.8 | bsz 511.8 | num_updates 6887 | lr 0.000313887 | gnorm 6.88 | clip 0 | loss_scale 128 | train_wall 361 | wall 5727 (progress_bar.py:269, print())
[2020-12-27 05:04:15]    INFO >> epoch 014 | valid on 'valid' subset | loss 72.07 | nll_loss 5.773 | bleu 15.225129434724082 | ppl 54.69 | wps 8074.7 | wpb 24814 | bsz 1987.7 | num_updates 6887 | best_bleu 15.333145882068267 (progress_bar.py:269, print())
[2020-12-27 05:04:17]    INFO >> saved checkpoint /home/wanyao/.ncc/code_search_net_feng/sum_bin_ast/python/data-mmap/nary_tree2seq/checkpoints/checkpoint_last.pt (epoch 14 @ 6887 updates, score 15.225129434724082) (writing took 2.6345417266711593 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2020-12-27 05:04:26]    INFO >> epoch 015:     13 / 492 loss=47.63, nll_loss=3.952, bleu=0, ppl=15.48, wps=5349, ups=0.87, wpb=6170.4, bsz=512, num_updates=6900, lr=0.000307609, gnorm=7.004, clip=0, loss_scale=128, train_wall=33, wall=5758 (progress_bar.py:262, log())
[2020-12-27 05:05:04]    INFO >> epoch 015:     63 / 492 loss=46.768, nll_loss=3.85, bleu=0, ppl=14.42, wps=8060.3, ups=1.3, wpb=6220.3, bsz=512, num_updates=6950, lr=0.000307609, gnorm=6.969, clip=0, loss_scale=128, train_wall=36, wall=5797 (progress_bar.py:262, log())
[2020-12-27 05:05:42]    INFO >> epoch 015:    113 / 492 loss=47.173, nll_loss=3.874, bleu=0, ppl=14.66, wps=8124.9, ups=1.3, wpb=6235.2, bsz=512, num_updates=7000, lr=0.000307609, gnorm=7.1, clip=0, loss_scale=128, train_wall=36, wall=5835 (progress_bar.py:262, log())
[2020-12-27 05:06:22]    INFO >> epoch 015:    163 / 492 loss=46.995, nll_loss=3.879, bleu=0, ppl=14.71, wps=7857.2, ups=1.27, wpb=6203.4, bsz=512, num_updates=7050, lr=0.000307609, gnorm=7.092, clip=0, loss_scale=128, train_wall=37, wall=5874 (progress_bar.py:262, log())
[2020-12-27 05:07:02]    INFO >> epoch 015:    213 / 492 loss=47.442, nll_loss=3.905, bleu=0, ppl=14.98, wps=7808.6, ups=1.26, wpb=6220.7, bsz=512, num_updates=7100, lr=0.000307609, gnorm=7.167, clip=0, loss_scale=128, train_wall=38, wall=5914 (progress_bar.py:262, log())
[2020-12-27 05:07:40]    INFO >> epoch 015:    263 / 492 loss=47.468, nll_loss=3.903, bleu=0, ppl=14.96, wps=8024.9, ups=1.29, wpb=6205.9, bsz=510.3, num_updates=7150, lr=0.000307609, gnorm=7.186, clip=0, loss_scale=128, train_wall=36, wall=5953 (progress_bar.py:262, log())
[2020-12-27 05:08:18]    INFO >> epoch 015:    313 / 492 loss=47.289, nll_loss=3.914, bleu=0, ppl=15.07, wps=8292.2, ups=1.34, wpb=6186.7, bsz=512, num_updates=7200, lr=0.000307609, gnorm=7.182, clip=0, loss_scale=128, train_wall=35, wall=5990 (progress_bar.py:262, log())
[2020-12-27 05:08:58]    INFO >> epoch 015:    363 / 492 loss=47.754, nll_loss=3.935, bleu=0, ppl=15.29, wps=7652.8, ups=1.23, wpb=6213.7, bsz=512, num_updates=7250, lr=0.000307609, gnorm=7.264, clip=0, loss_scale=128, train_wall=38, wall=6031 (progress_bar.py:262, log())
[2020-12-27 05:09:37]    INFO >> epoch 015:    413 / 492 loss=47.921, nll_loss=3.934, bleu=0, ppl=15.28, wps=8002.6, ups=1.28, wpb=6237, bsz=512, num_updates=7300, lr=0.000307609, gnorm=7.312, clip=0, loss_scale=128, train_wall=37, wall=6070 (progress_bar.py:262, log())
[2020-12-27 05:10:17]    INFO >> epoch 015:    463 / 492 loss=47.881, nll_loss=3.946, bleu=0, ppl=15.41, wps=7865.5, ups=1.27, wpb=6212.6, bsz=512, num_updates=7350, lr=0.000307609, gnorm=7.249, clip=0, loss_scale=128, train_wall=37, wall=6109 (progress_bar.py:262, log())
[2020-12-27 05:10:37]    INFO >> epoch 015 | loss 47.428 | nll_loss 3.905 | bleu 0 | ppl 14.98 | wps 7591.5 | ups 1.22 | wpb 6216.8 | bsz 511.8 | num_updates 7379 | lr 0.000307609 | gnorm 7.168 | clip 0 | loss_scale 128 | train_wall 359 | wall 6130 (progress_bar.py:269, print())
[2020-12-27 05:10:58]    INFO >> epoch 015 | valid on 'valid' subset | loss 72.316 | nll_loss 5.793 | bleu 15.185744616636944 | ppl 55.44 | wps 7798.5 | wpb 24814 | bsz 1987.7 | num_updates 7379 | best_bleu 15.333145882068267 (progress_bar.py:269, print())
[2020-12-27 05:11:01]    INFO >> saved checkpoint /home/wanyao/.ncc/code_search_net_feng/sum_bin_ast/python/data-mmap/nary_tree2seq/checkpoints/checkpoint_last.pt (epoch 15 @ 7379 updates, score 15.185744616636944) (writing took 2.624067721888423 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2020-12-27 05:11:15]    INFO >> epoch 016:     21 / 492 loss=47.096, nll_loss=3.872, bleu=0, ppl=14.64, wps=5341.1, ups=0.86, wpb=6228, bsz=512, num_updates=7400, lr=0.000301457, gnorm=7.278, clip=0, loss_scale=128, train_wall=32, wall=6168 (progress_bar.py:262, log())
[2020-12-27 05:11:53]    INFO >> epoch 016:     71 / 492 loss=46.427, nll_loss=3.811, bleu=0, ppl=14.04, wps=8209.7, ups=1.32, wpb=6236.9, bsz=512, num_updates=7450, lr=0.000301457, gnorm=7.236, clip=0, loss_scale=128, train_wall=36, wall=6206 (progress_bar.py:262, log())
[2020-12-27 05:12:32]    INFO >> epoch 016:    121 / 492 loss=46.436, nll_loss=3.816, bleu=0, ppl=14.09, wps=7964.6, ups=1.28, wpb=6230.2, bsz=512, num_updates=7500, lr=0.000301457, gnorm=7.359, clip=0, loss_scale=128, train_wall=37, wall=6245 (progress_bar.py:262, log())
[2020-12-27 05:13:10]    INFO >> epoch 016:    171 / 492 loss=46.572, nll_loss=3.823, bleu=0, ppl=14.15, wps=8198.4, ups=1.31, wpb=6237.9, bsz=512, num_updates=7550, lr=0.000301457, gnorm=7.361, clip=0, loss_scale=128, train_wall=36, wall=6283 (progress_bar.py:262, log())
[2020-12-27 05:13:49]    INFO >> epoch 016:    221 / 492 loss=46.486, nll_loss=3.838, bleu=0, ppl=14.3, wps=8080.7, ups=1.3, wpb=6202.1, bsz=512, num_updates=7600, lr=0.000301457, gnorm=7.397, clip=0, loss_scale=128, train_wall=36, wall=6321 (progress_bar.py:262, log())
[2020-12-27 05:14:27]    INFO >> epoch 016:    271 / 492 loss=46.678, nll_loss=3.845, bleu=0, ppl=14.37, wps=8097.3, ups=1.31, wpb=6195.3, bsz=510.3, num_updates=7650, lr=0.000301457, gnorm=7.5, clip=0, loss_scale=128, train_wall=36, wall=6359 (progress_bar.py:262, log())
[2020-12-27 05:15:06]    INFO >> epoch 016:    321 / 492 loss=46.507, nll_loss=3.846, bleu=0, ppl=14.38, wps=7967.3, ups=1.29, wpb=6191.9, bsz=512, num_updates=7700, lr=0.000301457, gnorm=7.429, clip=0, loss_scale=128, train_wall=37, wall=6398 (progress_bar.py:262, log())
[2020-12-27 05:15:45]    INFO >> epoch 016:    371 / 492 loss=47.291, nll_loss=3.869, bleu=0, ppl=14.62, wps=8053.8, ups=1.29, wpb=6257.6, bsz=512, num_updates=7750, lr=0.000301457, gnorm=7.57, clip=0, loss_scale=128, train_wall=37, wall=6437 (progress_bar.py:262, log())
[2020-12-27 05:16:22]    INFO >> epoch 016:    421 / 492 loss=47.064, nll_loss=3.882, bleu=0, ppl=14.74, wps=8234.9, ups=1.33, wpb=6207.1, bsz=512, num_updates=7800, lr=0.000301457, gnorm=7.51, clip=0, loss_scale=128, train_wall=36, wall=6475 (progress_bar.py:262, log())
[2020-12-27 05:17:02]    INFO >> epoch 016:    471 / 492 loss=46.83, nll_loss=3.869, bleu=0, ppl=14.61, wps=7843.1, ups=1.27, wpb=6196.7, bsz=512, num_updates=7850, lr=0.000301457, gnorm=7.539, clip=0, loss_scale=128, train_wall=37, wall=6514 (progress_bar.py:262, log())
[2020-12-27 05:17:19]    INFO >> epoch 016 | loss 46.684 | nll_loss 3.844 | bleu 0 | ppl 14.36 | wps 7618.2 | ups 1.23 | wpb 6216.8 | bsz 511.8 | num_updates 7871 | lr 0.000301457 | gnorm 7.432 | clip 0 | loss_scale 128 | train_wall 357 | wall 6531 (progress_bar.py:269, print())
[2020-12-27 05:17:35]    INFO >> epoch 016 | valid on 'valid' subset | loss 72.723 | nll_loss 5.825 | bleu 15.130127551110208 | ppl 56.71 | wps 10155.4 | wpb 24814 | bsz 1987.7 | num_updates 7871 | best_bleu 15.333145882068267 (progress_bar.py:269, print())
[2020-12-27 05:17:38]    INFO >> saved checkpoint /home/wanyao/.ncc/code_search_net_feng/sum_bin_ast/python/data-mmap/nary_tree2seq/checkpoints/checkpoint_last.pt (epoch 16 @ 7871 updates, score 15.130127551110208) (writing took 2.6613903855904937 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2020-12-27 05:18:01]    INFO >> epoch 017:     29 / 492 loss=46.219, nll_loss=3.799, bleu=0, ppl=13.92, wps=5296.5, ups=0.85, wpb=6229.2, bsz=512, num_updates=7900, lr=0.000295428, gnorm=7.43, clip=0, loss_scale=128, train_wall=37, wall=6573 (progress_bar.py:262, log())
[2020-12-27 05:18:39]    INFO >> epoch 017:     79 / 492 loss=45.301, nll_loss=3.728, bleu=0, ppl=13.25, wps=8148, ups=1.31, wpb=6222.1, bsz=512, num_updates=7950, lr=0.000295428, gnorm=7.549, clip=0, loss_scale=128, train_wall=36, wall=6611 (progress_bar.py:262, log())
[2020-12-27 05:19:18]    INFO >> epoch 017:    129 / 492 loss=45.059, nll_loss=3.738, bleu=0, ppl=13.35, wps=7819.2, ups=1.27, wpb=6150.7, bsz=510.3, num_updates=8000, lr=0.000295428, gnorm=7.564, clip=0, loss_scale=128, train_wall=37, wall=6651 (progress_bar.py:262, log())
[2020-12-27 05:19:56]    INFO >> epoch 017:    179 / 492 loss=45.613, nll_loss=3.759, bleu=0, ppl=13.54, wps=8180.6, ups=1.32, wpb=6213.2, bsz=512, num_updates=8050, lr=0.000295428, gnorm=7.692, clip=0, loss_scale=128, train_wall=36, wall=6689 (progress_bar.py:262, log())
[2020-12-27 05:20:34]    INFO >> epoch 017:    229 / 492 loss=45.928, nll_loss=3.778, bleu=0, ppl=13.72, wps=8171.5, ups=1.31, wpb=6223.8, bsz=512, num_updates=8100, lr=0.000295428, gnorm=7.621, clip=0, loss_scale=128, train_wall=36, wall=6727 (progress_bar.py:262, log())
[2020-12-27 05:21:14]    INFO >> epoch 017:    279 / 492 loss=46.241, nll_loss=3.798, bleu=0, ppl=13.91, wps=7744.7, ups=1.24, wpb=6234.1, bsz=512, num_updates=8150, lr=0.000295428, gnorm=7.743, clip=0, loss_scale=128, train_wall=38, wall=6767 (progress_bar.py:262, log())
[2020-12-27 05:21:54]    INFO >> epoch 017:    329 / 492 loss=45.743, nll_loss=3.767, bleu=0, ppl=13.61, wps=7896.4, ups=1.27, wpb=6217.4, bsz=512, num_updates=8200, lr=0.000295428, gnorm=7.676, clip=0, loss_scale=128, train_wall=37, wall=6806 (progress_bar.py:262, log())
[2020-12-27 05:22:34]    INFO >> epoch 017:    379 / 492 loss=46.606, nll_loss=3.814, bleu=0, ppl=14.06, wps=7847.2, ups=1.25, wpb=6257, bsz=512, num_updates=8250, lr=0.000295428, gnorm=7.807, clip=0, loss_scale=128, train_wall=38, wall=6846 (progress_bar.py:262, log())
[2020-12-27 05:23:18]    INFO >> epoch 017:    429 / 492 loss=46.264, nll_loss=3.806, bleu=0, ppl=13.98, wps=7027.4, ups=1.13, wpb=6224.1, bsz=512, num_updates=8300, lr=0.000295428, gnorm=7.737, clip=0, loss_scale=128, train_wall=42, wall=6890 (progress_bar.py:262, log())
[2020-12-27 05:23:58]    INFO >> epoch 017:    479 / 492 loss=46.114, nll_loss=3.81, bleu=0, ppl=14.03, wps=7807.3, ups=1.26, wpb=6196.9, bsz=512, num_updates=8350, lr=0.000295428, gnorm=7.805, clip=0, loss_scale=128, train_wall=38, wall=6930 (progress_bar.py:262, log())
[2020-12-27 05:24:07]    INFO >> epoch 017 | loss 45.861 | nll_loss 3.776 | bleu 0 | ppl 13.7 | wps 7492.5 | ups 1.21 | wpb 6216.8 | bsz 511.8 | num_updates 8363 | lr 0.000295428 | gnorm 7.669 | clip 0 | loss_scale 128 | train_wall 368 | wall 6939 (progress_bar.py:269, print())
[2020-12-27 05:24:26]    INFO >> epoch 017 | valid on 'valid' subset | loss 73.183 | nll_loss 5.862 | bleu 15.110452498485197 | ppl 58.17 | wps 8876.8 | wpb 24814 | bsz 1987.7 | num_updates 8363 | best_bleu 15.333145882068267 (progress_bar.py:269, print())
[2020-12-27 05:24:28]    INFO >> saved checkpoint /home/wanyao/.ncc/code_search_net_feng/sum_bin_ast/python/data-mmap/nary_tree2seq/checkpoints/checkpoint_last.pt (epoch 17 @ 8363 updates, score 15.110452498485197) (writing took 2.6363288834691048 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2020-12-27 05:24:55]    INFO >> epoch 018:     37 / 492 loss=44.588, nll_loss=3.67, bleu=0, ppl=12.73, wps=5385.2, ups=0.87, wpb=6219.6, bsz=512, num_updates=8400, lr=0.000289519, gnorm=7.592, clip=0, loss_scale=128, train_wall=34, wall=6988 (progress_bar.py:262, log())
[2020-12-27 05:25:33]    INFO >> epoch 018:     87 / 492 loss=44.828, nll_loss=3.681, bleu=0, ppl=12.83, wps=8183.4, ups=1.31, wpb=6235, bsz=512, num_updates=8450, lr=0.000289519, gnorm=7.716, clip=0, loss_scale=128, train_wall=36, wall=7026 (progress_bar.py:262, log())
[2020-12-27 05:26:13]    INFO >> epoch 018:    137 / 492 loss=44.151, nll_loss=3.655, bleu=0, ppl=12.59, wps=7854.3, ups=1.27, wpb=6185.5, bsz=512, num_updates=8500, lr=0.000289519, gnorm=7.822, clip=0, loss_scale=128, train_wall=37, wall=7065 (progress_bar.py:262, log())
[2020-12-27 05:26:53]    INFO >> epoch 018:    187 / 492 loss=44.959, nll_loss=3.693, bleu=0, ppl=12.93, wps=7774.4, ups=1.25, wpb=6233.8, bsz=512, num_updates=8550, lr=0.000289519, gnorm=7.912, clip=0, loss_scale=128, train_wall=38, wall=7105 (progress_bar.py:262, log())
[2020-12-27 05:27:31]    INFO >> epoch 018:    237 / 492 loss=44.636, nll_loss=3.684, bleu=0, ppl=12.85, wps=8162.7, ups=1.32, wpb=6183.7, bsz=510.3, num_updates=8600, lr=0.000289519, gnorm=7.883, clip=0, loss_scale=128, train_wall=36, wall=7143 (progress_bar.py:262, log())
[2020-12-27 05:28:09]    INFO >> epoch 018:    287 / 492 loss=45.364, nll_loss=3.72, bleu=0, ppl=13.18, wps=8145.9, ups=1.3, wpb=6242.8, bsz=512, num_updates=8650, lr=0.000289519, gnorm=7.893, clip=0, loss_scale=128, train_wall=36, wall=7182 (progress_bar.py:262, log())
[2020-12-27 05:28:48]    INFO >> epoch 018:    337 / 492 loss=45.446, nll_loss=3.715, bleu=0, ppl=13.13, wps=7996.3, ups=1.28, wpb=6262.9, bsz=512, num_updates=8700, lr=0.000289519, gnorm=7.974, clip=0, loss_scale=128, train_wall=37, wall=7221 (progress_bar.py:262, log())
[2020-12-27 05:29:27]    INFO >> epoch 018:    387 / 492 loss=45.128, nll_loss=3.738, bleu=0, ppl=13.35, wps=7959.8, ups=1.29, wpb=6180.6, bsz=512, num_updates=8750, lr=0.000289519, gnorm=7.981, clip=0, loss_scale=128, train_wall=37, wall=7260 (progress_bar.py:262, log())
[2020-12-27 05:30:07]    INFO >> epoch 018:    437 / 492 loss=45.285, nll_loss=3.744, bleu=0, ppl=13.4, wps=7720.2, ups=1.25, wpb=6193.1, bsz=512, num_updates=8800, lr=0.000289519, gnorm=7.928, clip=0, loss_scale=128, train_wall=38, wall=7300 (progress_bar.py:262, log())
[2020-12-27 05:30:46]    INFO >> epoch 018:    487 / 492 loss=45.708, nll_loss=3.759, bleu=0, ppl=13.54, wps=8012.3, ups=1.29, wpb=6225.6, bsz=512, num_updates=8850, lr=0.000289519, gnorm=8, clip=0, loss_scale=128, train_wall=37, wall=7339 (progress_bar.py:262, log())
[2020-12-27 05:30:50]    INFO >> epoch 018 | loss 44.989 | nll_loss 3.704 | bleu 0 | ppl 13.03 | wps 7577.9 | ups 1.22 | wpb 6216.8 | bsz 511.8 | num_updates 8855 | lr 0.000289519 | gnorm 7.876 | clip 0 | loss_scale 128 | train_wall 361 | wall 7343 (progress_bar.py:269, print())
[2020-12-27 05:31:07]    INFO >> epoch 018 | valid on 'valid' subset | loss 73.481 | nll_loss 5.886 | bleu 14.98012063386858 | ppl 59.14 | wps 10549 | wpb 24814 | bsz 1987.7 | num_updates 8855 | best_bleu 15.333145882068267 (progress_bar.py:269, print())
[2020-12-27 05:31:09]    INFO >> saved checkpoint /home/wanyao/.ncc/code_search_net_feng/sum_bin_ast/python/data-mmap/nary_tree2seq/checkpoints/checkpoint_last.pt (epoch 18 @ 8855 updates, score 14.98012063386858) (writing took 2.6001028018072248 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2020-12-27 05:31:44]    INFO >> epoch 019:     45 / 492 loss=43.882, nll_loss=3.6, bleu=0, ppl=12.12, wps=5385.5, ups=0.87, wpb=6221.1, bsz=510.3, num_updates=8900, lr=0.000283729, gnorm=7.936, clip=0, loss_scale=128, train_wall=37, wall=7396 (progress_bar.py:262, log())
[2020-12-27 05:32:22]    INFO >> epoch 019:     95 / 492 loss=43.685, nll_loss=3.594, bleu=0, ppl=12.07, wps=8160.1, ups=1.31, wpb=6223.4, bsz=512, num_updates=8950, lr=0.000283729, gnorm=7.991, clip=0, loss_scale=128, train_wall=36, wall=7435 (progress_bar.py:262, log())
[2020-12-27 05:33:02]    INFO >> epoch 019:    145 / 492 loss=43.826, nll_loss=3.606, bleu=0, ppl=12.18, wps=7869.3, ups=1.26, wpb=6222.6, bsz=512, num_updates=9000, lr=0.000283729, gnorm=8.003, clip=0, loss_scale=128, train_wall=37, wall=7474 (progress_bar.py:262, log())
[2020-12-27 05:33:40]    INFO >> epoch 019:    195 / 492 loss=43.927, nll_loss=3.621, bleu=0, ppl=12.3, wps=8006.2, ups=1.29, wpb=6211.8, bsz=512, num_updates=9050, lr=0.000283729, gnorm=8.092, clip=0, loss_scale=128, train_wall=37, wall=7513 (progress_bar.py:262, log())
[2020-12-27 05:34:19]    INFO >> epoch 019:    245 / 492 loss=44.511, nll_loss=3.642, bleu=0, ppl=12.49, wps=8127.7, ups=1.3, wpb=6257.1, bsz=512, num_updates=9100, lr=0.000283729, gnorm=8.097, clip=0, loss_scale=128, train_wall=36, wall=7551 (progress_bar.py:262, log())
[2020-12-27 05:34:59]    INFO >> epoch 019:    295 / 492 loss=44.04, nll_loss=3.633, bleu=0, ppl=12.4, wps=7736.9, ups=1.25, wpb=6206.9, bsz=512, num_updates=9150, lr=0.000283729, gnorm=8.176, clip=0, loss_scale=128, train_wall=38, wall=7591 (progress_bar.py:262, log())
[2020-12-27 05:35:38]    INFO >> epoch 019:    345 / 492 loss=43.97, nll_loss=3.644, bleu=0, ppl=12.5, wps=7920.1, ups=1.28, wpb=6177.6, bsz=512, num_updates=9200, lr=0.000283729, gnorm=8.129, clip=0, loss_scale=128, train_wall=37, wall=7630 (progress_bar.py:262, log())
[2020-12-27 05:36:18]    INFO >> epoch 019:    395 / 492 loss=44.462, nll_loss=3.675, bleu=0, ppl=12.77, wps=7788.8, ups=1.26, wpb=6194.8, bsz=512, num_updates=9250, lr=0.000283729, gnorm=8.178, clip=0, loss_scale=128, train_wall=38, wall=7670 (progress_bar.py:262, log())
[2020-12-27 05:36:57]    INFO >> epoch 019:    445 / 492 loss=44.553, nll_loss=3.666, bleu=0, ppl=12.7, wps=7971, ups=1.28, wpb=6221.8, bsz=512, num_updates=9300, lr=0.000283729, gnorm=8.215, clip=0, loss_scale=128, train_wall=37, wall=7709 (progress_bar.py:262, log())
[2020-12-27 05:37:33]    INFO >> epoch 019 | loss 44.128 | nll_loss 3.633 | bleu 0 | ppl 12.41 | wps 7590 | ups 1.22 | wpb 6216.8 | bsz 511.8 | num_updates 9347 | lr 0.000283729 | gnorm 8.099 | clip 0 | loss_scale 128 | train_wall 363 | wall 7746 (progress_bar.py:269, print())
[2020-12-27 05:37:51]    INFO >> epoch 019 | valid on 'valid' subset | loss 74.033 | nll_loss 5.93 | bleu 14.94661617374621 | ppl 60.98 | wps 9381.3 | wpb 24814 | bsz 1987.7 | num_updates 9347 | best_bleu 15.333145882068267 (progress_bar.py:269, print())
[2020-12-27 05:37:54]    INFO >> saved checkpoint /home/wanyao/.ncc/code_search_net_feng/sum_bin_ast/python/data-mmap/nary_tree2seq/checkpoints/checkpoint_last.pt (epoch 19 @ 9347 updates, score 14.94661617374621) (writing took 2.723557191900909 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2020-12-27 05:37:56]    INFO >> epoch 020:      3 / 492 loss=44.468, nll_loss=3.653, bleu=0, ppl=12.58, wps=5261.3, ups=0.84, wpb=6231.9, bsz=512, num_updates=9350, lr=0.000278054, gnorm=8.169, clip=0, loss_scale=128, train_wall=37, wall=7768 (progress_bar.py:262, log())
[2020-12-27 05:38:34]    INFO >> epoch 020:     53 / 492 loss=42.29, nll_loss=3.499, bleu=0, ppl=11.31, wps=8033.7, ups=1.3, wpb=6188.1, bsz=512, num_updates=9400, lr=0.000278054, gnorm=7.982, clip=0, loss_scale=128, train_wall=36, wall=7807 (progress_bar.py:262, log())
[2020-12-27 05:39:13]    INFO >> epoch 020:    103 / 492 loss=42.405, nll_loss=3.52, bleu=0, ppl=11.47, wps=8043.2, ups=1.3, wpb=6168.9, bsz=512, num_updates=9450, lr=0.000278054, gnorm=8.088, clip=0, loss_scale=128, train_wall=36, wall=7845 (progress_bar.py:262, log())
[2020-12-27 05:39:51]    INFO >> epoch 020:    153 / 492 loss=42.824, nll_loss=3.532, bleu=0, ppl=11.57, wps=8098.7, ups=1.3, wpb=6207.2, bsz=512, num_updates=9500, lr=0.000278054, gnorm=8.24, clip=0, loss_scale=128, train_wall=36, wall=7884 (progress_bar.py:262, log())
[2020-12-27 05:40:30]    INFO >> epoch 020:    203 / 492 loss=43.186, nll_loss=3.543, bleu=0, ppl=11.66, wps=8086.2, ups=1.3, wpb=6240.9, bsz=512, num_updates=9550, lr=0.000278054, gnorm=8.309, clip=0, loss_scale=128, train_wall=36, wall=7922 (progress_bar.py:262, log())
[2020-12-27 05:41:09]    INFO >> epoch 020:    253 / 492 loss=43.261, nll_loss=3.562, bleu=0, ppl=11.81, wps=7897.8, ups=1.27, wpb=6217.9, bsz=512, num_updates=9600, lr=0.000278054, gnorm=8.34, clip=0, loss_scale=128, train_wall=37, wall=7962 (progress_bar.py:262, log())
[2020-12-27 05:41:48]    INFO >> epoch 020:    303 / 492 loss=43.396, nll_loss=3.568, bleu=0, ppl=11.86, wps=7997.4, ups=1.28, wpb=6227.5, bsz=512, num_updates=9650, lr=0.000278054, gnorm=8.375, clip=0, loss_scale=128, train_wall=37, wall=8001 (progress_bar.py:262, log())
[2020-12-27 05:42:30]    INFO >> epoch 020:    353 / 492 loss=43.788, nll_loss=3.586, bleu=0, ppl=12.01, wps=7499.1, ups=1.2, wpb=6251.1, bsz=512, num_updates=9700, lr=0.000278054, gnorm=8.451, clip=0, loss_scale=128, train_wall=40, wall=8042 (progress_bar.py:262, log())
[2020-12-27 05:43:08]    INFO >> epoch 020:    403 / 492 loss=43.922, nll_loss=3.607, bleu=0, ppl=12.19, wps=8192, ups=1.32, wpb=6213.6, bsz=510.3, num_updates=9750, lr=0.000278054, gnorm=8.505, clip=0, loss_scale=128, train_wall=36, wall=8080 (progress_bar.py:262, log())
[2020-12-27 05:43:49]    INFO >> epoch 020:    453 / 492 loss=43.721, nll_loss=3.592, bleu=0, ppl=12.06, wps=7605.4, ups=1.22, wpb=6231.2, bsz=512, num_updates=9800, lr=0.000278054, gnorm=8.543, clip=0, loss_scale=128, train_wall=39, wall=8121 (progress_bar.py:262, log())
[2020-12-27 05:44:19]    INFO >> epoch 020 | loss 43.261 | nll_loss 3.562 | bleu 0 | ppl 11.81 | wps 7541.7 | ups 1.21 | wpb 6216.8 | bsz 511.8 | num_updates 9839 | lr 0.000278054 | gnorm 8.32 | clip 0 | loss_scale 128 | train_wall 364 | wall 8151 (progress_bar.py:269, print())
[2020-12-27 05:44:36]    INFO >> epoch 020 | valid on 'valid' subset | loss 74.517 | nll_loss 5.969 | bleu 15.044733010782153 | ppl 62.65 | wps 9833.6 | wpb 24814 | bsz 1987.7 | num_updates 9839 | best_bleu 15.333145882068267 (progress_bar.py:269, print())
[2020-12-27 05:44:39]    INFO >> saved checkpoint /home/wanyao/.ncc/code_search_net_feng/sum_bin_ast/python/data-mmap/nary_tree2seq/checkpoints/checkpoint_last.pt (epoch 20 @ 9839 updates, score 15.044733010782153) (writing took 2.6228052470833063 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2020-12-27 05:44:48]    INFO >> epoch 021:     11 / 492 loss=43.463, nll_loss=3.58, bleu=0, ppl=11.96, wps=5244, ups=0.84, wpb=6216, bsz=512, num_updates=9850, lr=0.000272493, gnorm=8.357, clip=0, loss_scale=128, train_wall=37, wall=8180 (progress_bar.py:262, log())
[2020-12-27 05:45:28]    INFO >> epoch 021:     61 / 492 loss=41.655, nll_loss=3.43, bleu=0, ppl=10.78, wps=7789.3, ups=1.25, wpb=6217, bsz=512, num_updates=9900, lr=0.000272493, gnorm=8.173, clip=0, loss_scale=128, train_wall=38, wall=8220 (progress_bar.py:262, log())
[2020-12-27 05:46:06]    INFO >> epoch 021:    111 / 492 loss=41.82, nll_loss=3.459, bleu=0, ppl=11, wps=8154.7, ups=1.32, wpb=6189.5, bsz=512, num_updates=9950, lr=0.000272493, gnorm=8.303, clip=0, loss_scale=128, train_wall=36, wall=8258 (progress_bar.py:262, log())
[2020-12-27 05:46:45]    INFO >> epoch 021:    161 / 492 loss=42.281, nll_loss=3.479, bleu=0, ppl=11.15, wps=7894.6, ups=1.27, wpb=6201.2, bsz=510.3, num_updates=10000, lr=0.000272493, gnorm=8.409, clip=0, loss_scale=128, train_wall=37, wall=8298 (progress_bar.py:262, log())
[2020-12-27 05:47:24]    INFO >> epoch 021:    211 / 492 loss=42.285, nll_loss=3.485, bleu=0, ppl=11.2, wps=7896, ups=1.27, wpb=6212.1, bsz=512, num_updates=10050, lr=0.000272493, gnorm=8.517, clip=0, loss_scale=128, train_wall=37, wall=8337 (progress_bar.py:262, log())
[2020-12-27 05:48:02]    INFO >> epoch 021:    261 / 492 loss=42.449, nll_loss=3.499, bleu=0, ppl=11.31, wps=8173.8, ups=1.32, wpb=6211.3, bsz=512, num_updates=10100, lr=0.000272493, gnorm=8.553, clip=0, loss_scale=140.8, train_wall=36, wall=8375 (progress_bar.py:262, log())
[2020-12-27 05:48:43]    INFO >> epoch 021:    311 / 492 loss=43.369, nll_loss=3.557, bleu=0, ppl=11.77, wps=7653.6, ups=1.23, wpb=6242.3, bsz=512, num_updates=10150, lr=0.000272493, gnorm=9.051, clip=0, loss_scale=256, train_wall=39, wall=8416 (progress_bar.py:262, log())
[2020-12-27 05:49:24]    INFO >> epoch 021:    361 / 492 loss=44.087, nll_loss=3.609, bleu=0, ppl=12.2, wps=7725.9, ups=1.24, wpb=6254, bsz=512, num_updates=10200, lr=0.000272493, gnorm=9.021, clip=0, loss_scale=256, train_wall=38, wall=8456 (progress_bar.py:262, log())
[2020-12-27 05:50:03]    INFO >> epoch 021:    411 / 492 loss=43.815, nll_loss=3.601, bleu=0, ppl=12.14, wps=7959.2, ups=1.28, wpb=6229, bsz=512, num_updates=10250, lr=0.000272493, gnorm=9.038, clip=0, loss_scale=256, train_wall=37, wall=8495 (progress_bar.py:262, log())
[2020-12-27 05:50:42]    INFO >> epoch 021:    461 / 492 loss=43.725, nll_loss=3.604, bleu=0, ppl=12.16, wps=7832.8, ups=1.26, wpb=6210.8, bsz=512, num_updates=10300, lr=0.000272493, gnorm=8.917, clip=0, loss_scale=256, train_wall=37, wall=8535 (progress_bar.py:262, log())
[2020-12-27 05:51:05]    INFO >> epoch 021 | loss 42.88 | nll_loss 3.53 | bleu 0 | ppl 11.55 | wps 7525 | ups 1.21 | wpb 6216.8 | bsz 511.8 | num_updates 10331 | lr 0.000272493 | gnorm 8.665 | clip 0 | loss_scale 189.398 | train_wall 365 | wall 8558 (progress_bar.py:269, print())
[2020-12-27 05:51:24]    INFO >> epoch 021 | valid on 'valid' subset | loss 74.931 | nll_loss 6.002 | bleu 14.918617349423283 | ppl 64.1 | wps 9117.3 | wpb 24814 | bsz 1987.7 | num_updates 10331 | best_bleu 15.333145882068267 (progress_bar.py:269, print())
[2020-12-27 05:51:26]    INFO >> saved checkpoint /home/wanyao/.ncc/code_search_net_feng/sum_bin_ast/python/data-mmap/nary_tree2seq/checkpoints/checkpoint_last.pt (epoch 21 @ 10331 updates, score 14.918617349423283) (writing took 2.5981052219867706 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2020-12-27 05:51:41]    INFO >> epoch 022:     19 / 492 loss=43.309, nll_loss=3.562, bleu=0, ppl=11.81, wps=5300.6, ups=0.85, wpb=6224.5, bsz=512, num_updates=10350, lr=0.000267043, gnorm=8.803, clip=0, loss_scale=256, train_wall=36, wall=8594 (progress_bar.py:262, log())
[2020-12-27 05:52:22]    INFO >> epoch 022:     69 / 492 loss=41.744, nll_loss=3.447, bleu=0, ppl=10.91, wps=7577.4, ups=1.22, wpb=6199.6, bsz=512, num_updates=10400, lr=0.000267043, gnorm=8.735, clip=0, loss_scale=256, train_wall=39, wall=8635 (progress_bar.py:262, log())
[2020-12-27 05:53:00]    INFO >> epoch 022:    119 / 492 loss=41.658, nll_loss=3.441, bleu=0, ppl=10.86, wps=8062.6, ups=1.3, wpb=6199.4, bsz=512, num_updates=10450, lr=0.000267043, gnorm=8.724, clip=0, loss_scale=256, train_wall=36, wall=8673 (progress_bar.py:262, log())
[2020-12-27 05:53:39]    INFO >> epoch 022:    169 / 492 loss=42.226, nll_loss=3.463, bleu=0, ppl=11.03, wps=8104.2, ups=1.3, wpb=6242.4, bsz=512, num_updates=10500, lr=0.000267043, gnorm=8.854, clip=0, loss_scale=256, train_wall=36, wall=8711 (progress_bar.py:262, log())
[2020-12-27 05:54:19]    INFO >> epoch 022:    219 / 492 loss=42.37, nll_loss=3.475, bleu=0, ppl=11.12, wps=7775.4, ups=1.25, wpb=6242.8, bsz=512, num_updates=10550, lr=0.000267043, gnorm=8.877, clip=0, loss_scale=256, train_wall=38, wall=8752 (progress_bar.py:262, log())
[2020-12-27 05:54:59]    INFO >> epoch 022:    269 / 492 loss=42.501, nll_loss=3.494, bleu=0, ppl=11.26, wps=7688.4, ups=1.24, wpb=6208.1, bsz=510.3, num_updates=10600, lr=0.000267043, gnorm=8.9, clip=0, loss_scale=256, train_wall=38, wall=8792 (progress_bar.py:262, log())
[2020-12-27 05:55:39]    INFO >> epoch 022:    319 / 492 loss=42.393, nll_loss=3.493, bleu=0, ppl=11.26, wps=7792.9, ups=1.25, wpb=6213.7, bsz=512, num_updates=10650, lr=0.000267043, gnorm=8.947, clip=0, loss_scale=256, train_wall=38, wall=8832 (progress_bar.py:262, log())
[2020-12-27 05:56:17]    INFO >> epoch 022:    369 / 492 loss=42.39, nll_loss=3.496, bleu=0, ppl=11.28, wps=8234.5, ups=1.33, wpb=6208.6, bsz=512, num_updates=10700, lr=0.000267043, gnorm=8.94, clip=0, loss_scale=256, train_wall=36, wall=8870 (progress_bar.py:262, log())
[2020-12-27 05:56:56]    INFO >> epoch 022:    419 / 492 loss=42.421, nll_loss=3.509, bleu=0, ppl=11.38, wps=7985.9, ups=1.29, wpb=6190.6, bsz=512, num_updates=10750, lr=0.000267043, gnorm=8.898, clip=0, loss_scale=256, train_wall=37, wall=8908 (progress_bar.py:262, log())
[2020-12-27 05:57:34]    INFO >> epoch 022:    469 / 492 loss=42.768, nll_loss=3.517, bleu=0, ppl=11.45, wps=8112, ups=1.3, wpb=6225.6, bsz=512, num_updates=10800, lr=0.000267043, gnorm=9, clip=0, loss_scale=256, train_wall=36, wall=8947 (progress_bar.py:262, log())
[2020-12-27 05:57:51]    INFO >> epoch 022 | loss 42.288 | nll_loss 3.482 | bleu 0 | ppl 11.17 | wps 7538.7 | ups 1.21 | wpb 6216.8 | bsz 511.8 | num_updates 10823 | lr 0.000267043 | gnorm 8.871 | clip 0 | loss_scale 256 | train_wall 363 | wall 8964 (progress_bar.py:269, print())
[2020-12-27 05:58:12]    INFO >> epoch 022 | valid on 'valid' subset | loss 75.386 | nll_loss 6.039 | bleu 14.890775205066939 | ppl 65.74 | wps 7913.2 | wpb 24814 | bsz 1987.7 | num_updates 10823 | best_bleu 15.333145882068267 (progress_bar.py:269, print())
[2020-12-27 05:58:15]    INFO >> saved checkpoint /home/wanyao/.ncc/code_search_net_feng/sum_bin_ast/python/data-mmap/nary_tree2seq/checkpoints/checkpoint_last.pt (epoch 22 @ 10823 updates, score 14.890775205066939) (writing took 2.6396883074194193 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2020-12-27 05:58:15]    INFO >> early stop since valid performance hasn't improved for last 10 runs (train.py:185, should_stop_early())
[2020-12-27 05:58:15]    INFO >> early stop since valid performance hasn't improved for last 10 runs (train.py:268, single_main())
[2020-12-27 05:58:15]    INFO >> done training in 8935.0 seconds (train.py:279, single_main())
