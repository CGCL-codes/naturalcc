nohup: ignoring input
[2020-12-26 14:35:05]    INFO >> Load arguments in /home/wanyao/yang/naturalcc-dev/run/summarization/tree2seq/config/csn_feng/ruby.fp16.yml (train.py:299, cli_main())
[2020-12-26 14:35:05]    INFO >> {'criterion': 'cross_entropy', 'optimizer': 'adam', 'lr_scheduler': 'fixed', 'tokenizer': None, 'bpe': None, 'common': {'no_progress_bar': 0, 'log_interval': 50, 'log_format': 'simple', 'tensorboard_logdir': '', 'memory_efficient_fp16': 1, 'fp16_no_flatten_grads': 1, 'fp16_init_scale': 128, 'fp16_scale_window': None, 'fp16_scale_tolerance': 0.0, 'min_loss_scale': 0.0001, 'threshold_loss_scale': None, 'empty_cache_freq': 0, 'task': 'graph_summarization', 'seed': 1, 'cpu': 0, 'fp16': 1, 'fp16_opt_level': '01', 'server_ip': '', 'server_port': ''}, 'dataset': {'num_workers': 0, 'skip_invalid_size_inputs_valid_test': 1, 'max_tokens': None, 'max_sentences': 128, 'required_batch_size_multiple': 8, 'dataset_impl': 'mmap', 'train_subset': 'train', 'valid_subset': 'valid', 'validate_interval': 1, 'fixed_validation_seed': None, 'disable_validation': 0, 'max_tokens_valid': None, 'max_sentences_valid': 512, 'curriculum': 0, 'gen_subset': 'test', 'num_shards': 1, 'shard_id': 0}, 'distributed_training': {'distributed_world_size': 4, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': None, 'distributed_port': -1, 'device_id': 0, 'distributed_no_spawn': 0, 'ddp_backend': 'no_c10d', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': None, 'find_unused_parameters': 0, 'fast_stat_sync': 0, 'broadcast_buffers': 0, 'global_sync_iter': 50, 'warmup_iterations': 500, 'local_rank': -1, 'block_momentum': 0.875, 'block_lr': 1, 'use_nbm': 0, 'average_sync': 0}, 'task': {'data': '/home/wanyao/.ncc/code_search_net_feng/sum_bin_ast/ruby/data-mmap', 'source_lang': 'bin_ast', 'target_lang': 'docstring_tokens', 'load_alignments': 0, 'left_pad_source': 0, 'left_pad_target': 0, 'max_source_positions': 1024, 'max_target_positions': 30, 'upsample_primary': 1, 'truncate_source': 0, 'truncate_target': 1, 'append_eos_to_target': 1, 'eval_bleu': 1, 'eval_bleu_detok': 'space', 'eval_bleu_detok_args': None, 'eval_tokenized_bleu': 0, 'eval_bleu_remove_bpe': None, 'eval_bleu_args': None, 'eval_bleu_print_samples': 0}, 'model': {'arch': 'nary_tree2seq', 'encoder_embed_dim': 512, 'encoder_embed': None, 'encoder_freeze_embed': 0, 'encoder_hidden_size': 512, 'encoder_layers': 1, 'encoder_bidirectional': 0, 'decoder_embed_dim': 512, 'decoder_embed': None, 'decoder_freeze_embed': None, 'decoder_hidden_size': 512, 'decoder_layers': 1, 'decoder_out_embed_dim': 512, 'decoder_attention': 1, 'adaptive_softmax_cutoff': None, 'share_decoder_input_output_embed': 0, 'share_all_embeddings': 0, 'encoder_dropout_in': 0.1, 'encoder_dropout_out': 0.2, 'decoder_dropout_in': 0.1, 'decoder_dropout_out': 0.2, 'max_source_positions': 1024, 'max_target_positions': 30}, 'optimization': {'max_epoch': 100, 'max_update': 0, 'clip_norm': 25, 'update_freq': [1], 'lr': [0.0004], 'min_lr': -1, 'use_bmuf': 0, 'force_anneal': 0, 'warmup_updates': 0, 'lr_shrink': 0.98, 'sentence_avg': 1, 'adam': {'adam_betas': '(0.9, 0.999)', 'adam_eps': 1e-08, 'weight_decay': 0.0, 'use_old_adam': 0}, 'weight_decay': 0.0, 'adam_epsilon': 1e-08, 'max_grad_norm': 1.0, 'num_train_epochs': 5, 'max_steps': -1, 'warmup_steps': 0, 'gradient_accumulation_steps': 1}, 'checkpoint': {'restore_file': 'checkpoint_last.pt', 'reset_dataloader': None, 'reset_lr_scheduler': None, 'reset_meters': None, 'reset_optimizer': None, 'optimizer_overrides': '{}', 'save_interval': 1, 'save_interval_updates': 0, 'keep_interval_updates': 0, 'keep_last_epochs': -1, 'keep_best_checkpoints': -1, 'no_save': 0, 'no_epoch_checkpoints': 1, 'no_last_checkpoints': 0, 'no_save_optimizer_state': None, 'best_checkpoint_metric': 'bleu', 'maximize_best_checkpoint_metric': 1, 'patience': 10, 'save_dir': '/home/wanyao/.ncc/code_search_net_feng/sum_bin_ast/ruby/data-mmap/nary_tree2seq/checkpoints', 'should_continue': 0, 'model_name_or_path': None, 'cache_dir': None, 'logging_steps': 500, 'save_steps': 2000, 'save_total_limit': 2, 'overwrite_output_dir': 0, 'overwrite_cache': 0}, 'eval': {'path': '/home/wanyao/.ncc/code_search_net_feng/sum_bin_ast/ruby/data-mmap/seq2seq/checkpoints/checkpoint_best.pt', 'result_path': None, 'remove_bpe': None, 'quiet': 0, 'model_overrides': '{}', 'max_sentences': 2048, 'beam': 1, 'nbest': 1, 'max_len_a': 0, 'max_len_b': 30, 'min_len': 1, 'match_source_len': 0, 'no_early_stop': 0, 'unnormalized': 0, 'no_beamable_mm': 0, 'lenpen': 1, 'unkpen': 0, 'replace_unk': None, 'sacrebleu': 0, 'score_reference': 0, 'prefix_size': 0, 'no_repeat_ngram_size': 0, 'sampling': 0, 'sampling_topk': -1, 'sampling_topp': -1, 'temperature': 1.0, 'diverse_beam_groups': -1, 'diverse_beam_strength': 0.5, 'diversity_rate': -1.0, 'print_alignment': 0, 'print_step': 0, 'iter_decode_eos_penalty': 0.0, 'iter_decode_max_iter': 10, 'iter_decode_force_max_iter': 0, 'iter_decode_with_beam': 1, 'iter_decode_with_external_reranker': 0, 'retain_iter_history': 0, 'decoding_format': None, 'nltk_bleu': 1, 'rouge': 1}} (train.py:301, cli_main())
[2020-12-26 14:35:08]    INFO >> distributed init (rank 0): tcp://localhost:10383 (distributed_utils.py:89, distributed_init())
[2020-12-26 14:35:08]    INFO >> distributed init (rank 3): tcp://localhost:10383 (distributed_utils.py:89, distributed_init())
[2020-12-26 14:35:08]    INFO >> initialized host node14 as rank 3 (distributed_utils.py:98, distributed_init())
[2020-12-26 14:35:08]    INFO >> distributed init (rank 1): tcp://localhost:10383 (distributed_utils.py:89, distributed_init())
[2020-12-26 14:35:08]    INFO >> initialized host node14 as rank 1 (distributed_utils.py:98, distributed_init())
[2020-12-26 14:35:08]    INFO >> distributed init (rank 2): tcp://localhost:10383 (distributed_utils.py:89, distributed_init())
[2020-12-26 14:35:08]    INFO >> initialized host node14 as rank 2 (distributed_utils.py:98, distributed_init())
[2020-12-26 14:35:08]    INFO >> initialized host node14 as rank 0 (distributed_utils.py:98, distributed_init())
[2020-12-26 14:35:15]    INFO >> [bin_ast] dictionary: 11744 types (graph_summarization.py:169, setup_task())
[2020-12-26 14:35:15]    INFO >> [docstring_tokens] dictionary: 6664 types (graph_summarization.py:170, setup_task())
[2020-12-26 14:35:15]    INFO >> truncate valid.docstring_tokens to 30 (graph_summarization.py:96, load_langpair_dataset())
[2020-12-26 14:35:15]    INFO >> loaded 1400 examples from: /home/wanyao/.ncc/code_search_net_feng/sum_bin_ast/ruby/data-mmap/valid.bin_ast (graph_summarization.py:117, load_langpair_dataset())
[2020-12-26 14:35:15]    INFO >> loaded 1400 examples from: /home/wanyao/.ncc/code_search_net_feng/sum_bin_ast/ruby/data-mmap/valid.docstring_tokens (graph_summarization.py:118, load_langpair_dataset())
[2020-12-26 14:35:16]    INFO >> NaryTree2SeqModel(
  (encoder): NaryTreeLSTMEncoder(
    (embed_tokens): Embedding(11744, 512, padding_idx=0)
    (lstm): NaryTreeLSTMCell(
      (W_iou): Linear(in_features=512, out_features=1536, bias=False)
      (U_iou): Linear(in_features=1024, out_features=1536, bias=False)
      (U_f): Linear(in_features=1024, out_features=1024, bias=True)
    )
  )
  (decoder): LSTMDecoder(
    (embed_tokens): Embedding(6664, 512, padding_idx=0)
    (layers): ModuleList(
      (0): LSTMCell(1024, 512)
    )
    (attention): AttentionLayer(
      (input_proj): Linear(in_features=512, out_features=512, bias=False)
      (output_proj): Linear(in_features=1024, out_features=512, bias=False)
    )
    (fc_out): Linear(in_features=512, out_features=6664, bias=True)
  )
) (train.py:220, single_main())
[2020-12-26 14:35:16]    INFO >> model nary_tree2seq, criterion CrossEntropyCriterion (train.py:221, single_main())
[2020-12-26 14:35:16]    INFO >> num. model params: 20190216 (num. trained: 20190216) (train.py:224, single_main())
[2020-12-26 14:35:16]    INFO >> training on 4 GPUs (train.py:229, single_main())
[2020-12-26 14:35:16]    INFO >> max tokens per GPU = None and max sentences per GPU = 128 (train.py:232, single_main())
[2020-12-26 14:35:16]    INFO >> no existing checkpoint found /home/wanyao/.ncc/code_search_net_feng/sum_bin_ast/ruby/data-mmap/nary_tree2seq/checkpoints/checkpoint_last.pt (ncc_trainer.py:267, load_checkpoint())
[2020-12-26 14:35:16]    INFO >> loading train data for epoch 1 (ncc_trainer.py:281, get_train_iterator())
[2020-12-26 14:35:21]    INFO >> truncate train.docstring_tokens to 30 (graph_summarization.py:96, load_langpair_dataset())
[2020-12-26 14:35:21]    INFO >> loaded 24927 examples from: /home/wanyao/.ncc/code_search_net_feng/sum_bin_ast/ruby/data-mmap/train.bin_ast (graph_summarization.py:117, load_langpair_dataset())
[2020-12-26 14:35:21]    INFO >> loaded 24927 examples from: /home/wanyao/.ncc/code_search_net_feng/sum_bin_ast/ruby/data-mmap/train.docstring_tokens (graph_summarization.py:118, load_langpair_dataset())
[2020-12-26 14:35:21]    INFO >> using FusedAdam (adam.py:39, __init__())
[2020-12-26 14:35:48]    INFO >> epoch 001 | loss 121.823 | nll_loss 9.242 | bleu 0 | ppl 605.7 | wps 12542.1 | ups 1.87 | wpb 6705.2 | bsz 508.7 | num_updates 49 | lr 0.0004 | gnorm 8.712 | clip 0 | loss_scale 128 | train_wall 25 | wall 32 (progress_bar.py:269, print())
[2020-12-26 14:35:50]    INFO >> epoch 001 | valid on 'valid' subset | loss 107.328 | nll_loss 8.035 | bleu 8.960942177860442 | ppl 262.25 | wps 0 | wpb 18701 | bsz 1400 | num_updates 49 (progress_bar.py:269, print())
[2020-12-26 14:35:51]    INFO >> saved checkpoint /home/wanyao/.ncc/code_search_net_feng/sum_bin_ast/ruby/data-mmap/nary_tree2seq/checkpoints/checkpoint_best.pt (epoch 1 @ 49 updates, score 8.960942177860442) (writing took 0.6704186350107193 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2020-12-26 14:35:51]    INFO >> epoch 002:      1 / 49 loss=121.573, nll_loss=9.222, bleu=0, ppl=597.11, wps=11408.1, ups=1.7, wpb=6707.3, bsz=508.8, num_updates=50, lr=0.0004, gnorm=8.627, clip=0, loss_scale=128, train_wall=26, wall=36 (progress_bar.py:262, log())
[2020-12-26 14:36:21]    INFO >> epoch 002 | loss 106.71 | nll_loss 8.096 | bleu 0 | ppl 273.59 | wps 9985.2 | ups 1.49 | wpb 6705.2 | bsz 508.7 | num_updates 98 | lr 0.0004 | gnorm 4.423 | clip 0 | loss_scale 128 | train_wall 27 | wall 65 (progress_bar.py:269, print())
[2020-12-26 14:36:23]    INFO >> epoch 002 | valid on 'valid' subset | loss 101.058 | nll_loss 7.565 | bleu 8.045244478967092 | ppl 189.42 | wps 0 | wpb 18701 | bsz 1400 | num_updates 98 | best_bleu 8.960942177860442 (progress_bar.py:269, print())
[2020-12-26 14:36:24]    INFO >> saved checkpoint /home/wanyao/.ncc/code_search_net_feng/sum_bin_ast/ruby/data-mmap/nary_tree2seq/checkpoints/checkpoint_last.pt (epoch 2 @ 98 updates, score 8.045244478967092) (writing took 0.5798752279952168 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2020-12-26 14:36:25]    INFO >> epoch 003:      2 / 49 loss=106.627, nll_loss=8.083, bleu=0, ppl=271.15, wps=10074.8, ups=1.5, wpb=6711.6, bsz=508.8, num_updates=100, lr=0.000392, gnorm=4.421, clip=0, loss_scale=128, train_wall=28, wall=69 (progress_bar.py:262, log())
[2020-12-26 14:36:50]    INFO >> epoch 003 | loss 100.841 | nll_loss 7.651 | bleu 0 | ppl 200.94 | wps 11414.6 | ups 1.7 | wpb 6705.2 | bsz 508.7 | num_updates 147 | lr 0.000392 | gnorm 4.795 | clip 0 | loss_scale 128 | train_wall 24 | wall 94 (progress_bar.py:269, print())
[2020-12-26 14:36:52]    INFO >> epoch 003 | valid on 'valid' subset | loss 96.613 | nll_loss 7.233 | bleu 8.526195250630488 | ppl 150.4 | wps 0 | wpb 18701 | bsz 1400 | num_updates 147 | best_bleu 8.960942177860442 (progress_bar.py:269, print())
[2020-12-26 14:36:52]    INFO >> saved checkpoint /home/wanyao/.ncc/code_search_net_feng/sum_bin_ast/ruby/data-mmap/nary_tree2seq/checkpoints/checkpoint_last.pt (epoch 3 @ 147 updates, score 8.526195250630488) (writing took 0.5950653860345483 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2020-12-26 14:36:54]    INFO >> epoch 004:      3 / 49 loss=100.487, nll_loss=7.628, bleu=0, ppl=197.81, wps=11454.4, ups=1.71, wpb=6702.4, bsz=508.8, num_updates=150, lr=0.00038416, gnorm=4.815, clip=0, loss_scale=128, train_wall=25, wall=98 (progress_bar.py:262, log())
[2020-12-26 14:37:18]    INFO >> epoch 004 | loss 95.922 | nll_loss 7.277 | bleu 0 | ppl 155.14 | wps 11583.8 | ups 1.73 | wpb 6705.2 | bsz 508.7 | num_updates 196 | lr 0.00038416 | gnorm 5.036 | clip 0 | loss_scale 128 | train_wall 24 | wall 122 (progress_bar.py:269, print())
[2020-12-26 14:37:20]    INFO >> epoch 004 | valid on 'valid' subset | loss 93.337 | nll_loss 6.987 | bleu 8.884097492220436 | ppl 126.89 | wps 0 | wpb 18701 | bsz 1400 | num_updates 196 | best_bleu 8.960942177860442 (progress_bar.py:269, print())
[2020-12-26 14:37:21]    INFO >> saved checkpoint /home/wanyao/.ncc/code_search_net_feng/sum_bin_ast/ruby/data-mmap/nary_tree2seq/checkpoints/checkpoint_last.pt (epoch 4 @ 196 updates, score 8.884097492220436) (writing took 0.5686992108821869 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2020-12-26 14:37:23]    INFO >> epoch 005:      4 / 49 loss=95.787, nll_loss=7.251, bleu=0, ppl=152.27, wps=11663.9, ups=1.74, wpb=6721.6, bsz=508.8, num_updates=200, lr=0.000376477, gnorm=5.069, clip=0, loss_scale=128, train_wall=25, wall=127 (progress_bar.py:262, log())
[2020-12-26 14:37:46]    INFO >> epoch 005 | loss 91.76 | nll_loss 6.962 | bleu 0 | ppl 124.64 | wps 11801.9 | ups 1.76 | wpb 6705.2 | bsz 508.7 | num_updates 245 | lr 0.000376477 | gnorm 5.649 | clip 0 | loss_scale 128 | train_wall 24 | wall 150 (progress_bar.py:269, print())
[2020-12-26 14:37:48]    INFO >> epoch 005 | valid on 'valid' subset | loss 91.007 | nll_loss 6.813 | bleu 9.080901828748969 | ppl 112.44 | wps 0 | wpb 18701 | bsz 1400 | num_updates 245 | best_bleu 9.080901828748969 (progress_bar.py:269, print())
[2020-12-26 14:37:49]    INFO >> saved checkpoint /home/wanyao/.ncc/code_search_net_feng/sum_bin_ast/ruby/data-mmap/nary_tree2seq/checkpoints/checkpoint_best.pt (epoch 5 @ 245 updates, score 9.080901828748969) (writing took 0.9905996359884739 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2020-12-26 14:37:51]    INFO >> epoch 006:      5 / 49 loss=91.244, nll_loss=6.929, bleu=0, ppl=121.82, wps=11632.1, ups=1.74, wpb=6700.3, bsz=508.8, num_updates=250, lr=0.000368947, gnorm=5.747, clip=0, loss_scale=128, train_wall=24, wall=156 (progress_bar.py:262, log())
[2020-12-26 14:38:14]    INFO >> epoch 006 | loss 88.121 | nll_loss 6.686 | bleu 0 | ppl 102.93 | wps 11664.1 | ups 1.74 | wpb 6705.2 | bsz 508.7 | num_updates 294 | lr 0.000368947 | gnorm 6.15 | clip 0 | loss_scale 128 | train_wall 23 | wall 178 (progress_bar.py:269, print())
[2020-12-26 14:38:16]    INFO >> epoch 006 | valid on 'valid' subset | loss 89.47 | nll_loss 6.698 | bleu 9.197159605949558 | ppl 103.82 | wps 0 | wpb 18701 | bsz 1400 | num_updates 294 | best_bleu 9.197159605949558 (progress_bar.py:269, print())
[2020-12-26 14:38:17]    INFO >> saved checkpoint /home/wanyao/.ncc/code_search_net_feng/sum_bin_ast/ruby/data-mmap/nary_tree2seq/checkpoints/checkpoint_best.pt (epoch 6 @ 294 updates, score 9.197159605949558) (writing took 0.981942992657423 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2020-12-26 14:38:20]    INFO >> epoch 007:      6 / 49 loss=87.588, nll_loss=6.656, bleu=0, ppl=100.81, wps=11696.9, ups=1.75, wpb=6695.6, bsz=508.8, num_updates=300, lr=0.000361568, gnorm=6.258, clip=0, loss_scale=128, train_wall=24, wall=184 (progress_bar.py:262, log())
[2020-12-26 14:38:42]    INFO >> epoch 007 | loss 84.867 | nll_loss 6.439 | bleu 0 | ppl 86.74 | wps 11719.1 | ups 1.75 | wpb 6705.2 | bsz 508.7 | num_updates 343 | lr 0.000361568 | gnorm 7.14 | clip 0 | loss_scale 128 | train_wall 23 | wall 207 (progress_bar.py:269, print())
[2020-12-26 14:38:44]    INFO >> epoch 007 | valid on 'valid' subset | loss 88.256 | nll_loss 6.607 | bleu 9.191002448791338 | ppl 97.48 | wps 0 | wpb 18701 | bsz 1400 | num_updates 343 | best_bleu 9.197159605949558 (progress_bar.py:269, print())
[2020-12-26 14:38:45]    INFO >> saved checkpoint /home/wanyao/.ncc/code_search_net_feng/sum_bin_ast/ruby/data-mmap/nary_tree2seq/checkpoints/checkpoint_last.pt (epoch 7 @ 343 updates, score 9.191002448791338) (writing took 0.5803719526156783 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2020-12-26 14:38:48]    INFO >> epoch 008:      7 / 49 loss=84.214, nll_loss=6.404, bleu=0, ppl=84.7, wps=11848.7, ups=1.77, wpb=6690.2, bsz=508.8, num_updates=350, lr=0.000354337, gnorm=7.112, clip=0, loss_scale=128, train_wall=24, wall=213 (progress_bar.py:262, log())
[2020-12-26 14:39:10]    INFO >> epoch 008 | loss 81.828 | nll_loss 6.208 | bleu 0 | ppl 73.93 | wps 11772.7 | ups 1.76 | wpb 6705.2 | bsz 508.7 | num_updates 392 | lr 0.000354337 | gnorm 7.34 | clip 0 | loss_scale 128 | train_wall 24 | wall 234 (progress_bar.py:269, print())
[2020-12-26 14:39:12]    INFO >> epoch 008 | valid on 'valid' subset | loss 87.271 | nll_loss 6.533 | bleu 9.32240115899413 | ppl 92.62 | wps 0 | wpb 18701 | bsz 1400 | num_updates 392 | best_bleu 9.32240115899413 (progress_bar.py:269, print())
[2020-12-26 14:39:13]    INFO >> saved checkpoint /home/wanyao/.ncc/code_search_net_feng/sum_bin_ast/ruby/data-mmap/nary_tree2seq/checkpoints/checkpoint_best.pt (epoch 8 @ 392 updates, score 9.32240115899413) (writing took 1.0290203038603067 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2020-12-26 14:39:18]    INFO >> epoch 009:      8 / 49 loss=81.628, nll_loss=6.177, bleu=0, ppl=72.35, wps=11515.8, ups=1.71, wpb=6723.6, bsz=508.8, num_updates=400, lr=0.00034725, gnorm=7.381, clip=0, loss_scale=128, train_wall=25, wall=242 (progress_bar.py:262, log())
[2020-12-26 14:39:39]    INFO >> epoch 009 | loss 79.046 | nll_loss 5.997 | bleu 0 | ppl 63.87 | wps 11336 | ups 1.69 | wpb 6705.2 | bsz 508.7 | num_updates 441 | lr 0.00034725 | gnorm 7.892 | clip 0 | loss_scale 128 | train_wall 24 | wall 263 (progress_bar.py:269, print())
[2020-12-26 14:39:41]    INFO >> epoch 009 | valid on 'valid' subset | loss 86.849 | nll_loss 6.502 | bleu 9.331971183803033 | ppl 90.62 | wps 0 | wpb 18701 | bsz 1400 | num_updates 441 | best_bleu 9.331971183803033 (progress_bar.py:269, print())
[2020-12-26 14:39:42]    INFO >> saved checkpoint /home/wanyao/.ncc/code_search_net_feng/sum_bin_ast/ruby/data-mmap/nary_tree2seq/checkpoints/checkpoint_best.pt (epoch 9 @ 441 updates, score 9.331971183803033) (writing took 0.9841398503631353 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2020-12-26 14:39:47]    INFO >> epoch 010:      9 / 49 loss=78.444, nll_loss=5.957, bleu=0, ppl=62.13, wps=11549.2, ups=1.72, wpb=6699.5, bsz=508.8, num_updates=450, lr=0.000340305, gnorm=7.969, clip=0, loss_scale=128, train_wall=24, wall=271 (progress_bar.py:262, log())
[2020-12-26 14:40:08]    INFO >> epoch 010 | loss 76.423 | nll_loss 5.798 | bleu 0 | ppl 55.64 | wps 11491.1 | ups 1.71 | wpb 6705.2 | bsz 508.7 | num_updates 490 | lr 0.000340305 | gnorm 8.211 | clip 0 | loss_scale 128 | train_wall 24 | wall 292 (progress_bar.py:269, print())
[2020-12-26 14:40:10]    INFO >> epoch 010 | valid on 'valid' subset | loss 86.482 | nll_loss 6.474 | bleu 9.322929381185945 | ppl 88.91 | wps 0 | wpb 18701 | bsz 1400 | num_updates 490 | best_bleu 9.331971183803033 (progress_bar.py:269, print())
[2020-12-26 14:40:10]    INFO >> saved checkpoint /home/wanyao/.ncc/code_search_net_feng/sum_bin_ast/ruby/data-mmap/nary_tree2seq/checkpoints/checkpoint_last.pt (epoch 10 @ 490 updates, score 9.322929381185945) (writing took 0.5727297374978662 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2020-12-26 14:40:15]    INFO >> epoch 011:     10 / 49 loss=75.858, nll_loss=5.758, bleu=0, ppl=54.11, wps=11647.7, ups=1.74, wpb=6703.1, bsz=508.8, num_updates=500, lr=0.000333499, gnorm=8.388, clip=0, loss_scale=128, train_wall=25, wall=300 (progress_bar.py:262, log())
[2020-12-26 14:40:36]    INFO >> epoch 011 | loss 74.001 | nll_loss 5.614 | bleu 0 | ppl 48.99 | wps 11820.4 | ups 1.76 | wpb 6705.2 | bsz 508.7 | num_updates 539 | lr 0.000333499 | gnorm 9.218 | clip 0 | loss_scale 128 | train_wall 24 | wall 320 (progress_bar.py:269, print())
[2020-12-26 14:40:37]    INFO >> epoch 011 | valid on 'valid' subset | loss 86.152 | nll_loss 6.45 | bleu 9.343660320468956 | ppl 87.4 | wps 0 | wpb 18701 | bsz 1400 | num_updates 539 | best_bleu 9.343660320468956 (progress_bar.py:269, print())
[2020-12-26 14:40:38]    INFO >> saved checkpoint /home/wanyao/.ncc/code_search_net_feng/sum_bin_ast/ruby/data-mmap/nary_tree2seq/checkpoints/checkpoint_best.pt (epoch 11 @ 539 updates, score 9.343660320468956) (writing took 0.9873187309131026 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2020-12-26 14:40:44]    INFO >> epoch 012:     11 / 49 loss=73.509, nll_loss=5.575, bleu=0, ppl=47.68, wps=11738.9, ups=1.75, wpb=6708.2, bsz=508.8, num_updates=550, lr=0.000326829, gnorm=9.336, clip=0, loss_scale=128, train_wall=24, wall=328 (progress_bar.py:262, log())
[2020-12-26 14:41:04]    INFO >> epoch 012 | loss 71.624 | nll_loss 5.434 | bleu 0 | ppl 43.23 | wps 11626.9 | ups 1.73 | wpb 6705.2 | bsz 508.7 | num_updates 588 | lr 0.000326829 | gnorm 9.659 | clip 0 | loss_scale 128 | train_wall 24 | wall 348 (progress_bar.py:269, print())
[2020-12-26 14:41:06]    INFO >> epoch 012 | valid on 'valid' subset | loss 86.02 | nll_loss 6.44 | bleu 9.2986640188846 | ppl 86.8 | wps 0 | wpb 18701 | bsz 1400 | num_updates 588 | best_bleu 9.343660320468956 (progress_bar.py:269, print())
[2020-12-26 14:41:06]    INFO >> saved checkpoint /home/wanyao/.ncc/code_search_net_feng/sum_bin_ast/ruby/data-mmap/nary_tree2seq/checkpoints/checkpoint_last.pt (epoch 12 @ 588 updates, score 9.2986640188846) (writing took 0.5785976648330688 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2020-12-26 14:41:13]    INFO >> epoch 013:     12 / 49 loss=71.148, nll_loss=5.394, bleu=0, ppl=42.06, wps=11603.2, ups=1.73, wpb=6702, bsz=508.1, num_updates=600, lr=0.000320293, gnorm=9.84, clip=0, loss_scale=128, train_wall=25, wall=357 (progress_bar.py:262, log())
[2020-12-26 14:41:33]    INFO >> epoch 013 | loss 69.374 | nll_loss 5.263 | bleu 0 | ppl 38.41 | wps 11346 | ups 1.69 | wpb 6705.2 | bsz 508.7 | num_updates 637 | lr 0.000320293 | gnorm 10.012 | clip 0 | loss_scale 128 | train_wall 25 | wall 377 (progress_bar.py:269, print())
[2020-12-26 14:41:35]    INFO >> epoch 013 | valid on 'valid' subset | loss 86.018 | nll_loss 6.439 | bleu 9.1514782475163 | ppl 86.79 | wps 0 | wpb 18701 | bsz 1400 | num_updates 637 | best_bleu 9.343660320468956 (progress_bar.py:269, print())
[2020-12-26 14:41:35]    INFO >> saved checkpoint /home/wanyao/.ncc/code_search_net_feng/sum_bin_ast/ruby/data-mmap/nary_tree2seq/checkpoints/checkpoint_last.pt (epoch 13 @ 637 updates, score 9.1514782475163) (writing took 0.5761320386081934 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2020-12-26 14:41:42]    INFO >> epoch 014:     13 / 49 loss=69.088, nll_loss=5.227, bleu=0, ppl=37.46, wps=11381.7, ups=1.69, wpb=6733.1, bsz=509.4, num_updates=650, lr=0.000313887, gnorm=10.094, clip=0, loss_scale=128, train_wall=25, wall=387 (progress_bar.py:262, log())
[2020-12-26 14:42:01]    INFO >> epoch 014 | loss 67.226 | nll_loss 5.1 | bleu 0 | ppl 34.3 | wps 11634.8 | ups 1.74 | wpb 6705.2 | bsz 508.7 | num_updates 686 | lr 0.000313887 | gnorm 10.581 | clip 0 | loss_scale 128 | train_wall 24 | wall 405 (progress_bar.py:269, print())
[2020-12-26 14:42:03]    INFO >> epoch 014 | valid on 'valid' subset | loss 86.317 | nll_loss 6.462 | bleu 9.216857835911568 | ppl 88.15 | wps 0 | wpb 18701 | bsz 1400 | num_updates 686 | best_bleu 9.343660320468956 (progress_bar.py:269, print())
[2020-12-26 14:42:03]    INFO >> saved checkpoint /home/wanyao/.ncc/code_search_net_feng/sum_bin_ast/ruby/data-mmap/nary_tree2seq/checkpoints/checkpoint_last.pt (epoch 14 @ 686 updates, score 9.216857835911568) (writing took 0.5746687948703766 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2020-12-26 14:42:11]    INFO >> epoch 015:     14 / 49 loss=66.417, nll_loss=5.048, bleu=0, ppl=33.09, wps=11788.8, ups=1.76, wpb=6685.1, bsz=508.1, num_updates=700, lr=0.000307609, gnorm=10.788, clip=0, loss_scale=128, train_wall=24, wall=415 (progress_bar.py:262, log())
[2020-12-26 14:42:29]    INFO >> epoch 015 | loss 65.155 | nll_loss 4.943 | bleu 0 | ppl 30.76 | wps 11648.7 | ups 1.74 | wpb 6705.2 | bsz 508.7 | num_updates 735 | lr 0.000307609 | gnorm 11.159 | clip 0 | loss_scale 128 | train_wall 24 | wall 433 (progress_bar.py:269, print())
[2020-12-26 14:42:31]    INFO >> epoch 015 | valid on 'valid' subset | loss 86.359 | nll_loss 6.465 | bleu 9.050070130303343 | ppl 88.34 | wps 0 | wpb 18701 | bsz 1400 | num_updates 735 | best_bleu 9.343660320468956 (progress_bar.py:269, print())
[2020-12-26 14:42:32]    INFO >> saved checkpoint /home/wanyao/.ncc/code_search_net_feng/sum_bin_ast/ruby/data-mmap/nary_tree2seq/checkpoints/checkpoint_last.pt (epoch 15 @ 735 updates, score 9.050070130303343) (writing took 0.6379811661317945 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2020-12-26 14:42:39]    INFO >> epoch 016:     15 / 49 loss=64.472, nll_loss=4.897, bleu=0, ppl=29.8, wps=11688.3, ups=1.74, wpb=6706.8, bsz=509.4, num_updates=750, lr=0.000301457, gnorm=11.132, clip=0, loss_scale=128, train_wall=24, wall=444 (progress_bar.py:262, log())
[2020-12-26 14:42:57]    INFO >> epoch 016 | loss 63.22 | nll_loss 4.796 | bleu 0 | ppl 27.79 | wps 11687.4 | ups 1.74 | wpb 6705.2 | bsz 508.7 | num_updates 784 | lr 0.000301457 | gnorm 11.472 | clip 0 | loss_scale 128 | train_wall 24 | wall 462 (progress_bar.py:269, print())
[2020-12-26 14:42:59]    INFO >> epoch 016 | valid on 'valid' subset | loss 86.882 | nll_loss 6.504 | bleu 9.224849710190028 | ppl 90.77 | wps 0 | wpb 18701 | bsz 1400 | num_updates 784 | best_bleu 9.343660320468956 (progress_bar.py:269, print())
[2020-12-26 14:43:00]    INFO >> saved checkpoint /home/wanyao/.ncc/code_search_net_feng/sum_bin_ast/ruby/data-mmap/nary_tree2seq/checkpoints/checkpoint_last.pt (epoch 16 @ 784 updates, score 9.224849710190028) (writing took 0.5847829580307007 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2020-12-26 14:43:08]    INFO >> epoch 017:     16 / 49 loss=62.464, nll_loss=4.748, bleu=0, ppl=26.87, wps=11510.3, ups=1.72, wpb=6685.2, bsz=508.1, num_updates=800, lr=0.000295428, gnorm=11.804, clip=0, loss_scale=128, train_wall=25, wall=473 (progress_bar.py:262, log())
[2020-12-26 14:43:26]    INFO >> epoch 017 | loss 61.405 | nll_loss 4.659 | bleu 0 | ppl 25.26 | wps 11376.6 | ups 1.7 | wpb 6705.2 | bsz 508.7 | num_updates 833 | lr 0.000295428 | gnorm 12.581 | clip 0 | loss_scale 128 | train_wall 25 | wall 490 (progress_bar.py:269, print())
[2020-12-26 14:43:28]    INFO >> epoch 017 | valid on 'valid' subset | loss 87.241 | nll_loss 6.531 | bleu 9.155013762111135 | ppl 92.48 | wps 0 | wpb 18701 | bsz 1400 | num_updates 833 | best_bleu 9.343660320468956 (progress_bar.py:269, print())
[2020-12-26 14:43:29]    INFO >> saved checkpoint /home/wanyao/.ncc/code_search_net_feng/sum_bin_ast/ruby/data-mmap/nary_tree2seq/checkpoints/checkpoint_last.pt (epoch 17 @ 833 updates, score 9.155013762111135) (writing took 0.5757287405431271 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2020-12-26 14:43:38]    INFO >> epoch 018:     17 / 49 loss=61.107, nll_loss=4.618, bleu=0, ppl=24.56, wps=11474, ups=1.7, wpb=6732.2, bsz=508.8, num_updates=850, lr=0.000289519, gnorm=12.632, clip=0, loss_scale=128, train_wall=25, wall=502 (progress_bar.py:262, log())
[2020-12-26 14:43:55]    INFO >> epoch 018 | loss 59.583 | nll_loss 4.52 | bleu 0 | ppl 22.95 | wps 11426.5 | ups 1.7 | wpb 6705.2 | bsz 508.7 | num_updates 882 | lr 0.000289519 | gnorm 12.71 | clip 0 | loss_scale 128 | train_wall 25 | wall 519 (progress_bar.py:269, print())
[2020-12-26 14:43:57]    INFO >> epoch 018 | valid on 'valid' subset | loss 87.467 | nll_loss 6.548 | bleu 9.202868004410675 | ppl 93.57 | wps 0 | wpb 18701 | bsz 1400 | num_updates 882 | best_bleu 9.343660320468956 (progress_bar.py:269, print())
[2020-12-26 14:43:57]    INFO >> saved checkpoint /home/wanyao/.ncc/code_search_net_feng/sum_bin_ast/ruby/data-mmap/nary_tree2seq/checkpoints/checkpoint_last.pt (epoch 18 @ 882 updates, score 9.202868004410675) (writing took 0.5710163228213787 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2020-12-26 14:44:07]    INFO >> epoch 019:     18 / 49 loss=58.692, nll_loss=4.46, bleu=0, ppl=22, wps=11510, ups=1.72, wpb=6704.5, bsz=509.4, num_updates=900, lr=0.000283729, gnorm=12.695, clip=0, loss_scale=128, train_wall=25, wall=531 (progress_bar.py:262, log())
[2020-12-26 14:44:23]    INFO >> epoch 019 | loss 57.8 | nll_loss 4.385 | bleu 0 | ppl 20.9 | wps 11667.9 | ups 1.74 | wpb 6705.2 | bsz 508.7 | num_updates 931 | lr 0.000283729 | gnorm 13.025 | clip 0 | loss_scale 128 | train_wall 24 | wall 547 (progress_bar.py:269, print())
[2020-12-26 14:44:25]    INFO >> epoch 019 | valid on 'valid' subset | loss 87.991 | nll_loss 6.587 | bleu 9.172231649318794 | ppl 96.15 | wps 0 | wpb 18701 | bsz 1400 | num_updates 931 | best_bleu 9.343660320468956 (progress_bar.py:269, print())
[2020-12-26 14:44:26]    INFO >> saved checkpoint /home/wanyao/.ncc/code_search_net_feng/sum_bin_ast/ruby/data-mmap/nary_tree2seq/checkpoints/checkpoint_last.pt (epoch 19 @ 931 updates, score 9.172231649318794) (writing took 0.6585835097357631 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2020-12-26 14:44:36]    INFO >> epoch 020:     19 / 49 loss=57.522, nll_loss=4.35, bleu=0, ppl=20.39, wps=11715.6, ups=1.74, wpb=6719.7, bsz=508.1, num_updates=950, lr=0.000278054, gnorm=13.425, clip=0, loss_scale=128, train_wall=24, wall=560 (progress_bar.py:262, log())
[2020-12-26 14:44:51]    INFO >> epoch 020 | loss 56.236 | nll_loss 4.266 | bleu 0 | ppl 19.25 | wps 11570.4 | ups 1.73 | wpb 6705.2 | bsz 508.7 | num_updates 980 | lr 0.000278054 | gnorm 13.655 | clip 0 | loss_scale 128 | train_wall 24 | wall 576 (progress_bar.py:269, print())
[2020-12-26 14:44:53]    INFO >> epoch 020 | valid on 'valid' subset | loss 88.733 | nll_loss 6.643 | bleu 9.242212060904073 | ppl 99.92 | wps 0 | wpb 18701 | bsz 1400 | num_updates 980 | best_bleu 9.343660320468956 (progress_bar.py:269, print())
[2020-12-26 14:44:54]    INFO >> saved checkpoint /home/wanyao/.ncc/code_search_net_feng/sum_bin_ast/ruby/data-mmap/nary_tree2seq/checkpoints/checkpoint_last.pt (epoch 20 @ 980 updates, score 9.242212060904073) (writing took 0.5837516253814101 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2020-12-26 14:45:04]    INFO >> epoch 021:     20 / 49 loss=55.237, nll_loss=4.212, bleu=0, ppl=18.53, wps=11630.5, ups=1.74, wpb=6673, bsz=508.8, num_updates=1000, lr=0.000272493, gnorm=14.266, clip=0, loss_scale=128, train_wall=24, wall=589 (progress_bar.py:262, log())
[2020-12-26 14:45:20]    INFO >> epoch 021 | loss 54.622 | nll_loss 4.144 | bleu 0 | ppl 17.68 | wps 11695.3 | ups 1.74 | wpb 6705.2 | bsz 508.7 | num_updates 1029 | lr 0.000272493 | gnorm 14.768 | clip 0 | loss_scale 128 | train_wall 24 | wall 604 (progress_bar.py:269, print())
[2020-12-26 14:45:21]    INFO >> epoch 021 | valid on 'valid' subset | loss 89.219 | nll_loss 6.679 | bleu 9.087204026175886 | ppl 102.47 | wps 0 | wpb 18701 | bsz 1400 | num_updates 1029 | best_bleu 9.343660320468956 (progress_bar.py:269, print())
[2020-12-26 14:45:22]    INFO >> saved checkpoint /home/wanyao/.ncc/code_search_net_feng/sum_bin_ast/ruby/data-mmap/nary_tree2seq/checkpoints/checkpoint_last.pt (epoch 21 @ 1029 updates, score 9.087204026175886) (writing took 0.6211437387391925 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2020-12-26 14:45:22]    INFO >> early stop since valid performance hasn't improved for last 10 runs (train.py:185, should_stop_early())
[2020-12-26 14:45:22]    INFO >> early stop since valid performance hasn't improved for last 10 runs (train.py:268, single_main())
[2020-12-26 14:45:22]    INFO >> done training in 601.3 seconds (train.py:279, single_main())
