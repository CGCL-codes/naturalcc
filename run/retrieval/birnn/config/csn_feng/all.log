nohup: 忽略输入
[2021-04-20 03:39:25]    INFO >> Load arguments in /home/yanghe/Documents/naturalcc-dev/run/retrieval/birnn/config/csn_feng/all.yml (train.py:302, cli_main())
[2021-04-20 03:39:25]    INFO >> {'criterion': 'retrieval_softmax', 'optimizer': 'torch_adam', 'lr_scheduler': 'fixed', 'tokenizer': None, 'bpe': None, 'common': {'no_progress_bar': 0, 'log_interval': 500, 'log_format': 'simple', 'tensorboard_logdir': '', 'seed': 0, 'cpu': 0, 'fp16': 0, 'memory_efficient_fp16': 0, 'fp16_no_flatten_grads': 0, 'fp16_init_scale': 128, 'fp16_scale_window': None, 'fp16_scale_tolerance': 0.0, 'min_loss_scale': 0.0001, 'threshold_loss_scale': None, 'user_dir': None, 'empty_cache_freq': 0, 'all_gather_list_size': 16384, 'task': 'hybrid_retrieval'}, 'dataset': {'num_workers': 1, 'skip_invalid_size_inputs_valid_test': 0, 'max_tokens': None, 'max_sentences': 1000, 'code_max_tokens': 200, 'query_max_tokens': 30, 'required_batch_size_multiple': 8, 'dataset_impl': 'mmap', 'train_subset': 'train', 'valid_subset': 'valid', 'validate_interval': 1, 'fixed_validation_seed': None, 'disable_validation': None, 'max_tokens_valid': None, 'max_sentences_valid': 1000, 'curriculum': 0, 'gen_subset': 'test', 'num_shards': 1, 'shard_id': 0, 'joined_dictionary': 0, 'langs': ['go', 'java', 'javascript', 'ruby', 'python', 'php']}, 'distributed_training': {'distributed_world_size': 1, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': None, 'distributed_port': -1, 'device_id': 0, 'distributed_no_spawn': 0, 'ddp_backend': 'c10d', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': None, 'find_unused_parameters': 0, 'fast_stat_sync': 0, 'broadcast_buffers': 0, 'global_sync_iter': 50, 'warmup_iterations': 500, 'local_rank': -1, 'block_momentum': 0.875, 'block_lr': 1, 'use_nbm': 0, 'average_sync': 0}, 'task': {'data': '/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all', 'sample_break_mode': 'complete', 'tokens_per_sample': 512, 'mask_prob': 0.15, 'leave_unmasked_prob': 0.1, 'random_token_prob': 0.1, 'freq_weighted_replacement': 0, 'mask_whole_words': 0, 'pooler_activation_fn': 'tanh', 'source_lang': 'code_tokens', 'target_lang': 'docstring_tokens', 'source_aux_lang': 'code_tokens.wo_func', 'target_aux_lang': 'func_name', 'fraction_using_func_name': 0.3, 'load_alignments': 0, 'left_pad_source': 1, 'left_pad_target': 0, 'upsample_primary': 1, 'truncate_source': 0, 'eval_mrr': 1}, 'model': {'arch': 'birnn', 'code_embed_dim': 128, 'code_doprout': 0.1, 'code_rnn_cell': 'lstm', 'code_rnn_layers': 2, 'code_hidden_dim': 64, 'code_rnn_dropout': 0.2, 'code_rnn_bidirectional': True, 'code_pooling': 'weighted_mean', 'code_activation_fn': 'tanh', 'code_paddding': 'same', 'query_embed_dim': 128, 'query_doprout': 0.1, 'query_rnn_cell': 'lstm', 'query_rnn_layers': 2, 'query_hidden_dim': 64, 'query_rnn_dropout': 0.2, 'query_rnn_bidirectional': True, 'query_pooling': 'weighted_mean', 'query_activation_fn': 'tanh', 'query_paddding': 'same', 'dropout': 0.1}, 'optimization': {'max_epoch': 300, 'max_update': 0, 'clip_norm': 1, 'sentence_avg': 0, 'update_freq': [1], 'lrs': [0.01], 'min_lr': -1, 'use_bmuf': 0, 'lr_shrink': 1.0, 'force_anneal': 0, 'warmup_updates': 0, 'end_learning_rate': 0.0, 'power': 1.0, 'total_num_update': 1000000, 'adam': {'adam_betas': '(0.9, 0.999)', 'adam_eps': 1e-08, 'weight_decay': 0, 'use_old_adam': 1}, 'margin': 1, 'clip_norm_version': 'tf_clip_by_global_norm'}, 'checkpoint': {'save_dir': '/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/birnn/checkpoints', 'restore_file': 'checkpoint_last.pt', 'reset_dataloader': None, 'reset_lr_scheduler': None, 'reset_meters': None, 'reset_optimizer': None, 'optimizer_overrides': '{}', 'save_interval': 1, 'save_interval_updates': 0, 'keep_interval_updates': 0, 'keep_last_epochs': -1, 'keep_best_checkpoints': -1, 'no_save': 0, 'no_epoch_checkpoints': 1, 'no_last_checkpoints': 0, 'no_save_optimizer_state': None, 'best_checkpoint_metric': 'mrr', 'maximize_best_checkpoint_metric': 1, 'patience': 10}, 'eval': {'path': '/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/birnn/checkpoints/checkpoint_best.pt', 'quiet': 1, 'max_sentences': 1000, 'model_overrides': '{}', 'eval_size': 1000}} (train.py:304, cli_main())
[2021-04-20 03:39:25]    INFO >> single GPU training... (train.py:333, cli_main())
[2021-04-20 03:39:25]    INFO >> loaded 44689 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/valid.go.code_tokens', '/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/valid.java.code_tokens', '/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/valid.javascript.code_tokens', '/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/valid.ruby.code_tokens', '/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/valid.python.code_tokens', '/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/valid.php.code_tokens'] (hybrid_retrieval.py:54, load_tokens_dataset())
[2021-04-20 03:39:25]    INFO >> loaded 44689 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/valid.go.docstring_tokens', '/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/valid.java.docstring_tokens', '/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/valid.javascript.docstring_tokens', '/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/valid.ruby.docstring_tokens', '/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/valid.python.docstring_tokens', '/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/valid.php.docstring_tokens'] (hybrid_retrieval.py:55, load_tokens_dataset())
[2021-04-20 03:39:26]    INFO >> BiRNN(
  (src_encoders): ModuleDict(
    (go): RNNEncoder(
      (embed): Embedding(10000, 128)
      (weight_layer): Linear(in_features=128, out_features=1, bias=False)
      (rnn): LSTM(128, 64, num_layers=2, batch_first=True, dropout=0.2, bidirectional=True)
    )
    (java): RNNEncoder(
      (embed): Embedding(10000, 128)
      (weight_layer): Linear(in_features=128, out_features=1, bias=False)
      (rnn): LSTM(128, 64, num_layers=2, batch_first=True, dropout=0.2, bidirectional=True)
    )
    (javascript): RNNEncoder(
      (embed): Embedding(10000, 128)
      (weight_layer): Linear(in_features=128, out_features=1, bias=False)
      (rnn): LSTM(128, 64, num_layers=2, batch_first=True, dropout=0.2, bidirectional=True)
    )
    (ruby): RNNEncoder(
      (embed): Embedding(10000, 128)
      (weight_layer): Linear(in_features=128, out_features=1, bias=False)
      (rnn): LSTM(128, 64, num_layers=2, batch_first=True, dropout=0.2, bidirectional=True)
    )
    (python): RNNEncoder(
      (embed): Embedding(10000, 128)
      (weight_layer): Linear(in_features=128, out_features=1, bias=False)
      (rnn): LSTM(128, 64, num_layers=2, batch_first=True, dropout=0.2, bidirectional=True)
    )
    (php): RNNEncoder(
      (embed): Embedding(10000, 128)
      (weight_layer): Linear(in_features=128, out_features=1, bias=False)
      (rnn): LSTM(128, 64, num_layers=2, batch_first=True, dropout=0.2, bidirectional=True)
    )
  )
  (tgt_encoders): RNNEncoder(
    (embed): Embedding(10000, 128)
    (weight_layer): Linear(in_features=128, out_features=1, bias=False)
    (rnn): LSTM(128, 64, num_layers=2, batch_first=True, dropout=0.2, bidirectional=True)
  )
) (train.py:223, single_main())
[2021-04-20 03:39:26]    INFO >> model birnn, criterion SearchSoftmaxCriterion (train.py:224, single_main())
[2021-04-20 03:39:26]    INFO >> num. model params: 10351488 (num. trained: 10351488) (train.py:227, single_main())
[2021-04-20 03:39:28]    INFO >> training on 1 GPUs (train.py:233, single_main())
[2021-04-20 03:39:28]    INFO >> max tokens per GPU = None and max sentences per GPU = 1000 (train.py:236, single_main())
[2021-04-20 03:39:28]    INFO >> no existing checkpoint found /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/birnn/checkpoints/checkpoint_last.pt (ncc_trainers.py:270, load_checkpoint())
[2021-04-20 03:39:28]    INFO >> loading train data for epoch 1 (ncc_trainers.py:285, get_train_iterator())
[2021-04-20 03:39:28]    INFO >> loaded 908224 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.go.code_tokens', '/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.java.code_tokens', '/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.javascript.code_tokens', '/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.ruby.code_tokens', '/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.python.code_tokens', '/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.php.code_tokens'] (hybrid_retrieval.py:54, load_tokens_dataset())
[2021-04-20 03:39:28]    INFO >> loaded 908224 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.go.docstring_tokens', '/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.java.docstring_tokens', '/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.javascript.docstring_tokens', '/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.ruby.docstring_tokens', '/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.python.docstring_tokens', '/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.php.docstring_tokens'] (hybrid_retrieval.py:55, load_tokens_dataset())
[2021-04-20 03:39:29]    INFO >> loaded 908224 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.go.code_tokens.wo_func', '/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.java.code_tokens.wo_func', '/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.javascript.code_tokens.wo_func', '/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.ruby.code_tokens.wo_func', '/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.python.code_tokens.wo_func', '/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.php.code_tokens.wo_func'] (hybrid_retrieval.py:67, load_tokens_dataset())
[2021-04-20 03:39:29]    INFO >> loaded 908224 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.go.func_name', '/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.java.func_name', '/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.javascript.func_name', '/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.ruby.func_name', '/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.python.func_name', '/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.php.func_name'] (hybrid_retrieval.py:81, load_tokens_dataset())
[2021-04-20 03:39:30]    INFO >> NOTE: your device may support faster training with fp16 (ncc_trainers.py:155, _setup_optimizer())
[2021-04-20 03:44:09]    INFO >> epoch 001:    500 / 909 loss=4.718, mrr=228.657, sample_size=1000, wps=1804.7, ups=1.8, wpb=1000, bsz=1000, num_updates=500, lr=0.01, gnorm=0.247, clip=0.2, train_wall=272, wall=281 (progress_bar.py:262, log())
[2021-04-20 03:47:55]    INFO >> epoch 001 | loss 3.831 | mrr 0.365145 | sample_size 1000 | wps 1807.9 | ups 1.81 | wpb 1000 | bsz 1000 | num_updates 908 | lr 0.01 | gnorm 0.232 | clip 0.1 | train_wall 493 | wall 506 (progress_bar.py:269, print())
[2021-04-20 03:48:00]    INFO >> epoch 001 | valid on 'valid' subset | loss 3.506 | mrr 0.409414 | sample_size 1000 | wps 15002.2 | wpb 1000 | bsz 1000 | num_updates 908 (progress_bar.py:269, print())
[2021-04-20 03:48:01]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/birnn/checkpoints/checkpoint_best.pt (epoch 1 @ 908 updates, score 0.409414) (writing took 0.902371 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 03:48:54]    INFO >> epoch 002:     92 / 909 loss=2.671, mrr=544.624, sample_size=1000, wps=1757.3, ups=1.76, wpb=1000, bsz=1000, num_updates=1000, lr=0.01, gnorm=0.213, clip=0, train_wall=270, wall=566 (progress_bar.py:262, log())
[2021-04-20 03:53:30]    INFO >> epoch 002:    593 / 909 loss=2.19, mrr=625.351, sample_size=1000, wps=1807.6, ups=1.81, wpb=1000, bsz=1000, num_updates=1500, lr=0.01, gnorm=0.205, clip=0, train_wall=272, wall=842 (progress_bar.py:262, log())
[2021-04-20 03:56:26]    INFO >> epoch 002 | loss 2.148 | mrr 0.632909 | sample_size 1000 | wps 1776.7 | ups 1.78 | wpb 1000 | bsz 1000 | num_updates 1816 | lr 0.01 | gnorm 0.204 | clip 0 | train_wall 493 | wall 1017 (progress_bar.py:269, print())
[2021-04-20 03:56:31]    INFO >> epoch 002 | valid on 'valid' subset | loss 2.983 | mrr 0.490935 | sample_size 1000 | wps 16067.1 | wpb 1000 | bsz 1000 | num_updates 1816 | best_mrr 490.935 (progress_bar.py:269, print())
[2021-04-20 03:56:33]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/birnn/checkpoints/checkpoint_best.pt (epoch 2 @ 1816 updates, score 0.490935) (writing took 1.061711 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 03:58:17]    INFO >> epoch 003:    184 / 909 loss=1.964, mrr=664.189, sample_size=1000, wps=1748, ups=1.75, wpb=1000, bsz=1000, num_updates=2000, lr=0.01, gnorm=0.2, clip=0, train_wall=271, wall=1128 (progress_bar.py:262, log())
[2021-04-20 04:02:29]    INFO >> epoch 003:    685 / 909 loss=1.837, mrr=685.936, sample_size=1000, wps=1978.3, ups=1.98, wpb=1000, bsz=1000, num_updates=2500, lr=0.01, gnorm=0.199, clip=0, train_wall=248, wall=1381 (progress_bar.py:262, log())
[2021-04-20 04:04:20]    INFO >> epoch 003 | loss 1.833 | mrr 0.68639 | sample_size 1000 | wps 1915.3 | ups 1.92 | wpb 1000 | bsz 1000 | num_updates 2724 | lr 0.01 | gnorm 0.199 | clip 0 | train_wall 455 | wall 1491 (progress_bar.py:269, print())
[2021-04-20 04:04:25]    INFO >> epoch 003 | valid on 'valid' subset | loss 2.809 | mrr 0.517879 | sample_size 1000 | wps 16194.4 | wpb 1000 | bsz 1000 | num_updates 2724 | best_mrr 517.879 (progress_bar.py:269, print())
[2021-04-20 04:04:26]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/birnn/checkpoints/checkpoint_best.pt (epoch 3 @ 2724 updates, score 0.517879) (writing took 1.005421 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:06:44]    INFO >> epoch 004:    276 / 909 loss=1.746, mrr=701.145, sample_size=1000, wps=1960.5, ups=1.96, wpb=1000, bsz=1000, num_updates=3000, lr=0.01, gnorm=0.199, clip=0, train_wall=241, wall=1636 (progress_bar.py:262, log())
[2021-04-20 04:10:56]    INFO >> epoch 004:    777 / 909 loss=1.7, mrr=708.572, sample_size=1000, wps=1987.5, ups=1.99, wpb=1000, bsz=1000, num_updates=3500, lr=0.01, gnorm=0.198, clip=0, train_wall=247, wall=1888 (progress_bar.py:262, log())
[2021-04-20 04:12:01]    INFO >> epoch 004 | loss 1.699 | mrr 0.708777 | sample_size 1000 | wps 1968.4 | ups 1.97 | wpb 1000 | bsz 1000 | num_updates 3632 | lr 0.01 | gnorm 0.198 | clip 0 | train_wall 443 | wall 1953 (progress_bar.py:269, print())
[2021-04-20 04:12:06]    INFO >> epoch 004 | valid on 'valid' subset | loss 2.715 | mrr 0.536051 | sample_size 1000 | wps 16504.3 | wpb 1000 | bsz 1000 | num_updates 3632 | best_mrr 536.051 (progress_bar.py:269, print())
[2021-04-20 04:12:07]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/birnn/checkpoints/checkpoint_best.pt (epoch 4 @ 3632 updates, score 0.536051) (writing took 0.925084 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:15:34]    INFO >> epoch 005:    369 / 909 loss=1.64, mrr=718.613, sample_size=1000, wps=1798.4, ups=1.8, wpb=1000, bsz=1000, num_updates=4000, lr=0.01, gnorm=0.199, clip=0, train_wall=264, wall=2166 (progress_bar.py:262, log())
[2021-04-20 04:22:10]    INFO >> epoch 005:    869 / 909 loss=1.627, mrr=721.566, sample_size=1000, wps=1263.8, ups=1.26, wpb=1000, bsz=1000, num_updates=4500, lr=0.01, gnorm=0.199, clip=0, train_wall=390, wall=2561 (progress_bar.py:262, log())
[2021-04-20 04:22:32]    INFO >> epoch 005 | loss 1.624 | mrr 0.721622 | sample_size 1000 | wps 1439.8 | ups 1.44 | wpb 1000 | bsz 1000 | num_updates 4540 | lr 0.01 | gnorm 0.199 | clip 0 | train_wall 613 | wall 2583 (progress_bar.py:269, print())
[2021-04-20 04:22:36]    INFO >> epoch 005 | valid on 'valid' subset | loss 2.666 | mrr 0.544341 | sample_size 1000 | wps 16753.9 | wpb 1000 | bsz 1000 | num_updates 4540 | best_mrr 544.341 (progress_bar.py:269, print())
[2021-04-20 04:22:38]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/birnn/checkpoints/checkpoint_best.pt (epoch 5 @ 4540 updates, score 0.544341) (writing took 1.196496 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:26:28]    INFO >> epoch 006:    460 / 909 loss=1.57, mrr=730.553, sample_size=1000, wps=1937.6, ups=1.94, wpb=1000, bsz=1000, num_updates=5000, lr=0.01, gnorm=0.2, clip=0, train_wall=244, wall=2819 (progress_bar.py:262, log())
[2021-04-20 04:31:10]    INFO >> epoch 006 | loss 1.578 | mrr 0.729353 | sample_size 1000 | wps 1750.5 | ups 1.75 | wpb 1000 | bsz 1000 | num_updates 5448 | lr 0.01 | gnorm 0.201 | clip 0 | train_wall 501 | wall 3102 (progress_bar.py:269, print())
[2021-04-20 04:31:20]    INFO >> epoch 006 | valid on 'valid' subset | loss 2.626 | mrr 0.550046 | sample_size 1000 | wps 6214.7 | wpb 1000 | bsz 1000 | num_updates 5448 | best_mrr 550.046 (progress_bar.py:269, print())
[2021-04-20 04:31:20]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/birnn/checkpoints/checkpoint_best.pt (epoch 6 @ 5448 updates, score 0.550046) (writing took 0.842587 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:32:37]    INFO >> epoch 007:     53 / 909 loss=1.581, mrr=729.027, sample_size=1000, wps=1354.6, ups=1.35, wpb=1000, bsz=1000, num_updates=5500, lr=0.01, gnorm=0.202, clip=0, train_wall=351, wall=3189 (progress_bar.py:262, log())
[2021-04-20 04:44:31]    INFO >> epoch 007:    553 / 909 loss=1.548, mrr=734.489, sample_size=1000, wps=700.2, ups=0.7, wpb=1000, bsz=1000, num_updates=6000, lr=0.01, gnorm=0.204, clip=0, train_wall=709, wall=3903 (progress_bar.py:262, log())
[2021-04-20 04:53:03]    INFO >> epoch 007 | loss 1.549 | mrr 0.734306 | sample_size 1000 | wps 691.9 | ups 0.69 | wpb 1000 | bsz 1000 | num_updates 6356 | lr 0.01 | gnorm 0.203 | clip 0 | train_wall 1290 | wall 4415 (progress_bar.py:269, print())
[2021-04-20 04:53:10]    INFO >> epoch 007 | valid on 'valid' subset | loss 2.591 | mrr 0.555093 | sample_size 1000 | wps 8564.4 | wpb 1000 | bsz 1000 | num_updates 6356 | best_mrr 555.093 (progress_bar.py:269, print())
[2021-04-20 04:53:11]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/birnn/checkpoints/checkpoint_best.pt (epoch 7 @ 6356 updates, score 0.555093) (writing took 1.120659 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:56:42]    INFO >> epoch 008:    145 / 909 loss=1.541, mrr=735.735, sample_size=1000, wps=683.9, ups=0.68, wpb=1000, bsz=1000, num_updates=6500, lr=0.01, gnorm=0.203, clip=0, train_wall=715, wall=4634 (progress_bar.py:262, log())
[2021-04-20 05:05:25]    INFO >> epoch 008:    645 / 909 loss=1.53, mrr=737.529, sample_size=1000, wps=956.1, ups=0.96, wpb=1000, bsz=1000, num_updates=7000, lr=0.01, gnorm=0.215, clip=0.2, train_wall=518, wall=5157 (progress_bar.py:262, log())
[2021-04-20 05:11:29]    INFO >> epoch 008 | loss 1.531 | mrr 0.737409 | sample_size 1000 | wps 821.1 | ups 0.82 | wpb 1000 | bsz 1000 | num_updates 7264 | lr 0.01 | gnorm 0.211 | clip 0.1 | train_wall 1085 | wall 5520 (progress_bar.py:269, print())
[2021-04-20 05:11:38]    INFO >> epoch 008 | valid on 'valid' subset | loss 2.57 | mrr 0.558779 | sample_size 1000 | wps 6080.7 | wpb 1000 | bsz 1000 | num_updates 7264 | best_mrr 558.779 (progress_bar.py:269, print())
[2021-04-20 05:11:39]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/birnn/checkpoints/checkpoint_best.pt (epoch 8 @ 7264 updates, score 0.558779) (writing took 1.049736 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 05:17:30]    INFO >> epoch 009:    236 / 909 loss=1.526, mrr=738.107, sample_size=1000, wps=689.6, ups=0.69, wpb=1000, bsz=1000, num_updates=7500, lr=0.01, gnorm=0.207, clip=0, train_wall=707, wall=5882 (progress_bar.py:262, log())
[2021-04-20 05:29:48]    INFO >> epoch 009:    737 / 909 loss=1.525, mrr=738.267, sample_size=1000, wps=677.6, ups=0.68, wpb=1000, bsz=1000, num_updates=8000, lr=0.01, gnorm=0.208, clip=0, train_wall=733, wall=6620 (progress_bar.py:262, log())
[2021-04-20 05:34:04]    INFO >> epoch 009 | loss 1.519 | mrr 0.73921 | sample_size 1000 | wps 669.7 | ups 0.67 | wpb 1000 | bsz 1000 | num_updates 8172 | lr 0.01 | gnorm 0.208 | clip 0 | train_wall 1333 | wall 6876 (progress_bar.py:269, print())
[2021-04-20 05:34:15]    INFO >> epoch 009 | valid on 'valid' subset | loss 2.56 | mrr 0.559391 | sample_size 1000 | wps 6101.7 | wpb 1000 | bsz 1000 | num_updates 8172 | best_mrr 559.391 (progress_bar.py:269, print())
[2021-04-20 05:34:16]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/birnn/checkpoints/checkpoint_best.pt (epoch 9 @ 8172 updates, score 0.559391) (writing took 0.943617 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 05:42:21]    INFO >> epoch 010:    328 / 909 loss=1.508, mrr=740.97, sample_size=1000, wps=663.7, ups=0.66, wpb=1000, bsz=1000, num_updates=8500, lr=0.01, gnorm=0.211, clip=0, train_wall=734, wall=7373 (progress_bar.py:262, log())
[2021-04-20 05:54:34]    INFO >> epoch 010:    829 / 909 loss=1.522, mrr=738.757, sample_size=1000, wps=681.9, ups=0.68, wpb=1000, bsz=1000, num_updates=9000, lr=0.01, gnorm=0.212, clip=0, train_wall=728, wall=8106 (progress_bar.py:262, log())
[2021-04-20 05:56:33]    INFO >> epoch 010 | loss 1.514 | mrr 0.740089 | sample_size 1000 | wps 673.3 | ups 0.67 | wpb 1000 | bsz 1000 | num_updates 9080 | lr 0.01 | gnorm 0.212 | clip 0 | train_wall 1325 | wall 8225 (progress_bar.py:269, print())
[2021-04-20 05:56:41]    INFO >> epoch 010 | valid on 'valid' subset | loss 2.556 | mrr 0.560968 | sample_size 1000 | wps 6893.1 | wpb 1000 | bsz 1000 | num_updates 9080 | best_mrr 560.968 (progress_bar.py:269, print())
[2021-04-20 05:56:42]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/birnn/checkpoints/checkpoint_best.pt (epoch 10 @ 9080 updates, score 0.560968) (writing took 1.050657 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 06:05:32]    INFO >> epoch 011:    420 / 909 loss=1.506, mrr=741.949, sample_size=1000, wps=760.5, ups=0.76, wpb=1000, bsz=1000, num_updates=9500, lr=0.01, gnorm=0.216, clip=0, train_wall=640, wall=8764 (progress_bar.py:262, log())
[2021-04-20 06:13:10]    INFO >> epoch 011 | loss 1.512 | mrr 0.740632 | sample_size 1000 | wps 910.9 | ups 0.91 | wpb 1000 | bsz 1000 | num_updates 9988 | lr 0.01 | gnorm 0.238 | clip 0.1 | train_wall 975 | wall 9222 (progress_bar.py:269, print())
[2021-04-20 06:13:18]    INFO >> epoch 011 | valid on 'valid' subset | loss 2.545 | mrr 0.563296 | sample_size 1000 | wps 9473 | wpb 1000 | bsz 1000 | num_updates 9988 | best_mrr 563.296 (progress_bar.py:269, print())
[2021-04-20 06:13:18]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/birnn/checkpoints/checkpoint_best.pt (epoch 11 @ 9988 updates, score 0.563296) (writing took 0.910684 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 06:13:33]    INFO >> epoch 012:     12 / 909 loss=1.52, mrr=739.076, sample_size=1000, wps=1039.2, ups=1.04, wpb=1000, bsz=1000, num_updates=10000, lr=0.01, gnorm=0.255, clip=0.2, train_wall=464, wall=9245 (progress_bar.py:262, log())
[2021-04-20 06:21:23]    INFO >> epoch 012:    512 / 909 loss=1.505, mrr=742.02, sample_size=1000, wps=1063.3, ups=1.06, wpb=1000, bsz=1000, num_updates=10500, lr=0.01, gnorm=0.231, clip=0.2, train_wall=465, wall=9715 (progress_bar.py:262, log())
[2021-04-20 06:27:33]    INFO >> epoch 012 | loss 1.512 | mrr 0.740793 | sample_size 1000 | wps 1051.7 | ups 1.05 | wpb 1000 | bsz 1000 | num_updates 10896 | lr 0.01 | gnorm 0.228 | clip 0.2 | train_wall 842 | wall 10085 (progress_bar.py:269, print())
[2021-04-20 06:27:38]    INFO >> epoch 012 | valid on 'valid' subset | loss 2.553 | mrr 0.562126 | sample_size 1000 | wps 16374.9 | wpb 1000 | bsz 1000 | num_updates 10896 | best_mrr 562.126 (progress_bar.py:269, print())
[2021-04-20 06:27:39]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/birnn/checkpoints/checkpoint_last.pt (epoch 12 @ 10896 updates, score 0.562126) (writing took 0.478806 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 06:28:32]    INFO >> epoch 013:    104 / 909 loss=1.514, mrr=740.311, sample_size=1000, wps=1165.9, ups=1.17, wpb=1000, bsz=1000, num_updates=11000, lr=0.01, gnorm=0.226, clip=0.4, train_wall=416, wall=10144 (progress_bar.py:262, log())
[2021-04-20 06:32:38]    INFO >> epoch 013:    605 / 909 loss=1.508, mrr=741.511, sample_size=1000, wps=2031.5, ups=2.03, wpb=1000, bsz=1000, num_updates=11500, lr=0.01, gnorm=0.235, clip=0.2, train_wall=241, wall=10390 (progress_bar.py:262, log())
[2021-04-20 06:35:08]    INFO >> epoch 013 | loss 1.512 | mrr 0.740604 | sample_size 1000 | wps 1995.5 | ups 2 | wpb 1000 | bsz 1000 | num_updates 11804 | lr 0.01 | gnorm 0.232 | clip 0.2 | train_wall 438 | wall 10540 (progress_bar.py:269, print())
[2021-04-20 06:35:14]    INFO >> epoch 013 | valid on 'valid' subset | loss 2.553 | mrr 0.561402 | sample_size 1000 | wps 16585.1 | wpb 1000 | bsz 1000 | num_updates 11804 | best_mrr 561.402 (progress_bar.py:269, print())
[2021-04-20 06:35:15]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/birnn/checkpoints/checkpoint_last.pt (epoch 13 @ 11804 updates, score 0.561402) (writing took 0.648693 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 06:36:54]    INFO >> epoch 014:    196 / 909 loss=1.516, mrr=740.272, sample_size=1000, wps=1956.8, ups=1.96, wpb=1000, bsz=1000, num_updates=12000, lr=0.01, gnorm=0.226, clip=0, train_wall=241, wall=10646 (progress_bar.py:262, log())
[2021-04-20 06:41:00]    INFO >> epoch 014:    697 / 909 loss=1.511, mrr=740.936, sample_size=1000, wps=2031.3, ups=2.03, wpb=1000, bsz=1000, num_updates=12500, lr=0.01, gnorm=0.231, clip=0, train_wall=241, wall=10892 (progress_bar.py:262, log())
[2021-04-20 06:42:44]    INFO >> epoch 014 | loss 1.512 | mrr 0.740697 | sample_size 1000 | wps 1990.2 | ups 1.99 | wpb 1000 | bsz 1000 | num_updates 12712 | lr 0.01 | gnorm 0.233 | clip 0.1 | train_wall 438 | wall 10996 (progress_bar.py:269, print())
[2021-04-20 06:42:50]    INFO >> epoch 014 | valid on 'valid' subset | loss 2.554 | mrr 0.562082 | sample_size 1000 | wps 16412 | wpb 1000 | bsz 1000 | num_updates 12712 | best_mrr 562.082 (progress_bar.py:269, print())
[2021-04-20 06:42:51]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/birnn/checkpoints/checkpoint_last.pt (epoch 14 @ 12712 updates, score 0.562082) (writing took 0.551537 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 06:45:15]    INFO >> epoch 015:    288 / 909 loss=1.513, mrr=740.195, sample_size=1000, wps=1958.2, ups=1.96, wpb=1000, bsz=1000, num_updates=13000, lr=0.01, gnorm=0.238, clip=0.2, train_wall=241, wall=11147 (progress_bar.py:262, log())
[2021-04-20 06:49:21]    INFO >> epoch 015:    789 / 909 loss=1.531, mrr=737.368, sample_size=1000, wps=2032.1, ups=2.03, wpb=1000, bsz=1000, num_updates=13500, lr=0.01, gnorm=0.268, clip=1, train_wall=241, wall=11393 (progress_bar.py:262, log())
[2021-04-20 06:50:21]    INFO >> epoch 015 | loss 1.524 | mrr 0.738486 | sample_size 1000 | wps 1990.5 | ups 1.99 | wpb 1000 | bsz 1000 | num_updates 13620 | lr 0.01 | gnorm 0.258 | clip 0.7 | train_wall 438 | wall 11452 (progress_bar.py:269, print())
[2021-04-20 06:50:26]    INFO >> epoch 015 | valid on 'valid' subset | loss 2.549 | mrr 0.562087 | sample_size 1000 | wps 16668.9 | wpb 1000 | bsz 1000 | num_updates 13620 | best_mrr 562.087 (progress_bar.py:269, print())
[2021-04-20 06:50:27]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/birnn/checkpoints/checkpoint_last.pt (epoch 15 @ 13620 updates, score 0.562087) (writing took 0.560747 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 06:53:36]    INFO >> epoch 016:    380 / 909 loss=1.531, mrr=737.243, sample_size=1000, wps=1962, ups=1.96, wpb=1000, bsz=1000, num_updates=14000, lr=0.01, gnorm=0.278, clip=0.6, train_wall=241, wall=11648 (progress_bar.py:262, log())
[2021-04-20 06:57:42]    INFO >> epoch 016:    881 / 909 loss=1.556, mrr=733.349, sample_size=1000, wps=2030.3, ups=2.03, wpb=1000, bsz=1000, num_updates=14500, lr=0.01, gnorm=0.362, clip=3.2, train_wall=241, wall=11894 (progress_bar.py:262, log())
[2021-04-20 06:57:56]    INFO >> epoch 016 | loss 1.542 | mrr 0.735676 | sample_size 1000 | wps 1991.8 | ups 1.99 | wpb 1000 | bsz 1000 | num_updates 14528 | lr 0.01 | gnorm 0.327 | clip 2.2 | train_wall 438 | wall 11908 (progress_bar.py:269, print())
[2021-04-20 06:58:02]    INFO >> epoch 016 | valid on 'valid' subset | loss 2.567 | mrr 0.559014 | sample_size 1000 | wps 16459 | wpb 1000 | bsz 1000 | num_updates 14528 | best_mrr 559.014 (progress_bar.py:269, print())
[2021-04-20 06:58:03]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/birnn/checkpoints/checkpoint_last.pt (epoch 16 @ 14528 updates, score 0.559014) (writing took 0.620437 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 07:01:58]    INFO >> epoch 017:    473 / 909 loss=1.543, mrr=735.292, sample_size=1000, wps=1959.6, ups=1.96, wpb=1000, bsz=1000, num_updates=15000, lr=0.01, gnorm=0.427, clip=5.6, train_wall=241, wall=12149 (progress_bar.py:262, log())
[2021-04-20 07:05:32]    INFO >> epoch 017 | loss 1.553 | mrr 0.73368 | sample_size 1000 | wps 1991.4 | ups 1.99 | wpb 1000 | bsz 1000 | num_updates 15436 | lr 0.01 | gnorm 0.401 | clip 4.4 | train_wall 438 | wall 12364 (progress_bar.py:269, print())
[2021-04-20 07:05:38]    INFO >> epoch 017 | valid on 'valid' subset | loss 2.577 | mrr 0.557404 | sample_size 1000 | wps 16739.9 | wpb 1000 | bsz 1000 | num_updates 15436 | best_mrr 557.404 (progress_bar.py:269, print())
[2021-04-20 07:05:39]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/birnn/checkpoints/checkpoint_last.pt (epoch 17 @ 15436 updates, score 0.557404) (writing took 0.608991 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 07:06:13]    INFO >> epoch 018:     64 / 909 loss=1.56, mrr=732.564, sample_size=1000, wps=1957.9, ups=1.96, wpb=1000, bsz=1000, num_updates=15500, lr=0.01, gnorm=0.366, clip=3.2, train_wall=241, wall=12405 (progress_bar.py:262, log())
[2021-04-20 07:10:19]    INFO >> epoch 018:    565 / 909 loss=1.552, mrr=734.07, sample_size=1000, wps=2031, ups=2.03, wpb=1000, bsz=1000, num_updates=16000, lr=0.01, gnorm=0.341, clip=3.4, train_wall=241, wall=12651 (progress_bar.py:262, log())
[2021-04-20 07:13:09]    INFO >> epoch 018 | loss 1.553 | mrr 0.733839 | sample_size 1000 | wps 1990.1 | ups 1.99 | wpb 1000 | bsz 1000 | num_updates 16344 | lr 0.01 | gnorm 0.362 | clip 3.6 | train_wall 438 | wall 12820 (progress_bar.py:269, print())
[2021-04-20 07:13:14]    INFO >> epoch 018 | valid on 'valid' subset | loss 2.584 | mrr 0.557761 | sample_size 1000 | wps 16492.7 | wpb 1000 | bsz 1000 | num_updates 16344 | best_mrr 557.761 (progress_bar.py:269, print())
[2021-04-20 07:13:15]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/birnn/checkpoints/checkpoint_last.pt (epoch 18 @ 16344 updates, score 0.557761) (writing took 0.832429 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 07:14:34]    INFO >> epoch 019:    156 / 909 loss=1.557, mrr=733.279, sample_size=1000, wps=1957.9, ups=1.96, wpb=1000, bsz=1000, num_updates=16500, lr=0.01, gnorm=0.47, clip=5.8, train_wall=241, wall=12906 (progress_bar.py:262, log())
[2021-04-20 07:18:41]    INFO >> epoch 019:    656 / 909 loss=1.577, mrr=729.292, sample_size=1000, wps=2031.9, ups=2.03, wpb=1000, bsz=1000, num_updates=17000, lr=0.01, gnorm=0.393, clip=3.2, train_wall=241, wall=13152 (progress_bar.py:262, log())
[2021-04-20 07:20:45]    INFO >> epoch 019 | loss 1.575 | mrr 0.729751 | sample_size 1000 | wps 1990.2 | ups 1.99 | wpb 1000 | bsz 1000 | num_updates 17252 | lr 0.01 | gnorm 0.408 | clip 3.6 | train_wall 438 | wall 13277 (progress_bar.py:269, print())
[2021-04-20 07:20:51]    INFO >> epoch 019 | valid on 'valid' subset | loss 2.579 | mrr 0.556224 | sample_size 1000 | wps 16331.7 | wpb 1000 | bsz 1000 | num_updates 17252 | best_mrr 556.224 (progress_bar.py:269, print())
[2021-04-20 07:20:51]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/birnn/checkpoints/checkpoint_last.pt (epoch 19 @ 17252 updates, score 0.556224) (writing took 0.563142 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 07:22:56]    INFO >> epoch 020:    248 / 909 loss=1.59, mrr=727.069, sample_size=1000, wps=1957, ups=1.96, wpb=1000, bsz=1000, num_updates=17500, lr=0.01, gnorm=1.565, clip=11, train_wall=241, wall=13408 (progress_bar.py:262, log())
[2021-04-20 07:27:03]    INFO >> epoch 020:    749 / 909 loss=1.858, mrr=681.826, sample_size=1000, wps=2025.5, ups=2.03, wpb=1000, bsz=1000, num_updates=18000, lr=0.01, gnorm=348.184, clip=97.4, train_wall=242, wall=13655 (progress_bar.py:262, log())
[2021-04-20 07:28:22]    INFO >> epoch 020 | loss 1.794 | mrr 0.692424 | sample_size 1000 | wps 1985.9 | ups 1.99 | wpb 1000 | bsz 1000 | num_updates 18160 | lr 0.01 | gnorm 196.402 | clip 74.9 | train_wall 439 | wall 13734 (progress_bar.py:269, print())
[2021-04-20 07:28:28]    INFO >> epoch 020 | valid on 'valid' subset | loss 2.743 | mrr 0.528141 | sample_size 1000 | wps 16376.7 | wpb 1000 | bsz 1000 | num_updates 18160 | best_mrr 528.141 (progress_bar.py:269, print())
[2021-04-20 07:28:29]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/birnn/checkpoints/checkpoint_last.pt (epoch 20 @ 18160 updates, score 0.528141) (writing took 0.792869 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 07:31:19]    INFO >> epoch 021:    340 / 909 loss=1.879, mrr=677.784, sample_size=1000, wps=1953.2, ups=1.95, wpb=1000, bsz=1000, num_updates=18500, lr=0.01, gnorm=11.434, clip=74, train_wall=242, wall=13911 (progress_bar.py:262, log())
[2021-04-20 07:35:26]    INFO >> epoch 021:    841 / 909 loss=1.877, mrr=677.915, sample_size=1000, wps=2024.7, ups=2.02, wpb=1000, bsz=1000, num_updates=19000, lr=0.01, gnorm=52.959, clip=92.2, train_wall=242, wall=14158 (progress_bar.py:262, log())
[2021-04-20 07:36:00]    INFO >> epoch 021 | loss 1.876 | mrr 0.678077 | sample_size 1000 | wps 1984.6 | ups 1.98 | wpb 1000 | bsz 1000 | num_updates 19068 | lr 0.01 | gnorm 50.306 | clip 83.6 | train_wall 439 | wall 14191 (progress_bar.py:269, print())
[2021-04-20 07:36:05]    INFO >> epoch 021 | valid on 'valid' subset | loss 2.775 | mrr 0.525202 | sample_size 1000 | wps 16330.9 | wpb 1000 | bsz 1000 | num_updates 19068 | best_mrr 525.202 (progress_bar.py:269, print())
[2021-04-20 07:36:06]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/birnn/checkpoints/checkpoint_last.pt (epoch 21 @ 19068 updates, score 0.525202) (writing took 0.577668 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 07:36:06]    INFO >> early stop since valid performance hasn't improved for last 10 runs (train.py:191, should_stop_early())
[2021-04-20 07:36:06]    INFO >> early stop since valid performance hasn't improved for last 10 runs (train.py:272, single_main())
[2021-04-20 07:36:06]    INFO >> done training in 14196.3 seconds (train.py:283, single_main())
