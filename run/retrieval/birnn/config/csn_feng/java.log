nohup: 忽略输入
[2021-04-20 04:29:29]    INFO >> Load arguments in /home/yanghe/Documents/naturalcc-dev/run/retrieval/birnn/config/csn_feng/java.yml (train.py:302, cli_main())
[2021-04-20 04:29:29]    INFO >> {'criterion': 'retrieval_softmax', 'optimizer': 'torch_adam', 'lr_scheduler': 'fixed', 'tokenizer': None, 'bpe': None, 'common': {'no_progress_bar': 0, 'log_interval': 500, 'log_format': 'simple', 'tensorboard_logdir': '', 'seed': 0, 'cpu': 0, 'fp16': 0, 'memory_efficient_fp16': 0, 'fp16_no_flatten_grads': 0, 'fp16_init_scale': 128, 'fp16_scale_window': None, 'fp16_scale_tolerance': 0.0, 'min_loss_scale': 0.0001, 'threshold_loss_scale': None, 'user_dir': None, 'empty_cache_freq': 0, 'all_gather_list_size': 16384, 'task': 'hybrid_retrieval'}, 'dataset': {'num_workers': 1, 'skip_invalid_size_inputs_valid_test': 0, 'max_tokens': None, 'max_sentences': 1000, 'code_max_tokens': 200, 'query_max_tokens': 30, 'required_batch_size_multiple': 8, 'dataset_impl': 'mmap', 'train_subset': 'train', 'valid_subset': 'valid', 'validate_interval': 1, 'fixed_validation_seed': None, 'disable_validation': None, 'max_tokens_valid': None, 'max_sentences_valid': 1000, 'curriculum': 0, 'gen_subset': 'test', 'num_shards': 1, 'shard_id': 0, 'joined_dictionary': 0, 'langs': ['java']}, 'distributed_training': {'distributed_world_size': 1, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': None, 'distributed_port': -1, 'device_id': 0, 'distributed_no_spawn': 0, 'ddp_backend': 'c10d', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': None, 'find_unused_parameters': 0, 'fast_stat_sync': 0, 'broadcast_buffers': 0, 'global_sync_iter': 50, 'warmup_iterations': 500, 'local_rank': -1, 'block_momentum': 0.875, 'block_lr': 1, 'use_nbm': 0, 'average_sync': 0}, 'task': {'data': '/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all', 'sample_break_mode': 'complete', 'tokens_per_sample': 512, 'mask_prob': 0.15, 'leave_unmasked_prob': 0.1, 'random_token_prob': 0.1, 'freq_weighted_replacement': 0, 'mask_whole_words': 0, 'pooler_activation_fn': 'tanh', 'source_lang': 'code_tokens', 'target_lang': 'docstring_tokens', 'source_aux_lang': 'code_tokens.wo_func', 'target_aux_lang': 'func_name', 'fraction_using_func_name': 0.3, 'load_alignments': 0, 'left_pad_source': 1, 'left_pad_target': 0, 'upsample_primary': 1, 'truncate_source': 0, 'eval_mrr': 1}, 'model': {'arch': 'birnn', 'code_embed_dim': 128, 'code_doprout': 0.1, 'code_rnn_cell': 'lstm', 'code_rnn_layers': 2, 'code_hidden_dim': 64, 'code_rnn_dropout': 0.2, 'code_rnn_bidirectional': True, 'code_pooling': 'weighted_mean', 'code_activation_fn': 'tanh', 'code_paddding': 'same', 'query_embed_dim': 128, 'query_doprout': 0.1, 'query_rnn_cell': 'lstm', 'query_rnn_layers': 2, 'query_hidden_dim': 64, 'query_rnn_dropout': 0.2, 'query_rnn_bidirectional': True, 'query_pooling': 'weighted_mean', 'query_activation_fn': 'tanh', 'query_paddding': 'same', 'dropout': 0.1}, 'optimization': {'max_epoch': 300, 'max_update': 0, 'clip_norm': 1, 'sentence_avg': 0, 'update_freq': [1], 'lrs': [0.01], 'min_lr': -1, 'use_bmuf': 0, 'lr_shrink': 1.0, 'force_anneal': 0, 'warmup_updates': 0, 'end_learning_rate': 0.0, 'power': 1.0, 'total_num_update': 1000000, 'adam': {'adam_betas': '(0.9, 0.999)', 'adam_eps': 1e-08, 'weight_decay': 0, 'use_old_adam': 1}, 'margin': 1, 'clip_norm_version': 'tf_clip_by_global_norm'}, 'checkpoint': {'save_dir': '/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/birnn/checkpoints', 'restore_file': 'checkpoint_last.pt', 'reset_dataloader': None, 'reset_lr_scheduler': None, 'reset_meters': None, 'reset_optimizer': None, 'optimizer_overrides': '{}', 'save_interval': 1, 'save_interval_updates': 0, 'keep_interval_updates': 0, 'keep_last_epochs': -1, 'keep_best_checkpoints': -1, 'no_save': 0, 'no_epoch_checkpoints': 1, 'no_last_checkpoints': 0, 'no_save_optimizer_state': None, 'best_checkpoint_metric': 'mrr', 'maximize_best_checkpoint_metric': 1, 'patience': 10}, 'eval': {'path': '/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/birnn/checkpoints/checkpoint_best.pt', 'quiet': 1, 'max_sentences': 1000, 'model_overrides': '{}', 'eval_size': -1}} (train.py:304, cli_main())
[2021-04-20 04:29:29]    INFO >> single GPU training... (train.py:333, cli_main())
[2021-04-20 04:29:29]    INFO >> loaded 5183 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/valid.java.code_tokens'] (hybrid_retrieval.py:54, load_tokens_dataset())
[2021-04-20 04:29:29]    INFO >> loaded 5183 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/valid.java.docstring_tokens'] (hybrid_retrieval.py:55, load_tokens_dataset())
[2021-04-20 04:29:29]    INFO >> BiRNN(
  (src_encoders): ModuleDict(
    (java): RNNEncoder(
      (embed): Embedding(10000, 128)
      (weight_layer): Linear(in_features=128, out_features=1, bias=False)
      (rnn): LSTM(128, 64, num_layers=2, batch_first=True, dropout=0.2, bidirectional=True)
    )
  )
  (tgt_encoders): RNNEncoder(
    (embed): Embedding(10000, 128)
    (weight_layer): Linear(in_features=128, out_features=1, bias=False)
    (rnn): LSTM(128, 64, num_layers=2, batch_first=True, dropout=0.2, bidirectional=True)
  )
) (train.py:223, single_main())
[2021-04-20 04:29:29]    INFO >> model birnn, criterion SearchSoftmaxCriterion (train.py:224, single_main())
[2021-04-20 04:29:29]    INFO >> num. model params: 2957568 (num. trained: 2957568) (train.py:227, single_main())
[2021-04-20 04:29:32]    INFO >> training on 1 GPUs (train.py:233, single_main())
[2021-04-20 04:29:32]    INFO >> max tokens per GPU = None and max sentences per GPU = 1000 (train.py:236, single_main())
[2021-04-20 04:29:32]    INFO >> no existing checkpoint found /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/birnn/checkpoints/checkpoint_last.pt (ncc_trainers.py:270, load_checkpoint())
[2021-04-20 04:29:32]    INFO >> loading train data for epoch 1 (ncc_trainers.py:285, get_train_iterator())
[2021-04-20 04:29:32]    INFO >> loaded 164923 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.java.code_tokens'] (hybrid_retrieval.py:54, load_tokens_dataset())
[2021-04-20 04:29:32]    INFO >> loaded 164923 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.java.docstring_tokens'] (hybrid_retrieval.py:55, load_tokens_dataset())
[2021-04-20 04:29:32]    INFO >> loaded 164923 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.java.code_tokens.wo_func'] (hybrid_retrieval.py:67, load_tokens_dataset())
[2021-04-20 04:29:32]    INFO >> loaded 164923 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.java.func_name'] (hybrid_retrieval.py:81, load_tokens_dataset())
[2021-04-20 04:29:32]    INFO >> NOTE: your device may support faster training with fp16 (ncc_trainers.py:155, _setup_optimizer())
[2021-04-20 04:32:21]    INFO >> epoch 001 | loss 6.191 | mrr 0.048181 | sample_size 1000 | wps 983.3 | ups 0.98 | wpb 1000 | bsz 1000 | num_updates 164 | lr 0.01 | gnorm 0.292 | clip 1.2 | train_wall 166 | wall 169 (progress_bar.py:269, print())
[2021-04-20 04:32:24]    INFO >> epoch 001 | valid on 'valid' subset | loss 5.025 | mrr 0.163277 | sample_size 1000 | wps 4558.9 | wpb 1000 | bsz 1000 | num_updates 164 (progress_bar.py:269, print())
[2021-04-20 04:32:25]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/birnn/checkpoints/checkpoint_best.pt (epoch 1 @ 164 updates, score 0.163277) (writing took 0.258728 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:35:20]    INFO >> epoch 002 | loss 3.189 | mrr 0.458246 | sample_size 1000 | wps 919.7 | ups 0.92 | wpb 1000 | bsz 1000 | num_updates 328 | lr 0.01 | gnorm 0.328 | clip 0 | train_wall 172 | wall 347 (progress_bar.py:269, print())
[2021-04-20 04:35:23]    INFO >> epoch 002 | valid on 'valid' subset | loss 3.13 | mrr 0.467949 | sample_size 1000 | wps 5502.4 | wpb 1000 | bsz 1000 | num_updates 328 | best_mrr 467.949 (progress_bar.py:269, print())
[2021-04-20 04:35:23]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/birnn/checkpoints/checkpoint_best.pt (epoch 2 @ 328 updates, score 0.467949) (writing took 0.370610 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:38:18]    INFO >> epoch 003 | loss 1.973 | mrr 0.668986 | sample_size 1000 | wps 916.7 | ups 0.92 | wpb 1000 | bsz 1000 | num_updates 492 | lr 0.01 | gnorm 0.266 | clip 0 | train_wall 172 | wall 526 (progress_bar.py:269, print())
[2021-04-20 04:38:22]    INFO >> epoch 003 | valid on 'valid' subset | loss 2.574 | mrr 0.560758 | sample_size 1000 | wps 4468.1 | wpb 1000 | bsz 1000 | num_updates 492 | best_mrr 560.758 (progress_bar.py:269, print())
[2021-04-20 04:38:22]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/birnn/checkpoints/checkpoint_best.pt (epoch 3 @ 492 updates, score 0.560758) (writing took 0.283896 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:38:33]    INFO >> epoch 004:      8 / 165 loss=3.749, mrr=397.182, sample_size=1000, wps=928.3, ups=0.93, wpb=1000, bsz=1000, num_updates=500, lr=0.01, gnorm=0.294, clip=0.4, train_wall=518, wall=541 (progress_bar.py:262, log())
[2021-04-20 04:41:14]    INFO >> epoch 004 | loss 1.551 | mrr 0.741571 | sample_size 1000 | wps 934.6 | ups 0.93 | wpb 1000 | bsz 1000 | num_updates 656 | lr 0.01 | gnorm 0.244 | clip 0 | train_wall 169 | wall 702 (progress_bar.py:269, print())
[2021-04-20 04:41:17]    INFO >> epoch 004 | valid on 'valid' subset | loss 2.373 | mrr 0.59523 | sample_size 1000 | wps 5067.8 | wpb 1000 | bsz 1000 | num_updates 656 | best_mrr 595.23 (progress_bar.py:269, print())
[2021-04-20 04:41:17]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/birnn/checkpoints/checkpoint_best.pt (epoch 4 @ 656 updates, score 0.59523) (writing took 0.262388 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:44:13]    INFO >> epoch 005 | loss 1.336 | mrr 0.776362 | sample_size 1000 | wps 915 | ups 0.91 | wpb 1000 | bsz 1000 | num_updates 820 | lr 0.01 | gnorm 0.237 | clip 0 | train_wall 173 | wall 881 (progress_bar.py:269, print())
[2021-04-20 04:44:16]    INFO >> epoch 005 | valid on 'valid' subset | loss 2.264 | mrr 0.614498 | sample_size 1000 | wps 5042.8 | wpb 1000 | bsz 1000 | num_updates 820 | best_mrr 614.498 (progress_bar.py:269, print())
[2021-04-20 04:44:17]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/birnn/checkpoints/checkpoint_best.pt (epoch 5 @ 820 updates, score 0.614498) (writing took 0.316099 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:47:09]    INFO >> epoch 006 | loss 1.196 | mrr 0.799973 | sample_size 1000 | wps 934.3 | ups 0.93 | wpb 1000 | bsz 1000 | num_updates 984 | lr 0.01 | gnorm 0.227 | clip 0 | train_wall 169 | wall 1057 (progress_bar.py:269, print())
[2021-04-20 04:47:12]    INFO >> epoch 006 | valid on 'valid' subset | loss 2.166 | mrr 0.633751 | sample_size 1000 | wps 5050.3 | wpb 1000 | bsz 1000 | num_updates 984 | best_mrr 633.751 (progress_bar.py:269, print())
[2021-04-20 04:47:12]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/birnn/checkpoints/checkpoint_best.pt (epoch 6 @ 984 updates, score 0.633751) (writing took 0.295243 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:47:32]    INFO >> epoch 007:     17 / 165 loss=1.347, mrr=775.001, sample_size=1000, wps=927.2, ups=0.93, wpb=1000, bsz=1000, num_updates=1000, lr=0.01, gnorm=0.235, clip=0, train_wall=519, wall=1080 (progress_bar.py:262, log())
[2021-04-20 04:50:08]    INFO >> epoch 007 | loss 1.093 | mrr 0.817153 | sample_size 1000 | wps 914.4 | ups 0.91 | wpb 1000 | bsz 1000 | num_updates 1148 | lr 0.01 | gnorm 0.223 | clip 0 | train_wall 172 | wall 1236 (progress_bar.py:269, print())
[2021-04-20 04:50:12]    INFO >> epoch 007 | valid on 'valid' subset | loss 2.129 | mrr 0.640041 | sample_size 1000 | wps 6958.5 | wpb 1000 | bsz 1000 | num_updates 1148 | best_mrr 640.041 (progress_bar.py:269, print())
[2021-04-20 04:50:12]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/birnn/checkpoints/checkpoint_best.pt (epoch 7 @ 1148 updates, score 0.640041) (writing took 0.275592 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:53:06]    INFO >> epoch 008 | loss 1.023 | mrr 0.82815 | sample_size 1000 | wps 922.1 | ups 0.92 | wpb 1000 | bsz 1000 | num_updates 1312 | lr 0.01 | gnorm 0.221 | clip 0 | train_wall 171 | wall 1414 (progress_bar.py:269, print())
[2021-04-20 04:53:09]    INFO >> epoch 008 | valid on 'valid' subset | loss 2.147 | mrr 0.64456 | sample_size 1000 | wps 4761.3 | wpb 1000 | bsz 1000 | num_updates 1312 | best_mrr 644.56 (progress_bar.py:269, print())
[2021-04-20 04:53:09]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/birnn/checkpoints/checkpoint_best.pt (epoch 8 @ 1312 updates, score 0.64456) (writing took 0.290628 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:56:01]    INFO >> epoch 009 | loss 0.971 | mrr 0.837212 | sample_size 1000 | wps 937 | ups 0.94 | wpb 1000 | bsz 1000 | num_updates 1476 | lr 0.01 | gnorm 0.22 | clip 0 | train_wall 168 | wall 1589 (progress_bar.py:269, print())
[2021-04-20 04:56:04]    INFO >> epoch 009 | valid on 'valid' subset | loss 2.118 | mrr 0.643948 | sample_size 1000 | wps 5013 | wpb 1000 | bsz 1000 | num_updates 1476 | best_mrr 643.948 (progress_bar.py:269, print())
[2021-04-20 04:56:04]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/birnn/checkpoints/checkpoint_last.pt (epoch 9 @ 1476 updates, score 0.643948) (writing took 0.185921 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:56:33]    INFO >> epoch 010:     24 / 165 loss=1.021, mrr=828.899, sample_size=1000, wps=925.1, ups=0.93, wpb=1000, bsz=1000, num_updates=1500, lr=0.01, gnorm=0.221, clip=0, train_wall=520, wall=1621 (progress_bar.py:262, log())
[2021-04-20 04:59:00]    INFO >> epoch 010 | loss 0.923 | mrr 0.844793 | sample_size 1000 | wps 916.2 | ups 0.92 | wpb 1000 | bsz 1000 | num_updates 1640 | lr 0.01 | gnorm 0.219 | clip 0 | train_wall 173 | wall 1768 (progress_bar.py:269, print())
[2021-04-20 04:59:03]    INFO >> epoch 010 | valid on 'valid' subset | loss 2.098 | mrr 0.645144 | sample_size 1000 | wps 4916.4 | wpb 1000 | bsz 1000 | num_updates 1640 | best_mrr 645.144 (progress_bar.py:269, print())
[2021-04-20 04:59:03]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/birnn/checkpoints/checkpoint_best.pt (epoch 10 @ 1640 updates, score 0.645144) (writing took 0.308703 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 05:01:04]    INFO >> epoch 011 | loss 0.892 | mrr 0.850032 | sample_size 1000 | wps 1327 | ups 1.33 | wpb 1000 | bsz 1000 | num_updates 1804 | lr 0.01 | gnorm 0.219 | clip 0 | train_wall 117 | wall 1892 (progress_bar.py:269, print())
[2021-04-20 05:01:08]    INFO >> epoch 011 | valid on 'valid' subset | loss 2.082 | mrr 0.650533 | sample_size 1000 | wps 6196.3 | wpb 1000 | bsz 1000 | num_updates 1804 | best_mrr 650.533 (progress_bar.py:269, print())
[2021-04-20 05:01:08]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/birnn/checkpoints/checkpoint_best.pt (epoch 11 @ 1804 updates, score 0.650533) (writing took 0.315800 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 05:03:06]    INFO >> epoch 012 | loss 0.857 | mrr 0.855609 | sample_size 1000 | wps 1338.3 | ups 1.34 | wpb 1000 | bsz 1000 | num_updates 1968 | lr 0.01 | gnorm 0.216 | clip 0 | train_wall 115 | wall 2014 (progress_bar.py:269, print())
[2021-04-20 05:03:10]    INFO >> epoch 012 | valid on 'valid' subset | loss 2.057 | mrr 0.656825 | sample_size 1000 | wps 6453.8 | wpb 1000 | bsz 1000 | num_updates 1968 | best_mrr 656.825 (progress_bar.py:269, print())
[2021-04-20 05:03:10]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/birnn/checkpoints/checkpoint_best.pt (epoch 12 @ 1968 updates, score 0.656825) (writing took 0.318175 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 05:03:35]    INFO >> epoch 013:     33 / 165 loss=0.885, mrr=851.139, sample_size=1000, wps=1183.4, ups=1.18, wpb=1000, bsz=1000, num_updates=2000, lr=0.01, gnorm=0.218, clip=0, train_wall=401, wall=2043 (progress_bar.py:262, log())
[2021-04-20 05:05:09]    INFO >> epoch 013 | loss 0.831 | mrr 0.860188 | sample_size 1000 | wps 1337.3 | ups 1.34 | wpb 1000 | bsz 1000 | num_updates 2132 | lr 0.01 | gnorm 0.215 | clip 0 | train_wall 115 | wall 2137 (progress_bar.py:269, print())
[2021-04-20 05:05:13]    INFO >> epoch 013 | valid on 'valid' subset | loss 2.082 | mrr 0.649292 | sample_size 1000 | wps 6194 | wpb 1000 | bsz 1000 | num_updates 2132 | best_mrr 649.292 (progress_bar.py:269, print())
[2021-04-20 05:05:13]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/birnn/checkpoints/checkpoint_last.pt (epoch 13 @ 2132 updates, score 0.649292) (writing took 0.195449 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 05:07:38]    INFO >> epoch 014 | loss 0.809 | mrr 0.862777 | sample_size 1000 | wps 1097.8 | ups 1.1 | wpb 1000 | bsz 1000 | num_updates 2296 | lr 0.01 | gnorm 0.217 | clip 0 | train_wall 142 | wall 2286 (progress_bar.py:269, print())
[2021-04-20 05:07:42]    INFO >> epoch 014 | valid on 'valid' subset | loss 2.082 | mrr 0.653401 | sample_size 1000 | wps 4530.1 | wpb 1000 | bsz 1000 | num_updates 2296 | best_mrr 653.401 (progress_bar.py:269, print())
[2021-04-20 05:07:43]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/birnn/checkpoints/checkpoint_last.pt (epoch 14 @ 2296 updates, score 0.653401) (writing took 0.294646 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 05:10:42]    INFO >> epoch 015 | loss 0.798 | mrr 0.865168 | sample_size 1000 | wps 893.1 | ups 0.89 | wpb 1000 | bsz 1000 | num_updates 2460 | lr 0.01 | gnorm 0.216 | clip 0 | train_wall 176 | wall 2470 (progress_bar.py:269, print())
[2021-04-20 05:10:46]    INFO >> epoch 015 | valid on 'valid' subset | loss 2.063 | mrr 0.655605 | sample_size 1000 | wps 4807.4 | wpb 1000 | bsz 1000 | num_updates 2460 | best_mrr 655.605 (progress_bar.py:269, print())
[2021-04-20 05:10:46]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/birnn/checkpoints/checkpoint_last.pt (epoch 15 @ 2460 updates, score 0.655605) (writing took 0.184323 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 05:11:31]    INFO >> epoch 016:     40 / 165 loss=0.809, mrr=863.191, sample_size=1000, wps=1050.4, ups=1.05, wpb=1000, bsz=1000, num_updates=2500, lr=0.01, gnorm=0.216, clip=0, train_wall=453, wall=2519 (progress_bar.py:262, log())
[2021-04-20 05:13:42]    INFO >> epoch 016 | loss 0.785 | mrr 0.867318 | sample_size 1000 | wps 908 | ups 0.91 | wpb 1000 | bsz 1000 | num_updates 2624 | lr 0.01 | gnorm 0.217 | clip 0 | train_wall 173 | wall 2650 (progress_bar.py:269, print())
[2021-04-20 05:13:47]    INFO >> epoch 016 | valid on 'valid' subset | loss 2.074 | mrr 0.654748 | sample_size 1000 | wps 4491.1 | wpb 1000 | bsz 1000 | num_updates 2624 | best_mrr 654.748 (progress_bar.py:269, print())
[2021-04-20 05:13:47]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/birnn/checkpoints/checkpoint_last.pt (epoch 16 @ 2624 updates, score 0.654748) (writing took 0.189655 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 05:16:46]    INFO >> epoch 017 | loss 0.766 | mrr 0.870328 | sample_size 1000 | wps 894.5 | ups 0.89 | wpb 1000 | bsz 1000 | num_updates 2788 | lr 0.01 | gnorm 0.215 | clip 0 | train_wall 176 | wall 2834 (progress_bar.py:269, print())
[2021-04-20 05:16:50]    INFO >> epoch 017 | valid on 'valid' subset | loss 2.06 | mrr 0.657684 | sample_size 1000 | wps 4706.3 | wpb 1000 | bsz 1000 | num_updates 2788 | best_mrr 657.684 (progress_bar.py:269, print())
[2021-04-20 05:16:50]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/birnn/checkpoints/checkpoint_best.pt (epoch 17 @ 2788 updates, score 0.657684) (writing took 0.299934 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 05:19:49]    INFO >> epoch 018 | loss 0.761 | mrr 0.870705 | sample_size 1000 | wps 893.2 | ups 0.89 | wpb 1000 | bsz 1000 | num_updates 2952 | lr 0.01 | gnorm 0.216 | clip 0 | train_wall 176 | wall 3017 (progress_bar.py:269, print())
[2021-04-20 05:19:54]    INFO >> epoch 018 | valid on 'valid' subset | loss 2.074 | mrr 0.656744 | sample_size 1000 | wps 4874.3 | wpb 1000 | bsz 1000 | num_updates 2952 | best_mrr 656.744 (progress_bar.py:269, print())
[2021-04-20 05:19:54]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/birnn/checkpoints/checkpoint_last.pt (epoch 18 @ 2952 updates, score 0.656744) (writing took 0.180927 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 05:20:49]    INFO >> epoch 019:     49 / 165 loss=0.766, mrr=870.243, sample_size=1000, wps=897, ups=0.9, wpb=1000, bsz=1000, num_updates=3000, lr=0.01, gnorm=0.216, clip=0, train_wall=535, wall=3077 (progress_bar.py:262, log())
[2021-04-20 05:22:53]    INFO >> epoch 019 | loss 0.747 | mrr 0.872805 | sample_size 1000 | wps 893.6 | ups 0.89 | wpb 1000 | bsz 1000 | num_updates 3116 | lr 0.01 | gnorm 0.214 | clip 0 | train_wall 176 | wall 3201 (progress_bar.py:269, print())
[2021-04-20 05:22:57]    INFO >> epoch 019 | valid on 'valid' subset | loss 2.064 | mrr 0.658869 | sample_size 1000 | wps 4450 | wpb 1000 | bsz 1000 | num_updates 3116 | best_mrr 658.869 (progress_bar.py:269, print())
[2021-04-20 05:22:57]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/birnn/checkpoints/checkpoint_best.pt (epoch 19 @ 3116 updates, score 0.658869) (writing took 0.302639 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 05:25:57]    INFO >> epoch 020 | loss 0.74 | mrr 0.874192 | sample_size 1000 | wps 891.8 | ups 0.89 | wpb 1000 | bsz 1000 | num_updates 3280 | lr 0.01 | gnorm 0.215 | clip 0 | train_wall 176 | wall 3385 (progress_bar.py:269, print())
[2021-04-20 05:26:01]    INFO >> epoch 020 | valid on 'valid' subset | loss 2.061 | mrr 0.660133 | sample_size 1000 | wps 4435.6 | wpb 1000 | bsz 1000 | num_updates 3280 | best_mrr 660.133 (progress_bar.py:269, print())
[2021-04-20 05:26:02]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/birnn/checkpoints/checkpoint_best.pt (epoch 20 @ 3280 updates, score 0.660133) (writing took 0.363356 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 05:29:01]    INFO >> epoch 021 | loss 0.734 | mrr 0.875299 | sample_size 1000 | wps 889.6 | ups 0.89 | wpb 1000 | bsz 1000 | num_updates 3444 | lr 0.01 | gnorm 0.216 | clip 0 | train_wall 177 | wall 3569 (progress_bar.py:269, print())
[2021-04-20 05:29:05]    INFO >> epoch 021 | valid on 'valid' subset | loss 2.05 | mrr 0.660998 | sample_size 1000 | wps 4635.2 | wpb 1000 | bsz 1000 | num_updates 3444 | best_mrr 660.998 (progress_bar.py:269, print())
[2021-04-20 05:29:06]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/birnn/checkpoints/checkpoint_best.pt (epoch 21 @ 3444 updates, score 0.660998) (writing took 0.264544 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 05:30:07]    INFO >> epoch 022:     56 / 165 loss=0.738, mrr=874.415, sample_size=1000, wps=896.4, ups=0.9, wpb=1000, bsz=1000, num_updates=3500, lr=0.01, gnorm=0.215, clip=0, train_wall=535, wall=3635 (progress_bar.py:262, log())
[2021-04-20 05:32:06]    INFO >> epoch 022 | loss 0.726 | mrr 0.87658 | sample_size 1000 | wps 889.3 | ups 0.89 | wpb 1000 | bsz 1000 | num_updates 3608 | lr 0.01 | gnorm 0.215 | clip 0 | train_wall 177 | wall 3754 (progress_bar.py:269, print())
[2021-04-20 05:32:10]    INFO >> epoch 022 | valid on 'valid' subset | loss 2.069 | mrr 0.663454 | sample_size 1000 | wps 4705.1 | wpb 1000 | bsz 1000 | num_updates 3608 | best_mrr 663.454 (progress_bar.py:269, print())
[2021-04-20 05:32:10]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/birnn/checkpoints/checkpoint_best.pt (epoch 22 @ 3608 updates, score 0.663454) (writing took 0.272771 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 05:35:07]    INFO >> epoch 023 | loss 0.716 | mrr 0.878011 | sample_size 1000 | wps 907.1 | ups 0.91 | wpb 1000 | bsz 1000 | num_updates 3772 | lr 0.01 | gnorm 0.215 | clip 0 | train_wall 173 | wall 3934 (progress_bar.py:269, print())
[2021-04-20 05:35:11]    INFO >> epoch 023 | valid on 'valid' subset | loss 2.084 | mrr 0.659346 | sample_size 1000 | wps 4700 | wpb 1000 | bsz 1000 | num_updates 3772 | best_mrr 659.346 (progress_bar.py:269, print())
[2021-04-20 05:35:11]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/birnn/checkpoints/checkpoint_last.pt (epoch 23 @ 3772 updates, score 0.659346) (writing took 0.180307 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 05:38:11]    INFO >> epoch 024 | loss 0.714 | mrr 0.878702 | sample_size 1000 | wps 890.2 | ups 0.89 | wpb 1000 | bsz 1000 | num_updates 3936 | lr 0.01 | gnorm 0.215 | clip 0 | train_wall 177 | wall 4119 (progress_bar.py:269, print())
[2021-04-20 05:38:15]    INFO >> epoch 024 | valid on 'valid' subset | loss 2.074 | mrr 0.657843 | sample_size 1000 | wps 4524.7 | wpb 1000 | bsz 1000 | num_updates 3936 | best_mrr 657.843 (progress_bar.py:269, print())
[2021-04-20 05:38:15]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/birnn/checkpoints/checkpoint_last.pt (epoch 24 @ 3936 updates, score 0.657843) (writing took 0.159917 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 05:39:25]    INFO >> epoch 025:     64 / 165 loss=0.717, mrr=877.991, sample_size=1000, wps=895.8, ups=0.9, wpb=1000, bsz=1000, num_updates=4000, lr=0.01, gnorm=0.215, clip=0, train_wall=535, wall=4193 (progress_bar.py:262, log())
[2021-04-20 05:41:15]    INFO >> epoch 025 | loss 0.71 | mrr 0.878905 | sample_size 1000 | wps 890.1 | ups 0.89 | wpb 1000 | bsz 1000 | num_updates 4100 | lr 0.01 | gnorm 0.215 | clip 0 | train_wall 177 | wall 4303 (progress_bar.py:269, print())
[2021-04-20 05:41:19]    INFO >> epoch 025 | valid on 'valid' subset | loss 2.059 | mrr 0.657414 | sample_size 1000 | wps 4607 | wpb 1000 | bsz 1000 | num_updates 4100 | best_mrr 657.414 (progress_bar.py:269, print())
[2021-04-20 05:41:19]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/birnn/checkpoints/checkpoint_last.pt (epoch 25 @ 4100 updates, score 0.657414) (writing took 0.271454 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 05:44:19]    INFO >> epoch 026 | loss 0.703 | mrr 0.880324 | sample_size 1000 | wps 890.3 | ups 0.89 | wpb 1000 | bsz 1000 | num_updates 4264 | lr 0.01 | gnorm 0.215 | clip 0 | train_wall 177 | wall 4487 (progress_bar.py:269, print())
[2021-04-20 05:44:23]    INFO >> epoch 026 | valid on 'valid' subset | loss 2.085 | mrr 0.657143 | sample_size 1000 | wps 6172.6 | wpb 1000 | bsz 1000 | num_updates 4264 | best_mrr 657.143 (progress_bar.py:269, print())
[2021-04-20 05:44:23]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/birnn/checkpoints/checkpoint_last.pt (epoch 26 @ 4264 updates, score 0.657143) (writing took 0.173232 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 05:47:24]    INFO >> epoch 027 | loss 0.695 | mrr 0.881824 | sample_size 1000 | wps 888.7 | ups 0.89 | wpb 1000 | bsz 1000 | num_updates 4428 | lr 0.01 | gnorm 0.215 | clip 0 | train_wall 177 | wall 4672 (progress_bar.py:269, print())
[2021-04-20 05:47:27]    INFO >> epoch 027 | valid on 'valid' subset | loss 2.079 | mrr 0.660059 | sample_size 1000 | wps 6829.6 | wpb 1000 | bsz 1000 | num_updates 4428 | best_mrr 660.059 (progress_bar.py:269, print())
[2021-04-20 05:47:27]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/birnn/checkpoints/checkpoint_last.pt (epoch 27 @ 4428 updates, score 0.660059) (writing took 0.173265 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 05:48:48]    INFO >> epoch 028:     72 / 165 loss=0.702, mrr=880.409, sample_size=1000, wps=887.4, ups=0.89, wpb=1000, bsz=1000, num_updates=4500, lr=0.01, gnorm=0.215, clip=0, train_wall=542, wall=4756 (progress_bar.py:262, log())
[2021-04-20 05:50:26]    INFO >> epoch 028 | loss 0.699 | mrr 0.880786 | sample_size 1000 | wps 900.5 | ups 0.9 | wpb 1000 | bsz 1000 | num_updates 4592 | lr 0.01 | gnorm 0.215 | clip 0 | train_wall 176 | wall 4854 (progress_bar.py:269, print())
[2021-04-20 05:50:29]    INFO >> epoch 028 | valid on 'valid' subset | loss 2.064 | mrr 0.657004 | sample_size 1000 | wps 4756.1 | wpb 1000 | bsz 1000 | num_updates 4592 | best_mrr 657.004 (progress_bar.py:269, print())
[2021-04-20 05:50:29]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/birnn/checkpoints/checkpoint_last.pt (epoch 28 @ 4592 updates, score 0.657004) (writing took 0.161217 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 05:53:28]    INFO >> epoch 029 | loss 0.695 | mrr 0.881511 | sample_size 1000 | wps 898.2 | ups 0.9 | wpb 1000 | bsz 1000 | num_updates 4756 | lr 0.01 | gnorm 0.217 | clip 0 | train_wall 176 | wall 5036 (progress_bar.py:269, print())
[2021-04-20 05:53:32]    INFO >> epoch 029 | valid on 'valid' subset | loss 2.08 | mrr 0.659843 | sample_size 1000 | wps 4769.7 | wpb 1000 | bsz 1000 | num_updates 4756 | best_mrr 659.843 (progress_bar.py:269, print())
[2021-04-20 05:53:32]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/birnn/checkpoints/checkpoint_last.pt (epoch 29 @ 4756 updates, score 0.659843) (writing took 0.167487 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 05:56:31]    INFO >> epoch 030 | loss 0.688 | mrr 0.882425 | sample_size 1000 | wps 898 | ups 0.9 | wpb 1000 | bsz 1000 | num_updates 4920 | lr 0.01 | gnorm 0.216 | clip 0 | train_wall 176 | wall 5219 (progress_bar.py:269, print())
[2021-04-20 05:56:34]    INFO >> epoch 030 | valid on 'valid' subset | loss 2.055 | mrr 0.661196 | sample_size 1000 | wps 6084.7 | wpb 1000 | bsz 1000 | num_updates 4920 | best_mrr 661.196 (progress_bar.py:269, print())
[2021-04-20 05:56:34]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/birnn/checkpoints/checkpoint_last.pt (epoch 30 @ 4920 updates, score 0.661196) (writing took 0.163374 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 05:58:03]    INFO >> epoch 031:     81 / 165 loss=0.693, mrr=881.732, sample_size=1000, wps=901.8, ups=0.9, wpb=1000, bsz=1000, num_updates=5000, lr=0.01, gnorm=0.216, clip=0, train_wall=535, wall=5311 (progress_bar.py:262, log())
[2021-04-20 05:59:32]    INFO >> epoch 031 | loss 0.688 | mrr 0.882501 | sample_size 1000 | wps 908.8 | ups 0.91 | wpb 1000 | bsz 1000 | num_updates 5084 | lr 0.01 | gnorm 0.216 | clip 0 | train_wall 174 | wall 5399 (progress_bar.py:269, print())
[2021-04-20 05:59:35]    INFO >> epoch 031 | valid on 'valid' subset | loss 2.061 | mrr 0.661978 | sample_size 1000 | wps 4516.6 | wpb 1000 | bsz 1000 | num_updates 5084 | best_mrr 661.978 (progress_bar.py:269, print())
[2021-04-20 05:59:35]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/birnn/checkpoints/checkpoint_last.pt (epoch 31 @ 5084 updates, score 0.661978) (writing took 0.153165 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 06:02:34]    INFO >> epoch 032 | loss 0.684 | mrr 0.883083 | sample_size 1000 | wps 898.4 | ups 0.9 | wpb 1000 | bsz 1000 | num_updates 5248 | lr 0.01 | gnorm 0.215 | clip 0 | train_wall 176 | wall 5582 (progress_bar.py:269, print())
[2021-04-20 06:02:37]    INFO >> epoch 032 | valid on 'valid' subset | loss 2.063 | mrr 0.663009 | sample_size 1000 | wps 4924.2 | wpb 1000 | bsz 1000 | num_updates 5248 | best_mrr 663.009 (progress_bar.py:269, print())
[2021-04-20 06:02:37]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/birnn/checkpoints/checkpoint_last.pt (epoch 32 @ 5248 updates, score 0.663009) (writing took 0.158475 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 06:02:37]    INFO >> early stop since valid performance hasn't improved for last 10 runs (train.py:191, should_stop_early())
[2021-04-20 06:02:37]    INFO >> early stop since valid performance hasn't improved for last 10 runs (train.py:272, single_main())
[2021-04-20 06:02:37]    INFO >> done training in 5585.0 seconds (train.py:283, single_main())
