nohup: 忽略输入
[2021-04-20 05:06:13]    INFO >> Load arguments in /home/yanghe/Documents/naturalcc-dev/run/retrieval/birnn/config/csn_feng/go.yml (train.py:302, cli_main())
[2021-04-20 05:06:13]    INFO >> {'criterion': 'retrieval_softmax', 'optimizer': 'torch_adam', 'lr_scheduler': 'fixed', 'tokenizer': None, 'bpe': None, 'common': {'no_progress_bar': 0, 'log_interval': 500, 'log_format': 'simple', 'tensorboard_logdir': '', 'seed': 0, 'cpu': 0, 'fp16': 0, 'memory_efficient_fp16': 0, 'fp16_no_flatten_grads': 0, 'fp16_init_scale': 128, 'fp16_scale_window': None, 'fp16_scale_tolerance': 0.0, 'min_loss_scale': 0.0001, 'threshold_loss_scale': None, 'user_dir': None, 'empty_cache_freq': 0, 'all_gather_list_size': 16384, 'task': 'hybrid_retrieval'}, 'dataset': {'num_workers': 1, 'skip_invalid_size_inputs_valid_test': 0, 'max_tokens': None, 'max_sentences': 1000, 'code_max_tokens': 200, 'query_max_tokens': 30, 'required_batch_size_multiple': 8, 'dataset_impl': 'mmap', 'train_subset': 'train', 'valid_subset': 'valid', 'validate_interval': 1, 'fixed_validation_seed': None, 'disable_validation': None, 'max_tokens_valid': None, 'max_sentences_valid': 1000, 'curriculum': 0, 'gen_subset': 'test', 'num_shards': 1, 'shard_id': 0, 'joined_dictionary': 0, 'langs': ['go']}, 'distributed_training': {'distributed_world_size': 1, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': None, 'distributed_port': -1, 'device_id': 0, 'distributed_no_spawn': 0, 'ddp_backend': 'c10d', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': None, 'find_unused_parameters': 0, 'fast_stat_sync': 0, 'broadcast_buffers': 0, 'global_sync_iter': 50, 'warmup_iterations': 500, 'local_rank': -1, 'block_momentum': 0.875, 'block_lr': 1, 'use_nbm': 0, 'average_sync': 0}, 'task': {'data': '/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all', 'sample_break_mode': 'complete', 'tokens_per_sample': 512, 'mask_prob': 0.15, 'leave_unmasked_prob': 0.1, 'random_token_prob': 0.1, 'freq_weighted_replacement': 0, 'mask_whole_words': 0, 'pooler_activation_fn': 'tanh', 'source_lang': 'code_tokens', 'target_lang': 'docstring_tokens', 'source_aux_lang': 'code_tokens.wo_func', 'target_aux_lang': 'func_name', 'fraction_using_func_name': 0.3, 'load_alignments': 0, 'left_pad_source': 1, 'left_pad_target': 0, 'upsample_primary': 1, 'truncate_source': 0, 'eval_mrr': 1}, 'model': {'arch': 'birnn', 'code_embed_dim': 128, 'code_doprout': 0.1, 'code_rnn_cell': 'lstm', 'code_rnn_layers': 2, 'code_hidden_dim': 64, 'code_rnn_dropout': 0.2, 'code_rnn_bidirectional': True, 'code_pooling': 'weighted_mean', 'code_activation_fn': 'tanh', 'code_paddding': 'same', 'query_embed_dim': 128, 'query_doprout': 0.1, 'query_rnn_cell': 'lstm', 'query_rnn_layers': 2, 'query_hidden_dim': 64, 'query_rnn_dropout': 0.2, 'query_rnn_bidirectional': True, 'query_pooling': 'weighted_mean', 'query_activation_fn': 'tanh', 'query_paddding': 'same', 'dropout': 0.1}, 'optimization': {'max_epoch': 300, 'max_update': 0, 'clip_norm': 1, 'sentence_avg': 0, 'update_freq': [1], 'lrs': [0.01], 'min_lr': -1, 'use_bmuf': 0, 'lr_shrink': 1.0, 'force_anneal': 0, 'warmup_updates': 0, 'end_learning_rate': 0.0, 'power': 1.0, 'total_num_update': 1000000, 'adam': {'adam_betas': '(0.9, 0.999)', 'adam_eps': 1e-08, 'weight_decay': 0, 'use_old_adam': 1}, 'margin': 1, 'clip_norm_version': 'tf_clip_by_global_norm'}, 'checkpoint': {'save_dir': '/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/birnn/checkpoints', 'restore_file': 'checkpoint_last.pt', 'reset_dataloader': None, 'reset_lr_scheduler': None, 'reset_meters': None, 'reset_optimizer': None, 'optimizer_overrides': '{}', 'save_interval': 1, 'save_interval_updates': 0, 'keep_interval_updates': 0, 'keep_last_epochs': -1, 'keep_best_checkpoints': -1, 'no_save': 0, 'no_epoch_checkpoints': 1, 'no_last_checkpoints': 0, 'no_save_optimizer_state': None, 'best_checkpoint_metric': 'mrr', 'maximize_best_checkpoint_metric': 1, 'patience': 10}, 'eval': {'path': '/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/birnn/checkpoints/checkpoint_best.pt', 'quiet': 1, 'max_sentences': 1000, 'model_overrides': '{}', 'eval_size': -1}} (train.py:304, cli_main())
[2021-04-20 05:06:13]    INFO >> single GPU training... (train.py:333, cli_main())
[2021-04-20 05:06:14]    INFO >> loaded 7325 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/valid.go.code_tokens'] (hybrid_retrieval.py:54, load_tokens_dataset())
[2021-04-20 05:06:14]    INFO >> loaded 7325 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/valid.go.docstring_tokens'] (hybrid_retrieval.py:55, load_tokens_dataset())
[2021-04-20 05:06:14]    INFO >> BiRNN(
  (src_encoders): ModuleDict(
    (go): RNNEncoder(
      (embed): Embedding(10000, 128)
      (weight_layer): Linear(in_features=128, out_features=1, bias=False)
      (rnn): LSTM(128, 64, num_layers=2, batch_first=True, dropout=0.2, bidirectional=True)
    )
  )
  (tgt_encoders): RNNEncoder(
    (embed): Embedding(10000, 128)
    (weight_layer): Linear(in_features=128, out_features=1, bias=False)
    (rnn): LSTM(128, 64, num_layers=2, batch_first=True, dropout=0.2, bidirectional=True)
  )
) (train.py:223, single_main())
[2021-04-20 05:06:14]    INFO >> model birnn, criterion SearchSoftmaxCriterion (train.py:224, single_main())
[2021-04-20 05:06:14]    INFO >> num. model params: 2957568 (num. trained: 2957568) (train.py:227, single_main())
[2021-04-20 05:06:19]    INFO >> training on 1 GPUs (train.py:233, single_main())
[2021-04-20 05:06:19]    INFO >> max tokens per GPU = None and max sentences per GPU = 1000 (train.py:236, single_main())
[2021-04-20 05:06:19]    INFO >> no existing checkpoint found /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/birnn/checkpoints/checkpoint_last.pt (ncc_trainers.py:270, load_checkpoint())
[2021-04-20 05:06:19]    INFO >> loading train data for epoch 1 (ncc_trainers.py:285, get_train_iterator())
[2021-04-20 05:06:19]    INFO >> loaded 167288 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.go.code_tokens'] (hybrid_retrieval.py:54, load_tokens_dataset())
[2021-04-20 05:06:19]    INFO >> loaded 167288 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.go.docstring_tokens'] (hybrid_retrieval.py:55, load_tokens_dataset())
[2021-04-20 05:06:19]    INFO >> loaded 167288 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.go.code_tokens.wo_func'] (hybrid_retrieval.py:67, load_tokens_dataset())
[2021-04-20 05:06:19]    INFO >> loaded 167288 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.go.func_name'] (hybrid_retrieval.py:81, load_tokens_dataset())
[2021-04-20 05:06:20]    INFO >> NOTE: your device may support faster training with fp16 (ncc_trainers.py:155, _setup_optimizer())
[2021-04-20 05:09:12]    INFO >> epoch 001 | loss 5.552 | mrr 0.104313 | sample_size 1000 | wps 984.5 | ups 0.98 | wpb 1000 | bsz 1000 | num_updates 167 | lr 0.01 | gnorm 0.571 | clip 11.4 | train_wall 169 | wall 172 (progress_bar.py:269, print())
[2021-04-20 05:09:16]    INFO >> epoch 001 | valid on 'valid' subset | loss 3.363 | mrr 0.40437 | sample_size 1000 | wps 5505 | wpb 1000 | bsz 1000 | num_updates 167 (progress_bar.py:269, print())
[2021-04-20 05:09:16]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/birnn/checkpoints/checkpoint_best.pt (epoch 1 @ 167 updates, score 0.40437) (writing took 0.322879 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 05:12:05]    INFO >> epoch 002 | loss 1.951 | mrr 0.650756 | sample_size 1000 | wps 962.1 | ups 0.96 | wpb 1000 | bsz 1000 | num_updates 334 | lr 0.01 | gnorm 0.378 | clip 0 | train_wall 166 | wall 346 (progress_bar.py:269, print())
[2021-04-20 05:12:10]    INFO >> epoch 002 | valid on 'valid' subset | loss 1.41 | mrr 0.742566 | sample_size 1000 | wps 5413.3 | wpb 1000 | bsz 1000 | num_updates 334 | best_mrr 742.566 (progress_bar.py:269, print())
[2021-04-20 05:12:10]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/birnn/checkpoints/checkpoint_best.pt (epoch 2 @ 334 updates, score 0.742566) (writing took 0.301218 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 05:15:00]    INFO >> epoch 003:    167 / 168 loss=2.891, mrr=516.497, sample_size=1000, wps=964.4, ups=0.96, wpb=1000, bsz=1000, num_updates=500, lr=0.01, gnorm=0.4, clip=3.8, train_wall=502, wall=521 (progress_bar.py:262, log())
[2021-04-20 05:15:02]    INFO >> epoch 003 | loss 1.159 | mrr 0.796209 | sample_size 1000 | wps 945.9 | ups 0.95 | wpb 1000 | bsz 1000 | num_updates 501 | lr 0.01 | gnorm 0.25 | clip 0 | train_wall 169 | wall 522 (progress_bar.py:269, print())
[2021-04-20 05:15:06]    INFO >> epoch 003 | valid on 'valid' subset | loss 1.132 | mrr 0.786937 | sample_size 1000 | wps 5167.2 | wpb 1000 | bsz 1000 | num_updates 501 | best_mrr 786.937 (progress_bar.py:269, print())
[2021-04-20 05:15:07]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/birnn/checkpoints/checkpoint_best.pt (epoch 3 @ 501 updates, score 0.786937) (writing took 0.307933 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 05:17:58]    INFO >> epoch 004 | loss 0.888 | mrr 0.843889 | sample_size 1000 | wps 946.4 | ups 0.95 | wpb 1000 | bsz 1000 | num_updates 668 | lr 0.01 | gnorm 0.224 | clip 0 | train_wall 168 | wall 699 (progress_bar.py:269, print())
[2021-04-20 05:18:03]    INFO >> epoch 004 | valid on 'valid' subset | loss 1.045 | mrr 0.805253 | sample_size 1000 | wps 5460.8 | wpb 1000 | bsz 1000 | num_updates 668 | best_mrr 805.253 (progress_bar.py:269, print())
[2021-04-20 05:18:03]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/birnn/checkpoints/checkpoint_best.pt (epoch 4 @ 668 updates, score 0.805253) (writing took 0.312472 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 05:20:55]    INFO >> epoch 005 | loss 0.753 | mrr 0.86689 | sample_size 1000 | wps 944.1 | ups 0.94 | wpb 1000 | bsz 1000 | num_updates 835 | lr 0.01 | gnorm 0.207 | clip 0 | train_wall 169 | wall 876 (progress_bar.py:269, print())
[2021-04-20 05:21:00]    INFO >> epoch 005 | valid on 'valid' subset | loss 0.98 | mrr 0.815044 | sample_size 1000 | wps 5366.4 | wpb 1000 | bsz 1000 | num_updates 835 | best_mrr 815.044 (progress_bar.py:269, print())
[2021-04-20 05:21:00]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/birnn/checkpoints/checkpoint_best.pt (epoch 5 @ 835 updates, score 0.815044) (writing took 0.279541 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 05:23:49]    INFO >> epoch 006:    166 / 168 loss=0.765, mrr=864.872, sample_size=1000, wps=945.4, ups=0.95, wpb=1000, bsz=1000, num_updates=1000, lr=0.01, gnorm=0.209, clip=0, train_wall=505, wall=1050 (progress_bar.py:262, log())
[2021-04-20 05:23:52]    INFO >> epoch 006 | loss 0.651 | mrr 0.884447 | sample_size 1000 | wps 946 | ups 0.95 | wpb 1000 | bsz 1000 | num_updates 1002 | lr 0.01 | gnorm 0.196 | clip 0 | train_wall 169 | wall 1052 (progress_bar.py:269, print())
[2021-04-20 05:23:55]    INFO >> epoch 006 | valid on 'valid' subset | loss 0.954 | mrr 0.821069 | sample_size 1000 | wps 5339.6 | wpb 1000 | bsz 1000 | num_updates 1002 | best_mrr 821.069 (progress_bar.py:269, print())
[2021-04-20 05:23:56]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/birnn/checkpoints/checkpoint_best.pt (epoch 6 @ 1002 updates, score 0.821069) (writing took 0.338572 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 05:26:48]    INFO >> epoch 007 | loss 0.587 | mrr 0.895924 | sample_size 1000 | wps 947.1 | ups 0.95 | wpb 1000 | bsz 1000 | num_updates 1169 | lr 0.01 | gnorm 0.19 | clip 0 | train_wall 168 | wall 1229 (progress_bar.py:269, print())
[2021-04-20 05:26:52]    INFO >> epoch 007 | valid on 'valid' subset | loss 0.95 | mrr 0.82564 | sample_size 1000 | wps 5403.3 | wpb 1000 | bsz 1000 | num_updates 1169 | best_mrr 825.64 (progress_bar.py:269, print())
[2021-04-20 05:26:52]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/birnn/checkpoints/checkpoint_best.pt (epoch 7 @ 1169 updates, score 0.82564) (writing took 0.273979 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 05:29:44]    INFO >> epoch 008 | loss 0.533 | mrr 0.905618 | sample_size 1000 | wps 950.7 | ups 0.95 | wpb 1000 | bsz 1000 | num_updates 1336 | lr 0.01 | gnorm 0.185 | clip 0 | train_wall 169 | wall 1404 (progress_bar.py:269, print())
[2021-04-20 05:29:47]    INFO >> epoch 008 | valid on 'valid' subset | loss 0.915 | mrr 0.826498 | sample_size 1000 | wps 5383.7 | wpb 1000 | bsz 1000 | num_updates 1336 | best_mrr 826.498 (progress_bar.py:269, print())
[2021-04-20 05:29:47]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/birnn/checkpoints/checkpoint_best.pt (epoch 8 @ 1336 updates, score 0.826498) (writing took 0.251210 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 05:32:36]    INFO >> epoch 009:    164 / 168 loss=0.538, mrr=904.616, sample_size=1000, wps=949.5, ups=0.95, wpb=1000, bsz=1000, num_updates=1500, lr=0.01, gnorm=0.185, clip=0, train_wall=505, wall=1577 (progress_bar.py:262, log())
[2021-04-20 05:32:39]    INFO >> epoch 009 | loss 0.491 | mrr 0.91257 | sample_size 1000 | wps 951.1 | ups 0.95 | wpb 1000 | bsz 1000 | num_updates 1503 | lr 0.01 | gnorm 0.18 | clip 0 | train_wall 169 | wall 1580 (progress_bar.py:269, print())
[2021-04-20 05:32:43]    INFO >> epoch 009 | valid on 'valid' subset | loss 0.91 | mrr 0.826627 | sample_size 1000 | wps 5214.8 | wpb 1000 | bsz 1000 | num_updates 1503 | best_mrr 826.627 (progress_bar.py:269, print())
[2021-04-20 05:32:43]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/birnn/checkpoints/checkpoint_best.pt (epoch 9 @ 1503 updates, score 0.826627) (writing took 0.291146 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 05:35:32]    INFO >> epoch 010 | loss 0.469 | mrr 0.916825 | sample_size 1000 | wps 969.2 | ups 0.97 | wpb 1000 | bsz 1000 | num_updates 1670 | lr 0.01 | gnorm 0.181 | clip 0 | train_wall 165 | wall 1752 (progress_bar.py:269, print())
[2021-04-20 05:35:35]    INFO >> epoch 010 | valid on 'valid' subset | loss 0.934 | mrr 0.82534 | sample_size 1000 | wps 5302.7 | wpb 1000 | bsz 1000 | num_updates 1670 | best_mrr 825.34 (progress_bar.py:269, print())
[2021-04-20 05:35:35]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/birnn/checkpoints/checkpoint_last.pt (epoch 10 @ 1670 updates, score 0.82534) (writing took 0.152495 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 05:38:27]    INFO >> epoch 011 | loss 0.445 | mrr 0.921432 | sample_size 1000 | wps 951.5 | ups 0.95 | wpb 1000 | bsz 1000 | num_updates 1837 | lr 0.01 | gnorm 0.176 | clip 0 | train_wall 169 | wall 1928 (progress_bar.py:269, print())
[2021-04-20 05:38:31]    INFO >> epoch 011 | valid on 'valid' subset | loss 0.936 | mrr 0.824267 | sample_size 1000 | wps 5140.4 | wpb 1000 | bsz 1000 | num_updates 1837 | best_mrr 824.267 (progress_bar.py:269, print())
[2021-04-20 05:38:31]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/birnn/checkpoints/checkpoint_last.pt (epoch 11 @ 1837 updates, score 0.824267) (writing took 0.146572 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 05:41:19]    INFO >> epoch 012:    164 / 168 loss=0.447, mrr=920.653, sample_size=1000, wps=955, ups=0.95, wpb=1000, bsz=1000, num_updates=2000, lr=0.01, gnorm=0.178, clip=0, train_wall=503, wall=2100 (progress_bar.py:262, log())
[2021-04-20 05:41:23]    INFO >> epoch 012 | loss 0.427 | mrr 0.923825 | sample_size 1000 | wps 951.3 | ups 0.95 | wpb 1000 | bsz 1000 | num_updates 2004 | lr 0.01 | gnorm 0.177 | clip 0 | train_wall 169 | wall 2103 (progress_bar.py:269, print())
[2021-04-20 05:41:26]    INFO >> epoch 012 | valid on 'valid' subset | loss 0.917 | mrr 0.827208 | sample_size 1000 | wps 5363.8 | wpb 1000 | bsz 1000 | num_updates 2004 | best_mrr 827.208 (progress_bar.py:269, print())
[2021-04-20 05:41:26]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/birnn/checkpoints/checkpoint_best.pt (epoch 12 @ 2004 updates, score 0.827208) (writing took 0.252858 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 05:44:21]    INFO >> epoch 013 | loss 0.412 | mrr 0.926528 | sample_size 1000 | wps 937.3 | ups 0.94 | wpb 1000 | bsz 1000 | num_updates 2171 | lr 0.01 | gnorm 0.175 | clip 0 | train_wall 171 | wall 2282 (progress_bar.py:269, print())
[2021-04-20 05:44:24]    INFO >> epoch 013 | valid on 'valid' subset | loss 0.912 | mrr 0.829981 | sample_size 1000 | wps 7219 | wpb 1000 | bsz 1000 | num_updates 2171 | best_mrr 829.981 (progress_bar.py:269, print())
[2021-04-20 05:44:24]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/birnn/checkpoints/checkpoint_best.pt (epoch 13 @ 2171 updates, score 0.829981) (writing took 0.248017 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 05:47:20]    INFO >> epoch 014 | loss 0.403 | mrr 0.928257 | sample_size 1000 | wps 934.9 | ups 0.93 | wpb 1000 | bsz 1000 | num_updates 2338 | lr 0.01 | gnorm 0.173 | clip 0 | train_wall 172 | wall 2460 (progress_bar.py:269, print())
[2021-04-20 05:47:24]    INFO >> epoch 014 | valid on 'valid' subset | loss 0.938 | mrr 0.829617 | sample_size 1000 | wps 5421.6 | wpb 1000 | bsz 1000 | num_updates 2338 | best_mrr 829.617 (progress_bar.py:269, print())
[2021-04-20 05:47:24]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/birnn/checkpoints/checkpoint_last.pt (epoch 14 @ 2338 updates, score 0.829617) (writing took 0.343657 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 05:50:13]    INFO >> epoch 015:    163 / 168 loss=0.401, mrr=928.693, sample_size=1000, wps=937.7, ups=0.94, wpb=1000, bsz=1000, num_updates=2500, lr=0.01, gnorm=0.173, clip=0, train_wall=512, wall=2633 (progress_bar.py:262, log())
[2021-04-20 05:50:18]    INFO >> epoch 015 | loss 0.386 | mrr 0.931553 | sample_size 1000 | wps 934.9 | ups 0.93 | wpb 1000 | bsz 1000 | num_updates 2505 | lr 0.01 | gnorm 0.17 | clip 0 | train_wall 171 | wall 2639 (progress_bar.py:269, print())
[2021-04-20 05:50:23]    INFO >> epoch 015 | valid on 'valid' subset | loss 0.913 | mrr 0.831431 | sample_size 1000 | wps 5417.5 | wpb 1000 | bsz 1000 | num_updates 2505 | best_mrr 831.431 (progress_bar.py:269, print())
[2021-04-20 05:50:23]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/birnn/checkpoints/checkpoint_best.pt (epoch 15 @ 2505 updates, score 0.831431) (writing took 0.286246 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 05:53:15]    INFO >> epoch 016 | loss 0.379 | mrr 0.932241 | sample_size 1000 | wps 942.3 | ups 0.94 | wpb 1000 | bsz 1000 | num_updates 2672 | lr 0.01 | gnorm 0.171 | clip 0 | train_wall 169 | wall 2816 (progress_bar.py:269, print())
[2021-04-20 05:53:20]    INFO >> epoch 016 | valid on 'valid' subset | loss 0.94 | mrr 0.827893 | sample_size 1000 | wps 5418.1 | wpb 1000 | bsz 1000 | num_updates 2672 | best_mrr 827.893 (progress_bar.py:269, print())
[2021-04-20 05:53:20]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/birnn/checkpoints/checkpoint_last.pt (epoch 16 @ 2672 updates, score 0.827893) (writing took 0.152287 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 05:56:12]    INFO >> epoch 017 | loss 0.379 | mrr 0.93253 | sample_size 1000 | wps 944.7 | ups 0.94 | wpb 1000 | bsz 1000 | num_updates 2839 | lr 0.01 | gnorm 0.174 | clip 0 | train_wall 169 | wall 2993 (progress_bar.py:269, print())
[2021-04-20 05:56:17]    INFO >> epoch 017 | valid on 'valid' subset | loss 0.904 | mrr 0.831887 | sample_size 1000 | wps 5306.9 | wpb 1000 | bsz 1000 | num_updates 2839 | best_mrr 831.887 (progress_bar.py:269, print())
[2021-04-20 05:56:17]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/birnn/checkpoints/checkpoint_best.pt (epoch 17 @ 2839 updates, score 0.831887) (writing took 0.339434 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 05:58:58]    INFO >> epoch 018:    162 / 168 loss=0.375, mrr=932.97, sample_size=1000, wps=952.2, ups=0.95, wpb=1000, bsz=1000, num_updates=3000, lr=0.01, gnorm=0.172, clip=0, train_wall=501, wall=3159 (progress_bar.py:262, log())
[2021-04-20 05:59:04]    INFO >> epoch 018 | loss 0.368 | mrr 0.934132 | sample_size 1000 | wps 969.8 | ups 0.97 | wpb 1000 | bsz 1000 | num_updates 3006 | lr 0.01 | gnorm 0.171 | clip 0 | train_wall 164 | wall 3165 (progress_bar.py:269, print())
[2021-04-20 05:59:09]    INFO >> epoch 018 | valid on 'valid' subset | loss 0.898 | mrr 0.833901 | sample_size 1000 | wps 5416.5 | wpb 1000 | bsz 1000 | num_updates 3006 | best_mrr 833.901 (progress_bar.py:269, print())
[2021-04-20 05:59:09]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/birnn/checkpoints/checkpoint_best.pt (epoch 18 @ 3006 updates, score 0.833901) (writing took 0.248007 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 06:02:02]    INFO >> epoch 019 | loss 0.361 | mrr 0.935534 | sample_size 1000 | wps 941.8 | ups 0.94 | wpb 1000 | bsz 1000 | num_updates 3173 | lr 0.01 | gnorm 0.17 | clip 0 | train_wall 169 | wall 3342 (progress_bar.py:269, print())
[2021-04-20 06:02:06]    INFO >> epoch 019 | valid on 'valid' subset | loss 0.919 | mrr 0.831591 | sample_size 1000 | wps 5109 | wpb 1000 | bsz 1000 | num_updates 3173 | best_mrr 831.591 (progress_bar.py:269, print())
[2021-04-20 06:02:06]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/birnn/checkpoints/checkpoint_last.pt (epoch 19 @ 3173 updates, score 0.831591) (writing took 0.165348 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 06:04:09]    INFO >> epoch 020 | loss 0.362 | mrr 0.935321 | sample_size 1000 | wps 1312.3 | ups 1.31 | wpb 1000 | bsz 1000 | num_updates 3340 | lr 0.01 | gnorm 0.171 | clip 0 | train_wall 119 | wall 3470 (progress_bar.py:269, print())
[2021-04-20 06:04:13]    INFO >> epoch 020 | valid on 'valid' subset | loss 0.922 | mrr 0.830354 | sample_size 1000 | wps 7046.5 | wpb 1000 | bsz 1000 | num_updates 3340 | best_mrr 830.354 (progress_bar.py:269, print())
[2021-04-20 06:04:13]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/birnn/checkpoints/checkpoint_last.pt (epoch 20 @ 3340 updates, score 0.830354) (writing took 0.152717 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 06:06:02]    INFO >> epoch 021:    161 / 168 loss=0.362, mrr=935.426, sample_size=1000, wps=1179.8, ups=1.18, wpb=1000, bsz=1000, num_updates=3500, lr=0.01, gnorm=0.171, clip=0, train_wall=401, wall=3582 (progress_bar.py:262, log())
[2021-04-20 06:06:07]    INFO >> epoch 021 | loss 0.362 | mrr 0.935531 | sample_size 1000 | wps 1420.7 | ups 1.42 | wpb 1000 | bsz 1000 | num_updates 3507 | lr 0.01 | gnorm 0.171 | clip 0 | train_wall 110 | wall 3587 (progress_bar.py:269, print())
[2021-04-20 06:06:11]    INFO >> epoch 021 | valid on 'valid' subset | loss 0.927 | mrr 0.831858 | sample_size 1000 | wps 7211.3 | wpb 1000 | bsz 1000 | num_updates 3507 | best_mrr 831.858 (progress_bar.py:269, print())
[2021-04-20 06:06:11]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/birnn/checkpoints/checkpoint_last.pt (epoch 21 @ 3507 updates, score 0.831858) (writing took 0.146112 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 06:08:04]    INFO >> epoch 022 | loss 0.356 | mrr 0.93647 | sample_size 1000 | wps 1423.1 | ups 1.42 | wpb 1000 | bsz 1000 | num_updates 3674 | lr 0.01 | gnorm 0.17 | clip 0 | train_wall 110 | wall 3705 (progress_bar.py:269, print())
[2021-04-20 06:08:08]    INFO >> epoch 022 | valid on 'valid' subset | loss 0.896 | mrr 0.838846 | sample_size 1000 | wps 7531.1 | wpb 1000 | bsz 1000 | num_updates 3674 | best_mrr 838.846 (progress_bar.py:269, print())
[2021-04-20 06:08:08]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/birnn/checkpoints/checkpoint_best.pt (epoch 22 @ 3674 updates, score 0.838846) (writing took 0.296672 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 06:10:01]    INFO >> epoch 023 | loss 0.355 | mrr 0.936915 | sample_size 1000 | wps 1421.8 | ups 1.42 | wpb 1000 | bsz 1000 | num_updates 3841 | lr 0.01 | gnorm 0.169 | clip 0 | train_wall 110 | wall 3822 (progress_bar.py:269, print())
[2021-04-20 06:10:05]    INFO >> epoch 023 | valid on 'valid' subset | loss 0.915 | mrr 0.83347 | sample_size 1000 | wps 6780.1 | wpb 1000 | bsz 1000 | num_updates 3841 | best_mrr 833.47 (progress_bar.py:269, print())
[2021-04-20 06:10:06]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/birnn/checkpoints/checkpoint_last.pt (epoch 23 @ 3841 updates, score 0.83347) (writing took 0.176807 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 06:11:54]    INFO >> epoch 024:    160 / 168 loss=0.351, mrr=937.232, sample_size=1000, wps=1421.1, ups=1.42, wpb=1000, bsz=1000, num_updates=4000, lr=0.01, gnorm=0.169, clip=0, train_wall=330, wall=3934 (progress_bar.py:262, log())
[2021-04-20 06:11:59]    INFO >> epoch 024 | loss 0.343 | mrr 0.938303 | sample_size 1000 | wps 1419.2 | ups 1.42 | wpb 1000 | bsz 1000 | num_updates 4008 | lr 0.01 | gnorm 0.168 | clip 0 | train_wall 110 | wall 3940 (progress_bar.py:269, print())
[2021-04-20 06:12:03]    INFO >> epoch 024 | valid on 'valid' subset | loss 0.907 | mrr 0.83319 | sample_size 1000 | wps 6508.7 | wpb 1000 | bsz 1000 | num_updates 4008 | best_mrr 833.19 (progress_bar.py:269, print())
[2021-04-20 06:12:03]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/birnn/checkpoints/checkpoint_last.pt (epoch 24 @ 4008 updates, score 0.83319) (writing took 0.248851 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 06:13:50]    INFO >> epoch 025 | loss 0.347 | mrr 0.938239 | sample_size 1000 | wps 1511.3 | ups 1.51 | wpb 1000 | bsz 1000 | num_updates 4175 | lr 0.01 | gnorm 0.17 | clip 0 | train_wall 103 | wall 4050 (progress_bar.py:269, print())
[2021-04-20 06:13:53]    INFO >> epoch 025 | valid on 'valid' subset | loss 0.916 | mrr 0.834004 | sample_size 1000 | wps 7788 | wpb 1000 | bsz 1000 | num_updates 4175 | best_mrr 834.004 (progress_bar.py:269, print())
[2021-04-20 06:13:53]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/birnn/checkpoints/checkpoint_last.pt (epoch 25 @ 4175 updates, score 0.834004) (writing took 0.172400 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 06:15:46]    INFO >> epoch 026 | loss 0.34 | mrr 0.939358 | sample_size 1000 | wps 1437.3 | ups 1.44 | wpb 1000 | bsz 1000 | num_updates 4342 | lr 0.01 | gnorm 0.17 | clip 0 | train_wall 110 | wall 4166 (progress_bar.py:269, print())
[2021-04-20 06:15:50]    INFO >> epoch 026 | valid on 'valid' subset | loss 0.905 | mrr 0.832419 | sample_size 1000 | wps 7263.8 | wpb 1000 | bsz 1000 | num_updates 4342 | best_mrr 832.419 (progress_bar.py:269, print())
[2021-04-20 06:15:50]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/birnn/checkpoints/checkpoint_last.pt (epoch 26 @ 4342 updates, score 0.832419) (writing took 0.172332 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 06:17:37]    INFO >> epoch 027:    159 / 168 loss=0.343, mrr=938.956, sample_size=1000, wps=1456, ups=1.46, wpb=1000, bsz=1000, num_updates=4500, lr=0.01, gnorm=0.17, clip=0, train_wall=322, wall=4278 (progress_bar.py:262, log())
[2021-04-20 06:17:43]    INFO >> epoch 027 | loss 0.341 | mrr 0.939273 | sample_size 1000 | wps 1422.8 | ups 1.42 | wpb 1000 | bsz 1000 | num_updates 4509 | lr 0.01 | gnorm 0.17 | clip 0 | train_wall 110 | wall 4284 (progress_bar.py:269, print())
[2021-04-20 06:17:47]    INFO >> epoch 027 | valid on 'valid' subset | loss 0.901 | mrr 0.837351 | sample_size 1000 | wps 7488.5 | wpb 1000 | bsz 1000 | num_updates 4509 | best_mrr 837.351 (progress_bar.py:269, print())
[2021-04-20 06:17:47]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/birnn/checkpoints/checkpoint_last.pt (epoch 27 @ 4509 updates, score 0.837351) (writing took 0.174787 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 06:19:41]    INFO >> epoch 028 | loss 0.34 | mrr 0.939308 | sample_size 1000 | wps 1422.5 | ups 1.42 | wpb 1000 | bsz 1000 | num_updates 4676 | lr 0.01 | gnorm 0.171 | clip 0 | train_wall 110 | wall 4401 (progress_bar.py:269, print())
[2021-04-20 06:19:45]    INFO >> epoch 028 | valid on 'valid' subset | loss 0.91 | mrr 0.837099 | sample_size 1000 | wps 6806.3 | wpb 1000 | bsz 1000 | num_updates 4676 | best_mrr 837.099 (progress_bar.py:269, print())
[2021-04-20 06:19:45]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/birnn/checkpoints/checkpoint_last.pt (epoch 28 @ 4676 updates, score 0.837099) (writing took 0.163916 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 06:21:38]    INFO >> epoch 029 | loss 0.338 | mrr 0.939937 | sample_size 1000 | wps 1423.9 | ups 1.42 | wpb 1000 | bsz 1000 | num_updates 4843 | lr 0.01 | gnorm 0.168 | clip 0 | train_wall 110 | wall 4518 (progress_bar.py:269, print())
[2021-04-20 06:21:42]    INFO >> epoch 029 | valid on 'valid' subset | loss 0.906 | mrr 0.834981 | sample_size 1000 | wps 7537.1 | wpb 1000 | bsz 1000 | num_updates 4843 | best_mrr 834.981 (progress_bar.py:269, print())
[2021-04-20 06:21:42]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/birnn/checkpoints/checkpoint_last.pt (epoch 29 @ 4843 updates, score 0.834981) (writing took 0.200497 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 06:23:29]    INFO >> epoch 030:    158 / 168 loss=0.339, mrr=939.349, sample_size=1000, wps=1422.1, ups=1.42, wpb=1000, bsz=1000, num_updates=5000, lr=0.01, gnorm=0.171, clip=0, train_wall=330, wall=4629 (progress_bar.py:262, log())
[2021-04-20 06:23:35]    INFO >> epoch 030 | loss 0.34 | mrr 0.938809 | sample_size 1000 | wps 1419.8 | ups 1.42 | wpb 1000 | bsz 1000 | num_updates 5010 | lr 0.01 | gnorm 0.175 | clip 0 | train_wall 110 | wall 4636 (progress_bar.py:269, print())
[2021-04-20 06:23:39]    INFO >> epoch 030 | valid on 'valid' subset | loss 0.918 | mrr 0.834206 | sample_size 1000 | wps 7793.2 | wpb 1000 | bsz 1000 | num_updates 5010 | best_mrr 834.206 (progress_bar.py:269, print())
[2021-04-20 06:23:40]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/birnn/checkpoints/checkpoint_last.pt (epoch 30 @ 5010 updates, score 0.834206) (writing took 0.320220 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 06:25:33]    INFO >> epoch 031 | loss 0.341 | mrr 0.93911 | sample_size 1000 | wps 1422.6 | ups 1.42 | wpb 1000 | bsz 1000 | num_updates 5177 | lr 0.01 | gnorm 0.17 | clip 0 | train_wall 110 | wall 4753 (progress_bar.py:269, print())
[2021-04-20 06:25:37]    INFO >> epoch 031 | valid on 'valid' subset | loss 0.94 | mrr 0.834267 | sample_size 1000 | wps 7619.4 | wpb 1000 | bsz 1000 | num_updates 5177 | best_mrr 834.267 (progress_bar.py:269, print())
[2021-04-20 06:25:37]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/birnn/checkpoints/checkpoint_last.pt (epoch 31 @ 5177 updates, score 0.834267) (writing took 0.203399 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 06:27:30]    INFO >> epoch 032 | loss 0.338 | mrr 0.939202 | sample_size 1000 | wps 1422.5 | ups 1.42 | wpb 1000 | bsz 1000 | num_updates 5344 | lr 0.01 | gnorm 0.171 | clip 0 | train_wall 110 | wall 4871 (progress_bar.py:269, print())
[2021-04-20 06:27:34]    INFO >> epoch 032 | valid on 'valid' subset | loss 0.927 | mrr 0.83286 | sample_size 1000 | wps 9445.8 | wpb 1000 | bsz 1000 | num_updates 5344 | best_mrr 832.86 (progress_bar.py:269, print())
[2021-04-20 06:27:34]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/birnn/checkpoints/checkpoint_last.pt (epoch 32 @ 5344 updates, score 0.83286) (writing took 0.319511 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 06:27:34]    INFO >> early stop since valid performance hasn't improved for last 10 runs (train.py:191, should_stop_early())
[2021-04-20 06:27:34]    INFO >> early stop since valid performance hasn't improved for last 10 runs (train.py:272, single_main())
[2021-04-20 06:27:34]    INFO >> done training in 4874.7 seconds (train.py:283, single_main())
