nohup: 忽略输入
[2021-04-20 04:29:35]    INFO >> Load arguments in /home/yanghe/Documents/naturalcc-dev/run/retrieval/birnn/config/csn_feng/javascript.yml (train.py:302, cli_main())
[2021-04-20 04:29:35]    INFO >> {'criterion': 'retrieval_softmax', 'optimizer': 'torch_adam', 'lr_scheduler': 'fixed', 'tokenizer': None, 'bpe': None, 'common': {'no_progress_bar': 0, 'log_interval': 500, 'log_format': 'simple', 'tensorboard_logdir': '', 'seed': 0, 'cpu': 0, 'fp16': 0, 'memory_efficient_fp16': 0, 'fp16_no_flatten_grads': 0, 'fp16_init_scale': 128, 'fp16_scale_window': None, 'fp16_scale_tolerance': 0.0, 'min_loss_scale': 0.0001, 'threshold_loss_scale': None, 'user_dir': None, 'empty_cache_freq': 0, 'all_gather_list_size': 16384, 'task': 'hybrid_retrieval'}, 'dataset': {'num_workers': 1, 'skip_invalid_size_inputs_valid_test': 0, 'max_tokens': None, 'max_sentences': 1000, 'code_max_tokens': 200, 'query_max_tokens': 30, 'required_batch_size_multiple': 8, 'dataset_impl': 'mmap', 'train_subset': 'train', 'valid_subset': 'valid', 'validate_interval': 1, 'fixed_validation_seed': None, 'disable_validation': None, 'max_tokens_valid': None, 'max_sentences_valid': 1000, 'curriculum': 0, 'gen_subset': 'test', 'num_shards': 1, 'shard_id': 0, 'joined_dictionary': 0, 'langs': ['javascript']}, 'distributed_training': {'distributed_world_size': 1, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': None, 'distributed_port': -1, 'device_id': 0, 'distributed_no_spawn': 0, 'ddp_backend': 'c10d', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': None, 'find_unused_parameters': 0, 'fast_stat_sync': 0, 'broadcast_buffers': 0, 'global_sync_iter': 50, 'warmup_iterations': 500, 'local_rank': -1, 'block_momentum': 0.875, 'block_lr': 1, 'use_nbm': 0, 'average_sync': 0}, 'task': {'data': '/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all', 'sample_break_mode': 'complete', 'tokens_per_sample': 512, 'mask_prob': 0.15, 'leave_unmasked_prob': 0.1, 'random_token_prob': 0.1, 'freq_weighted_replacement': 0, 'mask_whole_words': 0, 'pooler_activation_fn': 'tanh', 'source_lang': 'code_tokens', 'target_lang': 'docstring_tokens', 'source_aux_lang': 'code_tokens.wo_func', 'target_aux_lang': 'func_name', 'fraction_using_func_name': 0.3, 'load_alignments': 0, 'left_pad_source': 1, 'left_pad_target': 0, 'upsample_primary': 1, 'truncate_source': 0, 'eval_mrr': 1}, 'model': {'arch': 'birnn', 'code_embed_dim': 128, 'code_doprout': 0.1, 'code_rnn_cell': 'lstm', 'code_rnn_layers': 2, 'code_hidden_dim': 64, 'code_rnn_dropout': 0.2, 'code_rnn_bidirectional': True, 'code_pooling': 'weighted_mean', 'code_activation_fn': 'tanh', 'code_paddding': 'same', 'query_embed_dim': 128, 'query_doprout': 0.1, 'query_rnn_cell': 'lstm', 'query_rnn_layers': 2, 'query_hidden_dim': 64, 'query_rnn_dropout': 0.2, 'query_rnn_bidirectional': True, 'query_pooling': 'weighted_mean', 'query_activation_fn': 'tanh', 'query_paddding': 'same', 'dropout': 0.1}, 'optimization': {'max_epoch': 300, 'max_update': 0, 'clip_norm': 1, 'sentence_avg': 0, 'update_freq': [1], 'lrs': [0.01], 'min_lr': -1, 'use_bmuf': 0, 'lr_shrink': 1.0, 'force_anneal': 0, 'warmup_updates': 0, 'end_learning_rate': 0.0, 'power': 1.0, 'total_num_update': 1000000, 'adam': {'adam_betas': '(0.9, 0.999)', 'adam_eps': 1e-08, 'weight_decay': 0, 'use_old_adam': 1}, 'margin': 1, 'clip_norm_version': 'tf_clip_by_global_norm'}, 'checkpoint': {'save_dir': '/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/javascript/birnn/checkpoints', 'restore_file': 'checkpoint_last.pt', 'reset_dataloader': None, 'reset_lr_scheduler': None, 'reset_meters': None, 'reset_optimizer': None, 'optimizer_overrides': '{}', 'save_interval': 1, 'save_interval_updates': 0, 'keep_interval_updates': 0, 'keep_last_epochs': -1, 'keep_best_checkpoints': -1, 'no_save': 0, 'no_epoch_checkpoints': 1, 'no_last_checkpoints': 0, 'no_save_optimizer_state': None, 'best_checkpoint_metric': 'mrr', 'maximize_best_checkpoint_metric': 1, 'patience': 10}, 'eval': {'path': '/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/javascript/birnn/checkpoints/checkpoint_best.pt', 'quiet': 1, 'max_sentences': 1000, 'model_overrides': '{}', 'eval_size': -1}} (train.py:304, cli_main())
[2021-04-20 04:29:35]    INFO >> single GPU training... (train.py:333, cli_main())
[2021-04-20 04:29:35]    INFO >> loaded 3885 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/valid.javascript.code_tokens'] (hybrid_retrieval.py:54, load_tokens_dataset())
[2021-04-20 04:29:35]    INFO >> loaded 3885 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/valid.javascript.docstring_tokens'] (hybrid_retrieval.py:55, load_tokens_dataset())
[2021-04-20 04:29:35]    INFO >> BiRNN(
  (src_encoders): ModuleDict(
    (javascript): RNNEncoder(
      (embed): Embedding(10000, 128)
      (weight_layer): Linear(in_features=128, out_features=1, bias=False)
      (rnn): LSTM(128, 64, num_layers=2, batch_first=True, dropout=0.2, bidirectional=True)
    )
  )
  (tgt_encoders): RNNEncoder(
    (embed): Embedding(10000, 128)
    (weight_layer): Linear(in_features=128, out_features=1, bias=False)
    (rnn): LSTM(128, 64, num_layers=2, batch_first=True, dropout=0.2, bidirectional=True)
  )
) (train.py:223, single_main())
[2021-04-20 04:29:35]    INFO >> model birnn, criterion SearchSoftmaxCriterion (train.py:224, single_main())
[2021-04-20 04:29:35]    INFO >> num. model params: 2957568 (num. trained: 2957568) (train.py:227, single_main())
[2021-04-20 04:29:41]    INFO >> training on 1 GPUs (train.py:233, single_main())
[2021-04-20 04:29:41]    INFO >> max tokens per GPU = None and max sentences per GPU = 1000 (train.py:236, single_main())
[2021-04-20 04:29:41]    INFO >> no existing checkpoint found /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/javascript/birnn/checkpoints/checkpoint_last.pt (ncc_trainers.py:270, load_checkpoint())
[2021-04-20 04:29:41]    INFO >> loading train data for epoch 1 (ncc_trainers.py:285, get_train_iterator())
[2021-04-20 04:29:41]    INFO >> loaded 58025 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.javascript.code_tokens'] (hybrid_retrieval.py:54, load_tokens_dataset())
[2021-04-20 04:29:41]    INFO >> loaded 58025 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.javascript.docstring_tokens'] (hybrid_retrieval.py:55, load_tokens_dataset())
[2021-04-20 04:29:41]    INFO >> loaded 58025 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.javascript.code_tokens.wo_func'] (hybrid_retrieval.py:67, load_tokens_dataset())
[2021-04-20 04:29:41]    INFO >> loaded 58025 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.javascript.func_name'] (hybrid_retrieval.py:81, load_tokens_dataset())
[2021-04-20 04:29:41]    INFO >> NOTE: your device may support faster training with fp16 (ncc_trainers.py:155, _setup_optimizer())
[2021-04-20 04:30:46]    INFO >> epoch 001 | loss 6.691 | mrr 0.014151 | sample_size 1000 | wps 917.6 | ups 0.92 | wpb 1000 | bsz 1000 | num_updates 58 | lr 0.01 | gnorm 0.13 | clip 0 | train_wall 63 | wall 66 (progress_bar.py:269, print())
[2021-04-20 04:30:50]    INFO >> epoch 001 | valid on 'valid' subset | loss 6.438 | mrr 0.022544 | sample_size 1000 | wps 3948.6 | wpb 1000 | bsz 1000 | num_updates 58 (progress_bar.py:269, print())
[2021-04-20 04:30:50]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/javascript/birnn/checkpoints/checkpoint_best.pt (epoch 1 @ 58 updates, score 0.022544) (writing took 0.248576 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:31:53]    INFO >> epoch 002 | loss 6.244 | mrr 0.029972 | sample_size 1000 | wps 873.4 | ups 0.87 | wpb 1000 | bsz 1000 | num_updates 116 | lr 0.01 | gnorm 0.32 | clip 3.4 | train_wall 60 | wall 132 (progress_bar.py:269, print())
[2021-04-20 04:31:56]    INFO >> epoch 002 | valid on 'valid' subset | loss 6.088 | mrr 0.036955 | sample_size 1000 | wps 4112.6 | wpb 1000 | bsz 1000 | num_updates 116 | best_mrr 36.9546 (progress_bar.py:269, print())
[2021-04-20 04:31:57]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/javascript/birnn/checkpoints/checkpoint_best.pt (epoch 2 @ 116 updates, score 0.036955) (writing took 0.243696 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:32:59]    INFO >> epoch 003 | loss 5.646 | mrr 0.070113 | sample_size 1000 | wps 876.2 | ups 0.88 | wpb 1000 | bsz 1000 | num_updates 174 | lr 0.01 | gnorm 0.401 | clip 1.7 | train_wall 60 | wall 198 (progress_bar.py:269, print())
[2021-04-20 04:33:03]    INFO >> epoch 003 | valid on 'valid' subset | loss 5.687 | mrr 0.074324 | sample_size 1000 | wps 3965.3 | wpb 1000 | bsz 1000 | num_updates 174 | best_mrr 74.3245 (progress_bar.py:269, print())
[2021-04-20 04:33:03]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/javascript/birnn/checkpoints/checkpoint_best.pt (epoch 3 @ 174 updates, score 0.074324) (writing took 0.551230 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:34:09]    INFO >> epoch 004 | loss 5.049 | mrr 0.131346 | sample_size 1000 | wps 830.1 | ups 0.83 | wpb 1000 | bsz 1000 | num_updates 232 | lr 0.01 | gnorm 0.355 | clip 0 | train_wall 63 | wall 268 (progress_bar.py:269, print())
[2021-04-20 04:34:13]    INFO >> epoch 004 | valid on 'valid' subset | loss 5.242 | mrr 0.13174 | sample_size 1000 | wps 3758.7 | wpb 1000 | bsz 1000 | num_updates 232 | best_mrr 131.74 (progress_bar.py:269, print())
[2021-04-20 04:34:13]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/javascript/birnn/checkpoints/checkpoint_best.pt (epoch 4 @ 232 updates, score 0.13174) (writing took 0.303120 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:35:19]    INFO >> epoch 005 | loss 4.429 | mrr 0.220352 | sample_size 1000 | wps 833.2 | ups 0.83 | wpb 1000 | bsz 1000 | num_updates 290 | lr 0.01 | gnorm 0.397 | clip 0 | train_wall 63 | wall 338 (progress_bar.py:269, print())
[2021-04-20 04:35:22]    INFO >> epoch 005 | valid on 'valid' subset | loss 4.783 | mrr 0.201897 | sample_size 1000 | wps 3858.4 | wpb 1000 | bsz 1000 | num_updates 290 | best_mrr 201.897 (progress_bar.py:269, print())
[2021-04-20 04:35:23]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/javascript/birnn/checkpoints/checkpoint_best.pt (epoch 5 @ 290 updates, score 0.201897) (writing took 0.295346 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:36:28]    INFO >> epoch 006 | loss 3.844 | mrr 0.317272 | sample_size 1000 | wps 835.3 | ups 0.84 | wpb 1000 | bsz 1000 | num_updates 348 | lr 0.01 | gnorm 0.368 | clip 0 | train_wall 63 | wall 407 (progress_bar.py:269, print())
[2021-04-20 04:36:32]    INFO >> epoch 006 | valid on 'valid' subset | loss 4.46 | mrr 0.26884 | sample_size 1000 | wps 3457.2 | wpb 1000 | bsz 1000 | num_updates 348 | best_mrr 268.84 (progress_bar.py:269, print())
[2021-04-20 04:36:32]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/javascript/birnn/checkpoints/checkpoint_best.pt (epoch 6 @ 348 updates, score 0.26884) (writing took 0.247801 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:37:38]    INFO >> epoch 007 | loss 3.341 | mrr 0.403895 | sample_size 1000 | wps 832.8 | ups 0.83 | wpb 1000 | bsz 1000 | num_updates 406 | lr 0.01 | gnorm 0.367 | clip 0 | train_wall 63 | wall 477 (progress_bar.py:269, print())
[2021-04-20 04:37:41]    INFO >> epoch 007 | valid on 'valid' subset | loss 4.245 | mrr 0.297585 | sample_size 1000 | wps 3643.2 | wpb 1000 | bsz 1000 | num_updates 406 | best_mrr 297.585 (progress_bar.py:269, print())
[2021-04-20 04:37:42]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/javascript/birnn/checkpoints/checkpoint_best.pt (epoch 7 @ 406 updates, score 0.297585) (writing took 0.306923 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:38:44]    INFO >> epoch 008 | loss 2.939 | mrr 0.471674 | sample_size 1000 | wps 873.4 | ups 0.87 | wpb 1000 | bsz 1000 | num_updates 464 | lr 0.01 | gnorm 0.368 | clip 0 | train_wall 60 | wall 543 (progress_bar.py:269, print())
[2021-04-20 04:38:48]    INFO >> epoch 008 | valid on 'valid' subset | loss 4.195 | mrr 0.323536 | sample_size 1000 | wps 3762.5 | wpb 1000 | bsz 1000 | num_updates 464 | best_mrr 323.536 (progress_bar.py:269, print())
[2021-04-20 04:38:48]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/javascript/birnn/checkpoints/checkpoint_best.pt (epoch 8 @ 464 updates, score 0.323536) (writing took 0.414837 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:39:30]    INFO >> epoch 009:     36 / 59 loss=4.613, mrr=231.344, sample_size=1000, wps=852.6, ups=0.85, wpb=1000, bsz=1000, num_updates=500, lr=0.01, gnorm=0.342, clip=0.6, train_wall=532, wall=589 (progress_bar.py:262, log())
[2021-04-20 04:39:54]    INFO >> epoch 009 | loss 2.608 | mrr 0.531151 | sample_size 1000 | wps 831.7 | ups 0.83 | wpb 1000 | bsz 1000 | num_updates 522 | lr 0.01 | gnorm 0.381 | clip 0 | train_wall 63 | wall 613 (progress_bar.py:269, print())
[2021-04-20 04:39:58]    INFO >> epoch 009 | valid on 'valid' subset | loss 4.128 | mrr 0.338648 | sample_size 1000 | wps 3643.9 | wpb 1000 | bsz 1000 | num_updates 522 | best_mrr 338.648 (progress_bar.py:269, print())
[2021-04-20 04:39:58]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/javascript/birnn/checkpoints/checkpoint_best.pt (epoch 9 @ 522 updates, score 0.338648) (writing took 0.388855 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:41:04]    INFO >> epoch 010 | loss 2.352 | mrr 0.576483 | sample_size 1000 | wps 830.9 | ups 0.83 | wpb 1000 | bsz 1000 | num_updates 580 | lr 0.01 | gnorm 0.379 | clip 0 | train_wall 63 | wall 683 (progress_bar.py:269, print())
[2021-04-20 04:41:08]    INFO >> epoch 010 | valid on 'valid' subset | loss 4.142 | mrr 0.351877 | sample_size 1000 | wps 3595.8 | wpb 1000 | bsz 1000 | num_updates 580 | best_mrr 351.877 (progress_bar.py:269, print())
[2021-04-20 04:41:08]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/javascript/birnn/checkpoints/checkpoint_best.pt (epoch 10 @ 580 updates, score 0.351877) (writing took 0.499549 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:42:11]    INFO >> epoch 011 | loss 2.138 | mrr 0.614056 | sample_size 1000 | wps 866 | ups 0.87 | wpb 1000 | bsz 1000 | num_updates 638 | lr 0.01 | gnorm 0.383 | clip 0 | train_wall 60 | wall 750 (progress_bar.py:269, print())
[2021-04-20 04:42:14]    INFO >> epoch 011 | valid on 'valid' subset | loss 4.176 | mrr 0.361271 | sample_size 1000 | wps 3384.9 | wpb 1000 | bsz 1000 | num_updates 638 | best_mrr 361.271 (progress_bar.py:269, print())
[2021-04-20 04:42:15]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/javascript/birnn/checkpoints/checkpoint_best.pt (epoch 11 @ 638 updates, score 0.361271) (writing took 0.331773 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:43:20]    INFO >> epoch 012 | loss 1.948 | mrr 0.647921 | sample_size 1000 | wps 833.7 | ups 0.83 | wpb 1000 | bsz 1000 | num_updates 696 | lr 0.01 | gnorm 0.379 | clip 0 | train_wall 63 | wall 819 (progress_bar.py:269, print())
[2021-04-20 04:43:24]    INFO >> epoch 012 | valid on 'valid' subset | loss 4.324 | mrr 0.35872 | sample_size 1000 | wps 3663.1 | wpb 1000 | bsz 1000 | num_updates 696 | best_mrr 358.72 (progress_bar.py:269, print())
[2021-04-20 04:43:24]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/javascript/birnn/checkpoints/checkpoint_last.pt (epoch 12 @ 696 updates, score 0.35872) (writing took 0.175088 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:44:27]    INFO >> epoch 013 | loss 1.796 | mrr 0.675942 | sample_size 1000 | wps 871.3 | ups 0.87 | wpb 1000 | bsz 1000 | num_updates 754 | lr 0.01 | gnorm 0.385 | clip 0 | train_wall 60 | wall 886 (progress_bar.py:269, print())
[2021-04-20 04:44:31]    INFO >> epoch 013 | valid on 'valid' subset | loss 4.379 | mrr 0.359226 | sample_size 1000 | wps 3681.5 | wpb 1000 | bsz 1000 | num_updates 754 | best_mrr 359.226 (progress_bar.py:269, print())
[2021-04-20 04:44:31]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/javascript/birnn/checkpoints/checkpoint_last.pt (epoch 13 @ 754 updates, score 0.359226) (writing took 0.162360 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:45:36]    INFO >> epoch 014 | loss 1.704 | mrr 0.692801 | sample_size 1000 | wps 836.7 | ups 0.84 | wpb 1000 | bsz 1000 | num_updates 812 | lr 0.01 | gnorm 0.444 | clip 3.4 | train_wall 63 | wall 955 (progress_bar.py:269, print())
[2021-04-20 04:45:40]    INFO >> epoch 014 | valid on 'valid' subset | loss 4.411 | mrr 0.362523 | sample_size 1000 | wps 3565.6 | wpb 1000 | bsz 1000 | num_updates 812 | best_mrr 362.523 (progress_bar.py:269, print())
[2021-04-20 04:45:40]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/javascript/birnn/checkpoints/checkpoint_best.pt (epoch 14 @ 812 updates, score 0.362523) (writing took 0.474251 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:46:46]    INFO >> epoch 015 | loss 1.606 | mrr 0.710296 | sample_size 1000 | wps 831 | ups 0.83 | wpb 1000 | bsz 1000 | num_updates 870 | lr 0.01 | gnorm 0.383 | clip 0 | train_wall 63 | wall 1025 (progress_bar.py:269, print())
[2021-04-20 04:46:50]    INFO >> epoch 015 | valid on 'valid' subset | loss 4.443 | mrr 0.362729 | sample_size 1000 | wps 3485.8 | wpb 1000 | bsz 1000 | num_updates 870 | best_mrr 362.729 (progress_bar.py:269, print())
[2021-04-20 04:46:50]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/javascript/birnn/checkpoints/checkpoint_best.pt (epoch 15 @ 870 updates, score 0.362729) (writing took 0.360360 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:47:52]    INFO >> epoch 016 | loss 1.472 | mrr 0.734576 | sample_size 1000 | wps 870.7 | ups 0.87 | wpb 1000 | bsz 1000 | num_updates 928 | lr 0.01 | gnorm 0.384 | clip 0 | train_wall 60 | wall 1092 (progress_bar.py:269, print())
[2021-04-20 04:47:56]    INFO >> epoch 016 | valid on 'valid' subset | loss 4.562 | mrr 0.368748 | sample_size 1000 | wps 3786.9 | wpb 1000 | bsz 1000 | num_updates 928 | best_mrr 368.748 (progress_bar.py:269, print())
[2021-04-20 04:47:57]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/javascript/birnn/checkpoints/checkpoint_best.pt (epoch 16 @ 928 updates, score 0.368748) (writing took 0.296990 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:49:02]    INFO >> epoch 017 | loss 1.377 | mrr 0.753061 | sample_size 1000 | wps 835.9 | ups 0.84 | wpb 1000 | bsz 1000 | num_updates 986 | lr 0.01 | gnorm 0.38 | clip 0 | train_wall 63 | wall 1161 (progress_bar.py:269, print())
[2021-04-20 04:49:06]    INFO >> epoch 017 | valid on 'valid' subset | loss 4.615 | mrr 0.364973 | sample_size 1000 | wps 3502.6 | wpb 1000 | bsz 1000 | num_updates 986 | best_mrr 364.973 (progress_bar.py:269, print())
[2021-04-20 04:49:06]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/javascript/birnn/checkpoints/checkpoint_last.pt (epoch 17 @ 986 updates, score 0.364973) (writing took 0.202778 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:49:23]    INFO >> epoch 018:     14 / 59 loss=1.822, mrr=671.753, sample_size=1000, wps=842, ups=0.84, wpb=1000, bsz=1000, num_updates=1000, lr=0.01, gnorm=0.388, clip=0.4, train_wall=532, wall=1183 (progress_bar.py:262, log())
[2021-04-20 04:50:10]    INFO >> epoch 018 | loss 1.317 | mrr 0.764133 | sample_size 1000 | wps 847.5 | ups 0.85 | wpb 1000 | bsz 1000 | num_updates 1044 | lr 0.01 | gnorm 0.38 | clip 0 | train_wall 62 | wall 1230 (progress_bar.py:269, print())
[2021-04-20 04:50:13]    INFO >> epoch 018 | valid on 'valid' subset | loss 4.63 | mrr 0.361301 | sample_size 1000 | wps 4609.6 | wpb 1000 | bsz 1000 | num_updates 1044 | best_mrr 361.301 (progress_bar.py:269, print())
[2021-04-20 04:50:13]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/javascript/birnn/checkpoints/checkpoint_last.pt (epoch 18 @ 1044 updates, score 0.361301) (writing took 0.137557 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:51:19]    INFO >> epoch 019 | loss 1.247 | mrr 0.776019 | sample_size 1000 | wps 846.1 | ups 0.85 | wpb 1000 | bsz 1000 | num_updates 1102 | lr 0.01 | gnorm 0.377 | clip 0 | train_wall 63 | wall 1298 (progress_bar.py:269, print())
[2021-04-20 04:51:23]    INFO >> epoch 019 | valid on 'valid' subset | loss 4.74 | mrr 0.359182 | sample_size 1000 | wps 3479.8 | wpb 1000 | bsz 1000 | num_updates 1102 | best_mrr 359.182 (progress_bar.py:269, print())
[2021-04-20 04:51:23]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/javascript/birnn/checkpoints/checkpoint_last.pt (epoch 19 @ 1102 updates, score 0.359182) (writing took 0.274772 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:52:29]    INFO >> epoch 020 | loss 1.189 | mrr 0.787961 | sample_size 1000 | wps 833.1 | ups 0.83 | wpb 1000 | bsz 1000 | num_updates 1160 | lr 0.01 | gnorm 0.375 | clip 0 | train_wall 63 | wall 1368 (progress_bar.py:269, print())
[2021-04-20 04:52:32]    INFO >> epoch 020 | valid on 'valid' subset | loss 4.722 | mrr 0.366959 | sample_size 1000 | wps 3567.5 | wpb 1000 | bsz 1000 | num_updates 1160 | best_mrr 366.959 (progress_bar.py:269, print())
[2021-04-20 04:52:33]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/javascript/birnn/checkpoints/checkpoint_last.pt (epoch 20 @ 1160 updates, score 0.366959) (writing took 0.162078 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:53:30]    INFO >> epoch 021 | loss 1.141 | mrr 0.795613 | sample_size 1000 | wps 949.5 | ups 0.95 | wpb 1000 | bsz 1000 | num_updates 1218 | lr 0.01 | gnorm 0.375 | clip 0 | train_wall 54 | wall 1429 (progress_bar.py:269, print())
[2021-04-20 04:53:33]    INFO >> epoch 021 | valid on 'valid' subset | loss 4.844 | mrr 0.362708 | sample_size 1000 | wps 3695.6 | wpb 1000 | bsz 1000 | num_updates 1218 | best_mrr 362.708 (progress_bar.py:269, print())
[2021-04-20 04:53:33]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/javascript/birnn/checkpoints/checkpoint_last.pt (epoch 21 @ 1218 updates, score 0.362708) (writing took 0.150256 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:54:39]    INFO >> epoch 022 | loss 1.105 | mrr 0.802521 | sample_size 1000 | wps 836.8 | ups 0.84 | wpb 1000 | bsz 1000 | num_updates 1276 | lr 0.01 | gnorm 0.377 | clip 0 | train_wall 63 | wall 1498 (progress_bar.py:269, print())
[2021-04-20 04:54:43]    INFO >> epoch 022 | valid on 'valid' subset | loss 4.885 | mrr 0.363623 | sample_size 1000 | wps 3797.1 | wpb 1000 | bsz 1000 | num_updates 1276 | best_mrr 363.623 (progress_bar.py:269, print())
[2021-04-20 04:54:43]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/javascript/birnn/checkpoints/checkpoint_last.pt (epoch 22 @ 1276 updates, score 0.363623) (writing took 0.139220 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:55:48]    INFO >> epoch 023 | loss 1.065 | mrr 0.809729 | sample_size 1000 | wps 836 | ups 0.84 | wpb 1000 | bsz 1000 | num_updates 1334 | lr 0.01 | gnorm 0.377 | clip 0 | train_wall 63 | wall 1568 (progress_bar.py:269, print())
[2021-04-20 04:55:52]    INFO >> epoch 023 | valid on 'valid' subset | loss 4.878 | mrr 0.364195 | sample_size 1000 | wps 3716.4 | wpb 1000 | bsz 1000 | num_updates 1334 | best_mrr 364.195 (progress_bar.py:269, print())
[2021-04-20 04:55:52]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/javascript/birnn/checkpoints/checkpoint_last.pt (epoch 23 @ 1334 updates, score 0.364195) (writing took 0.147587 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:56:55]    INFO >> epoch 024 | loss 1.022 | mrr 0.818197 | sample_size 1000 | wps 870 | ups 0.87 | wpb 1000 | bsz 1000 | num_updates 1392 | lr 0.01 | gnorm 0.372 | clip 0 | train_wall 60 | wall 1634 (progress_bar.py:269, print())
[2021-04-20 04:56:59]    INFO >> epoch 024 | valid on 'valid' subset | loss 5.012 | mrr 0.357955 | sample_size 1000 | wps 3798.4 | wpb 1000 | bsz 1000 | num_updates 1392 | best_mrr 357.955 (progress_bar.py:269, print())
[2021-04-20 04:56:59]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/javascript/birnn/checkpoints/checkpoint_last.pt (epoch 24 @ 1392 updates, score 0.357955) (writing took 0.158217 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:58:04]    INFO >> epoch 025 | loss 0.989 | mrr 0.823816 | sample_size 1000 | wps 836.6 | ups 0.84 | wpb 1000 | bsz 1000 | num_updates 1450 | lr 0.01 | gnorm 0.371 | clip 0 | train_wall 63 | wall 1704 (progress_bar.py:269, print())
[2021-04-20 04:58:08]    INFO >> epoch 025 | valid on 'valid' subset | loss 5.01 | mrr 0.363328 | sample_size 1000 | wps 3738.1 | wpb 1000 | bsz 1000 | num_updates 1450 | best_mrr 363.328 (progress_bar.py:269, print())
[2021-04-20 04:58:08]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/javascript/birnn/checkpoints/checkpoint_last.pt (epoch 25 @ 1450 updates, score 0.363328) (writing took 0.169452 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:59:03]    INFO >> epoch 026:     51 / 59 loss=1.113, mrr=801.058, sample_size=1000, wps=862.5, ups=0.86, wpb=1000, bsz=1000, num_updates=1500, lr=0.01, gnorm=0.375, clip=0, train_wall=527, wall=1762 (progress_bar.py:262, log())
[2021-04-20 04:59:11]    INFO >> epoch 026 | loss 0.96 | mrr 0.828943 | sample_size 1000 | wps 875.3 | ups 0.88 | wpb 1000 | bsz 1000 | num_updates 1508 | lr 0.01 | gnorm 0.371 | clip 0 | train_wall 60 | wall 1770 (progress_bar.py:269, print())
[2021-04-20 04:59:14]    INFO >> epoch 026 | valid on 'valid' subset | loss 4.99 | mrr 0.36403 | sample_size 1000 | wps 3950.8 | wpb 1000 | bsz 1000 | num_updates 1508 | best_mrr 364.03 (progress_bar.py:269, print())
[2021-04-20 04:59:14]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/javascript/birnn/checkpoints/checkpoint_last.pt (epoch 26 @ 1508 updates, score 0.36403) (writing took 0.159347 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:59:14]    INFO >> early stop since valid performance hasn't improved for last 10 runs (train.py:191, should_stop_early())
[2021-04-20 04:59:14]    INFO >> early stop since valid performance hasn't improved for last 10 runs (train.py:272, single_main())
[2021-04-20 04:59:14]    INFO >> done training in 1773.5 seconds (train.py:283, single_main())
