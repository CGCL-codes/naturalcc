nohup: 忽略输入
[2021-04-20 04:27:30]    INFO >> Load arguments in /home/yanghe/Documents/naturalcc-dev/run/retrieval/birnn/config/csn_feng/ruby.yml (train.py:302, cli_main())
[2021-04-20 04:27:30]    INFO >> {'criterion': 'retrieval_softmax', 'optimizer': 'torch_adam', 'lr_scheduler': 'fixed', 'tokenizer': None, 'bpe': None, 'common': {'no_progress_bar': 0, 'log_interval': 500, 'log_format': 'simple', 'tensorboard_logdir': '', 'seed': 0, 'cpu': 0, 'fp16': 0, 'memory_efficient_fp16': 0, 'fp16_no_flatten_grads': 0, 'fp16_init_scale': 128, 'fp16_scale_window': None, 'fp16_scale_tolerance': 0.0, 'min_loss_scale': 0.0001, 'threshold_loss_scale': None, 'user_dir': None, 'empty_cache_freq': 0, 'all_gather_list_size': 16384, 'task': 'hybrid_retrieval'}, 'dataset': {'num_workers': 1, 'skip_invalid_size_inputs_valid_test': 0, 'max_tokens': None, 'max_sentences': 1000, 'code_max_tokens': 200, 'query_max_tokens': 30, 'required_batch_size_multiple': 8, 'dataset_impl': 'mmap', 'train_subset': 'train', 'valid_subset': 'valid', 'validate_interval': 1, 'fixed_validation_seed': None, 'disable_validation': None, 'max_tokens_valid': None, 'max_sentences_valid': 1000, 'curriculum': 0, 'gen_subset': 'test', 'num_shards': 1, 'shard_id': 0, 'joined_dictionary': 0, 'langs': ['ruby']}, 'distributed_training': {'distributed_world_size': 1, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': None, 'distributed_port': -1, 'device_id': 0, 'distributed_no_spawn': 0, 'ddp_backend': 'c10d', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': None, 'find_unused_parameters': 0, 'fast_stat_sync': 0, 'broadcast_buffers': 0, 'global_sync_iter': 50, 'warmup_iterations': 500, 'local_rank': -1, 'block_momentum': 0.875, 'block_lr': 1, 'use_nbm': 0, 'average_sync': 0}, 'task': {'data': '/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all', 'sample_break_mode': 'complete', 'tokens_per_sample': 512, 'mask_prob': 0.15, 'leave_unmasked_prob': 0.1, 'random_token_prob': 0.1, 'freq_weighted_replacement': 0, 'mask_whole_words': 0, 'pooler_activation_fn': 'tanh', 'source_lang': 'code_tokens', 'target_lang': 'docstring_tokens', 'source_aux_lang': 'code_tokens.wo_func', 'target_aux_lang': 'func_name', 'fraction_using_func_name': 0.3, 'load_alignments': 0, 'left_pad_source': 1, 'left_pad_target': 0, 'upsample_primary': 1, 'truncate_source': 0, 'eval_mrr': 1}, 'model': {'arch': 'birnn', 'code_embed_dim': 128, 'code_doprout': 0.1, 'code_rnn_cell': 'lstm', 'code_rnn_layers': 2, 'code_hidden_dim': 64, 'code_rnn_dropout': 0.2, 'code_rnn_bidirectional': True, 'code_pooling': 'weighted_mean', 'code_activation_fn': 'tanh', 'code_paddding': 'same', 'query_embed_dim': 128, 'query_doprout': 0.1, 'query_rnn_cell': 'lstm', 'query_rnn_layers': 2, 'query_hidden_dim': 64, 'query_rnn_dropout': 0.2, 'query_rnn_bidirectional': True, 'query_pooling': 'weighted_mean', 'query_activation_fn': 'tanh', 'query_paddding': 'same', 'dropout': 0.1}, 'optimization': {'max_epoch': 300, 'max_update': 0, 'clip_norm': 1, 'sentence_avg': 0, 'update_freq': [1], 'lrs': [0.01], 'min_lr': -1, 'use_bmuf': 0, 'lr_shrink': 1.0, 'force_anneal': 0, 'warmup_updates': 0, 'end_learning_rate': 0.0, 'power': 1.0, 'total_num_update': 1000000, 'adam': {'adam_betas': '(0.9, 0.999)', 'adam_eps': 1e-08, 'weight_decay': 0, 'use_old_adam': 1}, 'margin': 1, 'clip_norm_version': 'tf_clip_by_global_norm'}, 'checkpoint': {'save_dir': '/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/birnn/checkpoints', 'restore_file': 'checkpoint_last.pt', 'reset_dataloader': None, 'reset_lr_scheduler': None, 'reset_meters': None, 'reset_optimizer': None, 'optimizer_overrides': '{}', 'save_interval': 1, 'save_interval_updates': 0, 'keep_interval_updates': 0, 'keep_last_epochs': -1, 'keep_best_checkpoints': -1, 'no_save': 0, 'no_epoch_checkpoints': 1, 'no_last_checkpoints': 0, 'no_save_optimizer_state': None, 'best_checkpoint_metric': 'mrr', 'maximize_best_checkpoint_metric': 1, 'patience': 10}, 'eval': {'path': '/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/birnn/checkpoints/checkpoint_best.pt', 'quiet': 1, 'max_sentences': 1000, 'model_overrides': '{}', 'eval_size': -1}} (train.py:304, cli_main())
[2021-04-20 04:27:30]    INFO >> single GPU training... (train.py:333, cli_main())
[2021-04-20 04:27:30]    INFO >> loaded 1400 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/valid.ruby.code_tokens'] (hybrid_retrieval.py:54, load_tokens_dataset())
[2021-04-20 04:27:30]    INFO >> loaded 1400 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/valid.ruby.docstring_tokens'] (hybrid_retrieval.py:55, load_tokens_dataset())
[2021-04-20 04:27:30]    INFO >> BiRNN(
  (src_encoders): ModuleDict(
    (ruby): RNNEncoder(
      (embed): Embedding(10000, 128)
      (weight_layer): Linear(in_features=128, out_features=1, bias=False)
      (rnn): LSTM(128, 64, num_layers=2, batch_first=True, dropout=0.2, bidirectional=True)
    )
  )
  (tgt_encoders): RNNEncoder(
    (embed): Embedding(10000, 128)
    (weight_layer): Linear(in_features=128, out_features=1, bias=False)
    (rnn): LSTM(128, 64, num_layers=2, batch_first=True, dropout=0.2, bidirectional=True)
  )
) (train.py:223, single_main())
[2021-04-20 04:27:30]    INFO >> model birnn, criterion SearchSoftmaxCriterion (train.py:224, single_main())
[2021-04-20 04:27:30]    INFO >> num. model params: 2957568 (num. trained: 2957568) (train.py:227, single_main())
[2021-04-20 04:27:34]    INFO >> training on 1 GPUs (train.py:233, single_main())
[2021-04-20 04:27:34]    INFO >> max tokens per GPU = None and max sentences per GPU = 1000 (train.py:236, single_main())
[2021-04-20 04:27:34]    INFO >> no existing checkpoint found /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/birnn/checkpoints/checkpoint_last.pt (ncc_trainers.py:270, load_checkpoint())
[2021-04-20 04:27:34]    INFO >> loading train data for epoch 1 (ncc_trainers.py:285, get_train_iterator())
[2021-04-20 04:27:34]    INFO >> loaded 24927 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.ruby.code_tokens'] (hybrid_retrieval.py:54, load_tokens_dataset())
[2021-04-20 04:27:34]    INFO >> loaded 24927 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.ruby.docstring_tokens'] (hybrid_retrieval.py:55, load_tokens_dataset())
[2021-04-20 04:27:34]    INFO >> loaded 24927 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.ruby.code_tokens.wo_func'] (hybrid_retrieval.py:67, load_tokens_dataset())
[2021-04-20 04:27:34]    INFO >> loaded 24927 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.ruby.func_name'] (hybrid_retrieval.py:81, load_tokens_dataset())
[2021-04-20 04:27:34]    INFO >> NOTE: your device may support faster training with fp16 (ncc_trainers.py:155, _setup_optimizer())
[2021-04-20 04:27:50]    INFO >> epoch 001 | loss 6.851 | mrr 0.010358 | sample_size 1000 | wps 1719.2 | ups 1.72 | wpb 1000 | bsz 1000 | num_updates 24 | lr 0.01 | gnorm 0.08 | clip 0 | train_wall 14 | wall 16 (progress_bar.py:269, print())
[2021-04-20 04:27:53]    INFO >> epoch 001 | valid on 'valid' subset | loss 6.835 | mrr 0.01104 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 24 (progress_bar.py:269, print())
[2021-04-20 04:27:54]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/birnn/checkpoints/checkpoint_best.pt (epoch 1 @ 24 updates, score 0.01104) (writing took 0.272216 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:28:12]    INFO >> epoch 002 | loss 6.659 | mrr 0.01608 | sample_size 1000 | wps 1115.3 | ups 1.12 | wpb 1000 | bsz 1000 | num_updates 48 | lr 0.01 | gnorm 0.237 | clip 0 | train_wall 15 | wall 38 (progress_bar.py:269, print())
[2021-04-20 04:28:14]    INFO >> epoch 002 | valid on 'valid' subset | loss 6.738 | mrr 0.014523 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 48 | best_mrr 14.523 (progress_bar.py:269, print())
[2021-04-20 04:28:14]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/birnn/checkpoints/checkpoint_best.pt (epoch 2 @ 48 updates, score 0.014523) (writing took 0.291012 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:28:41]    INFO >> epoch 003 | loss 6.428 | mrr 0.022181 | sample_size 1000 | wps 819.1 | ups 0.82 | wpb 1000 | bsz 1000 | num_updates 72 | lr 0.01 | gnorm 0.348 | clip 4.2 | train_wall 24 | wall 67 (progress_bar.py:269, print())
[2021-04-20 04:28:43]    INFO >> epoch 003 | valid on 'valid' subset | loss 6.61 | mrr 0.016413 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 72 | best_mrr 16.413 (progress_bar.py:269, print())
[2021-04-20 04:28:44]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/birnn/checkpoints/checkpoint_best.pt (epoch 3 @ 72 updates, score 0.016413) (writing took 0.332643 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:29:19]    INFO >> epoch 004 | loss 6.163 | mrr 0.032716 | sample_size 1000 | wps 635.7 | ups 0.64 | wpb 1000 | bsz 1000 | num_updates 96 | lr 0.01 | gnorm 0.394 | clip 0 | train_wall 32 | wall 105 (progress_bar.py:269, print())
[2021-04-20 04:29:21]    INFO >> epoch 004 | valid on 'valid' subset | loss 6.479 | mrr 0.028768 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 96 | best_mrr 28.7678 (progress_bar.py:269, print())
[2021-04-20 04:29:21]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/birnn/checkpoints/checkpoint_best.pt (epoch 4 @ 96 updates, score 0.028768) (writing took 0.340223 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:29:56]    INFO >> epoch 005 | loss 5.849 | mrr 0.051478 | sample_size 1000 | wps 634.7 | ups 0.63 | wpb 1000 | bsz 1000 | num_updates 120 | lr 0.01 | gnorm 0.471 | clip 4.2 | train_wall 32 | wall 143 (progress_bar.py:269, print())
[2021-04-20 04:30:00]    INFO >> epoch 005 | valid on 'valid' subset | loss 6.328 | mrr 0.041562 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 120 | best_mrr 41.5616 (progress_bar.py:269, print())
[2021-04-20 04:30:00]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/birnn/checkpoints/checkpoint_best.pt (epoch 5 @ 120 updates, score 0.041562) (writing took 0.322629 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:30:35]    INFO >> epoch 006 | loss 5.433 | mrr 0.086506 | sample_size 1000 | wps 619.4 | ups 0.62 | wpb 1000 | bsz 1000 | num_updates 144 | lr 0.01 | gnorm 0.628 | clip 8.3 | train_wall 32 | wall 182 (progress_bar.py:269, print())
[2021-04-20 04:30:38]    INFO >> epoch 006 | valid on 'valid' subset | loss 6.054 | mrr 0.06735 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 144 | best_mrr 67.3503 (progress_bar.py:269, print())
[2021-04-20 04:30:38]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/birnn/checkpoints/checkpoint_best.pt (epoch 6 @ 144 updates, score 0.06735) (writing took 0.322000 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:31:13]    INFO >> epoch 007 | loss 4.971 | mrr 0.146995 | sample_size 1000 | wps 635 | ups 0.63 | wpb 1000 | bsz 1000 | num_updates 168 | lr 0.01 | gnorm 0.666 | clip 4.2 | train_wall 32 | wall 219 (progress_bar.py:269, print())
[2021-04-20 04:31:17]    INFO >> epoch 007 | valid on 'valid' subset | loss 5.92 | mrr 0.096361 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 168 | best_mrr 96.3614 (progress_bar.py:269, print())
[2021-04-20 04:31:17]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/birnn/checkpoints/checkpoint_best.pt (epoch 7 @ 168 updates, score 0.096361) (writing took 0.260342 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:31:52]    INFO >> epoch 008 | loss 4.44 | mrr 0.227002 | sample_size 1000 | wps 612.8 | ups 0.61 | wpb 1000 | bsz 1000 | num_updates 192 | lr 0.01 | gnorm 0.507 | clip 0 | train_wall 32 | wall 259 (progress_bar.py:269, print())
[2021-04-20 04:31:55]    INFO >> epoch 008 | valid on 'valid' subset | loss 5.709 | mrr 0.135629 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 192 | best_mrr 135.629 (progress_bar.py:269, print())
[2021-04-20 04:31:55]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/birnn/checkpoints/checkpoint_best.pt (epoch 8 @ 192 updates, score 0.135629) (writing took 0.310844 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:32:30]    INFO >> epoch 009 | loss 3.907 | mrr 0.311474 | sample_size 1000 | wps 631.7 | ups 0.63 | wpb 1000 | bsz 1000 | num_updates 216 | lr 0.01 | gnorm 0.495 | clip 0 | train_wall 32 | wall 297 (progress_bar.py:269, print())
[2021-04-20 04:32:34]    INFO >> epoch 009 | valid on 'valid' subset | loss 5.594 | mrr 0.166854 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 216 | best_mrr 166.854 (progress_bar.py:269, print())
[2021-04-20 04:32:34]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/birnn/checkpoints/checkpoint_best.pt (epoch 9 @ 216 updates, score 0.166854) (writing took 0.445551 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:33:09]    INFO >> epoch 010 | loss 3.439 | mrr 0.389316 | sample_size 1000 | wps 614.3 | ups 0.61 | wpb 1000 | bsz 1000 | num_updates 240 | lr 0.01 | gnorm 0.57 | clip 4.2 | train_wall 32 | wall 336 (progress_bar.py:269, print())
[2021-04-20 04:33:12]    INFO >> epoch 010 | valid on 'valid' subset | loss 5.491 | mrr 0.177953 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 240 | best_mrr 177.953 (progress_bar.py:269, print())
[2021-04-20 04:33:12]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/birnn/checkpoints/checkpoint_best.pt (epoch 10 @ 240 updates, score 0.177953) (writing took 0.280994 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:33:48]    INFO >> epoch 011 | loss 3.064 | mrr 0.453413 | sample_size 1000 | wps 627.5 | ups 0.63 | wpb 1000 | bsz 1000 | num_updates 264 | lr 0.01 | gnorm 0.532 | clip 0 | train_wall 32 | wall 374 (progress_bar.py:269, print())
[2021-04-20 04:33:51]    INFO >> epoch 011 | valid on 'valid' subset | loss 5.445 | mrr 0.201562 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 264 | best_mrr 201.562 (progress_bar.py:269, print())
[2021-04-20 04:33:51]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/birnn/checkpoints/checkpoint_best.pt (epoch 11 @ 264 updates, score 0.201562) (writing took 0.333089 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:34:23]    INFO >> epoch 012 | loss 2.7 | mrr 0.519014 | sample_size 1000 | wps 668.7 | ups 0.67 | wpb 1000 | bsz 1000 | num_updates 288 | lr 0.01 | gnorm 0.482 | clip 0 | train_wall 29 | wall 410 (progress_bar.py:269, print())
[2021-04-20 04:34:26]    INFO >> epoch 012 | valid on 'valid' subset | loss 5.634 | mrr 0.206925 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 288 | best_mrr 206.925 (progress_bar.py:269, print())
[2021-04-20 04:34:26]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/birnn/checkpoints/checkpoint_best.pt (epoch 12 @ 288 updates, score 0.206925) (writing took 0.336805 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:35:02]    INFO >> epoch 013 | loss 2.423 | mrr 0.570946 | sample_size 1000 | wps 629.9 | ups 0.63 | wpb 1000 | bsz 1000 | num_updates 312 | lr 0.01 | gnorm 0.463 | clip 0 | train_wall 32 | wall 448 (progress_bar.py:269, print())
[2021-04-20 04:35:05]    INFO >> epoch 013 | valid on 'valid' subset | loss 5.598 | mrr 0.218949 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 312 | best_mrr 218.949 (progress_bar.py:269, print())
[2021-04-20 04:35:06]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/birnn/checkpoints/checkpoint_best.pt (epoch 13 @ 312 updates, score 0.218949) (writing took 0.341222 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:35:41]    INFO >> epoch 014 | loss 2.171 | mrr 0.61368 | sample_size 1000 | wps 614.4 | ups 0.61 | wpb 1000 | bsz 1000 | num_updates 336 | lr 0.01 | gnorm 0.459 | clip 0 | train_wall 32 | wall 487 (progress_bar.py:269, print())
[2021-04-20 04:35:43]    INFO >> epoch 014 | valid on 'valid' subset | loss 5.773 | mrr 0.22609 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 336 | best_mrr 226.09 (progress_bar.py:269, print())
[2021-04-20 04:35:44]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/birnn/checkpoints/checkpoint_best.pt (epoch 14 @ 336 updates, score 0.22609) (writing took 0.305141 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:36:18]    INFO >> epoch 015 | loss 1.958 | mrr 0.650824 | sample_size 1000 | wps 634.9 | ups 0.63 | wpb 1000 | bsz 1000 | num_updates 360 | lr 0.01 | gnorm 0.452 | clip 0 | train_wall 32 | wall 525 (progress_bar.py:269, print())
[2021-04-20 04:36:22]    INFO >> epoch 015 | valid on 'valid' subset | loss 5.768 | mrr 0.234734 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 360 | best_mrr 234.734 (progress_bar.py:269, print())
[2021-04-20 04:36:22]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/birnn/checkpoints/checkpoint_best.pt (epoch 15 @ 360 updates, score 0.234734) (writing took 0.289550 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:36:57]    INFO >> epoch 016 | loss 1.77 | mrr 0.683239 | sample_size 1000 | wps 620.9 | ups 0.62 | wpb 1000 | bsz 1000 | num_updates 384 | lr 0.01 | gnorm 0.466 | clip 0 | train_wall 32 | wall 563 (progress_bar.py:269, print())
[2021-04-20 04:37:00]    INFO >> epoch 016 | valid on 'valid' subset | loss 5.754 | mrr 0.243808 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 384 | best_mrr 243.808 (progress_bar.py:269, print())
[2021-04-20 04:37:00]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/birnn/checkpoints/checkpoint_best.pt (epoch 16 @ 384 updates, score 0.243808) (writing took 0.384967 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:37:35]    INFO >> epoch 017 | loss 1.626 | mrr 0.70925 | sample_size 1000 | wps 633.1 | ups 0.63 | wpb 1000 | bsz 1000 | num_updates 408 | lr 0.01 | gnorm 0.482 | clip 0 | train_wall 32 | wall 601 (progress_bar.py:269, print())
[2021-04-20 04:37:39]    INFO >> epoch 017 | valid on 'valid' subset | loss 5.948 | mrr 0.255824 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 408 | best_mrr 255.824 (progress_bar.py:269, print())
[2021-04-20 04:37:39]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/birnn/checkpoints/checkpoint_best.pt (epoch 17 @ 408 updates, score 0.255824) (writing took 0.337653 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:38:14]    INFO >> epoch 018 | loss 1.501 | mrr 0.729745 | sample_size 1000 | wps 619 | ups 0.62 | wpb 1000 | bsz 1000 | num_updates 432 | lr 0.01 | gnorm 0.461 | clip 0 | train_wall 32 | wall 640 (progress_bar.py:269, print())
[2021-04-20 04:38:17]    INFO >> epoch 018 | valid on 'valid' subset | loss 6.02 | mrr 0.255687 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 432 | best_mrr 255.687 (progress_bar.py:269, print())
[2021-04-20 04:38:17]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/birnn/checkpoints/checkpoint_last.pt (epoch 18 @ 432 updates, score 0.255687) (writing took 0.171820 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:38:52]    INFO >> epoch 019 | loss 1.332 | mrr 0.762265 | sample_size 1000 | wps 634.6 | ups 0.63 | wpb 1000 | bsz 1000 | num_updates 456 | lr 0.01 | gnorm 0.43 | clip 0 | train_wall 32 | wall 678 (progress_bar.py:269, print())
[2021-04-20 04:38:55]    INFO >> epoch 019 | valid on 'valid' subset | loss 6.128 | mrr 0.25735 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 456 | best_mrr 257.35 (progress_bar.py:269, print())
[2021-04-20 04:38:56]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/birnn/checkpoints/checkpoint_best.pt (epoch 19 @ 456 updates, score 0.25735) (writing took 0.307419 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:39:31]    INFO >> epoch 020 | loss 1.234 | mrr 0.779557 | sample_size 1000 | wps 611.9 | ups 0.61 | wpb 1000 | bsz 1000 | num_updates 480 | lr 0.01 | gnorm 0.42 | clip 0 | train_wall 32 | wall 717 (progress_bar.py:269, print())
[2021-04-20 04:39:34]    INFO >> epoch 020 | valid on 'valid' subset | loss 6.381 | mrr 0.250738 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 480 | best_mrr 250.738 (progress_bar.py:269, print())
[2021-04-20 04:39:34]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/birnn/checkpoints/checkpoint_last.pt (epoch 20 @ 480 updates, score 0.250738) (writing took 0.211731 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:39:58]    INFO >> epoch 021:     21 / 25 loss=3.593, mrr=404.744, sample_size=1000, wps=673, ups=0.67, wpb=1000, bsz=1000, num_updates=500, lr=0.01, gnorm=0.451, clip=1.2, train_wall=623, wall=744 (progress_bar.py:262, log())
[2021-04-20 04:40:04]    INFO >> epoch 021 | loss 1.139 | mrr 0.796347 | sample_size 1000 | wps 728.9 | ups 0.73 | wpb 1000 | bsz 1000 | num_updates 504 | lr 0.01 | gnorm 0.427 | clip 0 | train_wall 27 | wall 750 (progress_bar.py:269, print())
[2021-04-20 04:40:07]    INFO >> epoch 021 | valid on 'valid' subset | loss 6.443 | mrr 0.249932 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 504 | best_mrr 249.932 (progress_bar.py:269, print())
[2021-04-20 04:40:08]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/birnn/checkpoints/checkpoint_last.pt (epoch 21 @ 504 updates, score 0.249932) (writing took 0.208214 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:40:43]    INFO >> epoch 022 | loss 1.058 | mrr 0.811295 | sample_size 1000 | wps 614.6 | ups 0.61 | wpb 1000 | bsz 1000 | num_updates 528 | lr 0.01 | gnorm 0.407 | clip 0 | train_wall 32 | wall 789 (progress_bar.py:269, print())
[2021-04-20 04:40:45]    INFO >> epoch 022 | valid on 'valid' subset | loss 6.421 | mrr 0.243886 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 528 | best_mrr 243.886 (progress_bar.py:269, print())
[2021-04-20 04:40:46]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/birnn/checkpoints/checkpoint_last.pt (epoch 22 @ 528 updates, score 0.243886) (writing took 0.149338 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:41:21]    INFO >> epoch 023 | loss 0.986 | mrr 0.823379 | sample_size 1000 | wps 636.9 | ups 0.64 | wpb 1000 | bsz 1000 | num_updates 552 | lr 0.01 | gnorm 0.392 | clip 0 | train_wall 32 | wall 827 (progress_bar.py:269, print())
[2021-04-20 04:41:24]    INFO >> epoch 023 | valid on 'valid' subset | loss 6.543 | mrr 0.247824 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 552 | best_mrr 247.824 (progress_bar.py:269, print())
[2021-04-20 04:41:24]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/birnn/checkpoints/checkpoint_last.pt (epoch 23 @ 552 updates, score 0.247824) (writing took 0.187950 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:41:59]    INFO >> epoch 024 | loss 0.928 | mrr 0.836238 | sample_size 1000 | wps 622 | ups 0.62 | wpb 1000 | bsz 1000 | num_updates 576 | lr 0.01 | gnorm 0.394 | clip 0 | train_wall 32 | wall 866 (progress_bar.py:269, print())
[2021-04-20 04:42:02]    INFO >> epoch 024 | valid on 'valid' subset | loss 6.574 | mrr 0.251648 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 576 | best_mrr 251.648 (progress_bar.py:269, print())
[2021-04-20 04:42:02]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/birnn/checkpoints/checkpoint_last.pt (epoch 24 @ 576 updates, score 0.251648) (writing took 0.179191 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:42:37]    INFO >> epoch 025 | loss 0.868 | mrr 0.845884 | sample_size 1000 | wps 628.1 | ups 0.63 | wpb 1000 | bsz 1000 | num_updates 600 | lr 0.01 | gnorm 0.373 | clip 0 | train_wall 32 | wall 904 (progress_bar.py:269, print())
[2021-04-20 04:42:41]    INFO >> epoch 025 | valid on 'valid' subset | loss 6.753 | mrr 0.250308 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 600 | best_mrr 250.308 (progress_bar.py:269, print())
[2021-04-20 04:42:41]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/birnn/checkpoints/checkpoint_last.pt (epoch 25 @ 600 updates, score 0.250308) (writing took 0.506435 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:43:16]    INFO >> epoch 026 | loss 0.808 | mrr 0.857852 | sample_size 1000 | wps 614.3 | ups 0.61 | wpb 1000 | bsz 1000 | num_updates 624 | lr 0.01 | gnorm 0.378 | clip 0 | train_wall 33 | wall 943 (progress_bar.py:269, print())
[2021-04-20 04:43:19]    INFO >> epoch 026 | valid on 'valid' subset | loss 6.736 | mrr 0.253518 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 624 | best_mrr 253.518 (progress_bar.py:269, print())
[2021-04-20 04:43:19]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/birnn/checkpoints/checkpoint_last.pt (epoch 26 @ 624 updates, score 0.253518) (writing took 0.153891 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:43:54]    INFO >> epoch 027 | loss 0.745 | mrr 0.867815 | sample_size 1000 | wps 639 | ups 0.64 | wpb 1000 | bsz 1000 | num_updates 648 | lr 0.01 | gnorm 0.357 | clip 0 | train_wall 32 | wall 980 (progress_bar.py:269, print())
[2021-04-20 04:43:58]    INFO >> epoch 027 | valid on 'valid' subset | loss 6.745 | mrr 0.253885 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 648 | best_mrr 253.885 (progress_bar.py:269, print())
[2021-04-20 04:43:58]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/birnn/checkpoints/checkpoint_last.pt (epoch 27 @ 648 updates, score 0.253885) (writing took 0.144792 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:44:33]    INFO >> epoch 028 | loss 0.707 | mrr 0.875133 | sample_size 1000 | wps 618.4 | ups 0.62 | wpb 1000 | bsz 1000 | num_updates 672 | lr 0.01 | gnorm 0.356 | clip 0 | train_wall 32 | wall 1019 (progress_bar.py:269, print())
[2021-04-20 04:44:36]    INFO >> epoch 028 | valid on 'valid' subset | loss 6.798 | mrr 0.250379 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 672 | best_mrr 250.379 (progress_bar.py:269, print())
[2021-04-20 04:44:36]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/birnn/checkpoints/checkpoint_last.pt (epoch 28 @ 672 updates, score 0.250379) (writing took 0.157167 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:45:10]    INFO >> epoch 029 | loss 0.673 | mrr 0.881596 | sample_size 1000 | wps 647.8 | ups 0.65 | wpb 1000 | bsz 1000 | num_updates 696 | lr 0.01 | gnorm 0.352 | clip 0 | train_wall 32 | wall 1056 (progress_bar.py:269, print())
[2021-04-20 04:45:13]    INFO >> epoch 029 | valid on 'valid' subset | loss 6.976 | mrr 0.254221 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 696 | best_mrr 254.221 (progress_bar.py:269, print())
[2021-04-20 04:45:13]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/birnn/checkpoints/checkpoint_last.pt (epoch 29 @ 696 updates, score 0.254221) (writing took 0.182889 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:45:13]    INFO >> early stop since valid performance hasn't improved for last 10 runs (train.py:191, should_stop_early())
[2021-04-20 04:45:13]    INFO >> early stop since valid performance hasn't improved for last 10 runs (train.py:272, single_main())
[2021-04-20 04:45:13]    INFO >> done training in 1059.1 seconds (train.py:283, single_main())
