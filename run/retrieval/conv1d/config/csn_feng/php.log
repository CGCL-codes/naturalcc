nohup: 忽略输入
[2021-04-20 09:36:02]    INFO >> Load arguments in /home/yanghe/Documents/naturalcc-dev/run/retrieval/conv1d/config/csn_feng/php.yml (train.py:302, cli_main())
[2021-04-20 09:36:02]    INFO >> {'criterion': 'retrieval_softmax', 'optimizer': 'torch_adam', 'lr_scheduler': 'fixed', 'tokenizer': None, 'bpe': None, 'common': {'no_progress_bar': 0, 'log_interval': 500, 'log_format': 'simple', 'tensorboard_logdir': '', 'seed': 0, 'cpu': 0, 'fp16': 0, 'memory_efficient_fp16': 0, 'fp16_no_flatten_grads': 0, 'fp16_init_scale': 128, 'fp16_scale_window': None, 'fp16_scale_tolerance': 0.0, 'min_loss_scale': 0.0001, 'threshold_loss_scale': None, 'user_dir': None, 'empty_cache_freq': 0, 'all_gather_list_size': 16384, 'task': 'hybrid_retrieval'}, 'dataset': {'num_workers': 1, 'skip_invalid_size_inputs_valid_test': 0, 'max_tokens': None, 'max_sentences': 1000, 'code_max_tokens': 200, 'query_max_tokens': 30, 'required_batch_size_multiple': 8, 'dataset_impl': 'mmap', 'train_subset': 'train', 'valid_subset': 'valid', 'validate_interval': 1, 'fixed_validation_seed': None, 'disable_validation': None, 'max_tokens_valid': None, 'max_sentences_valid': 1000, 'curriculum': 0, 'gen_subset': 'test', 'num_shards': 1, 'shard_id': 0, 'joined_dictionary': 0, 'langs': ['php']}, 'distributed_training': {'distributed_world_size': 1, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': None, 'distributed_port': -1, 'device_id': 0, 'distributed_no_spawn': 0, 'ddp_backend': 'c10d', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': None, 'find_unused_parameters': 0, 'fast_stat_sync': 0, 'broadcast_buffers': 0, 'global_sync_iter': 50, 'warmup_iterations': 500, 'local_rank': -1, 'block_momentum': 0.875, 'block_lr': 1, 'use_nbm': 0, 'average_sync': 0}, 'task': {'data': '/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all', 'sample_break_mode': 'complete', 'tokens_per_sample': 512, 'mask_prob': 0.15, 'leave_unmasked_prob': 0.1, 'random_token_prob': 0.1, 'freq_weighted_replacement': 0, 'mask_whole_words': 0, 'pooler_activation_fn': 'tanh', 'source_lang': 'code_tokens', 'target_lang': 'docstring_tokens', 'source_aux_lang': 'code_tokens.wo_func', 'target_aux_lang': 'func_name', 'fraction_using_func_name': 0.3, 'load_alignments': 0, 'left_pad_source': 1, 'left_pad_target': 0, 'upsample_primary': 1, 'truncate_source': 0, 'eval_mrr': 1}, 'model': {'arch': 'conv1d_res', 'code_embed_dim': 128, 'code_kernel_size': [16, 16, 16], 'code_residual': True, 'code_layers': [128, 128, 128], 'code_pooling': 'weighted_mean', 'code_activation_fn': 'tanh', 'code_position_encoding': 'learned', 'code_paddding': 'same', 'code_dropout': 0.1, 'query_embed_dim': 128, 'query_kernel_size': [16, 16, 16], 'query_residual': True, 'query_layers': [128, 128, 128], 'query_pooling': 'weighted_mean', 'query_activation_fn': 'tanh', 'query_position_encoding': 'learned', 'query_paddding': 'same', 'query_dropout': 0.1}, 'optimization': {'max_epoch': 300, 'max_update': 0, 'clip_norm': 1, 'sentence_avg': 0, 'update_freq': [1], 'lrs': [0.0005], 'min_lr': -1, 'use_bmuf': 0, 'lr_shrink': 1.0, 'force_anneal': 0, 'warmup_updates': 0, 'end_learning_rate': 0.0, 'power': 1.0, 'total_num_update': 1000000, 'adam': {'adam_betas': '(0.9, 0.999)', 'adam_eps': 1e-08, 'weight_decay': 0, 'use_old_adam': 1}, 'margin': 1, 'clip_norm_version': 'tf_clip_by_global_norm'}, 'checkpoint': {'save_dir': '/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/conv1d_res/checkpoints', 'restore_file': 'checkpoint_last.pt', 'reset_dataloader': None, 'reset_lr_scheduler': None, 'reset_meters': None, 'reset_optimizer': None, 'optimizer_overrides': '{}', 'save_interval': 1, 'save_interval_updates': 0, 'keep_interval_updates': 0, 'keep_last_epochs': -1, 'keep_best_checkpoints': -1, 'no_save': 0, 'no_epoch_checkpoints': 1, 'no_last_checkpoints': 0, 'no_save_optimizer_state': None, 'best_checkpoint_metric': 'mrr', 'maximize_best_checkpoint_metric': 1, 'patience': 10}, 'eval': {'path': '/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/conv1d_res/checkpoints/checkpoint_best.pt', 'quiet': 1, 'max_sentences': 1000, 'model_overrides': '{}', 'eval_size': -1}} (train.py:304, cli_main())
[2021-04-20 09:36:02]    INFO >> single GPU training... (train.py:333, cli_main())
[2021-04-20 09:36:03]    INFO >> loaded 12982 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/valid.php.code_tokens'] (hybrid_retrieval.py:54, load_tokens_dataset())
[2021-04-20 09:36:03]    INFO >> loaded 12982 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/valid.php.docstring_tokens'] (hybrid_retrieval.py:55, load_tokens_dataset())
[2021-04-20 09:36:03]    INFO >> Conv1dRes(
  (src_encoders): ModuleDict(
    (php): Conv1dResEncoder(
      (embed): Embedding(10000, 128)
      (weight_layer): Linear(in_features=128, out_features=1, bias=False)
      (conv_layers): ModuleList(
        (0): Conv2d(1, 128, kernel_size=(16, 128), stride=(1, 1))
        (1): Conv2d(1, 128, kernel_size=(16, 128), stride=(1, 1))
        (2): Conv2d(1, 128, kernel_size=(16, 128), stride=(1, 1))
      )
    )
  )
  (tgt_encoders): Conv1dResEncoder(
    (embed): Embedding(10000, 128)
    (weight_layer): Linear(in_features=128, out_features=1, bias=False)
    (conv_layers): ModuleList(
      (0): Conv2d(1, 128, kernel_size=(16, 128), stride=(1, 1))
      (1): Conv2d(1, 128, kernel_size=(16, 128), stride=(1, 1))
      (2): Conv2d(1, 128, kernel_size=(16, 128), stride=(1, 1))
    )
  )
) (train.py:223, single_main())
[2021-04-20 09:36:03]    INFO >> model conv1d_res, criterion SearchSoftmaxCriterion (train.py:224, single_main())
[2021-04-20 09:36:03]    INFO >> num. model params: 4163328 (num. trained: 4163328) (train.py:227, single_main())
[2021-04-20 09:36:06]    INFO >> training on 1 GPUs (train.py:233, single_main())
[2021-04-20 09:36:06]    INFO >> max tokens per GPU = None and max sentences per GPU = 1000 (train.py:236, single_main())
[2021-04-20 09:36:06]    INFO >> no existing checkpoint found /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/conv1d_res/checkpoints/checkpoint_last.pt (ncc_trainers.py:270, load_checkpoint())
[2021-04-20 09:36:06]    INFO >> loading train data for epoch 1 (ncc_trainers.py:285, get_train_iterator())
[2021-04-20 09:36:06]    INFO >> loaded 241241 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.php.code_tokens'] (hybrid_retrieval.py:54, load_tokens_dataset())
[2021-04-20 09:36:06]    INFO >> loaded 241241 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.php.docstring_tokens'] (hybrid_retrieval.py:55, load_tokens_dataset())
[2021-04-20 09:36:06]    INFO >> loaded 241241 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.php.code_tokens.wo_func'] (hybrid_retrieval.py:67, load_tokens_dataset())
[2021-04-20 09:36:06]    INFO >> loaded 241241 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.php.func_name'] (hybrid_retrieval.py:81, load_tokens_dataset())
[2021-04-20 09:36:06]    INFO >> NOTE: your device may support faster training with fp16 (ncc_trainers.py:155, _setup_optimizer())
[2021-04-20 09:40:44]    INFO >> epoch 001 | loss 6.084 | mrr 0.054418 | sample_size 1000 | wps 873.8 | ups 0.87 | wpb 1000 | bsz 1000 | num_updates 241 | lr 0.0005 | gnorm 2.294 | clip 71.8 | train_wall 274 | wall 278 (progress_bar.py:269, print())
[2021-04-20 09:40:53]    INFO >> epoch 001 | valid on 'valid' subset | loss 5.668 | mrr 0.096536 | sample_size 1000 | wps 1966.3 | wpb 1000 | bsz 1000 | num_updates 241 (progress_bar.py:269, print())
[2021-04-20 09:40:53]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/conv1d_res/checkpoints/checkpoint_best.pt (epoch 1 @ 241 updates, score 0.096536) (writing took 0.411771 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 09:45:50]    INFO >> epoch 002 | loss 4.721 | mrr 0.20307 | sample_size 1000 | wps 789.5 | ups 0.79 | wpb 1000 | bsz 1000 | num_updates 482 | lr 0.0005 | gnorm 3.042 | clip 100 | train_wall 293 | wall 584 (progress_bar.py:269, print())
[2021-04-20 09:45:58]    INFO >> epoch 002 | valid on 'valid' subset | loss 4.83 | mrr 0.231285 | sample_size 1000 | wps 1969.4 | wpb 1000 | bsz 1000 | num_updates 482 | best_mrr 231.285 (progress_bar.py:269, print())
[2021-04-20 09:45:58]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/conv1d_res/checkpoints/checkpoint_best.pt (epoch 2 @ 482 updates, score 0.231285) (writing took 0.418502 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 09:46:23]    INFO >> epoch 003:     18 / 242 loss=5.355, mrr=135.23, sample_size=1000, wps=814, ups=0.81, wpb=1000, bsz=1000, num_updates=500, lr=0.0005, gnorm=2.693, clip=86.4, train_wall=590, wall=617 (progress_bar.py:262, log())
[2021-04-20 09:50:56]    INFO >> epoch 003 | loss 3.753 | mrr 0.371832 | sample_size 1000 | wps 787.7 | ups 0.79 | wpb 1000 | bsz 1000 | num_updates 723 | lr 0.0005 | gnorm 3.053 | clip 100 | train_wall 294 | wall 890 (progress_bar.py:269, print())
[2021-04-20 09:51:03]    INFO >> epoch 003 | valid on 'valid' subset | loss 4.126 | mrr 0.347004 | sample_size 1000 | wps 2129 | wpb 1000 | bsz 1000 | num_updates 723 | best_mrr 347.004 (progress_bar.py:269, print())
[2021-04-20 09:51:04]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/conv1d_res/checkpoints/checkpoint_best.pt (epoch 3 @ 723 updates, score 0.347004) (writing took 0.580083 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 09:56:03]    INFO >> epoch 004 | loss 3.086 | mrr 0.487011 | sample_size 1000 | wps 784.6 | ups 0.78 | wpb 1000 | bsz 1000 | num_updates 964 | lr 0.0005 | gnorm 3.004 | clip 100 | train_wall 295 | wall 1197 (progress_bar.py:269, print())
[2021-04-20 09:56:11]    INFO >> epoch 004 | valid on 'valid' subset | loss 3.668 | mrr 0.412662 | sample_size 1000 | wps 2280.6 | wpb 1000 | bsz 1000 | num_updates 964 | best_mrr 412.662 (progress_bar.py:269, print())
[2021-04-20 09:56:12]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/conv1d_res/checkpoints/checkpoint_best.pt (epoch 4 @ 964 updates, score 0.412662) (writing took 0.488265 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 09:56:58]    INFO >> epoch 005:     36 / 242 loss=3.347, mrr=441.762, sample_size=1000, wps=787, ups=0.79, wpb=1000, bsz=1000, num_updates=1000, lr=0.0005, gnorm=3.011, clip=100, train_wall=611, wall=1252 (progress_bar.py:262, log())
[2021-04-20 10:01:08]    INFO >> epoch 005 | loss 2.616 | mrr 0.562565 | sample_size 1000 | wps 788.6 | ups 0.79 | wpb 1000 | bsz 1000 | num_updates 1205 | lr 0.0005 | gnorm 2.851 | clip 100 | train_wall 293 | wall 1502 (progress_bar.py:269, print())
[2021-04-20 10:01:17]    INFO >> epoch 005 | valid on 'valid' subset | loss 3.326 | mrr 0.469451 | sample_size 1000 | wps 1968.8 | wpb 1000 | bsz 1000 | num_updates 1205 | best_mrr 469.451 (progress_bar.py:269, print())
[2021-04-20 10:01:17]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/conv1d_res/checkpoints/checkpoint_best.pt (epoch 5 @ 1205 updates, score 0.469451) (writing took 0.614723 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 10:06:15]    INFO >> epoch 006 | loss 2.286 | mrr 0.616847 | sample_size 1000 | wps 786.2 | ups 0.79 | wpb 1000 | bsz 1000 | num_updates 1446 | lr 0.0005 | gnorm 2.803 | clip 100 | train_wall 293 | wall 1809 (progress_bar.py:269, print())
[2021-04-20 10:06:24]    INFO >> epoch 006 | valid on 'valid' subset | loss 3.07 | mrr 0.501983 | sample_size 1000 | wps 1947.3 | wpb 1000 | bsz 1000 | num_updates 1446 | best_mrr 501.983 (progress_bar.py:269, print())
[2021-04-20 10:06:25]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/conv1d_res/checkpoints/checkpoint_best.pt (epoch 6 @ 1446 updates, score 0.501983) (writing took 0.438131 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 10:07:32]    INFO >> epoch 007:     54 / 242 loss=2.388, mrr=599.69, sample_size=1000, wps=788.3, ups=0.79, wpb=1000, bsz=1000, num_updates=1500, lr=0.0005, gnorm=2.819, clip=100, train_wall=607, wall=1886 (progress_bar.py:262, log())
[2021-04-20 10:11:20]    INFO >> epoch 007 | loss 2.034 | mrr 0.656424 | sample_size 1000 | wps 788.6 | ups 0.79 | wpb 1000 | bsz 1000 | num_updates 1687 | lr 0.0005 | gnorm 2.737 | clip 100 | train_wall 292 | wall 2114 (progress_bar.py:269, print())
[2021-04-20 10:11:30]    INFO >> epoch 007 | valid on 'valid' subset | loss 2.922 | mrr 0.529961 | sample_size 1000 | wps 1944 | wpb 1000 | bsz 1000 | num_updates 1687 | best_mrr 529.961 (progress_bar.py:269, print())
[2021-04-20 10:11:31]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/conv1d_res/checkpoints/checkpoint_best.pt (epoch 7 @ 1687 updates, score 0.529961) (writing took 0.668801 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 10:16:27]    INFO >> epoch 008 | loss 1.847 | mrr 0.687753 | sample_size 1000 | wps 785.1 | ups 0.79 | wpb 1000 | bsz 1000 | num_updates 1928 | lr 0.0005 | gnorm 2.641 | clip 100 | train_wall 293 | wall 2421 (progress_bar.py:269, print())
[2021-04-20 10:16:36]    INFO >> epoch 008 | valid on 'valid' subset | loss 2.771 | mrr 0.550802 | sample_size 1000 | wps 1978.1 | wpb 1000 | bsz 1000 | num_updates 1928 | best_mrr 550.802 (progress_bar.py:269, print())
[2021-04-20 10:16:36]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/conv1d_res/checkpoints/checkpoint_best.pt (epoch 8 @ 1928 updates, score 0.550802) (writing took 0.480910 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 10:18:06]    INFO >> epoch 009:     72 / 242 loss=1.891, mrr=680.732, sample_size=1000, wps=788.6, ups=0.79, wpb=1000, bsz=1000, num_updates=2000, lr=0.0005, gnorm=2.66, clip=100, train_wall=608, wall=2520 (progress_bar.py:262, log())
[2021-04-20 10:21:32]    INFO >> epoch 009 | loss 1.701 | mrr 0.712153 | sample_size 1000 | wps 791.8 | ups 0.79 | wpb 1000 | bsz 1000 | num_updates 2169 | lr 0.0005 | gnorm 2.604 | clip 100 | train_wall 292 | wall 2726 (progress_bar.py:269, print())
[2021-04-20 10:21:40]    INFO >> epoch 009 | valid on 'valid' subset | loss 2.692 | mrr 0.569158 | sample_size 1000 | wps 1969.7 | wpb 1000 | bsz 1000 | num_updates 2169 | best_mrr 569.158 (progress_bar.py:269, print())
[2021-04-20 10:21:41]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/conv1d_res/checkpoints/checkpoint_best.pt (epoch 9 @ 2169 updates, score 0.569158) (writing took 0.602076 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 10:26:39]    INFO >> epoch 010 | loss 1.575 | mrr 0.732301 | sample_size 1000 | wps 783.7 | ups 0.78 | wpb 1000 | bsz 1000 | num_updates 2410 | lr 0.0005 | gnorm 2.636 | clip 100 | train_wall 295 | wall 3033 (progress_bar.py:269, print())
[2021-04-20 10:26:47]    INFO >> epoch 010 | valid on 'valid' subset | loss 2.63 | mrr 0.57933 | sample_size 1000 | wps 2302.8 | wpb 1000 | bsz 1000 | num_updates 2410 | best_mrr 579.33 (progress_bar.py:269, print())
[2021-04-20 10:26:47]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/conv1d_res/checkpoints/checkpoint_best.pt (epoch 10 @ 2410 updates, score 0.57933) (writing took 0.421994 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 10:28:41]    INFO >> epoch 011:     90 / 242 loss=1.6, mrr=728.3, sample_size=1000, wps=788.4, ups=0.79, wpb=1000, bsz=1000, num_updates=2500, lr=0.0005, gnorm=2.615, clip=100, train_wall=610, wall=3155 (progress_bar.py:262, log())
[2021-04-20 10:31:46]    INFO >> epoch 011 | loss 1.476 | mrr 0.748879 | sample_size 1000 | wps 785.5 | ups 0.79 | wpb 1000 | bsz 1000 | num_updates 2651 | lr 0.0005 | gnorm 2.615 | clip 100 | train_wall 295 | wall 3340 (progress_bar.py:269, print())
[2021-04-20 10:31:55]    INFO >> epoch 011 | valid on 'valid' subset | loss 2.561 | mrr 0.589611 | sample_size 1000 | wps 1975 | wpb 1000 | bsz 1000 | num_updates 2651 | best_mrr 589.611 (progress_bar.py:269, print())
[2021-04-20 10:31:55]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/conv1d_res/checkpoints/checkpoint_best.pt (epoch 11 @ 2651 updates, score 0.589611) (writing took 0.472940 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 10:36:53]    INFO >> epoch 012 | loss 1.385 | mrr 0.763509 | sample_size 1000 | wps 786.6 | ups 0.79 | wpb 1000 | bsz 1000 | num_updates 2892 | lr 0.0005 | gnorm 2.582 | clip 100 | train_wall 294 | wall 3647 (progress_bar.py:269, print())
[2021-04-20 10:37:01]    INFO >> epoch 012 | valid on 'valid' subset | loss 2.55 | mrr 0.595229 | sample_size 1000 | wps 1949 | wpb 1000 | bsz 1000 | num_updates 2892 | best_mrr 595.229 (progress_bar.py:269, print())
[2021-04-20 10:37:02]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/conv1d_res/checkpoints/checkpoint_best.pt (epoch 12 @ 2892 updates, score 0.595229) (writing took 0.403763 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 10:39:14]    INFO >> epoch 013:    109 / 242 loss=1.394, mrr=762.011, sample_size=1000, wps=789.4, ups=0.79, wpb=1000, bsz=1000, num_updates=3000, lr=0.0005, gnorm=2.611, clip=100, train_wall=607, wall=3788 (progress_bar.py:262, log())
[2021-04-20 10:41:58]    INFO >> epoch 013 | loss 1.307 | mrr 0.775469 | sample_size 1000 | wps 790.3 | ups 0.79 | wpb 1000 | bsz 1000 | num_updates 3133 | lr 0.0005 | gnorm 2.548 | clip 100 | train_wall 292 | wall 3952 (progress_bar.py:269, print())
[2021-04-20 10:42:06]    INFO >> epoch 013 | valid on 'valid' subset | loss 2.49 | mrr 0.604106 | sample_size 1000 | wps 1938.9 | wpb 1000 | bsz 1000 | num_updates 3133 | best_mrr 604.106 (progress_bar.py:269, print())
[2021-04-20 10:42:07]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/conv1d_res/checkpoints/checkpoint_best.pt (epoch 13 @ 3133 updates, score 0.604106) (writing took 0.560224 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 10:47:05]    INFO >> epoch 014 | loss 1.232 | mrr 0.78824 | sample_size 1000 | wps 783.4 | ups 0.78 | wpb 1000 | bsz 1000 | num_updates 3374 | lr 0.0005 | gnorm 2.57 | clip 100 | train_wall 295 | wall 4259 (progress_bar.py:269, print())
[2021-04-20 10:47:13]    INFO >> epoch 014 | valid on 'valid' subset | loss 2.444 | mrr 0.609115 | sample_size 1000 | wps 1945.4 | wpb 1000 | bsz 1000 | num_updates 3374 | best_mrr 609.115 (progress_bar.py:269, print())
[2021-04-20 10:47:14]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/conv1d_res/checkpoints/checkpoint_best.pt (epoch 14 @ 3374 updates, score 0.609115) (writing took 0.502457 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 10:49:49]    INFO >> epoch 015:    126 / 242 loss=1.239, mrr=787.262, sample_size=1000, wps=787.8, ups=0.79, wpb=1000, bsz=1000, num_updates=3500, lr=0.0005, gnorm=2.523, clip=100, train_wall=609, wall=4423 (progress_bar.py:262, log())
[2021-04-20 10:52:10]    INFO >> epoch 015 | loss 1.18 | mrr 0.797091 | sample_size 1000 | wps 790.4 | ups 0.79 | wpb 1000 | bsz 1000 | num_updates 3615 | lr 0.0005 | gnorm 2.499 | clip 100 | train_wall 292 | wall 4564 (progress_bar.py:269, print())
[2021-04-20 10:52:18]    INFO >> epoch 015 | valid on 'valid' subset | loss 2.451 | mrr 0.611262 | sample_size 1000 | wps 1966.9 | wpb 1000 | bsz 1000 | num_updates 3615 | best_mrr 611.262 (progress_bar.py:269, print())
[2021-04-20 10:52:19]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/conv1d_res/checkpoints/checkpoint_best.pt (epoch 15 @ 3615 updates, score 0.611262) (writing took 0.380384 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 10:57:16]    INFO >> epoch 016 | loss 1.111 | mrr 0.808538 | sample_size 1000 | wps 787.6 | ups 0.79 | wpb 1000 | bsz 1000 | num_updates 3856 | lr 0.0005 | gnorm 2.522 | clip 100 | train_wall 294 | wall 4870 (progress_bar.py:269, print())
[2021-04-20 10:57:24]    INFO >> epoch 016 | valid on 'valid' subset | loss 2.409 | mrr 0.615752 | sample_size 1000 | wps 1949.6 | wpb 1000 | bsz 1000 | num_updates 3856 | best_mrr 615.752 (progress_bar.py:269, print())
[2021-04-20 10:57:25]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/conv1d_res/checkpoints/checkpoint_best.pt (epoch 16 @ 3856 updates, score 0.615752) (writing took 0.435084 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 11:00:23]    INFO >> epoch 017:    145 / 242 loss=1.116, mrr=807.585, sample_size=1000, wps=788.3, ups=0.79, wpb=1000, bsz=1000, num_updates=4000, lr=0.0005, gnorm=2.518, clip=100, train_wall=610, wall=5057 (progress_bar.py:262, log())
[2021-04-20 11:02:22]    INFO >> epoch 017 | loss 1.071 | mrr 0.814898 | sample_size 1000 | wps 787.6 | ups 0.79 | wpb 1000 | bsz 1000 | num_updates 4097 | lr 0.0005 | gnorm 2.508 | clip 100 | train_wall 294 | wall 5176 (progress_bar.py:269, print())
[2021-04-20 11:02:30]    INFO >> epoch 017 | valid on 'valid' subset | loss 2.4 | mrr 0.620988 | sample_size 1000 | wps 2237 | wpb 1000 | bsz 1000 | num_updates 4097 | best_mrr 620.988 (progress_bar.py:269, print())
[2021-04-20 11:02:31]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/conv1d_res/checkpoints/checkpoint_best.pt (epoch 17 @ 4097 updates, score 0.620988) (writing took 1.542092 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 11:07:29]    INFO >> epoch 018 | loss 1.018 | mrr 0.824186 | sample_size 1000 | wps 784.2 | ups 0.78 | wpb 1000 | bsz 1000 | num_updates 4338 | lr 0.0005 | gnorm 2.524 | clip 100 | train_wall 295 | wall 5483 (progress_bar.py:269, print())
[2021-04-20 11:07:39]    INFO >> epoch 018 | valid on 'valid' subset | loss 2.388 | mrr 0.621296 | sample_size 1000 | wps 1948.6 | wpb 1000 | bsz 1000 | num_updates 4338 | best_mrr 621.296 (progress_bar.py:269, print())
[2021-04-20 11:07:39]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/conv1d_res/checkpoints/checkpoint_best.pt (epoch 18 @ 4338 updates, score 0.621296) (writing took 0.464278 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 11:10:59]    INFO >> epoch 019:    163 / 242 loss=1.016, mrr=824.289, sample_size=1000, wps=785.8, ups=0.79, wpb=1000, bsz=1000, num_updates=4500, lr=0.0005, gnorm=2.515, clip=100, train_wall=611, wall=5693 (progress_bar.py:262, log())
[2021-04-20 11:12:38]    INFO >> epoch 019 | loss 0.979 | mrr 0.830627 | sample_size 1000 | wps 781.2 | ups 0.78 | wpb 1000 | bsz 1000 | num_updates 4579 | lr 0.0005 | gnorm 2.497 | clip 100 | train_wall 295 | wall 5792 (progress_bar.py:269, print())
[2021-04-20 11:12:46]    INFO >> epoch 019 | valid on 'valid' subset | loss 2.409 | mrr 0.627648 | sample_size 1000 | wps 1971.6 | wpb 1000 | bsz 1000 | num_updates 4579 | best_mrr 627.648 (progress_bar.py:269, print())
[2021-04-20 11:12:47]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/conv1d_res/checkpoints/checkpoint_best.pt (epoch 19 @ 4579 updates, score 0.627648) (writing took 0.497388 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 11:17:44]    INFO >> epoch 020 | loss 0.938 | mrr 0.837161 | sample_size 1000 | wps 788.5 | ups 0.79 | wpb 1000 | bsz 1000 | num_updates 4820 | lr 0.0005 | gnorm 2.535 | clip 100 | train_wall 292 | wall 6098 (progress_bar.py:269, print())
[2021-04-20 11:17:52]    INFO >> epoch 020 | valid on 'valid' subset | loss 2.367 | mrr 0.628421 | sample_size 1000 | wps 1979.5 | wpb 1000 | bsz 1000 | num_updates 4820 | best_mrr 628.421 (progress_bar.py:269, print())
[2021-04-20 11:17:53]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/conv1d_res/checkpoints/checkpoint_best.pt (epoch 20 @ 4820 updates, score 0.628421) (writing took 0.486287 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 11:21:35]    INFO >> epoch 021:    181 / 242 loss=0.933, mrr=838.094, sample_size=1000, wps=786.3, ups=0.79, wpb=1000, bsz=1000, num_updates=5000, lr=0.0005, gnorm=2.52, clip=100, train_wall=610, wall=6329 (progress_bar.py:262, log())
[2021-04-20 11:22:51]    INFO >> epoch 021 | loss 0.904 | mrr 0.842839 | sample_size 1000 | wps 783.9 | ups 0.78 | wpb 1000 | bsz 1000 | num_updates 5061 | lr 0.0005 | gnorm 2.534 | clip 100 | train_wall 295 | wall 6405 (progress_bar.py:269, print())
[2021-04-20 11:22:59]    INFO >> epoch 021 | valid on 'valid' subset | loss 2.389 | mrr 0.634287 | sample_size 1000 | wps 1979.8 | wpb 1000 | bsz 1000 | num_updates 5061 | best_mrr 634.287 (progress_bar.py:269, print())
[2021-04-20 11:23:00]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/conv1d_res/checkpoints/checkpoint_best.pt (epoch 21 @ 5061 updates, score 0.634287) (writing took 0.401443 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 11:27:36]    INFO >> epoch 022 | loss 0.872 | mrr 0.848569 | sample_size 1000 | wps 845 | ups 0.84 | wpb 1000 | bsz 1000 | num_updates 5302 | lr 0.0005 | gnorm 2.527 | clip 100 | train_wall 273 | wall 6690 (progress_bar.py:269, print())
[2021-04-20 11:27:44]    INFO >> epoch 022 | valid on 'valid' subset | loss 2.42 | mrr 0.633058 | sample_size 1000 | wps 2450 | wpb 1000 | bsz 1000 | num_updates 5302 | best_mrr 633.058 (progress_bar.py:269, print())
[2021-04-20 11:27:45]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/conv1d_res/checkpoints/checkpoint_last.pt (epoch 22 @ 5302 updates, score 0.633058) (writing took 0.329531 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 11:31:02]    INFO >> epoch 023:    199 / 242 loss=0.863, mrr=849.85, sample_size=1000, wps=882.3, ups=0.88, wpb=1000, bsz=1000, num_updates=5500, lr=0.0005, gnorm=2.528, clip=100, train_wall=543, wall=6896 (progress_bar.py:262, log())
[2021-04-20 11:31:45]    INFO >> epoch 023 | loss 0.843 | mrr 0.85307 | sample_size 1000 | wps 968.4 | ups 0.97 | wpb 1000 | bsz 1000 | num_updates 5543 | lr 0.0005 | gnorm 2.527 | clip 100 | train_wall 237 | wall 6939 (progress_bar.py:269, print())
[2021-04-20 11:31:54]    INFO >> epoch 023 | valid on 'valid' subset | loss 2.429 | mrr 0.636532 | sample_size 1000 | wps 2439.3 | wpb 1000 | bsz 1000 | num_updates 5543 | best_mrr 636.532 (progress_bar.py:269, print())
[2021-04-20 11:31:54]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/conv1d_res/checkpoints/checkpoint_best.pt (epoch 23 @ 5543 updates, score 0.636532) (writing took 0.467896 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 11:35:47]    INFO >> epoch 024 | loss 0.813 | mrr 0.857717 | sample_size 1000 | wps 996.9 | ups 1 | wpb 1000 | bsz 1000 | num_updates 5784 | lr 0.0005 | gnorm 2.545 | clip 100 | train_wall 229 | wall 7181 (progress_bar.py:269, print())
[2021-04-20 11:35:54]    INFO >> epoch 024 | valid on 'valid' subset | loss 2.378 | mrr 0.638361 | sample_size 1000 | wps 2398 | wpb 1000 | bsz 1000 | num_updates 5784 | best_mrr 638.361 (progress_bar.py:269, print())
[2021-04-20 11:35:55]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/conv1d_res/checkpoints/checkpoint_best.pt (epoch 24 @ 5784 updates, score 0.638361) (writing took 0.618841 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 11:39:30]    INFO >> epoch 025:    216 / 242 loss=0.807, mrr=858.667, sample_size=1000, wps=983.4, ups=0.98, wpb=1000, bsz=1000, num_updates=6000, lr=0.0005, gnorm=2.526, clip=100, train_wall=484, wall=7404 (progress_bar.py:262, log())
[2021-04-20 11:39:56]    INFO >> epoch 025 | loss 0.791 | mrr 0.861608 | sample_size 1000 | wps 968.6 | ups 0.97 | wpb 1000 | bsz 1000 | num_updates 6025 | lr 0.0005 | gnorm 2.505 | clip 100 | train_wall 237 | wall 7430 (progress_bar.py:269, print())
[2021-04-20 11:40:04]    INFO >> epoch 025 | valid on 'valid' subset | loss 2.416 | mrr 0.637998 | sample_size 1000 | wps 2434.5 | wpb 1000 | bsz 1000 | num_updates 6025 | best_mrr 637.998 (progress_bar.py:269, print())
[2021-04-20 11:40:04]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/conv1d_res/checkpoints/checkpoint_last.pt (epoch 25 @ 6025 updates, score 0.637998) (writing took 0.224384 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 11:44:05]    INFO >> epoch 026 | loss 0.767 | mrr 0.865471 | sample_size 1000 | wps 968.2 | ups 0.97 | wpb 1000 | bsz 1000 | num_updates 6266 | lr 0.0005 | gnorm 2.526 | clip 100 | train_wall 237 | wall 7679 (progress_bar.py:269, print())
[2021-04-20 11:44:12]    INFO >> epoch 026 | valid on 'valid' subset | loss 2.403 | mrr 0.637603 | sample_size 1000 | wps 2623.6 | wpb 1000 | bsz 1000 | num_updates 6266 | best_mrr 637.603 (progress_bar.py:269, print())
[2021-04-20 11:44:13]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/conv1d_res/checkpoints/checkpoint_last.pt (epoch 26 @ 6266 updates, score 0.637603) (writing took 0.233260 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 11:48:00]    INFO >> epoch 027:    235 / 242 loss=0.756, mrr=867.514, sample_size=1000, wps=980.1, ups=0.98, wpb=1000, bsz=1000, num_updates=6500, lr=0.0005, gnorm=2.517, clip=100, train_wall=486, wall=7914 (progress_bar.py:262, log())
[2021-04-20 11:48:08]    INFO >> epoch 027 | loss 0.739 | mrr 0.870519 | sample_size 1000 | wps 991.6 | ups 0.99 | wpb 1000 | bsz 1000 | num_updates 6507 | lr 0.0005 | gnorm 2.498 | clip 100 | train_wall 232 | wall 7922 (progress_bar.py:269, print())
[2021-04-20 11:48:16]    INFO >> epoch 027 | valid on 'valid' subset | loss 2.429 | mrr 0.639077 | sample_size 1000 | wps 2427.9 | wpb 1000 | bsz 1000 | num_updates 6507 | best_mrr 639.077 (progress_bar.py:269, print())
[2021-04-20 11:48:17]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/conv1d_res/checkpoints/checkpoint_best.pt (epoch 27 @ 6507 updates, score 0.639077) (writing took 0.593541 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 11:52:18]    INFO >> epoch 028 | loss 0.719 | mrr 0.874122 | sample_size 1000 | wps 963.5 | ups 0.96 | wpb 1000 | bsz 1000 | num_updates 6748 | lr 0.0005 | gnorm 2.488 | clip 100 | train_wall 238 | wall 8172 (progress_bar.py:269, print())
[2021-04-20 11:52:26]    INFO >> epoch 028 | valid on 'valid' subset | loss 2.426 | mrr 0.639145 | sample_size 1000 | wps 2456.9 | wpb 1000 | bsz 1000 | num_updates 6748 | best_mrr 639.145 (progress_bar.py:269, print())
[2021-04-20 11:52:26]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/conv1d_res/checkpoints/checkpoint_best.pt (epoch 28 @ 6748 updates, score 0.639145) (writing took 0.427770 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 11:56:24]    INFO >> epoch 029 | loss 0.701 | mrr 0.877101 | sample_size 1000 | wps 981.3 | ups 0.98 | wpb 1000 | bsz 1000 | num_updates 6989 | lr 0.0005 | gnorm 2.573 | clip 100 | train_wall 233 | wall 8418 (progress_bar.py:269, print())
[2021-04-20 11:56:31]    INFO >> epoch 029 | valid on 'valid' subset | loss 2.427 | mrr 0.640837 | sample_size 1000 | wps 2429.2 | wpb 1000 | bsz 1000 | num_updates 6989 | best_mrr 640.837 (progress_bar.py:269, print())
[2021-04-20 11:56:31]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/conv1d_res/checkpoints/checkpoint_best.pt (epoch 29 @ 6989 updates, score 0.640837) (writing took 0.486416 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 11:56:45]    INFO >> epoch 030:     11 / 242 loss=0.709, mrr=875.777, sample_size=1000, wps=952.5, ups=0.95, wpb=1000, bsz=1000, num_updates=7000, lr=0.0005, gnorm=2.528, clip=100, train_wall=489, wall=8439 (progress_bar.py:262, log())
[2021-04-20 12:00:33]    INFO >> epoch 030 | loss 0.683 | mrr 0.8797 | sample_size 1000 | wps 964.9 | ups 0.96 | wpb 1000 | bsz 1000 | num_updates 7230 | lr 0.0005 | gnorm 2.489 | clip 100 | train_wall 238 | wall 8667 (progress_bar.py:269, print())
[2021-04-20 12:00:42]    INFO >> epoch 030 | valid on 'valid' subset | loss 2.443 | mrr 0.640018 | sample_size 1000 | wps 2437.3 | wpb 1000 | bsz 1000 | num_updates 7230 | best_mrr 640.018 (progress_bar.py:269, print())
[2021-04-20 12:00:42]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/conv1d_res/checkpoints/checkpoint_last.pt (epoch 30 @ 7230 updates, score 0.640018) (writing took 0.247878 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 12:04:28]    INFO >> epoch 031 | loss 0.66 | mrr 0.883575 | sample_size 1000 | wps 1025.5 | ups 1.03 | wpb 1000 | bsz 1000 | num_updates 7471 | lr 0.0005 | gnorm 2.533 | clip 100 | train_wall 223 | wall 8902 (progress_bar.py:269, print())
[2021-04-20 12:04:34]    INFO >> epoch 031 | valid on 'valid' subset | loss 2.474 | mrr 0.639274 | sample_size 1000 | wps 3169.1 | wpb 1000 | bsz 1000 | num_updates 7471 | best_mrr 639.274 (progress_bar.py:269, print())
[2021-04-20 12:04:34]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/conv1d_res/checkpoints/checkpoint_last.pt (epoch 31 @ 7471 updates, score 0.639274) (writing took 0.215252 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 12:04:58]    INFO >> epoch 032:     29 / 242 loss=0.669, mrr=882.09, sample_size=1000, wps=1014.4, ups=1.01, wpb=1000, bsz=1000, num_updates=7500, lr=0.0005, gnorm=2.504, clip=100, train_wall=471, wall=8932 (progress_bar.py:262, log())
[2021-04-20 12:07:30]    INFO >> epoch 032 | loss 0.644 | mrr 0.886522 | sample_size 1000 | wps 1327.6 | ups 1.33 | wpb 1000 | bsz 1000 | num_updates 7712 | lr 0.0005 | gnorm 2.471 | clip 100 | train_wall 172 | wall 9084 (progress_bar.py:269, print())
[2021-04-20 12:07:37]    INFO >> epoch 032 | valid on 'valid' subset | loss 2.46 | mrr 0.642244 | sample_size 1000 | wps 3215.7 | wpb 1000 | bsz 1000 | num_updates 7712 | best_mrr 642.244 (progress_bar.py:269, print())
[2021-04-20 12:07:37]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/conv1d_res/checkpoints/checkpoint_best.pt (epoch 32 @ 7712 updates, score 0.642244) (writing took 0.406965 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 12:10:36]    INFO >> epoch 033 | loss 0.628 | mrr 0.889097 | sample_size 1000 | wps 1298 | ups 1.3 | wpb 1000 | bsz 1000 | num_updates 7953 | lr 0.0005 | gnorm 2.517 | clip 100 | train_wall 175 | wall 9270 (progress_bar.py:269, print())
[2021-04-20 12:10:42]    INFO >> epoch 033 | valid on 'valid' subset | loss 2.481 | mrr 0.643874 | sample_size 1000 | wps 3190.1 | wpb 1000 | bsz 1000 | num_updates 7953 | best_mrr 643.874 (progress_bar.py:269, print())
[2021-04-20 12:10:43]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/conv1d_res/checkpoints/checkpoint_best.pt (epoch 33 @ 7953 updates, score 0.643874) (writing took 0.459398 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 12:11:18]    INFO >> epoch 034:     47 / 242 loss=0.633, mrr=888.412, sample_size=1000, wps=1316.4, ups=1.32, wpb=1000, bsz=1000, num_updates=8000, lr=0.0005, gnorm=2.502, clip=100, train_wall=358, wall=9312 (progress_bar.py:262, log())
[2021-04-20 12:13:39]    INFO >> epoch 034 | loss 0.611 | mrr 0.892171 | sample_size 1000 | wps 1310.1 | ups 1.31 | wpb 1000 | bsz 1000 | num_updates 8194 | lr 0.0005 | gnorm 2.522 | clip 100 | train_wall 173 | wall 9453 (progress_bar.py:269, print())
[2021-04-20 12:13:45]    INFO >> epoch 034 | valid on 'valid' subset | loss 2.506 | mrr 0.644703 | sample_size 1000 | wps 3210.1 | wpb 1000 | bsz 1000 | num_updates 8194 | best_mrr 644.703 (progress_bar.py:269, print())
[2021-04-20 12:13:46]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/conv1d_res/checkpoints/checkpoint_best.pt (epoch 34 @ 8194 updates, score 0.644703) (writing took 0.568165 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 12:16:45]    INFO >> epoch 035 | loss 0.598 | mrr 0.89401 | sample_size 1000 | wps 1300.9 | ups 1.3 | wpb 1000 | bsz 1000 | num_updates 8435 | lr 0.0005 | gnorm 2.514 | clip 100 | train_wall 175 | wall 9639 (progress_bar.py:269, print())
[2021-04-20 12:16:52]    INFO >> epoch 035 | valid on 'valid' subset | loss 2.513 | mrr 0.641473 | sample_size 1000 | wps 3167.8 | wpb 1000 | bsz 1000 | num_updates 8435 | best_mrr 641.473 (progress_bar.py:269, print())
[2021-04-20 12:16:52]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/conv1d_res/checkpoints/checkpoint_last.pt (epoch 35 @ 8435 updates, score 0.641473) (writing took 0.233844 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 12:17:40]    INFO >> epoch 036:     65 / 242 loss=0.601, mrr=893.582, sample_size=1000, wps=1308.7, ups=1.31, wpb=1000, bsz=1000, num_updates=8500, lr=0.0005, gnorm=2.518, clip=100, train_wall=361, wall=9694 (progress_bar.py:262, log())
[2021-04-20 12:19:48]    INFO >> epoch 036 | loss 0.585 | mrr 0.896437 | sample_size 1000 | wps 1316.8 | ups 1.32 | wpb 1000 | bsz 1000 | num_updates 8676 | lr 0.0005 | gnorm 2.532 | clip 100 | train_wall 172 | wall 9822 (progress_bar.py:269, print())
[2021-04-20 12:19:54]    INFO >> epoch 036 | valid on 'valid' subset | loss 2.507 | mrr 0.643419 | sample_size 1000 | wps 3178.7 | wpb 1000 | bsz 1000 | num_updates 8676 | best_mrr 643.419 (progress_bar.py:269, print())
[2021-04-20 12:19:54]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/conv1d_res/checkpoints/checkpoint_last.pt (epoch 36 @ 8676 updates, score 0.643419) (writing took 0.250339 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 12:22:26]    INFO >> epoch 037 | loss 0.57 | mrr 0.899032 | sample_size 1000 | wps 1519.7 | ups 1.52 | wpb 1000 | bsz 1000 | num_updates 8917 | lr 0.0005 | gnorm 2.515 | clip 100 | train_wall 149 | wall 9980 (progress_bar.py:269, print())
[2021-04-20 12:22:31]    INFO >> epoch 037 | valid on 'valid' subset | loss 2.524 | mrr 0.64366 | sample_size 1000 | wps 4782.3 | wpb 1000 | bsz 1000 | num_updates 8917 | best_mrr 643.66 (progress_bar.py:269, print())
[2021-04-20 12:22:32]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/conv1d_res/checkpoints/checkpoint_last.pt (epoch 37 @ 8917 updates, score 0.64366) (writing took 0.247182 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 12:23:14]    INFO >> epoch 038:     83 / 242 loss=0.571, mrr=898.951, sample_size=1000, wps=1499, ups=1.5, wpb=1000, bsz=1000, num_updates=9000, lr=0.0005, gnorm=2.516, clip=100, train_wall=315, wall=10028 (progress_bar.py:262, log())
[2021-04-20 12:24:30]    INFO >> epoch 038 | loss 0.561 | mrr 0.900821 | sample_size 1000 | wps 1942.6 | ups 1.94 | wpb 1000 | bsz 1000 | num_updates 9158 | lr 0.0005 | gnorm 2.5 | clip 100 | train_wall 116 | wall 10104 (progress_bar.py:269, print())
[2021-04-20 12:24:36]    INFO >> epoch 038 | valid on 'valid' subset | loss 2.507 | mrr 0.643681 | sample_size 1000 | wps 4717.5 | wpb 1000 | bsz 1000 | num_updates 9158 | best_mrr 643.681 (progress_bar.py:269, print())
[2021-04-20 12:24:36]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/conv1d_res/checkpoints/checkpoint_last.pt (epoch 38 @ 9158 updates, score 0.643681) (writing took 0.278439 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 12:26:35]    INFO >> epoch 039 | loss 0.55 | mrr 0.902697 | sample_size 1000 | wps 1927.5 | ups 1.93 | wpb 1000 | bsz 1000 | num_updates 9399 | lr 0.0005 | gnorm 2.515 | clip 100 | train_wall 116 | wall 10229 (progress_bar.py:269, print())
[2021-04-20 12:26:41]    INFO >> epoch 039 | valid on 'valid' subset | loss 2.547 | mrr 0.643632 | sample_size 1000 | wps 4709.1 | wpb 1000 | bsz 1000 | num_updates 9399 | best_mrr 643.632 (progress_bar.py:269, print())
[2021-04-20 12:26:41]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/conv1d_res/checkpoints/checkpoint_last.pt (epoch 39 @ 9399 updates, score 0.643632) (writing took 0.285196 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 12:27:33]    INFO >> epoch 040:    101 / 242 loss=0.552, mrr=902.252, sample_size=1000, wps=1931.7, ups=1.93, wpb=1000, bsz=1000, num_updates=9500, lr=0.0005, gnorm=2.514, clip=100, train_wall=240, wall=10287 (progress_bar.py:262, log())
[2021-04-20 12:28:41]    INFO >> epoch 040 | loss 0.536 | mrr 0.904616 | sample_size 1000 | wps 1926.3 | ups 1.93 | wpb 1000 | bsz 1000 | num_updates 9640 | lr 0.0005 | gnorm 2.52 | clip 100 | train_wall 116 | wall 10355 (progress_bar.py:269, print())
[2021-04-20 12:28:46]    INFO >> epoch 040 | valid on 'valid' subset | loss 2.531 | mrr 0.645247 | sample_size 1000 | wps 4711.4 | wpb 1000 | bsz 1000 | num_updates 9640 | best_mrr 645.247 (progress_bar.py:269, print())
[2021-04-20 12:28:47]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/conv1d_res/checkpoints/checkpoint_best.pt (epoch 40 @ 9640 updates, score 0.645247) (writing took 0.406279 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 12:30:40]    INFO >> epoch 041 | loss 0.526 | mrr 0.906773 | sample_size 1000 | wps 2023.4 | ups 2.02 | wpb 1000 | bsz 1000 | num_updates 9881 | lr 0.0005 | gnorm 2.521 | clip 100 | train_wall 109 | wall 10474 (progress_bar.py:269, print())
[2021-04-20 12:30:44]    INFO >> epoch 041 | valid on 'valid' subset | loss 2.55 | mrr 0.642524 | sample_size 1000 | wps 4545.3 | wpb 1000 | bsz 1000 | num_updates 9881 | best_mrr 642.524 (progress_bar.py:269, print())
[2021-04-20 12:30:45]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/conv1d_res/checkpoints/checkpoint_last.pt (epoch 41 @ 9881 updates, score 0.642524) (writing took 0.224335 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 12:31:45]    INFO >> epoch 042:    119 / 242 loss=0.528, mrr=906.162, sample_size=1000, wps=1985, ups=1.98, wpb=1000, bsz=1000, num_updates=10000, lr=0.0005, gnorm=2.515, clip=100, train_wall=233, wall=10539 (progress_bar.py:262, log())
[2021-04-20 12:32:44]    INFO >> epoch 042 | loss 0.517 | mrr 0.90807 | sample_size 1000 | wps 1940.5 | ups 1.94 | wpb 1000 | bsz 1000 | num_updates 10122 | lr 0.0005 | gnorm 2.497 | clip 100 | train_wall 116 | wall 10598 (progress_bar.py:269, print())
[2021-04-20 12:32:50]    INFO >> epoch 042 | valid on 'valid' subset | loss 2.525 | mrr 0.645031 | sample_size 1000 | wps 4597.4 | wpb 1000 | bsz 1000 | num_updates 10122 | best_mrr 645.031 (progress_bar.py:269, print())
[2021-04-20 12:32:50]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/conv1d_res/checkpoints/checkpoint_last.pt (epoch 42 @ 10122 updates, score 0.645031) (writing took 0.256168 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 12:34:49]    INFO >> epoch 043 | loss 0.501 | mrr 0.910634 | sample_size 1000 | wps 1921.5 | ups 1.92 | wpb 1000 | bsz 1000 | num_updates 10363 | lr 0.0005 | gnorm 2.522 | clip 100 | train_wall 116 | wall 10723 (progress_bar.py:269, print())
[2021-04-20 12:34:55]    INFO >> epoch 043 | valid on 'valid' subset | loss 2.541 | mrr 0.647163 | sample_size 1000 | wps 4686 | wpb 1000 | bsz 1000 | num_updates 10363 | best_mrr 647.163 (progress_bar.py:269, print())
[2021-04-20 12:34:55]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/conv1d_res/checkpoints/checkpoint_best.pt (epoch 43 @ 10363 updates, score 0.647163) (writing took 0.483888 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 12:36:04]    INFO >> epoch 044:    138 / 242 loss=0.502, mrr=910.698, sample_size=1000, wps=1927.7, ups=1.93, wpb=1000, bsz=1000, num_updates=10500, lr=0.0005, gnorm=2.51, clip=100, train_wall=240, wall=10798 (progress_bar.py:262, log())
[2021-04-20 12:36:54]    INFO >> epoch 044 | loss 0.492 | mrr 0.912224 | sample_size 1000 | wps 1928.1 | ups 1.93 | wpb 1000 | bsz 1000 | num_updates 10604 | lr 0.0005 | gnorm 2.5 | clip 100 | train_wall 115 | wall 10848 (progress_bar.py:269, print())
[2021-04-20 12:37:00]    INFO >> epoch 044 | valid on 'valid' subset | loss 2.578 | mrr 0.647549 | sample_size 1000 | wps 4681.5 | wpb 1000 | bsz 1000 | num_updates 10604 | best_mrr 647.549 (progress_bar.py:269, print())
[2021-04-20 12:37:00]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/conv1d_res/checkpoints/checkpoint_best.pt (epoch 44 @ 10604 updates, score 0.647549) (writing took 0.365346 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 12:38:59]    INFO >> epoch 045 | loss 0.487 | mrr 0.913366 | sample_size 1000 | wps 1929.5 | ups 1.93 | wpb 1000 | bsz 1000 | num_updates 10845 | lr 0.0005 | gnorm 2.489 | clip 100 | train_wall 115 | wall 10973 (progress_bar.py:269, print())
[2021-04-20 12:39:05]    INFO >> epoch 045 | valid on 'valid' subset | loss 2.58 | mrr 0.647207 | sample_size 1000 | wps 4646.2 | wpb 1000 | bsz 1000 | num_updates 10845 | best_mrr 647.207 (progress_bar.py:269, print())
[2021-04-20 12:39:05]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/conv1d_res/checkpoints/checkpoint_last.pt (epoch 45 @ 10845 updates, score 0.647207) (writing took 0.233639 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 12:40:17]    INFO >> epoch 046:    156 / 242 loss=0.484, mrr=913.754, sample_size=1000, wps=1976.6, ups=1.98, wpb=1000, bsz=1000, num_updates=11000, lr=0.0005, gnorm=2.478, clip=100, train_wall=234, wall=11051 (progress_bar.py:262, log())
[2021-04-20 12:40:59]    INFO >> epoch 046 | loss 0.475 | mrr 0.915306 | sample_size 1000 | wps 2017.7 | ups 2.02 | wpb 1000 | bsz 1000 | num_updates 11086 | lr 0.0005 | gnorm 2.468 | clip 100 | train_wall 110 | wall 11093 (progress_bar.py:269, print())
[2021-04-20 12:41:04]    INFO >> epoch 046 | valid on 'valid' subset | loss 2.616 | mrr 0.645778 | sample_size 1000 | wps 4550.4 | wpb 1000 | bsz 1000 | num_updates 11086 | best_mrr 645.778 (progress_bar.py:269, print())
[2021-04-20 12:41:05]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/conv1d_res/checkpoints/checkpoint_last.pt (epoch 46 @ 11086 updates, score 0.645778) (writing took 0.245826 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 12:43:04]    INFO >> epoch 047 | loss 0.469 | mrr 0.916386 | sample_size 1000 | wps 1925.9 | ups 1.93 | wpb 1000 | bsz 1000 | num_updates 11327 | lr 0.0005 | gnorm 2.474 | clip 100 | train_wall 116 | wall 11218 (progress_bar.py:269, print())
[2021-04-20 12:43:10]    INFO >> epoch 047 | valid on 'valid' subset | loss 2.569 | mrr 0.646834 | sample_size 1000 | wps 4605.1 | wpb 1000 | bsz 1000 | num_updates 11327 | best_mrr 646.834 (progress_bar.py:269, print())
[2021-04-20 12:43:10]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/conv1d_res/checkpoints/checkpoint_last.pt (epoch 47 @ 11327 updates, score 0.646834) (writing took 0.286244 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 12:44:36]    INFO >> epoch 048:    174 / 242 loss=0.468, mrr=916.445, sample_size=1000, wps=1931, ups=1.93, wpb=1000, bsz=1000, num_updates=11500, lr=0.0005, gnorm=2.478, clip=100, train_wall=240, wall=11310 (progress_bar.py:262, log())
[2021-04-20 12:45:09]    INFO >> epoch 048 | loss 0.463 | mrr 0.917234 | sample_size 1000 | wps 1926.3 | ups 1.93 | wpb 1000 | bsz 1000 | num_updates 11568 | lr 0.0005 | gnorm 2.491 | clip 100 | train_wall 116 | wall 11343 (progress_bar.py:269, print())
[2021-04-20 12:45:15]    INFO >> epoch 048 | valid on 'valid' subset | loss 2.6 | mrr 0.646493 | sample_size 1000 | wps 4625.5 | wpb 1000 | bsz 1000 | num_updates 11568 | best_mrr 646.493 (progress_bar.py:269, print())
[2021-04-20 12:45:15]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/conv1d_res/checkpoints/checkpoint_last.pt (epoch 48 @ 11568 updates, score 0.646493) (writing took 0.225273 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 12:47:14]    INFO >> epoch 049 | loss 0.454 | mrr 0.91923 | sample_size 1000 | wps 1923.9 | ups 1.92 | wpb 1000 | bsz 1000 | num_updates 11809 | lr 0.0005 | gnorm 2.461 | clip 100 | train_wall 115 | wall 11468 (progress_bar.py:269, print())
[2021-04-20 12:47:20]    INFO >> epoch 049 | valid on 'valid' subset | loss 2.617 | mrr 0.646013 | sample_size 1000 | wps 4650.5 | wpb 1000 | bsz 1000 | num_updates 11809 | best_mrr 646.013 (progress_bar.py:269, print())
[2021-04-20 12:47:20]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/conv1d_res/checkpoints/checkpoint_last.pt (epoch 49 @ 11809 updates, score 0.646013) (writing took 0.258600 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 12:48:55]    INFO >> epoch 050:    192 / 242 loss=0.453, mrr=919.269, sample_size=1000, wps=1929, ups=1.93, wpb=1000, bsz=1000, num_updates=12000, lr=0.0005, gnorm=2.472, clip=100, train_wall=240, wall=11569 (progress_bar.py:262, log())
[2021-04-20 12:49:19]    INFO >> epoch 050 | loss 0.445 | mrr 0.920659 | sample_size 1000 | wps 1924.7 | ups 1.92 | wpb 1000 | bsz 1000 | num_updates 12050 | lr 0.0005 | gnorm 2.457 | clip 100 | train_wall 116 | wall 11593 (progress_bar.py:269, print())
[2021-04-20 12:49:25]    INFO >> epoch 050 | valid on 'valid' subset | loss 2.625 | mrr 0.644008 | sample_size 1000 | wps 5391.7 | wpb 1000 | bsz 1000 | num_updates 12050 | best_mrr 644.008 (progress_bar.py:269, print())
[2021-04-20 12:49:25]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/conv1d_res/checkpoints/checkpoint_last.pt (epoch 50 @ 12050 updates, score 0.644008) (writing took 0.219715 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 12:51:20]    INFO >> epoch 051 | loss 0.439 | mrr 0.921937 | sample_size 1000 | wps 2002 | ups 2 | wpb 1000 | bsz 1000 | num_updates 12291 | lr 0.0005 | gnorm 2.473 | clip 100 | train_wall 111 | wall 11714 (progress_bar.py:269, print())
[2021-04-20 12:51:25]    INFO >> epoch 051 | valid on 'valid' subset | loss 2.638 | mrr 0.64678 | sample_size 1000 | wps 4703 | wpb 1000 | bsz 1000 | num_updates 12291 | best_mrr 646.78 (progress_bar.py:269, print())
[2021-04-20 12:51:26]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/conv1d_res/checkpoints/checkpoint_last.pt (epoch 51 @ 12291 updates, score 0.64678) (writing took 0.196213 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 12:53:09]    INFO >> epoch 052:    209 / 242 loss=0.437, mrr=922.195, sample_size=1000, wps=1969.7, ups=1.97, wpb=1000, bsz=1000, num_updates=12500, lr=0.0005, gnorm=2.464, clip=100, train_wall=235, wall=11823 (progress_bar.py:262, log())
[2021-04-20 12:53:25]    INFO >> epoch 052 | loss 0.432 | mrr 0.923057 | sample_size 1000 | wps 1932.6 | ups 1.93 | wpb 1000 | bsz 1000 | num_updates 12532 | lr 0.0005 | gnorm 2.455 | clip 100 | train_wall 115 | wall 11839 (progress_bar.py:269, print())
[2021-04-20 12:53:30]    INFO >> epoch 052 | valid on 'valid' subset | loss 2.633 | mrr 0.647509 | sample_size 1000 | wps 4675 | wpb 1000 | bsz 1000 | num_updates 12532 | best_mrr 647.509 (progress_bar.py:269, print())
[2021-04-20 12:53:31]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/conv1d_res/checkpoints/checkpoint_last.pt (epoch 52 @ 12532 updates, score 0.647509) (writing took 0.220414 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 12:55:29]    INFO >> epoch 053 | loss 0.425 | mrr 0.924186 | sample_size 1000 | wps 1932.3 | ups 1.93 | wpb 1000 | bsz 1000 | num_updates 12773 | lr 0.0005 | gnorm 2.409 | clip 100 | train_wall 115 | wall 11963 (progress_bar.py:269, print())
[2021-04-20 12:55:35]    INFO >> epoch 053 | valid on 'valid' subset | loss 2.657 | mrr 0.645154 | sample_size 1000 | wps 4697.5 | wpb 1000 | bsz 1000 | num_updates 12773 | best_mrr 645.154 (progress_bar.py:269, print())
[2021-04-20 12:55:35]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/conv1d_res/checkpoints/checkpoint_last.pt (epoch 53 @ 12773 updates, score 0.645154) (writing took 0.253061 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 12:57:27]    INFO >> epoch 054:    228 / 242 loss=0.424, mrr=924.257, sample_size=1000, wps=1937.9, ups=1.94, wpb=1000, bsz=1000, num_updates=13000, lr=0.0005, gnorm=2.427, clip=100, train_wall=239, wall=12081 (progress_bar.py:262, log())
[2021-04-20 12:57:34]    INFO >> epoch 054 | loss 0.417 | mrr 0.925274 | sample_size 1000 | wps 1933.7 | ups 1.93 | wpb 1000 | bsz 1000 | num_updates 13014 | lr 0.0005 | gnorm 2.431 | clip 100 | train_wall 115 | wall 12088 (progress_bar.py:269, print())
[2021-04-20 12:57:40]    INFO >> epoch 054 | valid on 'valid' subset | loss 2.664 | mrr 0.647463 | sample_size 1000 | wps 4688.9 | wpb 1000 | bsz 1000 | num_updates 13014 | best_mrr 647.463 (progress_bar.py:269, print())
[2021-04-20 12:57:40]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/conv1d_res/checkpoints/checkpoint_last.pt (epoch 54 @ 13014 updates, score 0.647463) (writing took 0.278578 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 12:57:40]    INFO >> early stop since valid performance hasn't improved for last 10 runs (train.py:191, should_stop_early())
[2021-04-20 12:57:40]    INFO >> early stop since valid performance hasn't improved for last 10 runs (train.py:272, single_main())
[2021-04-20 12:57:40]    INFO >> done training in 12093.5 seconds (train.py:283, single_main())
