nohup: 忽略输入
[2021-04-20 04:15:16]    INFO >> Load arguments in /home/yanghe/Documents/naturalcc-dev/run/retrieval/nbow/config/csn_feng/javascript.yml (train.py:302, cli_main())
[2021-04-20 04:15:16]    INFO >> {'criterion': 'retrieval_cosine', 'optimizer': 'torch_adam', 'lr_scheduler': 'fixed', 'tokenizer': None, 'bpe': None, 'common': {'no_progress_bar': 0, 'log_interval': 500, 'log_format': 'simple', 'tensorboard_logdir': '', 'seed': 666, 'cpu': 0, 'fp16': 0, 'memory_efficient_fp16': 0, 'fp16_no_flatten_grads': 0, 'fp16_init_scale': 128, 'fp16_scale_window': None, 'fp16_scale_tolerance': 0.0, 'min_loss_scale': 0.0001, 'threshold_loss_scale': None, 'user_dir': None, 'empty_cache_freq': 0, 'all_gather_list_size': 16384, 'task': 'hybrid_retrieval'}, 'dataset': {'num_workers': 1, 'skip_invalid_size_inputs_valid_test': 0, 'max_tokens': None, 'max_sentences': 1000, 'code_max_tokens': 200, 'query_max_tokens': 30, 'required_batch_size_multiple': 8, 'dataset_impl': 'mmap', 'train_subset': 'train', 'valid_subset': 'valid', 'validate_interval': 1, 'fixed_validation_seed': None, 'disable_validation': None, 'max_tokens_valid': None, 'max_sentences_valid': 1000, 'curriculum': 0, 'gen_subset': 'test', 'num_shards': 1, 'shard_id': 0, 'joined_dictionary': 0, 'langs': ['javascript']}, 'distributed_training': {'distributed_world_size': 1, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': None, 'distributed_port': -1, 'device_id': 0, 'distributed_no_spawn': 0, 'ddp_backend': 'c10d', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': None, 'find_unused_parameters': 0, 'fast_stat_sync': 0, 'broadcast_buffers': 0, 'global_sync_iter': 50, 'warmup_iterations': 500, 'local_rank': -1, 'block_momentum': 0.875, 'block_lr': 1, 'use_nbm': 0, 'average_sync': 0}, 'task': {'data': '/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/', 'sample_break_mode': 'complete', 'tokens_per_sample': 512, 'mask_prob': 0.15, 'leave_unmasked_prob': 0.1, 'random_token_prob': 0.1, 'freq_weighted_replacement': 0, 'mask_whole_words': 0, 'pooler_activation_fn': 'tanh', 'source_lang': 'code_tokens', 'target_lang': 'docstring_tokens', 'source_aux_lang': 'code_tokens.wo_func', 'target_aux_lang': 'func_name', 'fraction_using_func_name': 0.3, 'load_alignments': 0, 'left_pad_source': 1, 'left_pad_target': 0, 'upsample_primary': 1, 'truncate_source': 0, 'eval_mrr': 1}, 'model': {'arch': 'nbow', 'code_embed_dim': 128, 'code_dropout': 0.1, 'code_pooling': 'weighted_mean', 'query_embed_dim': 128, 'query_dropout': 0.1, 'query_pooling': 'weighted_mean'}, 'optimization': {'max_epoch': 300, 'max_update': 0, 'clip_norm': 1, 'sentence_avg': 0, 'update_freq': [1], 'lrs': [0.01], 'min_lr': -1, 'use_bmuf': 0, 'lr_shrink': 1.0, 'force_anneal': 0, 'warmup_updates': 0, 'end_learning_rate': 0.0, 'power': 1.0, 'total_num_update': 1000000, 'adam': {'adam_betas': '(0.9, 0.999)', 'adam_eps': 1e-08, 'weight_decay': 0, 'use_old_adam': 1}, 'margin': 1}, 'checkpoint': {'save_dir': '/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/javascript/nbow/checkpoints', 'restore_file': 'checkpoint_last.pt', 'reset_dataloader': None, 'reset_lr_scheduler': None, 'reset_meters': None, 'reset_optimizer': None, 'optimizer_overrides': '{}', 'save_interval': 1, 'save_interval_updates': 0, 'keep_interval_updates': 0, 'keep_last_epochs': -1, 'keep_best_checkpoints': -1, 'no_save': 0, 'no_epoch_checkpoints': 1, 'no_last_checkpoints': 0, 'no_save_optimizer_state': None, 'best_checkpoint_metric': 'mrr', 'maximize_best_checkpoint_metric': 1, 'patience': 10}, 'eval': {'path': '/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/javascript/nbow/checkpoints/checkpoint_best.pt', 'quiet': 1, 'max_sentences': 1000, 'model_overrides': '{}', 'eval_size': -1}} (train.py:304, cli_main())
[2021-04-20 04:15:16]    INFO >> single GPU training... (train.py:333, cli_main())
[2021-04-20 04:15:16]    INFO >> loaded 3885 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/valid.javascript.code_tokens'] (hybrid_retrieval.py:54, load_tokens_dataset())
[2021-04-20 04:15:16]    INFO >> loaded 3885 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/valid.javascript.docstring_tokens'] (hybrid_retrieval.py:55, load_tokens_dataset())
[2021-04-20 04:15:16]    INFO >> NBOW(
  (src_encoders): ModuleDict(
    (javascript): NBOWEncoder(
      (embed): Embedding(10000, 128, padding_idx=0)
      (weight_layer): Linear(in_features=128, out_features=1, bias=False)
    )
  )
  (tgt_encoders): NBOWEncoder(
    (embed): Embedding(10000, 128, padding_idx=0)
    (weight_layer): Linear(in_features=128, out_features=1, bias=False)
  )
) (train.py:223, single_main())
[2021-04-20 04:15:16]    INFO >> model nbow, criterion SearchCosineCriterion (train.py:224, single_main())
[2021-04-20 04:15:16]    INFO >> num. model params: 2560256 (num. trained: 2560256) (train.py:227, single_main())
[2021-04-20 04:15:20]    INFO >> training on 1 GPUs (train.py:233, single_main())
[2021-04-20 04:15:20]    INFO >> max tokens per GPU = None and max sentences per GPU = 1000 (train.py:236, single_main())
[2021-04-20 04:15:20]    INFO >> no existing checkpoint found /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/javascript/nbow/checkpoints/checkpoint_last.pt (ncc_trainers.py:270, load_checkpoint())
[2021-04-20 04:15:20]    INFO >> loading train data for epoch 1 (ncc_trainers.py:285, get_train_iterator())
[2021-04-20 04:15:20]    INFO >> loaded 58025 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.javascript.code_tokens'] (hybrid_retrieval.py:54, load_tokens_dataset())
[2021-04-20 04:15:20]    INFO >> loaded 58025 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.javascript.docstring_tokens'] (hybrid_retrieval.py:55, load_tokens_dataset())
[2021-04-20 04:15:20]    INFO >> loaded 58025 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.javascript.code_tokens.wo_func'] (hybrid_retrieval.py:67, load_tokens_dataset())
[2021-04-20 04:15:20]    INFO >> loaded 58025 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.javascript.func_name'] (hybrid_retrieval.py:81, load_tokens_dataset())
[2021-04-20 04:15:20]    INFO >> NOTE: your device may support faster training with fp16 (ncc_trainers.py:155, _setup_optimizer())
/home/yanghe/Documents/naturalcc-dev/ncc/utils/gradient_clip/fairseq_clip.py:57: UserWarning: amp_C fused kernels unavailable, disabling multi_tensor_l2norm; you may get better performance by installing NVIDIA's apex library
  "amp_C fused kernels unavailable, disabling multi_tensor_l2norm; "
[2021-04-20 04:15:27]    INFO >> epoch 001 | loss 1.019 | mrr 0.069844 | sample_size 1000 | wps 14551.7 | ups 14.53 | wpb 1000 | bsz 1000 | num_updates 58 | lr 0.01 | gnorm 0.051 | clip 0 | train_wall 4 | wall 7 (progress_bar.py:269, print())
[2021-04-20 04:15:30]    INFO >> epoch 001 | valid on 'valid' subset | loss 1.004 | mrr 0.145613 | sample_size 1000 | wps 6115.9 | wpb 1000 | bsz 1000 | num_updates 58 (progress_bar.py:269, print())
[2021-04-20 04:15:30]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/javascript/nbow/checkpoints/checkpoint_best.pt (epoch 1 @ 58 updates, score 0.145613) (writing took 0.195037 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:15:37]    INFO >> epoch 002 | loss 1.003 | mrr 0.263712 | sample_size 1000 | wps 5953 | ups 5.95 | wpb 1000 | bsz 1000 | num_updates 116 | lr 0.01 | gnorm 0.004 | clip 0 | train_wall 4 | wall 17 (progress_bar.py:269, print())
[2021-04-20 04:15:40]    INFO >> epoch 002 | valid on 'valid' subset | loss 1.003 | mrr 0.225728 | sample_size 1000 | wps 5406.7 | wpb 1000 | bsz 1000 | num_updates 116 | best_mrr 225.728 (progress_bar.py:269, print())
[2021-04-20 04:15:40]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/javascript/nbow/checkpoints/checkpoint_best.pt (epoch 2 @ 116 updates, score 0.225728) (writing took 0.214289 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:15:46]    INFO >> epoch 003 | loss 1.001 | mrr 0.406193 | sample_size 1000 | wps 6161.1 | ups 6.16 | wpb 1000 | bsz 1000 | num_updates 174 | lr 0.01 | gnorm 0.004 | clip 0 | train_wall 4 | wall 26 (progress_bar.py:269, print())
[2021-04-20 04:15:49]    INFO >> epoch 003 | valid on 'valid' subset | loss 1.003 | mrr 0.27768 | sample_size 1000 | wps 5113.3 | wpb 1000 | bsz 1000 | num_updates 174 | best_mrr 277.68 (progress_bar.py:269, print())
[2021-04-20 04:15:49]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/javascript/nbow/checkpoints/checkpoint_best.pt (epoch 3 @ 174 updates, score 0.27768) (writing took 0.256105 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:15:56]    INFO >> epoch 004 | loss 1 | mrr 0.533782 | sample_size 1000 | wps 6160.6 | ups 6.16 | wpb 1000 | bsz 1000 | num_updates 232 | lr 0.01 | gnorm 0.004 | clip 0 | train_wall 3 | wall 36 (progress_bar.py:269, print())
[2021-04-20 04:15:59]    INFO >> epoch 004 | valid on 'valid' subset | loss 1.004 | mrr 0.304382 | sample_size 1000 | wps 5362.2 | wpb 1000 | bsz 1000 | num_updates 232 | best_mrr 304.382 (progress_bar.py:269, print())
[2021-04-20 04:15:59]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/javascript/nbow/checkpoints/checkpoint_best.pt (epoch 4 @ 232 updates, score 0.304382) (writing took 0.266861 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:16:06]    INFO >> epoch 005 | loss 0.996 | mrr 0.621054 | sample_size 1000 | wps 5975.1 | ups 5.98 | wpb 1000 | bsz 1000 | num_updates 290 | lr 0.01 | gnorm 0.01 | clip 0 | train_wall 4 | wall 46 (progress_bar.py:269, print())
[2021-04-20 04:16:08]    INFO >> epoch 005 | valid on 'valid' subset | loss 1.023 | mrr 0.312582 | sample_size 1000 | wps 5761 | wpb 1000 | bsz 1000 | num_updates 290 | best_mrr 312.582 (progress_bar.py:269, print())
[2021-04-20 04:16:09]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/javascript/nbow/checkpoints/checkpoint_best.pt (epoch 5 @ 290 updates, score 0.312582) (writing took 0.231512 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:16:15]    INFO >> epoch 006 | loss 0.982 | mrr 0.645432 | sample_size 1000 | wps 6389.4 | ups 6.39 | wpb 1000 | bsz 1000 | num_updates 348 | lr 0.01 | gnorm 0.026 | clip 0 | train_wall 3 | wall 55 (progress_bar.py:269, print())
[2021-04-20 04:16:17]    INFO >> epoch 006 | valid on 'valid' subset | loss 1.065 | mrr 0.360815 | sample_size 1000 | wps 5689.7 | wpb 1000 | bsz 1000 | num_updates 348 | best_mrr 360.815 (progress_bar.py:269, print())
[2021-04-20 04:16:18]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/javascript/nbow/checkpoints/checkpoint_best.pt (epoch 6 @ 348 updates, score 0.360815) (writing took 0.208035 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:16:24]    INFO >> epoch 007 | loss 0.919 | mrr 0.785745 | sample_size 1000 | wps 6037.4 | ups 6.04 | wpb 1000 | bsz 1000 | num_updates 406 | lr 0.01 | gnorm 0.029 | clip 0 | train_wall 4 | wall 64 (progress_bar.py:269, print())
[2021-04-20 04:16:27]    INFO >> epoch 007 | valid on 'valid' subset | loss 1.081 | mrr 0.39436 | sample_size 1000 | wps 5376.3 | wpb 1000 | bsz 1000 | num_updates 406 | best_mrr 394.36 (progress_bar.py:269, print())
[2021-04-20 04:16:27]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/javascript/nbow/checkpoints/checkpoint_best.pt (epoch 7 @ 406 updates, score 0.39436) (writing took 0.244250 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:16:34]    INFO >> epoch 008 | loss 0.866 | mrr 0.869397 | sample_size 1000 | wps 6024.5 | ups 6.02 | wpb 1000 | bsz 1000 | num_updates 464 | lr 0.01 | gnorm 0.026 | clip 0 | train_wall 4 | wall 74 (progress_bar.py:269, print())
[2021-04-20 04:16:37]    INFO >> epoch 008 | valid on 'valid' subset | loss 1.078 | mrr 0.412261 | sample_size 1000 | wps 5694.5 | wpb 1000 | bsz 1000 | num_updates 464 | best_mrr 412.261 (progress_bar.py:269, print())
[2021-04-20 04:16:37]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/javascript/nbow/checkpoints/checkpoint_best.pt (epoch 8 @ 464 updates, score 0.412261) (writing took 0.238491 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:16:42]    INFO >> epoch 009:     37 / 59 loss=0.963, mrr=551.988, sample_size=1000, wps=6349.6, ups=6.35, wpb=1000, bsz=1000, num_updates=500, lr=0.01, gnorm=0.02, clip=0, train_wall=31, wall=82 (progress_bar.py:262, log())
[2021-04-20 04:16:44]    INFO >> epoch 009 | loss 0.837 | mrr 0.901962 | sample_size 1000 | wps 5798.8 | ups 5.8 | wpb 1000 | bsz 1000 | num_updates 522 | lr 0.01 | gnorm 0.025 | clip 0 | train_wall 4 | wall 84 (progress_bar.py:269, print())
[2021-04-20 04:16:47]    INFO >> epoch 009 | valid on 'valid' subset | loss 1.076 | mrr 0.415757 | sample_size 1000 | wps 4986.7 | wpb 1000 | bsz 1000 | num_updates 522 | best_mrr 415.757 (progress_bar.py:269, print())
[2021-04-20 04:16:47]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/javascript/nbow/checkpoints/checkpoint_best.pt (epoch 9 @ 522 updates, score 0.415757) (writing took 0.314353 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:16:54]    INFO >> epoch 010 | loss 0.816 | mrr 0.920399 | sample_size 1000 | wps 5962.9 | ups 5.96 | wpb 1000 | bsz 1000 | num_updates 580 | lr 0.01 | gnorm 0.024 | clip 0 | train_wall 4 | wall 94 (progress_bar.py:269, print())
[2021-04-20 04:16:56]    INFO >> epoch 010 | valid on 'valid' subset | loss 1.077 | mrr 0.409073 | sample_size 1000 | wps 5740.6 | wpb 1000 | bsz 1000 | num_updates 580 | best_mrr 409.073 (progress_bar.py:269, print())
[2021-04-20 04:16:57]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/javascript/nbow/checkpoints/checkpoint_last.pt (epoch 10 @ 580 updates, score 0.409073) (writing took 0.127927 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:17:03]    INFO >> epoch 011 | loss 0.802 | mrr 0.930915 | sample_size 1000 | wps 6228.7 | ups 6.23 | wpb 1000 | bsz 1000 | num_updates 638 | lr 0.01 | gnorm 0.023 | clip 0 | train_wall 3 | wall 103 (progress_bar.py:269, print())
[2021-04-20 04:17:07]    INFO >> epoch 011 | valid on 'valid' subset | loss 1.076 | mrr 0.41638 | sample_size 1000 | wps 4868.9 | wpb 1000 | bsz 1000 | num_updates 638 | best_mrr 416.38 (progress_bar.py:269, print())
[2021-04-20 04:17:07]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/javascript/nbow/checkpoints/checkpoint_best.pt (epoch 11 @ 638 updates, score 0.41638) (writing took 0.224893 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:17:14]    INFO >> epoch 012 | loss 0.791 | mrr 0.938457 | sample_size 1000 | wps 5469.5 | ups 5.47 | wpb 1000 | bsz 1000 | num_updates 696 | lr 0.01 | gnorm 0.023 | clip 0 | train_wall 4 | wall 114 (progress_bar.py:269, print())
[2021-04-20 04:17:16]    INFO >> epoch 012 | valid on 'valid' subset | loss 1.076 | mrr 0.416131 | sample_size 1000 | wps 5707.1 | wpb 1000 | bsz 1000 | num_updates 696 | best_mrr 416.131 (progress_bar.py:269, print())
[2021-04-20 04:17:17]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/javascript/nbow/checkpoints/checkpoint_last.pt (epoch 12 @ 696 updates, score 0.416131) (writing took 0.151378 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:17:22]    INFO >> epoch 013 | loss 0.783 | mrr 0.942136 | sample_size 1000 | wps 6545 | ups 6.54 | wpb 1000 | bsz 1000 | num_updates 754 | lr 0.01 | gnorm 0.022 | clip 0 | train_wall 3 | wall 122 (progress_bar.py:269, print())
[2021-04-20 04:17:25]    INFO >> epoch 013 | valid on 'valid' subset | loss 1.075 | mrr 0.412516 | sample_size 1000 | wps 5538.4 | wpb 1000 | bsz 1000 | num_updates 754 | best_mrr 412.516 (progress_bar.py:269, print())
[2021-04-20 04:17:25]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/javascript/nbow/checkpoints/checkpoint_last.pt (epoch 13 @ 754 updates, score 0.412516) (writing took 0.129930 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:17:32]    INFO >> epoch 014 | loss 0.776 | mrr 0.945995 | sample_size 1000 | wps 5934 | ups 5.93 | wpb 1000 | bsz 1000 | num_updates 812 | lr 0.01 | gnorm 0.022 | clip 0 | train_wall 4 | wall 132 (progress_bar.py:269, print())
[2021-04-20 04:17:35]    INFO >> epoch 014 | valid on 'valid' subset | loss 1.076 | mrr 0.411129 | sample_size 1000 | wps 5063.4 | wpb 1000 | bsz 1000 | num_updates 812 | best_mrr 411.129 (progress_bar.py:269, print())
[2021-04-20 04:17:35]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/javascript/nbow/checkpoints/checkpoint_last.pt (epoch 14 @ 812 updates, score 0.411129) (writing took 0.157012 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:17:42]    INFO >> epoch 015 | loss 0.77 | mrr 0.949018 | sample_size 1000 | wps 6147.5 | ups 6.15 | wpb 1000 | bsz 1000 | num_updates 870 | lr 0.01 | gnorm 0.022 | clip 0 | train_wall 4 | wall 142 (progress_bar.py:269, print())
[2021-04-20 04:17:44]    INFO >> epoch 015 | valid on 'valid' subset | loss 1.076 | mrr 0.411737 | sample_size 1000 | wps 4915.5 | wpb 1000 | bsz 1000 | num_updates 870 | best_mrr 411.737 (progress_bar.py:269, print())
[2021-04-20 04:17:45]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/javascript/nbow/checkpoints/checkpoint_last.pt (epoch 15 @ 870 updates, score 0.411737) (writing took 0.131701 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:17:52]    INFO >> epoch 016 | loss 0.765 | mrr 0.951582 | sample_size 1000 | wps 5876.1 | ups 5.88 | wpb 1000 | bsz 1000 | num_updates 928 | lr 0.01 | gnorm 0.022 | clip 0 | train_wall 4 | wall 151 (progress_bar.py:269, print())
[2021-04-20 04:17:55]    INFO >> epoch 016 | valid on 'valid' subset | loss 1.077 | mrr 0.410496 | sample_size 1000 | wps 5105.5 | wpb 1000 | bsz 1000 | num_updates 928 | best_mrr 410.496 (progress_bar.py:269, print())
[2021-04-20 04:17:55]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/javascript/nbow/checkpoints/checkpoint_last.pt (epoch 16 @ 928 updates, score 0.410496) (writing took 0.162547 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:18:01]    INFO >> epoch 017 | loss 0.76 | mrr 0.954576 | sample_size 1000 | wps 6043.3 | ups 6.04 | wpb 1000 | bsz 1000 | num_updates 986 | lr 0.01 | gnorm 0.021 | clip 0 | train_wall 3 | wall 161 (progress_bar.py:269, print())
[2021-04-20 04:18:04]    INFO >> epoch 017 | valid on 'valid' subset | loss 1.077 | mrr 0.410727 | sample_size 1000 | wps 5364.3 | wpb 1000 | bsz 1000 | num_updates 986 | best_mrr 410.727 (progress_bar.py:269, print())
[2021-04-20 04:18:04]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/javascript/nbow/checkpoints/checkpoint_last.pt (epoch 17 @ 986 updates, score 0.410727) (writing took 0.130861 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:18:08]    INFO >> epoch 018:     14 / 59 loss=0.785, mrr=940.009, sample_size=1000, wps=5828.8, ups=5.83, wpb=1000, bsz=1000, num_updates=1000, lr=0.01, gnorm=0.022, clip=0, train_wall=31, wall=168 (progress_bar.py:262, log())
[2021-04-20 04:18:11]    INFO >> epoch 018 | loss 0.757 | mrr 0.956118 | sample_size 1000 | wps 6011.1 | ups 6.01 | wpb 1000 | bsz 1000 | num_updates 1044 | lr 0.01 | gnorm 0.021 | clip 0 | train_wall 3 | wall 171 (progress_bar.py:269, print())
[2021-04-20 04:18:14]    INFO >> epoch 018 | valid on 'valid' subset | loss 1.078 | mrr 0.408551 | sample_size 1000 | wps 5386.7 | wpb 1000 | bsz 1000 | num_updates 1044 | best_mrr 408.551 (progress_bar.py:269, print())
[2021-04-20 04:18:14]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/javascript/nbow/checkpoints/checkpoint_last.pt (epoch 18 @ 1044 updates, score 0.408551) (writing took 0.123558 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:18:20]    INFO >> epoch 019 | loss 0.753 | mrr 0.956771 | sample_size 1000 | wps 6159.6 | ups 6.16 | wpb 1000 | bsz 1000 | num_updates 1102 | lr 0.01 | gnorm 0.021 | clip 0 | train_wall 4 | wall 180 (progress_bar.py:269, print())
[2021-04-20 04:18:23]    INFO >> epoch 019 | valid on 'valid' subset | loss 1.078 | mrr 0.408422 | sample_size 1000 | wps 5565.5 | wpb 1000 | bsz 1000 | num_updates 1102 | best_mrr 408.422 (progress_bar.py:269, print())
[2021-04-20 04:18:23]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/javascript/nbow/checkpoints/checkpoint_last.pt (epoch 19 @ 1102 updates, score 0.408422) (writing took 0.155811 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:18:30]    INFO >> epoch 020 | loss 0.75 | mrr 0.958727 | sample_size 1000 | wps 6275.8 | ups 6.28 | wpb 1000 | bsz 1000 | num_updates 1160 | lr 0.01 | gnorm 0.021 | clip 0 | train_wall 3 | wall 189 (progress_bar.py:269, print())
[2021-04-20 04:18:32]    INFO >> epoch 020 | valid on 'valid' subset | loss 1.078 | mrr 0.407789 | sample_size 1000 | wps 5153.9 | wpb 1000 | bsz 1000 | num_updates 1160 | best_mrr 407.789 (progress_bar.py:269, print())
[2021-04-20 04:18:32]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/javascript/nbow/checkpoints/checkpoint_last.pt (epoch 20 @ 1160 updates, score 0.407789) (writing took 0.139440 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:18:39]    INFO >> epoch 021 | loss 0.748 | mrr 0.958834 | sample_size 1000 | wps 5929.5 | ups 5.93 | wpb 1000 | bsz 1000 | num_updates 1218 | lr 0.01 | gnorm 0.021 | clip 0 | train_wall 4 | wall 199 (progress_bar.py:269, print())
[2021-04-20 04:18:42]    INFO >> epoch 021 | valid on 'valid' subset | loss 1.077 | mrr 0.406425 | sample_size 1000 | wps 5988.6 | wpb 1000 | bsz 1000 | num_updates 1218 | best_mrr 406.425 (progress_bar.py:269, print())
[2021-04-20 04:18:42]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/javascript/nbow/checkpoints/checkpoint_last.pt (epoch 21 @ 1218 updates, score 0.406425) (writing took 0.183199 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:18:42]    INFO >> early stop since valid performance hasn't improved for last 10 runs (train.py:191, should_stop_early())
[2021-04-20 04:18:42]    INFO >> early stop since valid performance hasn't improved for last 10 runs (train.py:272, single_main())
[2021-04-20 04:18:42]    INFO >> done training in 202.0 seconds (train.py:283, single_main())
