nohup: 忽略输入
[2021-04-20 04:07:25]    INFO >> Load arguments in /home/yanghe/Documents/naturalcc-dev/run/retrieval/nbow/config/csn_feng/ruby.yml (train.py:302, cli_main())
[2021-04-20 04:07:25]    INFO >> {'criterion': 'retrieval_cosine', 'optimizer': 'torch_adam', 'lr_scheduler': 'fixed', 'tokenizer': None, 'bpe': None, 'common': {'no_progress_bar': 0, 'log_interval': 500, 'log_format': 'simple', 'tensorboard_logdir': '', 'seed': 666, 'cpu': 0, 'fp16': 0, 'memory_efficient_fp16': 0, 'fp16_no_flatten_grads': 0, 'fp16_init_scale': 128, 'fp16_scale_window': None, 'fp16_scale_tolerance': 0.0, 'min_loss_scale': 0.0001, 'threshold_loss_scale': None, 'user_dir': None, 'empty_cache_freq': 0, 'all_gather_list_size': 16384, 'task': 'hybrid_retrieval'}, 'dataset': {'num_workers': 1, 'skip_invalid_size_inputs_valid_test': 0, 'max_tokens': None, 'max_sentences': 1000, 'code_max_tokens': 200, 'query_max_tokens': 30, 'required_batch_size_multiple': 8, 'dataset_impl': 'mmap', 'train_subset': 'train', 'valid_subset': 'valid', 'validate_interval': 1, 'fixed_validation_seed': None, 'disable_validation': None, 'max_tokens_valid': None, 'max_sentences_valid': 1000, 'curriculum': 0, 'gen_subset': 'test', 'num_shards': 1, 'shard_id': 0, 'joined_dictionary': 0, 'langs': ['ruby']}, 'distributed_training': {'distributed_world_size': 1, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': None, 'distributed_port': -1, 'device_id': 0, 'distributed_no_spawn': 0, 'ddp_backend': 'c10d', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': None, 'find_unused_parameters': 0, 'fast_stat_sync': 0, 'broadcast_buffers': 0, 'global_sync_iter': 50, 'warmup_iterations': 500, 'local_rank': -1, 'block_momentum': 0.875, 'block_lr': 1, 'use_nbm': 0, 'average_sync': 0}, 'task': {'data': '/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/', 'sample_break_mode': 'complete', 'tokens_per_sample': 512, 'mask_prob': 0.15, 'leave_unmasked_prob': 0.1, 'random_token_prob': 0.1, 'freq_weighted_replacement': 0, 'mask_whole_words': 0, 'pooler_activation_fn': 'tanh', 'source_lang': 'code_tokens', 'target_lang': 'docstring_tokens', 'source_aux_lang': 'code_tokens.wo_func', 'target_aux_lang': 'func_name', 'fraction_using_func_name': 0.3, 'load_alignments': 0, 'left_pad_source': 1, 'left_pad_target': 0, 'upsample_primary': 1, 'truncate_source': 0, 'eval_mrr': 1}, 'model': {'arch': 'nbow', 'code_embed_dim': 128, 'code_dropout': 0.1, 'code_pooling': 'weighted_mean', 'query_embed_dim': 128, 'query_dropout': 0.1, 'query_pooling': 'weighted_mean'}, 'optimization': {'max_epoch': 300, 'max_update': 0, 'clip_norm': 1, 'sentence_avg': 0, 'update_freq': [1], 'lrs': [0.01], 'min_lr': -1, 'use_bmuf': 0, 'lr_shrink': 1.0, 'force_anneal': 0, 'warmup_updates': 0, 'end_learning_rate': 0.0, 'power': 1.0, 'total_num_update': 1000000, 'adam': {'adam_betas': '(0.9, 0.999)', 'adam_eps': 1e-08, 'weight_decay': 0, 'use_old_adam': 1}, 'margin': 1}, 'checkpoint': {'save_dir': '/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/nbow/checkpoints', 'restore_file': 'checkpoint_last.pt', 'reset_dataloader': None, 'reset_lr_scheduler': None, 'reset_meters': None, 'reset_optimizer': None, 'optimizer_overrides': '{}', 'save_interval': 1, 'save_interval_updates': 0, 'keep_interval_updates': 0, 'keep_last_epochs': -1, 'keep_best_checkpoints': -1, 'no_save': 0, 'no_epoch_checkpoints': 1, 'no_last_checkpoints': 0, 'no_save_optimizer_state': None, 'best_checkpoint_metric': 'mrr', 'maximize_best_checkpoint_metric': 1, 'patience': 10}, 'eval': {'path': '/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/nbow/checkpoints/checkpoint_best.pt', 'quiet': 1, 'max_sentences': 1000, 'model_overrides': '{}', 'eval_size': -1}} (train.py:304, cli_main())
[2021-04-20 04:07:25]    INFO >> single GPU training... (train.py:333, cli_main())
[2021-04-20 04:07:25]    INFO >> loaded 1400 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/valid.ruby.code_tokens'] (hybrid_retrieval.py:54, load_tokens_dataset())
[2021-04-20 04:07:25]    INFO >> loaded 1400 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/valid.ruby.docstring_tokens'] (hybrid_retrieval.py:55, load_tokens_dataset())
[2021-04-20 04:07:25]    INFO >> NBOW(
  (src_encoders): ModuleDict(
    (ruby): NBOWEncoder(
      (embed): Embedding(10000, 128, padding_idx=0)
      (weight_layer): Linear(in_features=128, out_features=1, bias=False)
    )
  )
  (tgt_encoders): NBOWEncoder(
    (embed): Embedding(10000, 128, padding_idx=0)
    (weight_layer): Linear(in_features=128, out_features=1, bias=False)
  )
) (train.py:223, single_main())
[2021-04-20 04:07:25]    INFO >> model nbow, criterion SearchCosineCriterion (train.py:224, single_main())
[2021-04-20 04:07:25]    INFO >> num. model params: 2560256 (num. trained: 2560256) (train.py:227, single_main())
[2021-04-20 04:07:28]    INFO >> training on 1 GPUs (train.py:233, single_main())
[2021-04-20 04:07:28]    INFO >> max tokens per GPU = None and max sentences per GPU = 1000 (train.py:236, single_main())
[2021-04-20 04:07:28]    INFO >> no existing checkpoint found /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/nbow/checkpoints/checkpoint_last.pt (ncc_trainers.py:270, load_checkpoint())
[2021-04-20 04:07:28]    INFO >> loading train data for epoch 1 (ncc_trainers.py:285, get_train_iterator())
[2021-04-20 04:07:28]    INFO >> loaded 24927 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.ruby.code_tokens'] (hybrid_retrieval.py:54, load_tokens_dataset())
[2021-04-20 04:07:28]    INFO >> loaded 24927 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.ruby.docstring_tokens'] (hybrid_retrieval.py:55, load_tokens_dataset())
[2021-04-20 04:07:28]    INFO >> loaded 24927 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.ruby.code_tokens.wo_func'] (hybrid_retrieval.py:67, load_tokens_dataset())
[2021-04-20 04:07:28]    INFO >> loaded 24927 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.ruby.func_name'] (hybrid_retrieval.py:81, load_tokens_dataset())
[2021-04-20 04:07:28]    INFO >> NOTE: your device may support faster training with fp16 (ncc_trainers.py:155, _setup_optimizer())
/home/yanghe/Documents/naturalcc-dev/ncc/utils/gradient_clip/fairseq_clip.py:57: UserWarning: amp_C fused kernels unavailable, disabling multi_tensor_l2norm; you may get better performance by installing NVIDIA's apex library
  "amp_C fused kernels unavailable, disabling multi_tensor_l2norm; "
[2021-04-20 04:07:32]    INFO >> epoch 001 | loss 1.03 | mrr 0.053127 | sample_size 1000 | wps 15759.9 | ups 15.71 | wpb 1000 | bsz 1000 | num_updates 24 | lr 0.01 | gnorm 0.097 | clip 0 | train_wall 1 | wall 4 (progress_bar.py:269, print())
[2021-04-20 04:07:35]    INFO >> epoch 001 | valid on 'valid' subset | loss 1.007 | mrr 0.068743 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 24 (progress_bar.py:269, print())
[2021-04-20 04:07:35]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/nbow/checkpoints/checkpoint_best.pt (epoch 1 @ 24 updates, score 0.068743) (writing took 0.242677 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:07:39]    INFO >> epoch 002 | loss 1.004 | mrr 0.241241 | sample_size 1000 | wps 3314.2 | ups 3.31 | wpb 1000 | bsz 1000 | num_updates 48 | lr 0.01 | gnorm 0.007 | clip 0 | train_wall 1 | wall 11 (progress_bar.py:269, print())
[2021-04-20 04:07:41]    INFO >> epoch 002 | valid on 'valid' subset | loss 1.005 | mrr 0.124346 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 48 | best_mrr 124.346 (progress_bar.py:269, print())
[2021-04-20 04:07:42]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/nbow/checkpoints/checkpoint_best.pt (epoch 2 @ 48 updates, score 0.124346) (writing took 0.208478 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:07:45]    INFO >> epoch 003 | loss 1.002 | mrr 0.38916 | sample_size 1000 | wps 3849.2 | ups 3.85 | wpb 1000 | bsz 1000 | num_updates 72 | lr 0.01 | gnorm 0.005 | clip 0 | train_wall 1 | wall 18 (progress_bar.py:269, print())
[2021-04-20 04:07:48]    INFO >> epoch 003 | valid on 'valid' subset | loss 1.004 | mrr 0.169438 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 72 | best_mrr 169.438 (progress_bar.py:269, print())
[2021-04-20 04:07:48]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/nbow/checkpoints/checkpoint_best.pt (epoch 3 @ 72 updates, score 0.169438) (writing took 0.209693 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:07:51]    INFO >> epoch 004 | loss 1 | mrr 0.514823 | sample_size 1000 | wps 3842 | ups 3.84 | wpb 1000 | bsz 1000 | num_updates 96 | lr 0.01 | gnorm 0.004 | clip 0 | train_wall 1 | wall 24 (progress_bar.py:269, print())
[2021-04-20 04:07:54]    INFO >> epoch 004 | valid on 'valid' subset | loss 1.005 | mrr 0.206598 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 96 | best_mrr 206.598 (progress_bar.py:269, print())
[2021-04-20 04:07:54]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/nbow/checkpoints/checkpoint_best.pt (epoch 4 @ 96 updates, score 0.206598) (writing took 0.256486 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:07:58]    INFO >> epoch 005 | loss 0.998 | mrr 0.629213 | sample_size 1000 | wps 3814.9 | ups 3.81 | wpb 1000 | bsz 1000 | num_updates 120 | lr 0.01 | gnorm 0.005 | clip 0 | train_wall 1 | wall 30 (progress_bar.py:269, print())
[2021-04-20 04:08:00]    INFO >> epoch 005 | valid on 'valid' subset | loss 1.008 | mrr 0.226632 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 120 | best_mrr 226.632 (progress_bar.py:269, print())
[2021-04-20 04:08:00]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/nbow/checkpoints/checkpoint_best.pt (epoch 5 @ 120 updates, score 0.226632) (writing took 0.215745 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:08:04]    INFO >> epoch 006 | loss 0.992 | mrr 0.70722 | sample_size 1000 | wps 3882.4 | ups 3.88 | wpb 1000 | bsz 1000 | num_updates 144 | lr 0.01 | gnorm 0.009 | clip 0 | train_wall 1 | wall 36 (progress_bar.py:269, print())
[2021-04-20 04:08:06]    INFO >> epoch 006 | valid on 'valid' subset | loss 1.017 | mrr 0.259132 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 144 | best_mrr 259.132 (progress_bar.py:269, print())
[2021-04-20 04:08:07]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/nbow/checkpoints/checkpoint_best.pt (epoch 6 @ 144 updates, score 0.259132) (writing took 0.221118 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:08:10]    INFO >> epoch 007 | loss 0.963 | mrr 0.766614 | sample_size 1000 | wps 3876.9 | ups 3.88 | wpb 1000 | bsz 1000 | num_updates 168 | lr 0.01 | gnorm 0.026 | clip 0 | train_wall 1 | wall 43 (progress_bar.py:269, print())
[2021-04-20 04:08:13]    INFO >> epoch 007 | valid on 'valid' subset | loss 1.098 | mrr 0.290501 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 168 | best_mrr 290.501 (progress_bar.py:269, print())
[2021-04-20 04:08:13]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/nbow/checkpoints/checkpoint_best.pt (epoch 7 @ 168 updates, score 0.290501) (writing took 0.268201 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:08:17]    INFO >> epoch 008 | loss 0.905 | mrr 0.799705 | sample_size 1000 | wps 3749.2 | ups 3.75 | wpb 1000 | bsz 1000 | num_updates 192 | lr 0.01 | gnorm 0.042 | clip 0 | train_wall 1 | wall 49 (progress_bar.py:269, print())
[2021-04-20 04:08:19]    INFO >> epoch 008 | valid on 'valid' subset | loss 1.11 | mrr 0.316453 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 192 | best_mrr 316.453 (progress_bar.py:269, print())
[2021-04-20 04:08:19]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/nbow/checkpoints/checkpoint_best.pt (epoch 8 @ 192 updates, score 0.316453) (writing took 0.243235 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:08:23]    INFO >> epoch 009 | loss 0.854 | mrr 0.872285 | sample_size 1000 | wps 3886.5 | ups 3.89 | wpb 1000 | bsz 1000 | num_updates 216 | lr 0.01 | gnorm 0.034 | clip 0 | train_wall 1 | wall 55 (progress_bar.py:269, print())
[2021-04-20 04:08:25]    INFO >> epoch 009 | valid on 'valid' subset | loss 1.101 | mrr 0.344657 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 216 | best_mrr 344.657 (progress_bar.py:269, print())
[2021-04-20 04:08:25]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/nbow/checkpoints/checkpoint_best.pt (epoch 9 @ 216 updates, score 0.344657) (writing took 0.251378 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:08:29]    INFO >> epoch 010 | loss 0.808 | mrr 0.917239 | sample_size 1000 | wps 3897.5 | ups 3.9 | wpb 1000 | bsz 1000 | num_updates 240 | lr 0.01 | gnorm 0.031 | clip 0 | train_wall 1 | wall 61 (progress_bar.py:269, print())
[2021-04-20 04:08:31]    INFO >> epoch 010 | valid on 'valid' subset | loss 1.097 | mrr 0.35057 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 240 | best_mrr 350.57 (progress_bar.py:269, print())
[2021-04-20 04:08:31]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/nbow/checkpoints/checkpoint_best.pt (epoch 10 @ 240 updates, score 0.35057) (writing took 0.201256 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:08:35]    INFO >> epoch 011 | loss 0.779 | mrr 0.939293 | sample_size 1000 | wps 3891.8 | ups 3.89 | wpb 1000 | bsz 1000 | num_updates 264 | lr 0.01 | gnorm 0.029 | clip 0 | train_wall 1 | wall 67 (progress_bar.py:269, print())
[2021-04-20 04:08:38]    INFO >> epoch 011 | valid on 'valid' subset | loss 1.096 | mrr 0.362142 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 264 | best_mrr 362.142 (progress_bar.py:269, print())
[2021-04-20 04:08:39]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/nbow/checkpoints/checkpoint_best.pt (epoch 11 @ 264 updates, score 0.362142) (writing took 0.245162 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:08:42]    INFO >> epoch 012 | loss 0.756 | mrr 0.951856 | sample_size 1000 | wps 3270.9 | ups 3.27 | wpb 1000 | bsz 1000 | num_updates 288 | lr 0.01 | gnorm 0.028 | clip 0 | train_wall 1 | wall 75 (progress_bar.py:269, print())
[2021-04-20 04:08:45]    INFO >> epoch 012 | valid on 'valid' subset | loss 1.097 | mrr 0.367871 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 288 | best_mrr 367.871 (progress_bar.py:269, print())
[2021-04-20 04:08:45]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/nbow/checkpoints/checkpoint_best.pt (epoch 12 @ 288 updates, score 0.367871) (writing took 0.314995 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:08:49]    INFO >> epoch 013 | loss 0.74 | mrr 0.958354 | sample_size 1000 | wps 3752.5 | ups 3.75 | wpb 1000 | bsz 1000 | num_updates 312 | lr 0.01 | gnorm 0.028 | clip 0 | train_wall 1 | wall 81 (progress_bar.py:269, print())
[2021-04-20 04:08:51]    INFO >> epoch 013 | valid on 'valid' subset | loss 1.096 | mrr 0.366049 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 312 | best_mrr 366.049 (progress_bar.py:269, print())
[2021-04-20 04:08:51]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/nbow/checkpoints/checkpoint_last.pt (epoch 13 @ 312 updates, score 0.366049) (writing took 0.110036 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:08:55]    INFO >> epoch 014 | loss 0.727 | mrr 0.963723 | sample_size 1000 | wps 3889 | ups 3.89 | wpb 1000 | bsz 1000 | num_updates 336 | lr 0.01 | gnorm 0.027 | clip 0 | train_wall 1 | wall 87 (progress_bar.py:269, print())
[2021-04-20 04:08:57]    INFO >> epoch 014 | valid on 'valid' subset | loss 1.098 | mrr 0.355821 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 336 | best_mrr 355.821 (progress_bar.py:269, print())
[2021-04-20 04:08:57]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/nbow/checkpoints/checkpoint_last.pt (epoch 14 @ 336 updates, score 0.355821) (writing took 0.132371 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:09:01]    INFO >> epoch 015 | loss 0.719 | mrr 0.966194 | sample_size 1000 | wps 3892 | ups 3.89 | wpb 1000 | bsz 1000 | num_updates 360 | lr 0.01 | gnorm 0.027 | clip 0 | train_wall 1 | wall 94 (progress_bar.py:269, print())
[2021-04-20 04:09:04]    INFO >> epoch 015 | valid on 'valid' subset | loss 1.096 | mrr 0.358341 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 360 | best_mrr 358.341 (progress_bar.py:269, print())
[2021-04-20 04:09:04]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/nbow/checkpoints/checkpoint_last.pt (epoch 15 @ 360 updates, score 0.358341) (writing took 0.120475 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:09:07]    INFO >> epoch 016 | loss 0.711 | mrr 0.9701 | sample_size 1000 | wps 3865.1 | ups 3.87 | wpb 1000 | bsz 1000 | num_updates 384 | lr 0.01 | gnorm 0.026 | clip 0 | train_wall 1 | wall 100 (progress_bar.py:269, print())
[2021-04-20 04:09:10]    INFO >> epoch 016 | valid on 'valid' subset | loss 1.096 | mrr 0.361487 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 384 | best_mrr 361.487 (progress_bar.py:269, print())
[2021-04-20 04:09:10]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/nbow/checkpoints/checkpoint_last.pt (epoch 16 @ 384 updates, score 0.361487) (writing took 0.127369 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:09:14]    INFO >> epoch 017 | loss 0.704 | mrr 0.971541 | sample_size 1000 | wps 3882.8 | ups 3.88 | wpb 1000 | bsz 1000 | num_updates 408 | lr 0.01 | gnorm 0.026 | clip 0 | train_wall 1 | wall 106 (progress_bar.py:269, print())
[2021-04-20 04:09:16]    INFO >> epoch 017 | valid on 'valid' subset | loss 1.093 | mrr 0.368575 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 408 | best_mrr 368.575 (progress_bar.py:269, print())
[2021-04-20 04:09:16]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/nbow/checkpoints/checkpoint_best.pt (epoch 17 @ 408 updates, score 0.368575) (writing took 0.314296 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:09:20]    INFO >> epoch 018 | loss 0.696 | mrr 0.97516 | sample_size 1000 | wps 3849.4 | ups 3.85 | wpb 1000 | bsz 1000 | num_updates 432 | lr 0.01 | gnorm 0.025 | clip 0 | train_wall 1 | wall 112 (progress_bar.py:269, print())
[2021-04-20 04:09:22]    INFO >> epoch 018 | valid on 'valid' subset | loss 1.096 | mrr 0.362272 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 432 | best_mrr 362.272 (progress_bar.py:269, print())
[2021-04-20 04:09:22]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/nbow/checkpoints/checkpoint_last.pt (epoch 18 @ 432 updates, score 0.362272) (writing took 0.119992 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:09:26]    INFO >> epoch 019 | loss 0.69 | mrr 0.976331 | sample_size 1000 | wps 3828.6 | ups 3.83 | wpb 1000 | bsz 1000 | num_updates 456 | lr 0.01 | gnorm 0.025 | clip 0 | train_wall 1 | wall 118 (progress_bar.py:269, print())
[2021-04-20 04:09:28]    INFO >> epoch 019 | valid on 'valid' subset | loss 1.097 | mrr 0.36449 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 456 | best_mrr 364.49 (progress_bar.py:269, print())
[2021-04-20 04:09:29]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/nbow/checkpoints/checkpoint_last.pt (epoch 19 @ 456 updates, score 0.36449) (writing took 0.120295 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:09:32]    INFO >> epoch 020 | loss 0.684 | mrr 0.977467 | sample_size 1000 | wps 3908.8 | ups 3.91 | wpb 1000 | bsz 1000 | num_updates 480 | lr 0.01 | gnorm 0.025 | clip 0 | train_wall 1 | wall 125 (progress_bar.py:269, print())
[2021-04-20 04:09:35]    INFO >> epoch 020 | valid on 'valid' subset | loss 1.097 | mrr 0.364644 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 480 | best_mrr 364.644 (progress_bar.py:269, print())
[2021-04-20 04:09:35]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/nbow/checkpoints/checkpoint_last.pt (epoch 20 @ 480 updates, score 0.364644) (writing took 0.111788 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:09:38]    INFO >> epoch 021:     21 / 25 loss=0.832, mrr=785.1, sample_size=1000, wps=3907.3, ups=3.91, wpb=1000, bsz=1000, num_updates=500, lr=0.01, gnorm=0.026, clip=0, train_wall=18, wall=130 (progress_bar.py:262, log())
[2021-04-20 04:09:38]    INFO >> epoch 021 | loss 0.682 | mrr 0.97841 | sample_size 1000 | wps 3846.1 | ups 3.85 | wpb 1000 | bsz 1000 | num_updates 504 | lr 0.01 | gnorm 0.024 | clip 0 | train_wall 1 | wall 131 (progress_bar.py:269, print())
[2021-04-20 04:09:42]    INFO >> epoch 021 | valid on 'valid' subset | loss 1.098 | mrr 0.358582 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 504 | best_mrr 358.582 (progress_bar.py:269, print())
[2021-04-20 04:09:42]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/nbow/checkpoints/checkpoint_last.pt (epoch 21 @ 504 updates, score 0.358582) (writing took 0.150342 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:09:46]    INFO >> epoch 022 | loss 0.677 | mrr 0.978934 | sample_size 1000 | wps 3392.7 | ups 3.39 | wpb 1000 | bsz 1000 | num_updates 528 | lr 0.01 | gnorm 0.024 | clip 0 | train_wall 1 | wall 138 (progress_bar.py:269, print())
[2021-04-20 04:09:48]    INFO >> epoch 022 | valid on 'valid' subset | loss 1.096 | mrr 0.356524 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 528 | best_mrr 356.524 (progress_bar.py:269, print())
[2021-04-20 04:09:48]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/nbow/checkpoints/checkpoint_last.pt (epoch 22 @ 528 updates, score 0.356524) (writing took 0.119708 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:09:52]    INFO >> epoch 023 | loss 0.674 | mrr 0.980262 | sample_size 1000 | wps 3949.7 | ups 3.95 | wpb 1000 | bsz 1000 | num_updates 552 | lr 0.01 | gnorm 0.024 | clip 0 | train_wall 1 | wall 144 (progress_bar.py:269, print())
[2021-04-20 04:09:54]    INFO >> epoch 023 | valid on 'valid' subset | loss 1.096 | mrr 0.36188 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 552 | best_mrr 361.88 (progress_bar.py:269, print())
[2021-04-20 04:09:54]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/nbow/checkpoints/checkpoint_last.pt (epoch 23 @ 552 updates, score 0.36188) (writing took 0.128020 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:09:58]    INFO >> epoch 024 | loss 0.67 | mrr 0.980862 | sample_size 1000 | wps 3921 | ups 3.92 | wpb 1000 | bsz 1000 | num_updates 576 | lr 0.01 | gnorm 0.024 | clip 0 | train_wall 1 | wall 150 (progress_bar.py:269, print())
[2021-04-20 04:10:00]    INFO >> epoch 024 | valid on 'valid' subset | loss 1.096 | mrr 0.356735 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 576 | best_mrr 356.735 (progress_bar.py:269, print())
[2021-04-20 04:10:00]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/nbow/checkpoints/checkpoint_last.pt (epoch 24 @ 576 updates, score 0.356735) (writing took 0.122679 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:10:04]    INFO >> epoch 025 | loss 0.667 | mrr 0.981183 | sample_size 1000 | wps 3897.7 | ups 3.9 | wpb 1000 | bsz 1000 | num_updates 600 | lr 0.01 | gnorm 0.024 | clip 0 | train_wall 1 | wall 156 (progress_bar.py:269, print())
[2021-04-20 04:10:06]    INFO >> epoch 025 | valid on 'valid' subset | loss 1.094 | mrr 0.362698 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 600 | best_mrr 362.698 (progress_bar.py:269, print())
[2021-04-20 04:10:06]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/nbow/checkpoints/checkpoint_last.pt (epoch 25 @ 600 updates, score 0.362698) (writing took 0.110736 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:10:10]    INFO >> epoch 026 | loss 0.664 | mrr 0.982007 | sample_size 1000 | wps 3943.2 | ups 3.94 | wpb 1000 | bsz 1000 | num_updates 624 | lr 0.01 | gnorm 0.023 | clip 0 | train_wall 1 | wall 162 (progress_bar.py:269, print())
[2021-04-20 04:10:12]    INFO >> epoch 026 | valid on 'valid' subset | loss 1.094 | mrr 0.358783 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 624 | best_mrr 358.783 (progress_bar.py:269, print())
[2021-04-20 04:10:12]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/nbow/checkpoints/checkpoint_last.pt (epoch 26 @ 624 updates, score 0.358783) (writing took 0.115422 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:10:16]    INFO >> epoch 027 | loss 0.662 | mrr 0.983576 | sample_size 1000 | wps 3910.4 | ups 3.91 | wpb 1000 | bsz 1000 | num_updates 648 | lr 0.01 | gnorm 0.023 | clip 0 | train_wall 1 | wall 169 (progress_bar.py:269, print())
[2021-04-20 04:10:18]    INFO >> epoch 027 | valid on 'valid' subset | loss 1.094 | mrr 0.366708 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 648 | best_mrr 366.708 (progress_bar.py:269, print())
[2021-04-20 04:10:19]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/nbow/checkpoints/checkpoint_last.pt (epoch 27 @ 648 updates, score 0.366708) (writing took 0.121085 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:10:19]    INFO >> early stop since valid performance hasn't improved for last 10 runs (train.py:191, should_stop_early())
[2021-04-20 04:10:19]    INFO >> early stop since valid performance hasn't improved for last 10 runs (train.py:272, single_main())
[2021-04-20 04:10:19]    INFO >> done training in 171.0 seconds (train.py:283, single_main())
