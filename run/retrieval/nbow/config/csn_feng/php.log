nohup: 忽略输入
[2021-04-20 04:15:07]    INFO >> Load arguments in /home/yanghe/Documents/naturalcc-dev/run/retrieval/nbow/config/csn_feng/php.yml (train.py:302, cli_main())
[2021-04-20 04:15:07]    INFO >> {'criterion': 'retrieval_cosine', 'optimizer': 'torch_adam', 'lr_scheduler': 'fixed', 'tokenizer': None, 'bpe': None, 'common': {'no_progress_bar': 0, 'log_interval': 500, 'log_format': 'simple', 'tensorboard_logdir': '', 'seed': 666, 'cpu': 0, 'fp16': 0, 'memory_efficient_fp16': 0, 'fp16_no_flatten_grads': 0, 'fp16_init_scale': 128, 'fp16_scale_window': None, 'fp16_scale_tolerance': 0.0, 'min_loss_scale': 0.0001, 'threshold_loss_scale': None, 'user_dir': None, 'empty_cache_freq': 0, 'all_gather_list_size': 16384, 'task': 'hybrid_retrieval'}, 'dataset': {'num_workers': 1, 'skip_invalid_size_inputs_valid_test': 0, 'max_tokens': None, 'max_sentences': 1000, 'code_max_tokens': 200, 'query_max_tokens': 30, 'required_batch_size_multiple': 8, 'dataset_impl': 'mmap', 'train_subset': 'train', 'valid_subset': 'valid', 'validate_interval': 1, 'fixed_validation_seed': None, 'disable_validation': None, 'max_tokens_valid': None, 'max_sentences_valid': 1000, 'curriculum': 0, 'gen_subset': 'test', 'num_shards': 1, 'shard_id': 0, 'joined_dictionary': 0, 'langs': ['php']}, 'distributed_training': {'distributed_world_size': 1, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': None, 'distributed_port': -1, 'device_id': 0, 'distributed_no_spawn': 0, 'ddp_backend': 'c10d', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': None, 'find_unused_parameters': 0, 'fast_stat_sync': 0, 'broadcast_buffers': 0, 'global_sync_iter': 50, 'warmup_iterations': 500, 'local_rank': -1, 'block_momentum': 0.875, 'block_lr': 1, 'use_nbm': 0, 'average_sync': 0}, 'task': {'data': '/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/', 'sample_break_mode': 'complete', 'tokens_per_sample': 512, 'mask_prob': 0.15, 'leave_unmasked_prob': 0.1, 'random_token_prob': 0.1, 'freq_weighted_replacement': 0, 'mask_whole_words': 0, 'pooler_activation_fn': 'tanh', 'source_lang': 'code_tokens', 'target_lang': 'docstring_tokens', 'source_aux_lang': 'code_tokens.wo_func', 'target_aux_lang': 'func_name', 'fraction_using_func_name': 0.3, 'load_alignments': 0, 'left_pad_source': 1, 'left_pad_target': 0, 'upsample_primary': 1, 'truncate_source': 0, 'eval_mrr': 1}, 'model': {'arch': 'nbow', 'code_embed_dim': 128, 'code_dropout': 0.1, 'code_pooling': 'weighted_mean', 'query_embed_dim': 128, 'query_dropout': 0.1, 'query_pooling': 'weighted_mean'}, 'optimization': {'max_epoch': 300, 'max_update': 0, 'clip_norm': 1, 'sentence_avg': 0, 'update_freq': [1], 'lrs': [0.01], 'min_lr': -1, 'use_bmuf': 0, 'lr_shrink': 1.0, 'force_anneal': 0, 'warmup_updates': 0, 'end_learning_rate': 0.0, 'power': 1.0, 'total_num_update': 1000000, 'adam': {'adam_betas': '(0.9, 0.999)', 'adam_eps': 1e-08, 'weight_decay': 0, 'use_old_adam': 1}, 'margin': 1}, 'checkpoint': {'save_dir': '/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/nbow/checkpoints', 'restore_file': 'checkpoint_last.pt', 'reset_dataloader': None, 'reset_lr_scheduler': None, 'reset_meters': None, 'reset_optimizer': None, 'optimizer_overrides': '{}', 'save_interval': 1, 'save_interval_updates': 0, 'keep_interval_updates': 0, 'keep_last_epochs': -1, 'keep_best_checkpoints': -1, 'no_save': 0, 'no_epoch_checkpoints': 1, 'no_last_checkpoints': 0, 'no_save_optimizer_state': None, 'best_checkpoint_metric': 'mrr', 'maximize_best_checkpoint_metric': 1, 'patience': 10}, 'eval': {'path': '/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/nbow/checkpoints/checkpoint_best.pt', 'quiet': 1, 'max_sentences': 1000, 'model_overrides': '{}', 'eval_size': -1}} (train.py:304, cli_main())
[2021-04-20 04:15:07]    INFO >> single GPU training... (train.py:333, cli_main())
[2021-04-20 04:15:08]    INFO >> loaded 12982 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/valid.php.code_tokens'] (hybrid_retrieval.py:54, load_tokens_dataset())
[2021-04-20 04:15:08]    INFO >> loaded 12982 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/valid.php.docstring_tokens'] (hybrid_retrieval.py:55, load_tokens_dataset())
[2021-04-20 04:15:08]    INFO >> NBOW(
  (src_encoders): ModuleDict(
    (php): NBOWEncoder(
      (embed): Embedding(10000, 128, padding_idx=0)
      (weight_layer): Linear(in_features=128, out_features=1, bias=False)
    )
  )
  (tgt_encoders): NBOWEncoder(
    (embed): Embedding(10000, 128, padding_idx=0)
    (weight_layer): Linear(in_features=128, out_features=1, bias=False)
  )
) (train.py:223, single_main())
[2021-04-20 04:15:08]    INFO >> model nbow, criterion SearchCosineCriterion (train.py:224, single_main())
[2021-04-20 04:15:08]    INFO >> num. model params: 2560256 (num. trained: 2560256) (train.py:227, single_main())
[2021-04-20 04:15:10]    INFO >> training on 1 GPUs (train.py:233, single_main())
[2021-04-20 04:15:10]    INFO >> max tokens per GPU = None and max sentences per GPU = 1000 (train.py:236, single_main())
[2021-04-20 04:15:10]    INFO >> no existing checkpoint found /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/nbow/checkpoints/checkpoint_last.pt (ncc_trainers.py:270, load_checkpoint())
[2021-04-20 04:15:10]    INFO >> loading train data for epoch 1 (ncc_trainers.py:285, get_train_iterator())
[2021-04-20 04:15:10]    INFO >> loaded 241241 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.php.code_tokens'] (hybrid_retrieval.py:54, load_tokens_dataset())
[2021-04-20 04:15:10]    INFO >> loaded 241241 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.php.docstring_tokens'] (hybrid_retrieval.py:55, load_tokens_dataset())
[2021-04-20 04:15:10]    INFO >> loaded 241241 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.php.code_tokens.wo_func'] (hybrid_retrieval.py:67, load_tokens_dataset())
[2021-04-20 04:15:10]    INFO >> loaded 241241 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.php.func_name'] (hybrid_retrieval.py:81, load_tokens_dataset())
[2021-04-20 04:15:11]    INFO >> NOTE: your device may support faster training with fp16 (ncc_trainers.py:155, _setup_optimizer())
/home/yanghe/Documents/naturalcc-dev/ncc/utils/gradient_clip/fairseq_clip.py:57: UserWarning: amp_C fused kernels unavailable, disabling multi_tensor_l2norm; you may get better performance by installing NVIDIA's apex library
  "amp_C fused kernels unavailable, disabling multi_tensor_l2norm; "
[2021-04-20 04:15:28]    INFO >> epoch 001 | loss 1.005 | mrr 0.287192 | sample_size 1000 | wps 16621.4 | ups 16.62 | wpb 1000 | bsz 1000 | num_updates 241 | lr 0.01 | gnorm 0.013 | clip 0 | train_wall 13 | wall 18 (progress_bar.py:269, print())
[2021-04-20 04:15:31]    INFO >> epoch 001 | valid on 'valid' subset | loss 1.001 | mrr 0.450313 | sample_size 1000 | wps 13077.9 | wpb 1000 | bsz 1000 | num_updates 241 (progress_bar.py:269, print())
[2021-04-20 04:15:32]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/nbow/checkpoints/checkpoint_best.pt (epoch 1 @ 241 updates, score 0.450313) (writing took 0.284186 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:15:50]    INFO >> epoch 002 | loss 0.998 | mrr 0.577084 | sample_size 1000 | wps 10929.5 | ups 10.93 | wpb 1000 | bsz 1000 | num_updates 482 | lr 0.01 | gnorm 0.009 | clip 0 | train_wall 14 | wall 40 (progress_bar.py:269, print())
[2021-04-20 04:15:53]    INFO >> epoch 002 | valid on 'valid' subset | loss 1.025 | mrr 0.500663 | sample_size 1000 | wps 13484.5 | wpb 1000 | bsz 1000 | num_updates 482 | best_mrr 500.663 (progress_bar.py:269, print())
[2021-04-20 04:15:53]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/nbow/checkpoints/checkpoint_best.pt (epoch 2 @ 482 updates, score 0.500663) (writing took 0.223429 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:15:57]    INFO >> epoch 003:     18 / 242 loss=1, mrr=440.98, sample_size=1000, wps=11472.3, ups=11.47, wpb=1000, bsz=1000, num_updates=500, lr=0.01, gnorm=0.012, clip=0, train_wall=28, wall=47 (progress_bar.py:262, log())
[2021-04-20 04:16:12]    INFO >> epoch 003 | loss 0.957 | mrr 0.703687 | sample_size 1000 | wps 11124.3 | ups 11.12 | wpb 1000 | bsz 1000 | num_updates 723 | lr 0.01 | gnorm 0.023 | clip 0 | train_wall 14 | wall 61 (progress_bar.py:269, print())
[2021-04-20 04:16:15]    INFO >> epoch 003 | valid on 'valid' subset | loss 1.024 | mrr 0.575444 | sample_size 1000 | wps 12879.2 | wpb 1000 | bsz 1000 | num_updates 723 | best_mrr 575.444 (progress_bar.py:269, print())
[2021-04-20 04:16:15]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/nbow/checkpoints/checkpoint_best.pt (epoch 3 @ 723 updates, score 0.575444) (writing took 0.212051 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:16:34]    INFO >> epoch 004 | loss 0.914 | mrr 0.784372 | sample_size 1000 | wps 10706.5 | ups 10.71 | wpb 1000 | bsz 1000 | num_updates 964 | lr 0.01 | gnorm 0.022 | clip 0 | train_wall 15 | wall 84 (progress_bar.py:269, print())
[2021-04-20 04:16:38]    INFO >> epoch 004 | valid on 'valid' subset | loss 1.019 | mrr 0.586674 | sample_size 1000 | wps 12309.8 | wpb 1000 | bsz 1000 | num_updates 964 | best_mrr 586.674 (progress_bar.py:269, print())
[2021-04-20 04:16:38]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/nbow/checkpoints/checkpoint_best.pt (epoch 4 @ 964 updates, score 0.586674) (writing took 0.214620 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:16:43]    INFO >> epoch 005:     36 / 242 loss=0.931, mrr=752.421, sample_size=1000, wps=10876.6, ups=10.88, wpb=1000, bsz=1000, num_updates=1000, lr=0.01, gnorm=0.022, clip=0, train_wall=30, wall=93 (progress_bar.py:262, log())
[2021-04-20 04:16:57]    INFO >> epoch 005 | loss 0.896 | mrr 0.812881 | sample_size 1000 | wps 10709.2 | ups 10.71 | wpb 1000 | bsz 1000 | num_updates 1205 | lr 0.01 | gnorm 0.021 | clip 0 | train_wall 15 | wall 107 (progress_bar.py:269, print())
[2021-04-20 04:17:00]    INFO >> epoch 005 | valid on 'valid' subset | loss 1.018 | mrr 0.59043 | sample_size 1000 | wps 12582.1 | wpb 1000 | bsz 1000 | num_updates 1205 | best_mrr 590.43 (progress_bar.py:269, print())
[2021-04-20 04:17:00]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/nbow/checkpoints/checkpoint_best.pt (epoch 5 @ 1205 updates, score 0.59043) (writing took 0.244085 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:17:19]    INFO >> epoch 006 | loss 0.886 | mrr 0.828074 | sample_size 1000 | wps 11085.6 | ups 11.09 | wpb 1000 | bsz 1000 | num_updates 1446 | lr 0.01 | gnorm 0.021 | clip 0 | train_wall 14 | wall 128 (progress_bar.py:269, print())
[2021-04-20 04:17:22]    INFO >> epoch 006 | valid on 'valid' subset | loss 1.017 | mrr 0.595244 | sample_size 1000 | wps 13333.7 | wpb 1000 | bsz 1000 | num_updates 1446 | best_mrr 595.244 (progress_bar.py:269, print())
[2021-04-20 04:17:22]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/nbow/checkpoints/checkpoint_best.pt (epoch 6 @ 1446 updates, score 0.595244) (writing took 0.302584 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:17:27]    INFO >> epoch 007:     54 / 242 loss=0.889, mrr=823.075, sample_size=1000, wps=11251.7, ups=11.25, wpb=1000, bsz=1000, num_updates=1500, lr=0.01, gnorm=0.021, clip=0, train_wall=29, wall=137 (progress_bar.py:262, log())
[2021-04-20 04:17:41]    INFO >> epoch 007 | loss 0.879 | mrr 0.83634 | sample_size 1000 | wps 10768.2 | ups 10.77 | wpb 1000 | bsz 1000 | num_updates 1687 | lr 0.01 | gnorm 0.021 | clip 0 | train_wall 15 | wall 151 (progress_bar.py:269, print())
[2021-04-20 04:17:44]    INFO >> epoch 007 | valid on 'valid' subset | loss 1.016 | mrr 0.597064 | sample_size 1000 | wps 13657.1 | wpb 1000 | bsz 1000 | num_updates 1687 | best_mrr 597.064 (progress_bar.py:269, print())
[2021-04-20 04:17:44]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/nbow/checkpoints/checkpoint_best.pt (epoch 7 @ 1687 updates, score 0.597064) (writing took 0.287211 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:18:04]    INFO >> epoch 008 | loss 0.874 | mrr 0.843082 | sample_size 1000 | wps 10644.1 | ups 10.64 | wpb 1000 | bsz 1000 | num_updates 1928 | lr 0.01 | gnorm 0.021 | clip 0 | train_wall 15 | wall 173 (progress_bar.py:269, print())
[2021-04-20 04:18:08]    INFO >> epoch 008 | valid on 'valid' subset | loss 1.016 | mrr 0.596086 | sample_size 1000 | wps 13619.2 | wpb 1000 | bsz 1000 | num_updates 1928 | best_mrr 596.086 (progress_bar.py:269, print())
[2021-04-20 04:18:08]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/nbow/checkpoints/checkpoint_last.pt (epoch 8 @ 1928 updates, score 0.596086) (writing took 0.167270 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:18:15]    INFO >> epoch 009:     72 / 242 loss=0.875, mrr=840.997, sample_size=1000, wps=10566.2, ups=10.57, wpb=1000, bsz=1000, num_updates=2000, lr=0.01, gnorm=0.021, clip=0, train_wall=31, wall=185 (progress_bar.py:262, log())
[2021-04-20 04:18:26]    INFO >> epoch 009 | loss 0.87 | mrr 0.847586 | sample_size 1000 | wps 10535.9 | ups 10.54 | wpb 1000 | bsz 1000 | num_updates 2169 | lr 0.01 | gnorm 0.022 | clip 0 | train_wall 14 | wall 196 (progress_bar.py:269, print())
[2021-04-20 04:18:30]    INFO >> epoch 009 | valid on 'valid' subset | loss 1.016 | mrr 0.599593 | sample_size 1000 | wps 12971.2 | wpb 1000 | bsz 1000 | num_updates 2169 | best_mrr 599.593 (progress_bar.py:269, print())
[2021-04-20 04:18:30]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/nbow/checkpoints/checkpoint_best.pt (epoch 9 @ 2169 updates, score 0.599593) (writing took 0.294392 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:18:48]    INFO >> epoch 010 | loss 0.867 | mrr 0.852001 | sample_size 1000 | wps 10933.9 | ups 10.93 | wpb 1000 | bsz 1000 | num_updates 2410 | lr 0.01 | gnorm 0.022 | clip 0 | train_wall 14 | wall 218 (progress_bar.py:269, print())
[2021-04-20 04:18:52]    INFO >> epoch 010 | valid on 'valid' subset | loss 1.015 | mrr 0.598742 | sample_size 1000 | wps 13218.6 | wpb 1000 | bsz 1000 | num_updates 2410 | best_mrr 598.742 (progress_bar.py:269, print())
[2021-04-20 04:18:52]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/nbow/checkpoints/checkpoint_last.pt (epoch 10 @ 2410 updates, score 0.598742) (writing took 0.166305 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:19:00]    INFO >> epoch 011:     91 / 242 loss=0.867, mrr=851.329, sample_size=1000, wps=11045, ups=11.04, wpb=1000, bsz=1000, num_updates=2500, lr=0.01, gnorm=0.022, clip=0, train_wall=30, wall=230 (progress_bar.py:262, log())
[2021-04-20 04:19:09]    INFO >> epoch 011 | loss 0.864 | mrr 0.855352 | sample_size 1000 | wps 11605.7 | ups 11.61 | wpb 1000 | bsz 1000 | num_updates 2651 | lr 0.01 | gnorm 0.022 | clip 0 | train_wall 13 | wall 239 (progress_bar.py:269, print())
[2021-04-20 04:19:12]    INFO >> epoch 011 | valid on 'valid' subset | loss 1.016 | mrr 0.601391 | sample_size 1000 | wps 13211.1 | wpb 1000 | bsz 1000 | num_updates 2651 | best_mrr 601.391 (progress_bar.py:269, print())
[2021-04-20 04:19:13]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/nbow/checkpoints/checkpoint_best.pt (epoch 11 @ 2651 updates, score 0.601391) (writing took 0.253631 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:19:30]    INFO >> epoch 012 | loss 0.862 | mrr 0.8578 | sample_size 1000 | wps 11362.2 | ups 11.36 | wpb 1000 | bsz 1000 | num_updates 2892 | lr 0.01 | gnorm 0.022 | clip 0 | train_wall 13 | wall 260 (progress_bar.py:269, print())
[2021-04-20 04:19:34]    INFO >> epoch 012 | valid on 'valid' subset | loss 1.015 | mrr 0.600652 | sample_size 1000 | wps 12632.8 | wpb 1000 | bsz 1000 | num_updates 2892 | best_mrr 600.652 (progress_bar.py:269, print())
[2021-04-20 04:19:34]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/nbow/checkpoints/checkpoint_last.pt (epoch 12 @ 2892 updates, score 0.600652) (writing took 0.200996 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:19:43]    INFO >> epoch 013:    109 / 242 loss=0.862, mrr=857.456, sample_size=1000, wps=11739.7, ups=11.74, wpb=1000, bsz=1000, num_updates=3000, lr=0.01, gnorm=0.022, clip=0, train_wall=26, wall=272 (progress_bar.py:262, log())
[2021-04-20 04:19:52]    INFO >> epoch 013 | loss 0.86 | mrr 0.859949 | sample_size 1000 | wps 11150.7 | ups 11.15 | wpb 1000 | bsz 1000 | num_updates 3133 | lr 0.01 | gnorm 0.022 | clip 0 | train_wall 13 | wall 282 (progress_bar.py:269, print())
[2021-04-20 04:19:55]    INFO >> epoch 013 | valid on 'valid' subset | loss 1.015 | mrr 0.599801 | sample_size 1000 | wps 13330.4 | wpb 1000 | bsz 1000 | num_updates 3133 | best_mrr 599.801 (progress_bar.py:269, print())
[2021-04-20 04:19:55]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/nbow/checkpoints/checkpoint_last.pt (epoch 13 @ 3133 updates, score 0.599801) (writing took 0.120351 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:20:13]    INFO >> epoch 014 | loss 0.859 | mrr 0.862028 | sample_size 1000 | wps 11644.1 | ups 11.64 | wpb 1000 | bsz 1000 | num_updates 3374 | lr 0.01 | gnorm 0.023 | clip 0 | train_wall 13 | wall 303 (progress_bar.py:269, print())
[2021-04-20 04:20:16]    INFO >> epoch 014 | valid on 'valid' subset | loss 1.015 | mrr 0.599916 | sample_size 1000 | wps 13614 | wpb 1000 | bsz 1000 | num_updates 3374 | best_mrr 599.916 (progress_bar.py:269, print())
[2021-04-20 04:20:16]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/nbow/checkpoints/checkpoint_last.pt (epoch 14 @ 3374 updates, score 0.599916) (writing took 0.256496 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:20:26]    INFO >> epoch 015:    127 / 242 loss=0.859, mrr=861.81, sample_size=1000, wps=11574, ups=11.57, wpb=1000, bsz=1000, num_updates=3500, lr=0.01, gnorm=0.023, clip=0, train_wall=28, wall=316 (progress_bar.py:262, log())
[2021-04-20 04:20:33]    INFO >> epoch 015 | loss 0.857 | mrr 0.863786 | sample_size 1000 | wps 11853.1 | ups 11.85 | wpb 1000 | bsz 1000 | num_updates 3615 | lr 0.01 | gnorm 0.023 | clip 0 | train_wall 13 | wall 323 (progress_bar.py:269, print())
[2021-04-20 04:20:36]    INFO >> epoch 015 | valid on 'valid' subset | loss 1.016 | mrr 0.596731 | sample_size 1000 | wps 13579.3 | wpb 1000 | bsz 1000 | num_updates 3615 | best_mrr 596.731 (progress_bar.py:269, print())
[2021-04-20 04:20:36]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/nbow/checkpoints/checkpoint_last.pt (epoch 15 @ 3615 updates, score 0.596731) (writing took 0.201671 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:20:53]    INFO >> epoch 016 | loss 0.855 | mrr 0.865152 | sample_size 1000 | wps 12207.6 | ups 12.21 | wpb 1000 | bsz 1000 | num_updates 3856 | lr 0.01 | gnorm 0.023 | clip 0 | train_wall 11 | wall 343 (progress_bar.py:269, print())
[2021-04-20 04:20:56]    INFO >> epoch 016 | valid on 'valid' subset | loss 1.016 | mrr 0.597236 | sample_size 1000 | wps 12451.2 | wpb 1000 | bsz 1000 | num_updates 3856 | best_mrr 597.236 (progress_bar.py:269, print())
[2021-04-20 04:20:56]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/nbow/checkpoints/checkpoint_last.pt (epoch 16 @ 3856 updates, score 0.597236) (writing took 0.169053 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:21:07]    INFO >> epoch 017:    145 / 242 loss=0.856, mrr=865.122, sample_size=1000, wps=12300.1, ups=12.3, wpb=1000, bsz=1000, num_updates=4000, lr=0.01, gnorm=0.023, clip=0, train_wall=24, wall=356 (progress_bar.py:262, log())
[2021-04-20 04:21:12]    INFO >> epoch 017 | loss 0.854 | mrr 0.866458 | sample_size 1000 | wps 12371.2 | ups 12.37 | wpb 1000 | bsz 1000 | num_updates 4097 | lr 0.01 | gnorm 0.024 | clip 0 | train_wall 11 | wall 362 (progress_bar.py:269, print())
[2021-04-20 04:21:15]    INFO >> epoch 017 | valid on 'valid' subset | loss 1.016 | mrr 0.59707 | sample_size 1000 | wps 12439.5 | wpb 1000 | bsz 1000 | num_updates 4097 | best_mrr 597.07 (progress_bar.py:269, print())
[2021-04-20 04:21:16]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/nbow/checkpoints/checkpoint_last.pt (epoch 17 @ 4097 updates, score 0.59707) (writing took 0.172229 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:21:31]    INFO >> epoch 018 | loss 0.853 | mrr 0.868048 | sample_size 1000 | wps 13102 | ups 13.1 | wpb 1000 | bsz 1000 | num_updates 4338 | lr 0.01 | gnorm 0.024 | clip 0 | train_wall 10 | wall 380 (progress_bar.py:269, print())
[2021-04-20 04:21:34]    INFO >> epoch 018 | valid on 'valid' subset | loss 1.016 | mrr 0.597233 | sample_size 1000 | wps 12057.9 | wpb 1000 | bsz 1000 | num_updates 4338 | best_mrr 597.233 (progress_bar.py:269, print())
[2021-04-20 04:21:34]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/nbow/checkpoints/checkpoint_last.pt (epoch 18 @ 4338 updates, score 0.597233) (writing took 0.160101 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:21:45]    INFO >> epoch 019:    163 / 242 loss=0.853, mrr=867.678, sample_size=1000, wps=13152.6, ups=13.15, wpb=1000, bsz=1000, num_updates=4500, lr=0.01, gnorm=0.024, clip=0, train_wall=20, wall=394 (progress_bar.py:262, log())
[2021-04-20 04:21:49]    INFO >> epoch 019 | loss 0.853 | mrr 0.868199 | sample_size 1000 | wps 13369.7 | ups 13.37 | wpb 1000 | bsz 1000 | num_updates 4579 | lr 0.01 | gnorm 0.024 | clip 0 | train_wall 8 | wall 399 (progress_bar.py:269, print())
[2021-04-20 04:21:52]    INFO >> epoch 019 | valid on 'valid' subset | loss 1.016 | mrr 0.595497 | sample_size 1000 | wps 13414.6 | wpb 1000 | bsz 1000 | num_updates 4579 | best_mrr 595.497 (progress_bar.py:269, print())
[2021-04-20 04:21:52]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/nbow/checkpoints/checkpoint_last.pt (epoch 19 @ 4579 updates, score 0.595497) (writing took 0.152868 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:22:07]    INFO >> epoch 020 | loss 0.852 | mrr 0.869898 | sample_size 1000 | wps 13518.5 | ups 13.52 | wpb 1000 | bsz 1000 | num_updates 4820 | lr 0.01 | gnorm 0.025 | clip 0 | train_wall 8 | wall 416 (progress_bar.py:269, print())
[2021-04-20 04:22:10]    INFO >> epoch 020 | valid on 'valid' subset | loss 1.015 | mrr 0.596454 | sample_size 1000 | wps 13461.6 | wpb 1000 | bsz 1000 | num_updates 4820 | best_mrr 596.454 (progress_bar.py:269, print())
[2021-04-20 04:22:10]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/nbow/checkpoints/checkpoint_last.pt (epoch 20 @ 4820 updates, score 0.596454) (writing took 0.170218 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:22:21]    INFO >> epoch 021:    181 / 242 loss=0.852, mrr=869.48, sample_size=1000, wps=13757.4, ups=13.76, wpb=1000, bsz=1000, num_updates=5000, lr=0.01, gnorm=0.025, clip=0, train_wall=18, wall=431 (progress_bar.py:262, log())
[2021-04-20 04:22:24]    INFO >> epoch 021 | loss 0.851 | mrr 0.870355 | sample_size 1000 | wps 13725.7 | ups 13.73 | wpb 1000 | bsz 1000 | num_updates 5061 | lr 0.01 | gnorm 0.025 | clip 0 | train_wall 8 | wall 434 (progress_bar.py:269, print())
[2021-04-20 04:22:28]    INFO >> epoch 021 | valid on 'valid' subset | loss 1.016 | mrr 0.596172 | sample_size 1000 | wps 12643.1 | wpb 1000 | bsz 1000 | num_updates 5061 | best_mrr 596.172 (progress_bar.py:269, print())
[2021-04-20 04:22:28]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/nbow/checkpoints/checkpoint_last.pt (epoch 21 @ 5061 updates, score 0.596172) (writing took 0.213921 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:22:28]    INFO >> early stop since valid performance hasn't improved for last 10 runs (train.py:191, should_stop_early())
[2021-04-20 04:22:28]    INFO >> early stop since valid performance hasn't improved for last 10 runs (train.py:272, single_main())
[2021-04-20 04:22:28]    INFO >> done training in 437.6 seconds (train.py:283, single_main())
