nohup: 忽略输入
[2021-04-20 04:15:11]    INFO >> Load arguments in /home/yanghe/Documents/naturalcc-dev/run/retrieval/nbow/config/csn_feng/java.yml (train.py:302, cli_main())
[2021-04-20 04:15:12]    INFO >> {'criterion': 'retrieval_cosine', 'optimizer': 'torch_adam', 'lr_scheduler': 'fixed', 'tokenizer': None, 'bpe': None, 'common': {'no_progress_bar': 0, 'log_interval': 500, 'log_format': 'simple', 'tensorboard_logdir': '', 'seed': 666, 'cpu': 0, 'fp16': 0, 'memory_efficient_fp16': 0, 'fp16_no_flatten_grads': 0, 'fp16_init_scale': 128, 'fp16_scale_window': None, 'fp16_scale_tolerance': 0.0, 'min_loss_scale': 0.0001, 'threshold_loss_scale': None, 'user_dir': None, 'empty_cache_freq': 0, 'all_gather_list_size': 16384, 'task': 'hybrid_retrieval'}, 'dataset': {'num_workers': 1, 'skip_invalid_size_inputs_valid_test': 0, 'max_tokens': None, 'max_sentences': 1000, 'code_max_tokens': 200, 'query_max_tokens': 30, 'required_batch_size_multiple': 8, 'dataset_impl': 'mmap', 'train_subset': 'train', 'valid_subset': 'valid', 'validate_interval': 1, 'fixed_validation_seed': None, 'disable_validation': None, 'max_tokens_valid': None, 'max_sentences_valid': 1000, 'curriculum': 0, 'gen_subset': 'test', 'num_shards': 1, 'shard_id': 0, 'joined_dictionary': 0, 'langs': ['java']}, 'distributed_training': {'distributed_world_size': 1, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': None, 'distributed_port': -1, 'device_id': 0, 'distributed_no_spawn': 0, 'ddp_backend': 'c10d', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': None, 'find_unused_parameters': 0, 'fast_stat_sync': 0, 'broadcast_buffers': 0, 'global_sync_iter': 50, 'warmup_iterations': 500, 'local_rank': -1, 'block_momentum': 0.875, 'block_lr': 1, 'use_nbm': 0, 'average_sync': 0}, 'task': {'data': '/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/', 'sample_break_mode': 'complete', 'tokens_per_sample': 512, 'mask_prob': 0.15, 'leave_unmasked_prob': 0.1, 'random_token_prob': 0.1, 'freq_weighted_replacement': 0, 'mask_whole_words': 0, 'pooler_activation_fn': 'tanh', 'source_lang': 'code_tokens', 'target_lang': 'docstring_tokens', 'source_aux_lang': 'code_tokens.wo_func', 'target_aux_lang': 'func_name', 'fraction_using_func_name': 0.3, 'load_alignments': 0, 'left_pad_source': 1, 'left_pad_target': 0, 'upsample_primary': 1, 'truncate_source': 0, 'eval_mrr': 1}, 'model': {'arch': 'nbow', 'code_embed_dim': 128, 'code_dropout': 0.1, 'code_pooling': 'weighted_mean', 'query_embed_dim': 128, 'query_dropout': 0.1, 'query_pooling': 'weighted_mean'}, 'optimization': {'max_epoch': 300, 'max_update': 0, 'clip_norm': 1, 'sentence_avg': 0, 'update_freq': [1], 'lrs': [0.01], 'min_lr': -1, 'use_bmuf': 0, 'lr_shrink': 1.0, 'force_anneal': 0, 'warmup_updates': 0, 'end_learning_rate': 0.0, 'power': 1.0, 'total_num_update': 1000000, 'adam': {'adam_betas': '(0.9, 0.999)', 'adam_eps': 1e-08, 'weight_decay': 0, 'use_old_adam': 1}, 'margin': 1}, 'checkpoint': {'save_dir': '/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/nbow/checkpoints', 'restore_file': 'checkpoint_last.pt', 'reset_dataloader': None, 'reset_lr_scheduler': None, 'reset_meters': None, 'reset_optimizer': None, 'optimizer_overrides': '{}', 'save_interval': 1, 'save_interval_updates': 0, 'keep_interval_updates': 0, 'keep_last_epochs': -1, 'keep_best_checkpoints': -1, 'no_save': 0, 'no_epoch_checkpoints': 1, 'no_last_checkpoints': 0, 'no_save_optimizer_state': None, 'best_checkpoint_metric': 'mrr', 'maximize_best_checkpoint_metric': 1, 'patience': 10}, 'eval': {'path': '/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/nbow/checkpoints/checkpoint_best.pt', 'quiet': 1, 'max_sentences': 1000, 'model_overrides': '{}', 'eval_size': -1}} (train.py:304, cli_main())
[2021-04-20 04:15:12]    INFO >> single GPU training... (train.py:333, cli_main())
[2021-04-20 04:15:12]    INFO >> loaded 5183 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/valid.java.code_tokens'] (hybrid_retrieval.py:54, load_tokens_dataset())
[2021-04-20 04:15:12]    INFO >> loaded 5183 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/valid.java.docstring_tokens'] (hybrid_retrieval.py:55, load_tokens_dataset())
[2021-04-20 04:15:12]    INFO >> NBOW(
  (src_encoders): ModuleDict(
    (java): NBOWEncoder(
      (embed): Embedding(10000, 128, padding_idx=0)
      (weight_layer): Linear(in_features=128, out_features=1, bias=False)
    )
  )
  (tgt_encoders): NBOWEncoder(
    (embed): Embedding(10000, 128, padding_idx=0)
    (weight_layer): Linear(in_features=128, out_features=1, bias=False)
  )
) (train.py:223, single_main())
[2021-04-20 04:15:12]    INFO >> model nbow, criterion SearchCosineCriterion (train.py:224, single_main())
[2021-04-20 04:15:12]    INFO >> num. model params: 2560256 (num. trained: 2560256) (train.py:227, single_main())
[2021-04-20 04:15:15]    INFO >> training on 1 GPUs (train.py:233, single_main())
[2021-04-20 04:15:15]    INFO >> max tokens per GPU = None and max sentences per GPU = 1000 (train.py:236, single_main())
[2021-04-20 04:15:15]    INFO >> no existing checkpoint found /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/nbow/checkpoints/checkpoint_last.pt (ncc_trainers.py:270, load_checkpoint())
[2021-04-20 04:15:15]    INFO >> loading train data for epoch 1 (ncc_trainers.py:285, get_train_iterator())
[2021-04-20 04:15:15]    INFO >> loaded 164923 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.java.code_tokens'] (hybrid_retrieval.py:54, load_tokens_dataset())
[2021-04-20 04:15:15]    INFO >> loaded 164923 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.java.docstring_tokens'] (hybrid_retrieval.py:55, load_tokens_dataset())
[2021-04-20 04:15:15]    INFO >> loaded 164923 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.java.code_tokens.wo_func'] (hybrid_retrieval.py:67, load_tokens_dataset())
[2021-04-20 04:15:15]    INFO >> loaded 164923 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.java.func_name'] (hybrid_retrieval.py:81, load_tokens_dataset())
[2021-04-20 04:15:16]    INFO >> NOTE: your device may support faster training with fp16 (ncc_trainers.py:155, _setup_optimizer())
/home/yanghe/Documents/naturalcc-dev/ncc/utils/gradient_clip/fairseq_clip.py:57: UserWarning: amp_C fused kernels unavailable, disabling multi_tensor_l2norm; you may get better performance by installing NVIDIA's apex library
  "amp_C fused kernels unavailable, disabling multi_tensor_l2norm; "
[2021-04-20 04:15:29]    INFO >> epoch 001 | loss 1.006 | mrr 0.283641 | sample_size 1000 | wps 16068.1 | ups 16.06 | wpb 1000 | bsz 1000 | num_updates 164 | lr 0.01 | gnorm 0.017 | clip 0 | train_wall 9 | wall 13 (progress_bar.py:269, print())
[2021-04-20 04:15:31]    INFO >> epoch 001 | valid on 'valid' subset | loss 1.001 | mrr 0.418249 | sample_size 1000 | wps 8592.4 | wpb 1000 | bsz 1000 | num_updates 164 (progress_bar.py:269, print())
[2021-04-20 04:15:32]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/nbow/checkpoints/checkpoint_best.pt (epoch 1 @ 164 updates, score 0.418249) (writing took 0.189081 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:15:46]    INFO >> epoch 002 | loss 0.996 | mrr 0.594434 | sample_size 1000 | wps 9440.2 | ups 9.44 | wpb 1000 | bsz 1000 | num_updates 328 | lr 0.01 | gnorm 0.009 | clip 0 | train_wall 11 | wall 31 (progress_bar.py:269, print())
[2021-04-20 04:15:49]    INFO >> epoch 002 | valid on 'valid' subset | loss 1.028 | mrr 0.478159 | sample_size 1000 | wps 7003.7 | wpb 1000 | bsz 1000 | num_updates 328 | best_mrr 478.159 (progress_bar.py:269, print())
[2021-04-20 04:15:49]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/nbow/checkpoints/checkpoint_best.pt (epoch 2 @ 328 updates, score 0.478159) (writing took 0.240937 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:16:02]    INFO >> epoch 003 | loss 0.943 | mrr 0.727371 | sample_size 1000 | wps 10088.9 | ups 10.09 | wpb 1000 | bsz 1000 | num_updates 492 | lr 0.01 | gnorm 0.025 | clip 0 | train_wall 9 | wall 47 (progress_bar.py:269, print())
[2021-04-20 04:16:06]    INFO >> epoch 003 | valid on 'valid' subset | loss 1.024 | mrr 0.572362 | sample_size 1000 | wps 9005.3 | wpb 1000 | bsz 1000 | num_updates 492 | best_mrr 572.362 (progress_bar.py:269, print())
[2021-04-20 04:16:06]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/nbow/checkpoints/checkpoint_best.pt (epoch 3 @ 492 updates, score 0.572362) (writing took 0.256456 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:16:09]    INFO >> epoch 004:      8 / 165 loss=0.98, mrr=539.955, sample_size=1000, wps=9835.4, ups=9.83, wpb=1000, bsz=1000, num_updates=500, lr=0.01, gnorm=0.017, clip=0, train_wall=30, wall=54 (progress_bar.py:262, log())
[2021-04-20 04:16:19]    INFO >> epoch 004 | loss 0.887 | mrr 0.82366 | sample_size 1000 | wps 10005.5 | ups 10.01 | wpb 1000 | bsz 1000 | num_updates 656 | lr 0.01 | gnorm 0.022 | clip 0 | train_wall 8 | wall 63 (progress_bar.py:269, print())
[2021-04-20 04:16:21]    INFO >> epoch 004 | valid on 'valid' subset | loss 1.018 | mrr 0.593216 | sample_size 1000 | wps 9265.6 | wpb 1000 | bsz 1000 | num_updates 656 | best_mrr 593.216 (progress_bar.py:269, print())
[2021-04-20 04:16:22]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/nbow/checkpoints/checkpoint_best.pt (epoch 4 @ 656 updates, score 0.593216) (writing took 0.240854 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:16:35]    INFO >> epoch 005 | loss 0.863 | mrr 0.8565 | sample_size 1000 | wps 9881.1 | ups 9.88 | wpb 1000 | bsz 1000 | num_updates 820 | lr 0.01 | gnorm 0.021 | clip 0 | train_wall 10 | wall 80 (progress_bar.py:269, print())
[2021-04-20 04:16:38]    INFO >> epoch 005 | valid on 'valid' subset | loss 1.017 | mrr 0.593313 | sample_size 1000 | wps 8795.7 | wpb 1000 | bsz 1000 | num_updates 820 | best_mrr 593.313 (progress_bar.py:269, print())
[2021-04-20 04:16:38]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/nbow/checkpoints/checkpoint_best.pt (epoch 5 @ 820 updates, score 0.593313) (writing took 0.219757 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:16:53]    INFO >> epoch 006 | loss 0.849 | mrr 0.872222 | sample_size 1000 | wps 9523.9 | ups 9.52 | wpb 1000 | bsz 1000 | num_updates 984 | lr 0.01 | gnorm 0.021 | clip 0 | train_wall 11 | wall 97 (progress_bar.py:269, print())
[2021-04-20 04:16:55]    INFO >> epoch 006 | valid on 'valid' subset | loss 1.015 | mrr 0.59803 | sample_size 1000 | wps 7801.8 | wpb 1000 | bsz 1000 | num_updates 984 | best_mrr 598.03 (progress_bar.py:269, print())
[2021-04-20 04:16:56]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/nbow/checkpoints/checkpoint_best.pt (epoch 6 @ 984 updates, score 0.59803) (writing took 0.223325 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:16:59]    INFO >> epoch 007:     16 / 165 loss=0.865, mrr=852.362, sample_size=1000, wps=10061.4, ups=10.06, wpb=1000, bsz=1000, num_updates=1000, lr=0.01, gnorm=0.022, clip=0, train_wall=29, wall=104 (progress_bar.py:262, log())
[2021-04-20 04:17:08]    INFO >> epoch 007 | loss 0.84 | mrr 0.882826 | sample_size 1000 | wps 10312 | ups 10.31 | wpb 1000 | bsz 1000 | num_updates 1148 | lr 0.01 | gnorm 0.021 | clip 0 | train_wall 9 | wall 113 (progress_bar.py:269, print())
[2021-04-20 04:17:11]    INFO >> epoch 007 | valid on 'valid' subset | loss 1.015 | mrr 0.596859 | sample_size 1000 | wps 8725.9 | wpb 1000 | bsz 1000 | num_updates 1148 | best_mrr 596.859 (progress_bar.py:269, print())
[2021-04-20 04:17:11]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/nbow/checkpoints/checkpoint_last.pt (epoch 7 @ 1148 updates, score 0.596859) (writing took 0.198328 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:17:24]    INFO >> epoch 008 | loss 0.833 | mrr 0.88996 | sample_size 1000 | wps 10423.9 | ups 10.42 | wpb 1000 | bsz 1000 | num_updates 1312 | lr 0.01 | gnorm 0.021 | clip 0 | train_wall 9 | wall 129 (progress_bar.py:269, print())
[2021-04-20 04:17:27]    INFO >> epoch 008 | valid on 'valid' subset | loss 1.015 | mrr 0.59523 | sample_size 1000 | wps 8141.5 | wpb 1000 | bsz 1000 | num_updates 1312 | best_mrr 595.23 (progress_bar.py:269, print())
[2021-04-20 04:17:27]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/nbow/checkpoints/checkpoint_last.pt (epoch 8 @ 1312 updates, score 0.59523) (writing took 0.132275 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:17:42]    INFO >> epoch 009 | loss 0.828 | mrr 0.895181 | sample_size 1000 | wps 9415.7 | ups 9.42 | wpb 1000 | bsz 1000 | num_updates 1476 | lr 0.01 | gnorm 0.02 | clip 0 | train_wall 11 | wall 146 (progress_bar.py:269, print())
[2021-04-20 04:17:45]    INFO >> epoch 009 | valid on 'valid' subset | loss 1.015 | mrr 0.597293 | sample_size 1000 | wps 7715.5 | wpb 1000 | bsz 1000 | num_updates 1476 | best_mrr 597.293 (progress_bar.py:269, print())
[2021-04-20 04:17:45]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/nbow/checkpoints/checkpoint_last.pt (epoch 9 @ 1476 updates, score 0.597293) (writing took 0.178515 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:17:49]    INFO >> epoch 010:     24 / 165 loss=0.833, mrr=890.189, sample_size=1000, wps=10005.1, ups=10.01, wpb=1000, bsz=1000, num_updates=1500, lr=0.01, gnorm=0.021, clip=0, train_wall=29, wall=154 (progress_bar.py:262, log())
[2021-04-20 04:17:59]    INFO >> epoch 010 | loss 0.824 | mrr 0.899096 | sample_size 1000 | wps 9374.8 | ups 9.37 | wpb 1000 | bsz 1000 | num_updates 1640 | lr 0.01 | gnorm 0.02 | clip 0 | train_wall 11 | wall 164 (progress_bar.py:269, print())
[2021-04-20 04:18:02]    INFO >> epoch 010 | valid on 'valid' subset | loss 1.014 | mrr 0.599664 | sample_size 1000 | wps 8636.6 | wpb 1000 | bsz 1000 | num_updates 1640 | best_mrr 599.664 (progress_bar.py:269, print())
[2021-04-20 04:18:02]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/nbow/checkpoints/checkpoint_best.pt (epoch 10 @ 1640 updates, score 0.599664) (writing took 0.307719 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:18:15]    INFO >> epoch 011 | loss 0.821 | mrr 0.902472 | sample_size 1000 | wps 10524 | ups 10.52 | wpb 1000 | bsz 1000 | num_updates 1804 | lr 0.01 | gnorm 0.02 | clip 0 | train_wall 9 | wall 179 (progress_bar.py:269, print())
[2021-04-20 04:18:18]    INFO >> epoch 011 | valid on 'valid' subset | loss 1.014 | mrr 0.600835 | sample_size 1000 | wps 8764.7 | wpb 1000 | bsz 1000 | num_updates 1804 | best_mrr 600.835 (progress_bar.py:269, print())
[2021-04-20 04:18:18]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/nbow/checkpoints/checkpoint_best.pt (epoch 11 @ 1804 updates, score 0.600835) (writing took 0.224965 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:18:31]    INFO >> epoch 012 | loss 0.818 | mrr 0.905632 | sample_size 1000 | wps 10121.6 | ups 10.12 | wpb 1000 | bsz 1000 | num_updates 1968 | lr 0.01 | gnorm 0.02 | clip 0 | train_wall 9 | wall 196 (progress_bar.py:269, print())
[2021-04-20 04:18:34]    INFO >> epoch 012 | valid on 'valid' subset | loss 1.014 | mrr 0.601112 | sample_size 1000 | wps 8528 | wpb 1000 | bsz 1000 | num_updates 1968 | best_mrr 601.112 (progress_bar.py:269, print())
[2021-04-20 04:18:34]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/nbow/checkpoints/checkpoint_best.pt (epoch 12 @ 1968 updates, score 0.601112) (writing took 0.261213 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:18:39]    INFO >> epoch 013:     32 / 165 loss=0.82, mrr=902.935, sample_size=1000, wps=10014.8, ups=10.01, wpb=1000, bsz=1000, num_updates=2000, lr=0.01, gnorm=0.02, clip=0, train_wall=29, wall=204 (progress_bar.py:262, log())
[2021-04-20 04:18:48]    INFO >> epoch 013 | loss 0.815 | mrr 0.908642 | sample_size 1000 | wps 9585.9 | ups 9.59 | wpb 1000 | bsz 1000 | num_updates 2132 | lr 0.01 | gnorm 0.02 | clip 0 | train_wall 10 | wall 213 (progress_bar.py:269, print())
[2021-04-20 04:18:51]    INFO >> epoch 013 | valid on 'valid' subset | loss 1.014 | mrr 0.597249 | sample_size 1000 | wps 8585.1 | wpb 1000 | bsz 1000 | num_updates 2132 | best_mrr 597.249 (progress_bar.py:269, print())
[2021-04-20 04:18:51]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/nbow/checkpoints/checkpoint_last.pt (epoch 13 @ 2132 updates, score 0.597249) (writing took 0.129107 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:19:04]    INFO >> epoch 014 | loss 0.813 | mrr 0.90957 | sample_size 1000 | wps 10211.6 | ups 10.21 | wpb 1000 | bsz 1000 | num_updates 2296 | lr 0.01 | gnorm 0.021 | clip 0 | train_wall 10 | wall 229 (progress_bar.py:269, print())
[2021-04-20 04:19:08]    INFO >> epoch 014 | valid on 'valid' subset | loss 1.014 | mrr 0.599175 | sample_size 1000 | wps 7662.7 | wpb 1000 | bsz 1000 | num_updates 2296 | best_mrr 599.175 (progress_bar.py:269, print())
[2021-04-20 04:19:08]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/nbow/checkpoints/checkpoint_last.pt (epoch 14 @ 2296 updates, score 0.599175) (writing took 0.121720 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:19:20]    INFO >> epoch 015 | loss 0.811 | mrr 0.911747 | sample_size 1000 | wps 10296.2 | ups 10.3 | wpb 1000 | bsz 1000 | num_updates 2460 | lr 0.01 | gnorm 0.021 | clip 0 | train_wall 8 | wall 245 (progress_bar.py:269, print())
[2021-04-20 04:19:23]    INFO >> epoch 015 | valid on 'valid' subset | loss 1.013 | mrr 0.600596 | sample_size 1000 | wps 8487 | wpb 1000 | bsz 1000 | num_updates 2460 | best_mrr 600.596 (progress_bar.py:269, print())
[2021-04-20 04:19:23]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/nbow/checkpoints/checkpoint_last.pt (epoch 15 @ 2460 updates, score 0.600596) (writing took 0.133981 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:19:28]    INFO >> epoch 016:     41 / 165 loss=0.812, mrr=910.439, sample_size=1000, wps=10129, ups=10.13, wpb=1000, bsz=1000, num_updates=2500, lr=0.01, gnorm=0.021, clip=0, train_wall=28, wall=253 (progress_bar.py:262, log())
[2021-04-20 04:19:36]    INFO >> epoch 016 | loss 0.809 | mrr 0.913211 | sample_size 1000 | wps 10253.6 | ups 10.25 | wpb 1000 | bsz 1000 | num_updates 2624 | lr 0.01 | gnorm 0.021 | clip 0 | train_wall 9 | wall 261 (progress_bar.py:269, print())
[2021-04-20 04:19:39]    INFO >> epoch 016 | valid on 'valid' subset | loss 1.014 | mrr 0.597945 | sample_size 1000 | wps 7936.1 | wpb 1000 | bsz 1000 | num_updates 2624 | best_mrr 597.945 (progress_bar.py:269, print())
[2021-04-20 04:19:39]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/nbow/checkpoints/checkpoint_last.pt (epoch 16 @ 2624 updates, score 0.597945) (writing took 0.121344 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:19:53]    INFO >> epoch 017 | loss 0.808 | mrr 0.91425 | sample_size 1000 | wps 9868.8 | ups 9.87 | wpb 1000 | bsz 1000 | num_updates 2788 | lr 0.01 | gnorm 0.021 | clip 0 | train_wall 10 | wall 277 (progress_bar.py:269, print())
[2021-04-20 04:19:55]    INFO >> epoch 017 | valid on 'valid' subset | loss 1.014 | mrr 0.599644 | sample_size 1000 | wps 8805.1 | wpb 1000 | bsz 1000 | num_updates 2788 | best_mrr 599.644 (progress_bar.py:269, print())
[2021-04-20 04:19:56]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/nbow/checkpoints/checkpoint_last.pt (epoch 17 @ 2788 updates, score 0.599644) (writing took 0.113868 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:20:09]    INFO >> epoch 018 | loss 0.806 | mrr 0.914864 | sample_size 1000 | wps 10143.6 | ups 10.14 | wpb 1000 | bsz 1000 | num_updates 2952 | lr 0.01 | gnorm 0.021 | clip 0 | train_wall 10 | wall 294 (progress_bar.py:269, print())
[2021-04-20 04:20:12]    INFO >> epoch 018 | valid on 'valid' subset | loss 1.014 | mrr 0.599714 | sample_size 1000 | wps 9150.2 | wpb 1000 | bsz 1000 | num_updates 2952 | best_mrr 599.714 (progress_bar.py:269, print())
[2021-04-20 04:20:12]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/nbow/checkpoints/checkpoint_last.pt (epoch 18 @ 2952 updates, score 0.599714) (writing took 0.151275 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:20:17]    INFO >> epoch 019:     49 / 165 loss=0.807, mrr=914.414, sample_size=1000, wps=10289.3, ups=10.29, wpb=1000, bsz=1000, num_updates=3000, lr=0.01, gnorm=0.021, clip=0, train_wall=29, wall=302 (progress_bar.py:262, log())
[2021-04-20 04:20:24]    INFO >> epoch 019 | loss 0.805 | mrr 0.916146 | sample_size 1000 | wps 10812.9 | ups 10.81 | wpb 1000 | bsz 1000 | num_updates 3116 | lr 0.01 | gnorm 0.021 | clip 0 | train_wall 9 | wall 309 (progress_bar.py:269, print())
[2021-04-20 04:20:27]    INFO >> epoch 019 | valid on 'valid' subset | loss 1.015 | mrr 0.596613 | sample_size 1000 | wps 7836.9 | wpb 1000 | bsz 1000 | num_updates 3116 | best_mrr 596.613 (progress_bar.py:269, print())
[2021-04-20 04:20:27]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/nbow/checkpoints/checkpoint_last.pt (epoch 19 @ 3116 updates, score 0.596613) (writing took 0.122300 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:20:40]    INFO >> epoch 020 | loss 0.804 | mrr 0.916856 | sample_size 1000 | wps 10368.6 | ups 10.37 | wpb 1000 | bsz 1000 | num_updates 3280 | lr 0.01 | gnorm 0.022 | clip 0 | train_wall 9 | wall 324 (progress_bar.py:269, print())
[2021-04-20 04:20:43]    INFO >> epoch 020 | valid on 'valid' subset | loss 1.015 | mrr 0.595576 | sample_size 1000 | wps 9024.1 | wpb 1000 | bsz 1000 | num_updates 3280 | best_mrr 595.576 (progress_bar.py:269, print())
[2021-04-20 04:20:43]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/nbow/checkpoints/checkpoint_last.pt (epoch 20 @ 3280 updates, score 0.595576) (writing took 0.111881 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:20:55]    INFO >> epoch 021 | loss 0.803 | mrr 0.917426 | sample_size 1000 | wps 10937.4 | ups 10.94 | wpb 1000 | bsz 1000 | num_updates 3444 | lr 0.01 | gnorm 0.022 | clip 0 | train_wall 8 | wall 339 (progress_bar.py:269, print())
[2021-04-20 04:20:58]    INFO >> epoch 021 | valid on 'valid' subset | loss 1.014 | mrr 0.597696 | sample_size 1000 | wps 9216 | wpb 1000 | bsz 1000 | num_updates 3444 | best_mrr 597.696 (progress_bar.py:269, print())
[2021-04-20 04:20:58]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/nbow/checkpoints/checkpoint_last.pt (epoch 21 @ 3444 updates, score 0.597696) (writing took 0.120806 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:21:03]    INFO >> epoch 022:     57 / 165 loss=0.803, mrr=917.285, sample_size=1000, wps=10824.2, ups=10.82, wpb=1000, bsz=1000, num_updates=3500, lr=0.01, gnorm=0.021, clip=0, train_wall=26, wall=348 (progress_bar.py:262, log())
[2021-04-20 04:21:10]    INFO >> epoch 022 | loss 0.802 | mrr 0.918042 | sample_size 1000 | wps 11022.5 | ups 11.02 | wpb 1000 | bsz 1000 | num_updates 3608 | lr 0.01 | gnorm 0.022 | clip 0 | train_wall 8 | wall 354 (progress_bar.py:269, print())
[2021-04-20 04:21:13]    INFO >> epoch 022 | valid on 'valid' subset | loss 1.015 | mrr 0.595634 | sample_size 1000 | wps 8833.6 | wpb 1000 | bsz 1000 | num_updates 3608 | best_mrr 595.634 (progress_bar.py:269, print())
[2021-04-20 04:21:13]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/nbow/checkpoints/checkpoint_last.pt (epoch 22 @ 3608 updates, score 0.595634) (writing took 0.111668 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:21:13]    INFO >> early stop since valid performance hasn't improved for last 10 runs (train.py:191, should_stop_early())
[2021-04-20 04:21:13]    INFO >> early stop since valid performance hasn't improved for last 10 runs (train.py:272, single_main())
[2021-04-20 04:21:13]    INFO >> done training in 357.7 seconds (train.py:283, single_main())
