nohup: 忽略输入
[2021-04-20 04:15:22]    INFO >> Load arguments in /home/yanghe/Documents/naturalcc-dev/run/retrieval/nbow/config/csn_feng/go.yml (train.py:302, cli_main())
[2021-04-20 04:15:22]    INFO >> {'criterion': 'retrieval_cosine', 'optimizer': 'torch_adam', 'lr_scheduler': 'fixed', 'tokenizer': None, 'bpe': None, 'common': {'no_progress_bar': 0, 'log_interval': 500, 'log_format': 'simple', 'tensorboard_logdir': '', 'seed': 666, 'cpu': 0, 'fp16': 0, 'memory_efficient_fp16': 0, 'fp16_no_flatten_grads': 0, 'fp16_init_scale': 128, 'fp16_scale_window': None, 'fp16_scale_tolerance': 0.0, 'min_loss_scale': 0.0001, 'threshold_loss_scale': None, 'user_dir': None, 'empty_cache_freq': 0, 'all_gather_list_size': 16384, 'task': 'hybrid_retrieval'}, 'dataset': {'num_workers': 1, 'skip_invalid_size_inputs_valid_test': 0, 'max_tokens': None, 'max_sentences': 1000, 'code_max_tokens': 200, 'query_max_tokens': 30, 'required_batch_size_multiple': 8, 'dataset_impl': 'mmap', 'train_subset': 'train', 'valid_subset': 'valid', 'validate_interval': 1, 'fixed_validation_seed': None, 'disable_validation': None, 'max_tokens_valid': None, 'max_sentences_valid': 1000, 'curriculum': 0, 'gen_subset': 'test', 'num_shards': 1, 'shard_id': 0, 'joined_dictionary': 0, 'langs': ['go']}, 'distributed_training': {'distributed_world_size': 1, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': None, 'distributed_port': -1, 'device_id': 0, 'distributed_no_spawn': 0, 'ddp_backend': 'c10d', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': None, 'find_unused_parameters': 0, 'fast_stat_sync': 0, 'broadcast_buffers': 0, 'global_sync_iter': 50, 'warmup_iterations': 500, 'local_rank': -1, 'block_momentum': 0.875, 'block_lr': 1, 'use_nbm': 0, 'average_sync': 0}, 'task': {'data': '/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/', 'sample_break_mode': 'complete', 'tokens_per_sample': 512, 'mask_prob': 0.15, 'leave_unmasked_prob': 0.1, 'random_token_prob': 0.1, 'freq_weighted_replacement': 0, 'mask_whole_words': 0, 'pooler_activation_fn': 'tanh', 'source_lang': 'code_tokens', 'target_lang': 'docstring_tokens', 'source_aux_lang': 'code_tokens.wo_func', 'target_aux_lang': 'func_name', 'fraction_using_func_name': 0.3, 'load_alignments': 0, 'left_pad_source': 1, 'left_pad_target': 0, 'upsample_primary': 1, 'truncate_source': 0, 'eval_mrr': 1}, 'model': {'arch': 'nbow', 'code_embed_dim': 128, 'code_dropout': 0.1, 'code_pooling': 'weighted_mean', 'query_embed_dim': 128, 'query_dropout': 0.1, 'query_pooling': 'weighted_mean'}, 'optimization': {'max_epoch': 300, 'max_update': 0, 'clip_norm': 1, 'sentence_avg': 0, 'update_freq': [1], 'lrs': [0.01], 'min_lr': -1, 'use_bmuf': 0, 'lr_shrink': 1.0, 'force_anneal': 0, 'warmup_updates': 0, 'end_learning_rate': 0.0, 'power': 1.0, 'total_num_update': 1000000, 'adam': {'adam_betas': '(0.9, 0.999)', 'adam_eps': 1e-08, 'weight_decay': 0, 'use_old_adam': 1}, 'margin': 1}, 'checkpoint': {'save_dir': '/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/nbow/checkpoints', 'restore_file': 'checkpoint_last.pt', 'reset_dataloader': None, 'reset_lr_scheduler': None, 'reset_meters': None, 'reset_optimizer': None, 'optimizer_overrides': '{}', 'save_interval': 1, 'save_interval_updates': 0, 'keep_interval_updates': 0, 'keep_last_epochs': -1, 'keep_best_checkpoints': -1, 'no_save': 0, 'no_epoch_checkpoints': 1, 'no_last_checkpoints': 0, 'no_save_optimizer_state': None, 'best_checkpoint_metric': 'mrr', 'maximize_best_checkpoint_metric': 1, 'patience': 10}, 'eval': {'path': '/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/nbow/checkpoints/checkpoint_best.pt', 'quiet': 1, 'max_sentences': 1000, 'model_overrides': '{}', 'eval_size': -1}} (train.py:304, cli_main())
[2021-04-20 04:15:22]    INFO >> single GPU training... (train.py:333, cli_main())
[2021-04-20 04:15:22]    INFO >> loaded 7325 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/valid.go.code_tokens'] (hybrid_retrieval.py:54, load_tokens_dataset())
[2021-04-20 04:15:22]    INFO >> loaded 7325 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/valid.go.docstring_tokens'] (hybrid_retrieval.py:55, load_tokens_dataset())
[2021-04-20 04:15:23]    INFO >> NBOW(
  (src_encoders): ModuleDict(
    (go): NBOWEncoder(
      (embed): Embedding(10000, 128, padding_idx=0)
      (weight_layer): Linear(in_features=128, out_features=1, bias=False)
    )
  )
  (tgt_encoders): NBOWEncoder(
    (embed): Embedding(10000, 128, padding_idx=0)
    (weight_layer): Linear(in_features=128, out_features=1, bias=False)
  )
) (train.py:223, single_main())
[2021-04-20 04:15:23]    INFO >> model nbow, criterion SearchCosineCriterion (train.py:224, single_main())
[2021-04-20 04:15:23]    INFO >> num. model params: 2560256 (num. trained: 2560256) (train.py:227, single_main())
[2021-04-20 04:15:27]    INFO >> training on 1 GPUs (train.py:233, single_main())
[2021-04-20 04:15:27]    INFO >> max tokens per GPU = None and max sentences per GPU = 1000 (train.py:236, single_main())
[2021-04-20 04:15:27]    INFO >> no existing checkpoint found /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/nbow/checkpoints/checkpoint_last.pt (ncc_trainers.py:270, load_checkpoint())
[2021-04-20 04:15:27]    INFO >> loading train data for epoch 1 (ncc_trainers.py:285, get_train_iterator())
[2021-04-20 04:15:27]    INFO >> loaded 167288 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.go.code_tokens'] (hybrid_retrieval.py:54, load_tokens_dataset())
[2021-04-20 04:15:27]    INFO >> loaded 167288 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.go.docstring_tokens'] (hybrid_retrieval.py:55, load_tokens_dataset())
[2021-04-20 04:15:27]    INFO >> loaded 167288 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.go.code_tokens.wo_func'] (hybrid_retrieval.py:67, load_tokens_dataset())
[2021-04-20 04:15:27]    INFO >> loaded 167288 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.go.func_name'] (hybrid_retrieval.py:81, load_tokens_dataset())
[2021-04-20 04:15:27]    INFO >> NOTE: your device may support faster training with fp16 (ncc_trainers.py:155, _setup_optimizer())
/home/yanghe/Documents/naturalcc-dev/ncc/utils/gradient_clip/fairseq_clip.py:57: UserWarning: amp_C fused kernels unavailable, disabling multi_tensor_l2norm; you may get better performance by installing NVIDIA's apex library
  "amp_C fused kernels unavailable, disabling multi_tensor_l2norm; "
[2021-04-20 04:15:41]    INFO >> epoch 001 | loss 1.005 | mrr 0.390405 | sample_size 1000 | wps 14981.6 | ups 14.98 | wpb 1000 | bsz 1000 | num_updates 167 | lr 0.01 | gnorm 0.022 | clip 0.6 | train_wall 10 | wall 14 (progress_bar.py:269, print())
[2021-04-20 04:15:44]    INFO >> epoch 001 | valid on 'valid' subset | loss 1.002 | mrr 0.51781 | sample_size 1000 | wps 11148.9 | wpb 1000 | bsz 1000 | num_updates 167 (progress_bar.py:269, print())
[2021-04-20 04:15:44]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/nbow/checkpoints/checkpoint_best.pt (epoch 1 @ 167 updates, score 0.51781) (writing took 0.225053 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:15:57]    INFO >> epoch 002 | loss 0.931 | mrr 0.758046 | sample_size 1000 | wps 10823.9 | ups 10.82 | wpb 1000 | bsz 1000 | num_updates 334 | lr 0.01 | gnorm 0.026 | clip 0 | train_wall 8 | wall 30 (progress_bar.py:269, print())
[2021-04-20 04:16:00]    INFO >> epoch 002 | valid on 'valid' subset | loss 0.99 | mrr 0.682397 | sample_size 1000 | wps 11053.2 | wpb 1000 | bsz 1000 | num_updates 334 | best_mrr 682.397 (progress_bar.py:269, print())
[2021-04-20 04:16:00]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/nbow/checkpoints/checkpoint_best.pt (epoch 2 @ 334 updates, score 0.682397) (writing took 0.231681 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:16:13]    INFO >> epoch 003:    167 / 168 loss=0.926, mrr=676.27, sample_size=1000, wps=11650.6, ups=11.65, wpb=1000, bsz=1000, num_updates=500, lr=0.01, gnorm=0.024, clip=0.2, train_wall=28, wall=46 (progress_bar.py:262, log())
[2021-04-20 04:16:14]    INFO >> epoch 003 | loss 0.84 | mrr 0.881607 | sample_size 1000 | wps 10030.3 | ups 10.03 | wpb 1000 | bsz 1000 | num_updates 501 | lr 0.01 | gnorm 0.024 | clip 0 | train_wall 10 | wall 46 (progress_bar.py:269, print())
[2021-04-20 04:16:16]    INFO >> epoch 003 | valid on 'valid' subset | loss 0.982 | mrr 0.703614 | sample_size 1000 | wps 10669.5 | wpb 1000 | bsz 1000 | num_updates 501 | best_mrr 703.614 (progress_bar.py:269, print())
[2021-04-20 04:16:17]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/nbow/checkpoints/checkpoint_best.pt (epoch 3 @ 501 updates, score 0.703614) (writing took 0.322952 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:16:31]    INFO >> epoch 004 | loss 0.81 | mrr 0.910627 | sample_size 1000 | wps 9581.8 | ups 9.58 | wpb 1000 | bsz 1000 | num_updates 668 | lr 0.01 | gnorm 0.022 | clip 0 | train_wall 11 | wall 64 (progress_bar.py:269, print())
[2021-04-20 04:16:34]    INFO >> epoch 004 | valid on 'valid' subset | loss 0.98 | mrr 0.706654 | sample_size 1000 | wps 10346.6 | wpb 1000 | bsz 1000 | num_updates 668 | best_mrr 706.654 (progress_bar.py:269, print())
[2021-04-20 04:16:34]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/nbow/checkpoints/checkpoint_best.pt (epoch 4 @ 668 updates, score 0.706654) (writing took 0.263661 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:16:48]    INFO >> epoch 005 | loss 0.793 | mrr 0.923745 | sample_size 1000 | wps 9961.7 | ups 9.96 | wpb 1000 | bsz 1000 | num_updates 835 | lr 0.01 | gnorm 0.021 | clip 0 | train_wall 9 | wall 81 (progress_bar.py:269, print())
[2021-04-20 04:16:51]    INFO >> epoch 005 | valid on 'valid' subset | loss 0.979 | mrr 0.707527 | sample_size 1000 | wps 10743.2 | wpb 1000 | bsz 1000 | num_updates 835 | best_mrr 707.527 (progress_bar.py:269, print())
[2021-04-20 04:16:51]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/nbow/checkpoints/checkpoint_best.pt (epoch 5 @ 835 updates, score 0.707527) (writing took 0.282669 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:17:03]    INFO >> epoch 006:    166 / 168 loss=0.795, mrr=921.78, sample_size=1000, wps=10002.2, ups=10, wpb=1000, bsz=1000, num_updates=1000, lr=0.01, gnorm=0.021, clip=0, train_wall=28, wall=96 (progress_bar.py:262, log())
[2021-04-20 04:17:04]    INFO >> epoch 006 | loss 0.782 | mrr 0.931268 | sample_size 1000 | wps 10506.4 | ups 10.51 | wpb 1000 | bsz 1000 | num_updates 1002 | lr 0.01 | gnorm 0.02 | clip 0 | train_wall 8 | wall 96 (progress_bar.py:269, print())
[2021-04-20 04:17:07]    INFO >> epoch 006 | valid on 'valid' subset | loss 0.979 | mrr 0.706795 | sample_size 1000 | wps 10337 | wpb 1000 | bsz 1000 | num_updates 1002 | best_mrr 706.795 (progress_bar.py:269, print())
[2021-04-20 04:17:07]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/nbow/checkpoints/checkpoint_last.pt (epoch 6 @ 1002 updates, score 0.706795) (writing took 0.160803 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:17:21]    INFO >> epoch 007 | loss 0.775 | mrr 0.935375 | sample_size 1000 | wps 9691.7 | ups 9.69 | wpb 1000 | bsz 1000 | num_updates 1169 | lr 0.01 | gnorm 0.02 | clip 0 | train_wall 10 | wall 114 (progress_bar.py:269, print())
[2021-04-20 04:17:24]    INFO >> epoch 007 | valid on 'valid' subset | loss 0.978 | mrr 0.706036 | sample_size 1000 | wps 10842 | wpb 1000 | bsz 1000 | num_updates 1169 | best_mrr 706.036 (progress_bar.py:269, print())
[2021-04-20 04:17:24]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/nbow/checkpoints/checkpoint_last.pt (epoch 7 @ 1169 updates, score 0.706036) (writing took 0.125698 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:17:38]    INFO >> epoch 008 | loss 0.769 | mrr 0.939819 | sample_size 1000 | wps 9495 | ups 9.49 | wpb 1000 | bsz 1000 | num_updates 1336 | lr 0.01 | gnorm 0.02 | clip 0 | train_wall 11 | wall 131 (progress_bar.py:269, print())
[2021-04-20 04:17:41]    INFO >> epoch 008 | valid on 'valid' subset | loss 0.979 | mrr 0.709251 | sample_size 1000 | wps 10528.8 | wpb 1000 | bsz 1000 | num_updates 1336 | best_mrr 709.251 (progress_bar.py:269, print())
[2021-04-20 04:17:42]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/nbow/checkpoints/checkpoint_best.pt (epoch 8 @ 1336 updates, score 0.709251) (writing took 0.261038 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:17:55]    INFO >> epoch 009:    164 / 168 loss=0.77, mrr=939.033, sample_size=1000, wps=9662.8, ups=9.66, wpb=1000, bsz=1000, num_updates=1500, lr=0.01, gnorm=0.02, clip=0, train_wall=30, wall=148 (progress_bar.py:262, log())
[2021-04-20 04:17:55]    INFO >> epoch 009 | loss 0.764 | mrr 0.941917 | sample_size 1000 | wps 9838.6 | ups 9.84 | wpb 1000 | bsz 1000 | num_updates 1503 | lr 0.01 | gnorm 0.02 | clip 0 | train_wall 9 | wall 148 (progress_bar.py:269, print())
[2021-04-20 04:17:58]    INFO >> epoch 009 | valid on 'valid' subset | loss 0.978 | mrr 0.709349 | sample_size 1000 | wps 10532.2 | wpb 1000 | bsz 1000 | num_updates 1503 | best_mrr 709.349 (progress_bar.py:269, print())
[2021-04-20 04:17:59]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/nbow/checkpoints/checkpoint_best.pt (epoch 9 @ 1503 updates, score 0.709349) (writing took 0.222955 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:18:11]    INFO >> epoch 010 | loss 0.761 | mrr 0.944512 | sample_size 1000 | wps 10708.5 | ups 10.71 | wpb 1000 | bsz 1000 | num_updates 1670 | lr 0.01 | gnorm 0.02 | clip 0 | train_wall 8 | wall 164 (progress_bar.py:269, print())
[2021-04-20 04:18:14]    INFO >> epoch 010 | valid on 'valid' subset | loss 0.979 | mrr 0.705625 | sample_size 1000 | wps 10386.2 | wpb 1000 | bsz 1000 | num_updates 1670 | best_mrr 705.625 (progress_bar.py:269, print())
[2021-04-20 04:18:14]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/nbow/checkpoints/checkpoint_last.pt (epoch 10 @ 1670 updates, score 0.705625) (writing took 0.150303 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:18:28]    INFO >> epoch 011 | loss 0.758 | mrr 0.945802 | sample_size 1000 | wps 9706.8 | ups 9.71 | wpb 1000 | bsz 1000 | num_updates 1837 | lr 0.01 | gnorm 0.02 | clip 0 | train_wall 11 | wall 181 (progress_bar.py:269, print())
[2021-04-20 04:18:31]    INFO >> epoch 011 | valid on 'valid' subset | loss 0.978 | mrr 0.708728 | sample_size 1000 | wps 9498.6 | wpb 1000 | bsz 1000 | num_updates 1837 | best_mrr 708.728 (progress_bar.py:269, print())
[2021-04-20 04:18:31]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/nbow/checkpoints/checkpoint_last.pt (epoch 11 @ 1837 updates, score 0.708728) (writing took 0.119133 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:18:45]    INFO >> epoch 012:    164 / 168 loss=0.758, mrr=945.55, sample_size=1000, wps=9950.6, ups=9.95, wpb=1000, bsz=1000, num_updates=2000, lr=0.01, gnorm=0.02, clip=0, train_wall=30, wall=198 (progress_bar.py:262, log())
[2021-04-20 04:18:46]    INFO >> epoch 012 | loss 0.756 | mrr 0.946498 | sample_size 1000 | wps 9552.5 | ups 9.55 | wpb 1000 | bsz 1000 | num_updates 2004 | lr 0.01 | gnorm 0.02 | clip 0 | train_wall 11 | wall 199 (progress_bar.py:269, print())
[2021-04-20 04:18:49]    INFO >> epoch 012 | valid on 'valid' subset | loss 0.979 | mrr 0.706896 | sample_size 1000 | wps 9387.3 | wpb 1000 | bsz 1000 | num_updates 2004 | best_mrr 706.896 (progress_bar.py:269, print())
[2021-04-20 04:18:49]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/nbow/checkpoints/checkpoint_last.pt (epoch 12 @ 2004 updates, score 0.706896) (writing took 0.179086 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:19:02]    INFO >> epoch 013 | loss 0.753 | mrr 0.947946 | sample_size 1000 | wps 10323.1 | ups 10.32 | wpb 1000 | bsz 1000 | num_updates 2171 | lr 0.01 | gnorm 0.02 | clip 0 | train_wall 9 | wall 215 (progress_bar.py:269, print())
[2021-04-20 04:19:05]    INFO >> epoch 013 | valid on 'valid' subset | loss 0.979 | mrr 0.706012 | sample_size 1000 | wps 10327.5 | wpb 1000 | bsz 1000 | num_updates 2171 | best_mrr 706.012 (progress_bar.py:269, print())
[2021-04-20 04:19:05]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/nbow/checkpoints/checkpoint_last.pt (epoch 13 @ 2171 updates, score 0.706012) (writing took 0.125713 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:19:17]    INFO >> epoch 014 | loss 0.751 | mrr 0.949764 | sample_size 1000 | wps 10790.7 | ups 10.79 | wpb 1000 | bsz 1000 | num_updates 2338 | lr 0.01 | gnorm 0.02 | clip 0 | train_wall 8 | wall 230 (progress_bar.py:269, print())
[2021-04-20 04:19:20]    INFO >> epoch 014 | valid on 'valid' subset | loss 0.979 | mrr 0.706132 | sample_size 1000 | wps 10153.5 | wpb 1000 | bsz 1000 | num_updates 2338 | best_mrr 706.132 (progress_bar.py:269, print())
[2021-04-20 04:19:20]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/nbow/checkpoints/checkpoint_last.pt (epoch 14 @ 2338 updates, score 0.706132) (writing took 0.137680 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:19:34]    INFO >> epoch 015:    163 / 168 loss=0.751, mrr=949.374, sample_size=1000, wps=10337.8, ups=10.34, wpb=1000, bsz=1000, num_updates=2500, lr=0.01, gnorm=0.02, clip=0, train_wall=27, wall=246 (progress_bar.py:262, log())
[2021-04-20 04:19:34]    INFO >> epoch 015 | loss 0.749 | mrr 0.950409 | sample_size 1000 | wps 10022.4 | ups 10.02 | wpb 1000 | bsz 1000 | num_updates 2505 | lr 0.01 | gnorm 0.02 | clip 0 | train_wall 10 | wall 247 (progress_bar.py:269, print())
[2021-04-20 04:19:37]    INFO >> epoch 015 | valid on 'valid' subset | loss 0.979 | mrr 0.705263 | sample_size 1000 | wps 10449.2 | wpb 1000 | bsz 1000 | num_updates 2505 | best_mrr 705.263 (progress_bar.py:269, print())
[2021-04-20 04:19:37]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/nbow/checkpoints/checkpoint_last.pt (epoch 15 @ 2505 updates, score 0.705263) (writing took 0.226301 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:19:51]    INFO >> epoch 016 | loss 0.748 | mrr 0.951049 | sample_size 1000 | wps 9967.1 | ups 9.97 | wpb 1000 | bsz 1000 | num_updates 2672 | lr 0.01 | gnorm 0.02 | clip 0 | train_wall 10 | wall 264 (progress_bar.py:269, print())
[2021-04-20 04:19:54]    INFO >> epoch 016 | valid on 'valid' subset | loss 0.979 | mrr 0.705698 | sample_size 1000 | wps 10195.2 | wpb 1000 | bsz 1000 | num_updates 2672 | best_mrr 705.698 (progress_bar.py:269, print())
[2021-04-20 04:19:54]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/nbow/checkpoints/checkpoint_last.pt (epoch 16 @ 2672 updates, score 0.705698) (writing took 0.153152 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:20:07]    INFO >> epoch 017 | loss 0.746 | mrr 0.951412 | sample_size 1000 | wps 10450 | ups 10.45 | wpb 1000 | bsz 1000 | num_updates 2839 | lr 0.01 | gnorm 0.02 | clip 0 | train_wall 9 | wall 280 (progress_bar.py:269, print())
[2021-04-20 04:20:11]    INFO >> epoch 017 | valid on 'valid' subset | loss 0.979 | mrr 0.705707 | sample_size 1000 | wps 9844.3 | wpb 1000 | bsz 1000 | num_updates 2839 | best_mrr 705.707 (progress_bar.py:269, print())
[2021-04-20 04:20:11]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/nbow/checkpoints/checkpoint_last.pt (epoch 17 @ 2839 updates, score 0.705707) (writing took 0.135245 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:20:23]    INFO >> epoch 018:    162 / 168 loss=0.746, mrr=951.525, sample_size=1000, wps=10207.1, ups=10.21, wpb=1000, bsz=1000, num_updates=3000, lr=0.01, gnorm=0.02, clip=0, train_wall=28, wall=295 (progress_bar.py:262, log())
[2021-04-20 04:20:23]    INFO >> epoch 018 | loss 0.745 | mrr 0.952096 | sample_size 1000 | wps 10188.3 | ups 10.19 | wpb 1000 | bsz 1000 | num_updates 3006 | lr 0.01 | gnorm 0.02 | clip 0 | train_wall 9 | wall 296 (progress_bar.py:269, print())
[2021-04-20 04:20:26]    INFO >> epoch 018 | valid on 'valid' subset | loss 0.98 | mrr 0.703892 | sample_size 1000 | wps 9885.7 | wpb 1000 | bsz 1000 | num_updates 3006 | best_mrr 703.892 (progress_bar.py:269, print())
[2021-04-20 04:20:26]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/nbow/checkpoints/checkpoint_last.pt (epoch 18 @ 3006 updates, score 0.703892) (writing took 0.182695 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:20:39]    INFO >> epoch 019 | loss 0.744 | mrr 0.952834 | sample_size 1000 | wps 10265.1 | ups 10.27 | wpb 1000 | bsz 1000 | num_updates 3173 | lr 0.01 | gnorm 0.02 | clip 0 | train_wall 10 | wall 312 (progress_bar.py:269, print())
[2021-04-20 04:20:42]    INFO >> epoch 019 | valid on 'valid' subset | loss 0.98 | mrr 0.702777 | sample_size 1000 | wps 10389.2 | wpb 1000 | bsz 1000 | num_updates 3173 | best_mrr 702.777 (progress_bar.py:269, print())
[2021-04-20 04:20:42]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/nbow/checkpoints/checkpoint_last.pt (epoch 19 @ 3173 updates, score 0.702777) (writing took 0.128830 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 04:20:42]    INFO >> early stop since valid performance hasn't improved for last 10 runs (train.py:191, should_stop_early())
[2021-04-20 04:20:42]    INFO >> early stop since valid performance hasn't improved for last 10 runs (train.py:272, single_main())
[2021-04-20 04:20:42]    INFO >> done training in 315.0 seconds (train.py:283, single_main())
