nohup: 忽略输入
[2021-04-20 20:47:35]    INFO >> Load arguments in /home/yanghe/Documents/naturalcc-dev/run/retrieval/selfattn/config/csn_feng/javascript.yml (train.py:302, cli_main())
[2021-04-20 20:47:35]    INFO >> {'criterion': 'retrieval_softmax', 'optimizer': 'torch_adam', 'lr_scheduler': 'fixed', 'tokenizer': None, 'bpe': None, 'common': {'no_progress_bar': 0, 'log_interval': 1000, 'log_format': 'simple', 'tensorboard_logdir': '', 'seed': 0, 'cpu': 0, 'fp16': 0, 'memory_efficient_fp16': 0, 'fp16_no_flatten_grads': 0, 'fp16_init_scale': 128, 'fp16_scale_window': None, 'fp16_scale_tolerance': 0.0, 'min_loss_scale': 0.0001, 'threshold_loss_scale': None, 'user_dir': None, 'empty_cache_freq': 0, 'all_gather_list_size': 16384, 'task': 'hybrid_retrieval'}, 'dataset': {'num_workers': 3, 'skip_invalid_size_inputs_valid_test': 0, 'max_tokens': None, 'max_sentences': 450, 'code_max_tokens': 200, 'query_max_tokens': 30, 'required_batch_size_multiple': 1, 'dataset_impl': 'mmap', 'train_subset': 'train', 'valid_subset': 'valid', 'validate_interval': 1, 'fixed_validation_seed': None, 'disable_validation': None, 'max_tokens_valid': None, 'max_sentences_valid': 1000, 'curriculum': 0, 'gen_subset': 'test', 'num_shards': 1, 'shard_id': 0, 'joined_dictionary': 0, 'langs': ['javascript']}, 'distributed_training': {'distributed_world_size': 1, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': None, 'distributed_port': -1, 'device_id': 0, 'distributed_no_spawn': 0, 'ddp_backend': 'c10d', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': None, 'find_unused_parameters': 0, 'fast_stat_sync': 0, 'broadcast_buffers': 0, 'global_sync_iter': 50, 'warmup_iterations': 500, 'local_rank': -1, 'block_momentum': 0.875, 'block_lr': 1, 'use_nbm': 0, 'average_sync': 0}, 'task': {'data': '/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all', 'sample_break_mode': 'complete', 'tokens_per_sample': 512, 'mask_prob': 0.15, 'leave_unmasked_prob': 0.1, 'random_token_prob': 0.1, 'freq_weighted_replacement': 0, 'mask_whole_words': 0, 'pooler_activation_fn': 'tanh', 'source_lang': 'code_tokens', 'target_lang': 'docstring_tokens', 'source_aux_lang': 'code_tokens.wo_func', 'target_aux_lang': 'func_name', 'fraction_using_func_name': 0.3, 'load_alignments': 0, 'left_pad_source': 1, 'left_pad_target': 0, 'upsample_primary': 1, 'truncate_source': 0, 'eval_mrr': 1}, 'model': {'arch': 'self_attn', 'code_embed_dim': 128, 'code_token_types': 1, 'code_max_tokens': 200, 'code_position_encoding': 'learned', 'code_dropout': 0.1, 'code_pooling': 'weighted_mean', 'query_embed_dim': 128, 'query_token_types': 1, 'query_max_tokens': 30, 'query_self_attn_layers': 3, 'query_pooling': 'weighted_mean', 'query_position_encoding': 'learned', 'query_dropout': 0.1, 'self_attn_layers': 3, 'attention_heads': 8, 'ffn_embed_dim': 512, 'activation_fn': 'gelu'}, 'optimization': {'max_epoch': 300, 'max_update': 0, 'clip_norm': 1, 'sentence_avg': 0, 'update_freq': [1], 'lrs': [0.0005], 'min_lr': -1, 'use_bmuf': 0, 'lr_shrink': 1.0, 'force_anneal': 0, 'warmup_updates': 0, 'end_learning_rate': 0.0, 'power': 1.0, 'total_num_update': 1000000, 'adam': {'adam_betas': '(0.9, 0.999)', 'adam_eps': 1e-08, 'weight_decay': 0, 'use_old_adam': 1}, 'margin': 1, 'clip_norm_version': 'tf_clip_by_global_norm'}, 'checkpoint': {'save_dir': '/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/javascript/self_attn/checkpoints', 'restore_file': 'checkpoint_last.pt', 'reset_dataloader': None, 'reset_lr_scheduler': None, 'reset_meters': None, 'reset_optimizer': None, 'optimizer_overrides': '{}', 'save_interval': 1, 'save_interval_updates': 0, 'keep_interval_updates': 0, 'keep_last_epochs': -1, 'keep_best_checkpoints': -1, 'no_save': 0, 'no_epoch_checkpoints': 1, 'no_last_checkpoints': 0, 'no_save_optimizer_state': None, 'best_checkpoint_metric': 'mrr', 'maximize_best_checkpoint_metric': 1, 'patience': 10}, 'eval': {'path': '/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/javascript/self_attn/checkpoints/checkpoint_best.pt', 'quiet': 1, 'max_sentences': 450, 'model_overrides': '{}', 'eval_size': -1}} (train.py:304, cli_main())
[2021-04-20 20:47:35]    INFO >> single GPU training... (train.py:333, cli_main())
[2021-04-20 20:47:35]    INFO >> loaded 3885 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/valid.javascript.code_tokens'] (hybrid_retrieval.py:54, load_tokens_dataset())
[2021-04-20 20:47:35]    INFO >> loaded 3885 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/valid.javascript.docstring_tokens'] (hybrid_retrieval.py:55, load_tokens_dataset())
[2021-04-20 20:47:36]    INFO >> SelfAttn(
  (src_encoders): ModuleDict(
    (javascript): SelfAttnEncoder(
      (embed): Embedding(10000, 128, padding_idx=0)
      (type_embed): Embedding(1, 128)
      (embed_layer_norm): LayerNorm((128,), eps=1e-08, elementwise_affine=True)
      (layers): ModuleList(
        (0): TransformerEncoderLayer(
          (self_attn): MultiheadAttention(
            (k_proj): Linear(in_features=128, out_features=128, bias=True)
            (v_proj): Linear(in_features=128, out_features=128, bias=True)
            (q_proj): Linear(in_features=128, out_features=128, bias=True)
            (out_proj): Linear(in_features=128, out_features=128, bias=True)
          )
          (self_attn_layer_norm): LayerNorm((128,), eps=1e-08, elementwise_affine=True)
          (fc1): Linear(in_features=128, out_features=512, bias=True)
          (fc2): Linear(in_features=512, out_features=128, bias=True)
          (ff_layer_norm): LayerNorm((128,), eps=1e-08, elementwise_affine=True)
        )
        (1): TransformerEncoderLayer(
          (self_attn): MultiheadAttention(
            (k_proj): Linear(in_features=128, out_features=128, bias=True)
            (v_proj): Linear(in_features=128, out_features=128, bias=True)
            (q_proj): Linear(in_features=128, out_features=128, bias=True)
            (out_proj): Linear(in_features=128, out_features=128, bias=True)
          )
          (self_attn_layer_norm): LayerNorm((128,), eps=1e-08, elementwise_affine=True)
          (fc1): Linear(in_features=128, out_features=512, bias=True)
          (fc2): Linear(in_features=512, out_features=128, bias=True)
          (ff_layer_norm): LayerNorm((128,), eps=1e-08, elementwise_affine=True)
        )
        (2): TransformerEncoderLayer(
          (self_attn): MultiheadAttention(
            (k_proj): Linear(in_features=128, out_features=128, bias=True)
            (v_proj): Linear(in_features=128, out_features=128, bias=True)
            (q_proj): Linear(in_features=128, out_features=128, bias=True)
            (out_proj): Linear(in_features=128, out_features=128, bias=True)
          )
          (self_attn_layer_norm): LayerNorm((128,), eps=1e-08, elementwise_affine=True)
          (fc1): Linear(in_features=128, out_features=512, bias=True)
          (fc2): Linear(in_features=512, out_features=128, bias=True)
          (ff_layer_norm): LayerNorm((128,), eps=1e-08, elementwise_affine=True)
        )
      )
      (weight_layer): Linear(in_features=128, out_features=1, bias=False)
    )
  )
  (tgt_encoders): SelfAttnEncoder(
    (embed): Embedding(10000, 128, padding_idx=0)
    (type_embed): Embedding(1, 128)
    (embed_layer_norm): LayerNorm((128,), eps=1e-08, elementwise_affine=True)
    (layers): ModuleList(
      (0): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (k_proj): Linear(in_features=128, out_features=128, bias=True)
          (v_proj): Linear(in_features=128, out_features=128, bias=True)
          (q_proj): Linear(in_features=128, out_features=128, bias=True)
          (out_proj): Linear(in_features=128, out_features=128, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((128,), eps=1e-08, elementwise_affine=True)
        (fc1): Linear(in_features=128, out_features=512, bias=True)
        (fc2): Linear(in_features=512, out_features=128, bias=True)
        (ff_layer_norm): LayerNorm((128,), eps=1e-08, elementwise_affine=True)
      )
      (1): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (k_proj): Linear(in_features=128, out_features=128, bias=True)
          (v_proj): Linear(in_features=128, out_features=128, bias=True)
          (q_proj): Linear(in_features=128, out_features=128, bias=True)
          (out_proj): Linear(in_features=128, out_features=128, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((128,), eps=1e-08, elementwise_affine=True)
        (fc1): Linear(in_features=128, out_features=512, bias=True)
        (fc2): Linear(in_features=512, out_features=128, bias=True)
        (ff_layer_norm): LayerNorm((128,), eps=1e-08, elementwise_affine=True)
      )
      (2): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (k_proj): Linear(in_features=128, out_features=128, bias=True)
          (v_proj): Linear(in_features=128, out_features=128, bias=True)
          (q_proj): Linear(in_features=128, out_features=128, bias=True)
          (out_proj): Linear(in_features=128, out_features=128, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((128,), eps=1e-08, elementwise_affine=True)
        (fc1): Linear(in_features=128, out_features=512, bias=True)
        (fc2): Linear(in_features=512, out_features=128, bias=True)
        (ff_layer_norm): LayerNorm((128,), eps=1e-08, elementwise_affine=True)
      )
    )
    (weight_layer): Linear(in_features=128, out_features=1, bias=False)
  )
) (train.py:223, single_main())
[2021-04-20 20:47:36]    INFO >> model self_attn, criterion SearchSoftmaxCriterion (train.py:224, single_main())
[2021-04-20 20:47:36]    INFO >> num. model params: 3780096 (num. trained: 3780096) (train.py:227, single_main())
[2021-04-20 20:47:38]    INFO >> training on 1 GPUs (train.py:233, single_main())
[2021-04-20 20:47:38]    INFO >> max tokens per GPU = None and max sentences per GPU = 450 (train.py:236, single_main())
[2021-04-20 20:47:38]    INFO >> no existing checkpoint found /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/javascript/self_attn/checkpoints/checkpoint_last.pt (ncc_trainers.py:270, load_checkpoint())
[2021-04-20 20:47:38]    INFO >> loading train data for epoch 1 (ncc_trainers.py:285, get_train_iterator())
[2021-04-20 20:47:38]    INFO >> loaded 58025 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.javascript.code_tokens'] (hybrid_retrieval.py:54, load_tokens_dataset())
[2021-04-20 20:47:38]    INFO >> loaded 58025 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.javascript.docstring_tokens'] (hybrid_retrieval.py:55, load_tokens_dataset())
[2021-04-20 20:47:38]    INFO >> loaded 58025 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.javascript.code_tokens.wo_func'] (hybrid_retrieval.py:67, load_tokens_dataset())
[2021-04-20 20:47:38]    INFO >> loaded 58025 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.javascript.func_name'] (hybrid_retrieval.py:81, load_tokens_dataset())
[2021-04-20 20:47:38]    INFO >> NOTE: your device may support faster training with fp16 (ncc_trainers.py:155, _setup_optimizer())
[2021-04-20 20:48:24]    INFO >> epoch 001 | loss 5.3 | mrr 0.117779 | sample_size 450 | wps 1477.3 | ups 3.28 | wpb 450 | bsz 450 | num_updates 128 | lr 0.0005 | gnorm 3.821 | clip 88.3 | train_wall 39 | wall 46 (progress_bar.py:269, print())
[2021-04-20 20:48:31]    INFO >> epoch 001 | valid on 'valid' subset | loss 5.213 | mrr 0.163424 | sample_size 1000 | wps 3016.7 | wpb 1000 | bsz 1000 | num_updates 128 (progress_bar.py:269, print())
[2021-04-20 20:48:32]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/javascript/self_attn/checkpoints/checkpoint_best.pt (epoch 1 @ 128 updates, score 0.163424) (writing took 0.924447 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 20:49:18]    INFO >> epoch 002 | loss 3.26 | mrr 0.427064 | sample_size 450 | wps 1061.9 | ups 2.36 | wpb 450 | bsz 450 | num_updates 256 | lr 0.0005 | gnorm 7.843 | clip 100 | train_wall 38 | wall 100 (progress_bar.py:269, print())
[2021-04-20 20:49:25]    INFO >> epoch 002 | valid on 'valid' subset | loss 4.11 | mrr 0.334205 | sample_size 1000 | wps 3038.2 | wpb 1000 | bsz 1000 | num_updates 256 | best_mrr 334.205 (progress_bar.py:269, print())
[2021-04-20 20:49:26]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/javascript/self_attn/checkpoints/checkpoint_best.pt (epoch 2 @ 256 updates, score 0.334205) (writing took 0.785946 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 20:50:12]    INFO >> epoch 003 | loss 1.968 | mrr 0.658633 | sample_size 450 | wps 1065.4 | ups 2.37 | wpb 450 | bsz 450 | num_updates 384 | lr 0.0005 | gnorm 8.579 | clip 100 | train_wall 38 | wall 154 (progress_bar.py:269, print())
[2021-04-20 20:50:19]    INFO >> epoch 003 | valid on 'valid' subset | loss 3.84 | mrr 0.387106 | sample_size 1000 | wps 3002 | wpb 1000 | bsz 1000 | num_updates 384 | best_mrr 387.106 (progress_bar.py:269, print())
[2021-04-20 20:50:20]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/javascript/self_attn/checkpoints/checkpoint_best.pt (epoch 3 @ 384 updates, score 0.387106) (writing took 0.833766 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 20:51:05]    INFO >> epoch 004 | loss 1.224 | mrr 0.7921 | sample_size 450 | wps 1080.8 | ups 2.4 | wpb 450 | bsz 450 | num_updates 512 | lr 0.0005 | gnorm 7.965 | clip 100 | train_wall 38 | wall 207 (progress_bar.py:269, print())
[2021-04-20 20:51:13]    INFO >> epoch 004 | valid on 'valid' subset | loss 3.876 | mrr 0.411518 | sample_size 1000 | wps 2848.4 | wpb 1000 | bsz 1000 | num_updates 512 | best_mrr 411.518 (progress_bar.py:269, print())
[2021-04-20 20:51:14]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/javascript/self_attn/checkpoints/checkpoint_best.pt (epoch 4 @ 512 updates, score 0.411518) (writing took 0.951656 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 20:52:00]    INFO >> epoch 005 | loss 0.767 | mrr 0.872751 | sample_size 450 | wps 1055.6 | ups 2.35 | wpb 450 | bsz 450 | num_updates 640 | lr 0.0005 | gnorm 7.391 | clip 100 | train_wall 38 | wall 262 (progress_bar.py:269, print())
[2021-04-20 20:52:07]    INFO >> epoch 005 | valid on 'valid' subset | loss 4.064 | mrr 0.430458 | sample_size 1000 | wps 2984.6 | wpb 1000 | bsz 1000 | num_updates 640 | best_mrr 430.458 (progress_bar.py:269, print())
[2021-04-20 20:52:08]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/javascript/self_attn/checkpoints/checkpoint_best.pt (epoch 5 @ 640 updates, score 0.430458) (writing took 0.788287 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 20:52:54]    INFO >> epoch 006 | loss 0.518 | mrr 0.915699 | sample_size 450 | wps 1062.5 | ups 2.36 | wpb 450 | bsz 450 | num_updates 768 | lr 0.0005 | gnorm 6.77 | clip 100 | train_wall 38 | wall 316 (progress_bar.py:269, print())
[2021-04-20 20:53:01]    INFO >> epoch 006 | valid on 'valid' subset | loss 4.397 | mrr 0.427636 | sample_size 1000 | wps 3021 | wpb 1000 | bsz 1000 | num_updates 768 | best_mrr 427.636 (progress_bar.py:269, print())
[2021-04-20 20:53:02]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/javascript/self_attn/checkpoints/checkpoint_last.pt (epoch 6 @ 768 updates, score 0.427636) (writing took 0.476796 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 20:53:47]    INFO >> epoch 007 | loss 0.379 | mrr 0.939405 | sample_size 450 | wps 1086.7 | ups 2.41 | wpb 450 | bsz 450 | num_updates 896 | lr 0.0005 | gnorm 5.982 | clip 100 | train_wall 38 | wall 369 (progress_bar.py:269, print())
[2021-04-20 20:53:55]    INFO >> epoch 007 | valid on 'valid' subset | loss 4.544 | mrr 0.431393 | sample_size 1000 | wps 3028.3 | wpb 1000 | bsz 1000 | num_updates 896 | best_mrr 431.393 (progress_bar.py:269, print())
[2021-04-20 20:53:56]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/javascript/self_attn/checkpoints/checkpoint_best.pt (epoch 7 @ 896 updates, score 0.431393) (writing took 0.743912 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 20:54:33]    INFO >> epoch 008:    105 / 129 loss=1.747, mrr=316.793, sample_size=450, wps=1100.2, ups=2.44, wpb=450, bsz=450, num_updates=1000, lr=0.0005, gnorm=6.751, clip=98.5, train_wall=300, wall=416 (progress_bar.py:262, log())
[2021-04-20 20:54:41]    INFO >> epoch 008 | loss 0.295 | mrr 0.953523 | sample_size 450 | wps 1064 | ups 2.36 | wpb 450 | bsz 450 | num_updates 1024 | lr 0.0005 | gnorm 5.497 | clip 100 | train_wall 38 | wall 423 (progress_bar.py:269, print())
[2021-04-20 20:54:48]    INFO >> epoch 008 | valid on 'valid' subset | loss 4.646 | mrr 0.436822 | sample_size 1000 | wps 2965.2 | wpb 1000 | bsz 1000 | num_updates 1024 | best_mrr 436.822 (progress_bar.py:269, print())
[2021-04-20 20:54:49]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/javascript/self_attn/checkpoints/checkpoint_best.pt (epoch 8 @ 1024 updates, score 0.436822) (writing took 0.630729 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 20:55:35]    INFO >> epoch 009 | loss 0.251 | mrr 0.9596 | sample_size 450 | wps 1065.7 | ups 2.37 | wpb 450 | bsz 450 | num_updates 1152 | lr 0.0005 | gnorm 5.271 | clip 100 | train_wall 38 | wall 477 (progress_bar.py:269, print())
[2021-04-20 20:55:42]    INFO >> epoch 009 | valid on 'valid' subset | loss 4.816 | mrr 0.441056 | sample_size 1000 | wps 3018.2 | wpb 1000 | bsz 1000 | num_updates 1152 | best_mrr 441.056 (progress_bar.py:269, print())
[2021-04-20 20:55:43]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/javascript/self_attn/checkpoints/checkpoint_best.pt (epoch 9 @ 1152 updates, score 0.441056) (writing took 0.906101 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 20:56:29]    INFO >> epoch 010 | loss 0.214 | mrr 0.966295 | sample_size 450 | wps 1077.7 | ups 2.39 | wpb 450 | bsz 450 | num_updates 1280 | lr 0.0005 | gnorm 4.84 | clip 100 | train_wall 38 | wall 531 (progress_bar.py:269, print())
[2021-04-20 20:56:37]    INFO >> epoch 010 | valid on 'valid' subset | loss 4.885 | mrr 0.439466 | sample_size 1000 | wps 3059.8 | wpb 1000 | bsz 1000 | num_updates 1280 | best_mrr 439.466 (progress_bar.py:269, print())
[2021-04-20 20:56:37]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/javascript/self_attn/checkpoints/checkpoint_last.pt (epoch 10 @ 1280 updates, score 0.439466) (writing took 0.714048 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 20:57:23]    INFO >> epoch 011 | loss 0.19 | mrr 0.9696 | sample_size 450 | wps 1064.5 | ups 2.37 | wpb 450 | bsz 450 | num_updates 1408 | lr 0.0005 | gnorm 4.499 | clip 100 | train_wall 38 | wall 585 (progress_bar.py:269, print())
[2021-04-20 20:57:30]    INFO >> epoch 011 | valid on 'valid' subset | loss 4.949 | mrr 0.442666 | sample_size 1000 | wps 2980 | wpb 1000 | bsz 1000 | num_updates 1408 | best_mrr 442.666 (progress_bar.py:269, print())
[2021-04-20 20:57:31]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/javascript/self_attn/checkpoints/checkpoint_best.pt (epoch 11 @ 1408 updates, score 0.442666) (writing took 0.753150 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 20:58:17]    INFO >> epoch 012 | loss 0.166 | mrr 0.97424 | sample_size 450 | wps 1064.3 | ups 2.37 | wpb 450 | bsz 450 | num_updates 1536 | lr 0.0005 | gnorm 4.3 | clip 100 | train_wall 38 | wall 639 (progress_bar.py:269, print())
[2021-04-20 20:58:24]    INFO >> epoch 012 | valid on 'valid' subset | loss 5.066 | mrr 0.435721 | sample_size 1000 | wps 3009 | wpb 1000 | bsz 1000 | num_updates 1536 | best_mrr 435.721 (progress_bar.py:269, print())
[2021-04-20 20:58:24]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/javascript/self_attn/checkpoints/checkpoint_last.pt (epoch 12 @ 1536 updates, score 0.435721) (writing took 0.384554 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 20:59:10]    INFO >> epoch 013 | loss 0.147 | mrr 0.976851 | sample_size 450 | wps 1088.5 | ups 2.42 | wpb 450 | bsz 450 | num_updates 1664 | lr 0.0005 | gnorm 4.02 | clip 100 | train_wall 38 | wall 692 (progress_bar.py:269, print())
[2021-04-20 20:59:18]    INFO >> epoch 013 | valid on 'valid' subset | loss 4.969 | mrr 0.446093 | sample_size 1000 | wps 3002.5 | wpb 1000 | bsz 1000 | num_updates 1664 | best_mrr 446.093 (progress_bar.py:269, print())
[2021-04-20 20:59:19]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/javascript/self_attn/checkpoints/checkpoint_best.pt (epoch 13 @ 1664 updates, score 0.446093) (writing took 0.930936 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 21:00:04]    INFO >> epoch 014 | loss 0.137 | mrr 0.978425 | sample_size 450 | wps 1058.4 | ups 2.35 | wpb 450 | bsz 450 | num_updates 1792 | lr 0.0005 | gnorm 4.011 | clip 100 | train_wall 38 | wall 746 (progress_bar.py:269, print())
[2021-04-20 21:00:11]    INFO >> epoch 014 | valid on 'valid' subset | loss 5.13 | mrr 0.442143 | sample_size 1000 | wps 3021.8 | wpb 1000 | bsz 1000 | num_updates 1792 | best_mrr 442.143 (progress_bar.py:269, print())
[2021-04-20 21:00:12]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/javascript/self_attn/checkpoints/checkpoint_last.pt (epoch 14 @ 1792 updates, score 0.442143) (writing took 1.333141 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 21:00:59]    INFO >> epoch 015 | loss 0.122 | mrr 0.980461 | sample_size 450 | wps 1051.8 | ups 2.34 | wpb 450 | bsz 450 | num_updates 1920 | lr 0.0005 | gnorm 3.789 | clip 100 | train_wall 38 | wall 801 (progress_bar.py:269, print())
[2021-04-20 21:01:06]    INFO >> epoch 015 | valid on 'valid' subset | loss 5.319 | mrr 0.440189 | sample_size 1000 | wps 3018.4 | wpb 1000 | bsz 1000 | num_updates 1920 | best_mrr 440.189 (progress_bar.py:269, print())
[2021-04-20 21:01:06]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/javascript/self_attn/checkpoints/checkpoint_last.pt (epoch 15 @ 1920 updates, score 0.440189) (writing took 0.440263 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 21:01:37]    INFO >> epoch 016:     81 / 129 loss=0.174, mrr=437.549, sample_size=450, wps=1062.6, ups=2.36, wpb=450, bsz=450, num_updates=2000, lr=0.0005, gnorm=4.364, clip=100, train_wall=300, wall=839 (progress_bar.py:262, log())
[2021-04-20 21:01:52]    INFO >> epoch 016 | loss 0.116 | mrr 0.981595 | sample_size 450 | wps 1088 | ups 2.42 | wpb 450 | bsz 450 | num_updates 2048 | lr 0.0005 | gnorm 3.669 | clip 100 | train_wall 38 | wall 854 (progress_bar.py:269, print())
[2021-04-20 21:02:00]    INFO >> epoch 016 | valid on 'valid' subset | loss 5.58 | mrr 0.433433 | sample_size 1000 | wps 3014.3 | wpb 1000 | bsz 1000 | num_updates 2048 | best_mrr 433.433 (progress_bar.py:269, print())
[2021-04-20 21:02:00]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/javascript/self_attn/checkpoints/checkpoint_last.pt (epoch 16 @ 2048 updates, score 0.433433) (writing took 0.449090 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 21:02:46]    INFO >> epoch 017 | loss 0.108 | mrr 0.982529 | sample_size 450 | wps 1068.9 | ups 2.38 | wpb 450 | bsz 450 | num_updates 2176 | lr 0.0005 | gnorm 3.597 | clip 100 | train_wall 38 | wall 908 (progress_bar.py:269, print())
[2021-04-20 21:02:53]    INFO >> epoch 017 | valid on 'valid' subset | loss 5.449 | mrr 0.435918 | sample_size 1000 | wps 2994 | wpb 1000 | bsz 1000 | num_updates 2176 | best_mrr 435.918 (progress_bar.py:269, print())
[2021-04-20 21:02:53]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/javascript/self_attn/checkpoints/checkpoint_last.pt (epoch 17 @ 2176 updates, score 0.435918) (writing took 0.464952 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 21:03:40]    INFO >> epoch 018 | loss 0.096 | mrr 0.984913 | sample_size 450 | wps 1070.1 | ups 2.38 | wpb 450 | bsz 450 | num_updates 2304 | lr 0.0005 | gnorm 3.402 | clip 100 | train_wall 38 | wall 962 (progress_bar.py:269, print())
[2021-04-20 21:03:47]    INFO >> epoch 018 | valid on 'valid' subset | loss 5.448 | mrr 0.437326 | sample_size 1000 | wps 3004.1 | wpb 1000 | bsz 1000 | num_updates 2304 | best_mrr 437.326 (progress_bar.py:269, print())
[2021-04-20 21:03:47]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/javascript/self_attn/checkpoints/checkpoint_last.pt (epoch 18 @ 2304 updates, score 0.437326) (writing took 0.451620 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 21:04:33]    INFO >> epoch 019 | loss 0.099 | mrr 0.984653 | sample_size 450 | wps 1087.1 | ups 2.42 | wpb 450 | bsz 450 | num_updates 2432 | lr 0.0005 | gnorm 3.404 | clip 100 | train_wall 38 | wall 1015 (progress_bar.py:269, print())
[2021-04-20 21:04:41]    INFO >> epoch 019 | valid on 'valid' subset | loss 5.68 | mrr 0.435538 | sample_size 1000 | wps 2964.5 | wpb 1000 | bsz 1000 | num_updates 2432 | best_mrr 435.538 (progress_bar.py:269, print())
[2021-04-20 21:04:41]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/javascript/self_attn/checkpoints/checkpoint_last.pt (epoch 19 @ 2432 updates, score 0.435538) (writing took 0.644198 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 21:05:27]    INFO >> epoch 020 | loss 0.089 | mrr 0.985773 | sample_size 450 | wps 1066 | ups 2.37 | wpb 450 | bsz 450 | num_updates 2560 | lr 0.0005 | gnorm 3.217 | clip 100 | train_wall 38 | wall 1069 (progress_bar.py:269, print())
[2021-04-20 21:05:34]    INFO >> epoch 020 | valid on 'valid' subset | loss 5.65 | mrr 0.439109 | sample_size 1000 | wps 2978.4 | wpb 1000 | bsz 1000 | num_updates 2560 | best_mrr 439.109 (progress_bar.py:269, print())
[2021-04-20 21:05:34]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/javascript/self_attn/checkpoints/checkpoint_last.pt (epoch 20 @ 2560 updates, score 0.439109) (writing took 0.333276 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 21:06:20]    INFO >> epoch 021 | loss 0.084 | mrr 0.986689 | sample_size 450 | wps 1071.2 | ups 2.38 | wpb 450 | bsz 450 | num_updates 2688 | lr 0.0005 | gnorm 3.15 | clip 100 | train_wall 38 | wall 1122 (progress_bar.py:269, print())
[2021-04-20 21:06:27]    INFO >> epoch 021 | valid on 'valid' subset | loss 5.632 | mrr 0.44337 | sample_size 1000 | wps 3000 | wpb 1000 | bsz 1000 | num_updates 2688 | best_mrr 443.37 (progress_bar.py:269, print())
[2021-04-20 21:06:28]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/javascript/self_attn/checkpoints/checkpoint_last.pt (epoch 21 @ 2688 updates, score 0.44337) (writing took 0.418404 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 21:07:13]    INFO >> epoch 022 | loss 0.084 | mrr 0.986824 | sample_size 450 | wps 1087.7 | ups 2.42 | wpb 450 | bsz 450 | num_updates 2816 | lr 0.0005 | gnorm 3.122 | clip 100 | train_wall 38 | wall 1175 (progress_bar.py:269, print())
[2021-04-20 21:07:21]    INFO >> epoch 022 | valid on 'valid' subset | loss 5.633 | mrr 0.445715 | sample_size 1000 | wps 3019.1 | wpb 1000 | bsz 1000 | num_updates 2816 | best_mrr 445.715 (progress_bar.py:269, print())
[2021-04-20 21:07:23]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/javascript/self_attn/checkpoints/checkpoint_last.pt (epoch 22 @ 2816 updates, score 0.445715) (writing took 1.483067 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 21:08:08]    INFO >> epoch 023 | loss 0.078 | mrr 0.987545 | sample_size 450 | wps 1048.6 | ups 2.33 | wpb 450 | bsz 450 | num_updates 2944 | lr 0.0005 | gnorm 3.01 | clip 100 | train_wall 38 | wall 1230 (progress_bar.py:269, print())
[2021-04-20 21:08:15]    INFO >> epoch 023 | valid on 'valid' subset | loss 5.845 | mrr 0.441523 | sample_size 1000 | wps 3019.1 | wpb 1000 | bsz 1000 | num_updates 2944 | best_mrr 441.523 (progress_bar.py:269, print())
[2021-04-20 21:08:16]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/javascript/self_attn/checkpoints/checkpoint_last.pt (epoch 23 @ 2944 updates, score 0.441523) (writing took 0.470543 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 21:08:16]    INFO >> early stop since valid performance hasn't improved for last 10 runs (train.py:191, should_stop_early())
[2021-04-20 21:08:16]    INFO >> early stop since valid performance hasn't improved for last 10 runs (train.py:272, single_main())
[2021-04-20 21:08:16]    INFO >> done training in 1237.8 seconds (train.py:283, single_main())
