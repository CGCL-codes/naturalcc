nohup: 忽略输入
[2021-04-20 20:32:08]    INFO >> Load arguments in /home/yanghe/Documents/naturalcc-dev/run/retrieval/selfattn/config/csn_feng/java.yml (train.py:302, cli_main())
[2021-04-20 20:32:08]    INFO >> {'criterion': 'retrieval_softmax', 'optimizer': 'torch_adam', 'lr_scheduler': 'fixed', 'tokenizer': None, 'bpe': None, 'common': {'no_progress_bar': 0, 'log_interval': 1000, 'log_format': 'simple', 'tensorboard_logdir': '', 'seed': 0, 'cpu': 0, 'fp16': 0, 'memory_efficient_fp16': 0, 'fp16_no_flatten_grads': 0, 'fp16_init_scale': 128, 'fp16_scale_window': None, 'fp16_scale_tolerance': 0.0, 'min_loss_scale': 0.0001, 'threshold_loss_scale': None, 'user_dir': None, 'empty_cache_freq': 0, 'all_gather_list_size': 16384, 'task': 'hybrid_retrieval'}, 'dataset': {'num_workers': 3, 'skip_invalid_size_inputs_valid_test': 0, 'max_tokens': None, 'max_sentences': 450, 'code_max_tokens': 200, 'query_max_tokens': 30, 'required_batch_size_multiple': 1, 'dataset_impl': 'mmap', 'train_subset': 'train', 'valid_subset': 'valid', 'validate_interval': 1, 'fixed_validation_seed': None, 'disable_validation': None, 'max_tokens_valid': None, 'max_sentences_valid': 1000, 'curriculum': 0, 'gen_subset': 'test', 'num_shards': 1, 'shard_id': 0, 'joined_dictionary': 0, 'langs': ['java']}, 'distributed_training': {'distributed_world_size': 1, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': None, 'distributed_port': -1, 'device_id': 0, 'distributed_no_spawn': 0, 'ddp_backend': 'c10d', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': None, 'find_unused_parameters': 0, 'fast_stat_sync': 0, 'broadcast_buffers': 0, 'global_sync_iter': 50, 'warmup_iterations': 500, 'local_rank': -1, 'block_momentum': 0.875, 'block_lr': 1, 'use_nbm': 0, 'average_sync': 0}, 'task': {'data': '/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all', 'sample_break_mode': 'complete', 'tokens_per_sample': 512, 'mask_prob': 0.15, 'leave_unmasked_prob': 0.1, 'random_token_prob': 0.1, 'freq_weighted_replacement': 0, 'mask_whole_words': 0, 'pooler_activation_fn': 'tanh', 'source_lang': 'code_tokens', 'target_lang': 'docstring_tokens', 'source_aux_lang': 'code_tokens.wo_func', 'target_aux_lang': 'func_name', 'fraction_using_func_name': 0.3, 'load_alignments': 0, 'left_pad_source': 1, 'left_pad_target': 0, 'upsample_primary': 1, 'truncate_source': 0, 'eval_mrr': 1}, 'model': {'arch': 'self_attn', 'code_embed_dim': 128, 'code_token_types': 1, 'code_max_tokens': 200, 'code_position_encoding': 'learned', 'code_dropout': 0.1, 'code_pooling': 'weighted_mean', 'query_embed_dim': 128, 'query_token_types': 1, 'query_max_tokens': 30, 'query_self_attn_layers': 3, 'query_pooling': 'weighted_mean', 'query_position_encoding': 'learned', 'query_dropout': 0.1, 'self_attn_layers': 3, 'attention_heads': 8, 'ffn_embed_dim': 512, 'activation_fn': 'gelu'}, 'optimization': {'max_epoch': 300, 'max_update': 0, 'clip_norm': 1, 'sentence_avg': 0, 'update_freq': [1], 'lrs': [0.0005], 'min_lr': -1, 'use_bmuf': 0, 'lr_shrink': 1.0, 'force_anneal': 0, 'warmup_updates': 0, 'end_learning_rate': 0.0, 'power': 1.0, 'total_num_update': 1000000, 'adam': {'adam_betas': '(0.9, 0.999)', 'adam_eps': 1e-08, 'weight_decay': 0, 'use_old_adam': 1}, 'margin': 1, 'clip_norm_version': 'tf_clip_by_global_norm'}, 'checkpoint': {'save_dir': '/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/self_attn/checkpoints', 'restore_file': 'checkpoint_last.pt', 'reset_dataloader': None, 'reset_lr_scheduler': None, 'reset_meters': None, 'reset_optimizer': None, 'optimizer_overrides': '{}', 'save_interval': 1, 'save_interval_updates': 0, 'keep_interval_updates': 0, 'keep_last_epochs': -1, 'keep_best_checkpoints': -1, 'no_save': 0, 'no_epoch_checkpoints': 1, 'no_last_checkpoints': 0, 'no_save_optimizer_state': None, 'best_checkpoint_metric': 'mrr', 'maximize_best_checkpoint_metric': 1, 'patience': 10}, 'eval': {'path': '/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/self_attn/checkpoints/checkpoint_best.pt', 'quiet': 1, 'max_sentences': 450, 'model_overrides': '{}', 'eval_size': -1}} (train.py:304, cli_main())
[2021-04-20 20:32:08]    INFO >> single GPU training... (train.py:333, cli_main())
[2021-04-20 20:32:09]    INFO >> loaded 5183 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/valid.java.code_tokens'] (hybrid_retrieval.py:54, load_tokens_dataset())
[2021-04-20 20:32:09]    INFO >> loaded 5183 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/valid.java.docstring_tokens'] (hybrid_retrieval.py:55, load_tokens_dataset())
[2021-04-20 20:32:10]    INFO >> SelfAttn(
  (src_encoders): ModuleDict(
    (java): SelfAttnEncoder(
      (embed): Embedding(10000, 128, padding_idx=0)
      (type_embed): Embedding(1, 128)
      (embed_layer_norm): LayerNorm((128,), eps=1e-08, elementwise_affine=True)
      (layers): ModuleList(
        (0): TransformerEncoderLayer(
          (self_attn): MultiheadAttention(
            (k_proj): Linear(in_features=128, out_features=128, bias=True)
            (v_proj): Linear(in_features=128, out_features=128, bias=True)
            (q_proj): Linear(in_features=128, out_features=128, bias=True)
            (out_proj): Linear(in_features=128, out_features=128, bias=True)
          )
          (self_attn_layer_norm): LayerNorm((128,), eps=1e-08, elementwise_affine=True)
          (fc1): Linear(in_features=128, out_features=512, bias=True)
          (fc2): Linear(in_features=512, out_features=128, bias=True)
          (ff_layer_norm): LayerNorm((128,), eps=1e-08, elementwise_affine=True)
        )
        (1): TransformerEncoderLayer(
          (self_attn): MultiheadAttention(
            (k_proj): Linear(in_features=128, out_features=128, bias=True)
            (v_proj): Linear(in_features=128, out_features=128, bias=True)
            (q_proj): Linear(in_features=128, out_features=128, bias=True)
            (out_proj): Linear(in_features=128, out_features=128, bias=True)
          )
          (self_attn_layer_norm): LayerNorm((128,), eps=1e-08, elementwise_affine=True)
          (fc1): Linear(in_features=128, out_features=512, bias=True)
          (fc2): Linear(in_features=512, out_features=128, bias=True)
          (ff_layer_norm): LayerNorm((128,), eps=1e-08, elementwise_affine=True)
        )
        (2): TransformerEncoderLayer(
          (self_attn): MultiheadAttention(
            (k_proj): Linear(in_features=128, out_features=128, bias=True)
            (v_proj): Linear(in_features=128, out_features=128, bias=True)
            (q_proj): Linear(in_features=128, out_features=128, bias=True)
            (out_proj): Linear(in_features=128, out_features=128, bias=True)
          )
          (self_attn_layer_norm): LayerNorm((128,), eps=1e-08, elementwise_affine=True)
          (fc1): Linear(in_features=128, out_features=512, bias=True)
          (fc2): Linear(in_features=512, out_features=128, bias=True)
          (ff_layer_norm): LayerNorm((128,), eps=1e-08, elementwise_affine=True)
        )
      )
      (weight_layer): Linear(in_features=128, out_features=1, bias=False)
    )
  )
  (tgt_encoders): SelfAttnEncoder(
    (embed): Embedding(10000, 128, padding_idx=0)
    (type_embed): Embedding(1, 128)
    (embed_layer_norm): LayerNorm((128,), eps=1e-08, elementwise_affine=True)
    (layers): ModuleList(
      (0): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (k_proj): Linear(in_features=128, out_features=128, bias=True)
          (v_proj): Linear(in_features=128, out_features=128, bias=True)
          (q_proj): Linear(in_features=128, out_features=128, bias=True)
          (out_proj): Linear(in_features=128, out_features=128, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((128,), eps=1e-08, elementwise_affine=True)
        (fc1): Linear(in_features=128, out_features=512, bias=True)
        (fc2): Linear(in_features=512, out_features=128, bias=True)
        (ff_layer_norm): LayerNorm((128,), eps=1e-08, elementwise_affine=True)
      )
      (1): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (k_proj): Linear(in_features=128, out_features=128, bias=True)
          (v_proj): Linear(in_features=128, out_features=128, bias=True)
          (q_proj): Linear(in_features=128, out_features=128, bias=True)
          (out_proj): Linear(in_features=128, out_features=128, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((128,), eps=1e-08, elementwise_affine=True)
        (fc1): Linear(in_features=128, out_features=512, bias=True)
        (fc2): Linear(in_features=512, out_features=128, bias=True)
        (ff_layer_norm): LayerNorm((128,), eps=1e-08, elementwise_affine=True)
      )
      (2): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (k_proj): Linear(in_features=128, out_features=128, bias=True)
          (v_proj): Linear(in_features=128, out_features=128, bias=True)
          (q_proj): Linear(in_features=128, out_features=128, bias=True)
          (out_proj): Linear(in_features=128, out_features=128, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((128,), eps=1e-08, elementwise_affine=True)
        (fc1): Linear(in_features=128, out_features=512, bias=True)
        (fc2): Linear(in_features=512, out_features=128, bias=True)
        (ff_layer_norm): LayerNorm((128,), eps=1e-08, elementwise_affine=True)
      )
    )
    (weight_layer): Linear(in_features=128, out_features=1, bias=False)
  )
) (train.py:223, single_main())
[2021-04-20 20:32:10]    INFO >> model self_attn, criterion SearchSoftmaxCriterion (train.py:224, single_main())
[2021-04-20 20:32:10]    INFO >> num. model params: 3780096 (num. trained: 3780096) (train.py:227, single_main())
[2021-04-20 20:32:12]    INFO >> training on 1 GPUs (train.py:233, single_main())
[2021-04-20 20:32:12]    INFO >> max tokens per GPU = None and max sentences per GPU = 450 (train.py:236, single_main())
[2021-04-20 20:32:12]    INFO >> no existing checkpoint found /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/self_attn/checkpoints/checkpoint_last.pt (ncc_trainers.py:270, load_checkpoint())
[2021-04-20 20:32:12]    INFO >> loading train data for epoch 1 (ncc_trainers.py:285, get_train_iterator())
[2021-04-20 20:32:12]    INFO >> loaded 164923 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.java.code_tokens'] (hybrid_retrieval.py:54, load_tokens_dataset())
[2021-04-20 20:32:12]    INFO >> loaded 164923 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.java.docstring_tokens'] (hybrid_retrieval.py:55, load_tokens_dataset())
[2021-04-20 20:32:12]    INFO >> loaded 164923 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.java.code_tokens.wo_func'] (hybrid_retrieval.py:67, load_tokens_dataset())
[2021-04-20 20:32:12]    INFO >> loaded 164923 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.java.func_name'] (hybrid_retrieval.py:81, load_tokens_dataset())
[2021-04-20 20:32:12]    INFO >> NOTE: your device may support faster training with fp16 (ncc_trainers.py:155, _setup_optimizer())
[2021-04-20 20:34:11]    INFO >> epoch 001 | loss 3.03 | mrr 0.497722 | sample_size 450 | wps 1473.8 | ups 3.28 | wpb 450 | bsz 450 | num_updates 366 | lr 0.0005 | gnorm 7.058 | clip 96.2 | train_wall 110 | wall 119 (progress_bar.py:269, print())
[2021-04-20 20:34:20]    INFO >> epoch 001 | valid on 'valid' subset | loss 2.769 | mrr 0.538578 | sample_size 1000 | wps 3572.7 | wpb 1000 | bsz 1000 | num_updates 366 (progress_bar.py:269, print())
[2021-04-20 20:34:21]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/self_attn/checkpoints/checkpoint_best.pt (epoch 1 @ 366 updates, score 0.538578) (writing took 0.543621 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 20:36:20]    INFO >> epoch 002 | loss 1.065 | mrr 0.823991 | sample_size 450 | wps 1279.8 | ups 2.84 | wpb 450 | bsz 450 | num_updates 732 | lr 0.0005 | gnorm 7.099 | clip 100 | train_wall 110 | wall 248 (progress_bar.py:269, print())
[2021-04-20 20:36:29]    INFO >> epoch 002 | valid on 'valid' subset | loss 2.403 | mrr 0.618364 | sample_size 1000 | wps 3564.7 | wpb 1000 | bsz 1000 | num_updates 732 | best_mrr 618.364 (progress_bar.py:269, print())
[2021-04-20 20:36:30]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/self_attn/checkpoints/checkpoint_best.pt (epoch 2 @ 732 updates, score 0.618364) (writing took 0.759877 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 20:37:58]    INFO >> epoch 003:    269 / 367 loss=1.674, mrr=325.312, sample_size=450, wps=1329.1, ups=2.95, wpb=450, bsz=450, num_updates=1000, lr=0.0005, gnorm=6.796, clip=98.6, train_wall=301, wall=346 (progress_bar.py:262, log())
[2021-04-20 20:38:28]    INFO >> epoch 003 | loss 0.652 | mrr 0.892762 | sample_size 450 | wps 1283.2 | ups 2.85 | wpb 450 | bsz 450 | num_updates 1098 | lr 0.0005 | gnorm 5.973 | clip 100 | train_wall 110 | wall 377 (progress_bar.py:269, print())
[2021-04-20 20:38:37]    INFO >> epoch 003 | valid on 'valid' subset | loss 2.293 | mrr 0.633056 | sample_size 1000 | wps 3596 | wpb 1000 | bsz 1000 | num_updates 1098 | best_mrr 633.056 (progress_bar.py:269, print())
[2021-04-20 20:38:38]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/self_attn/checkpoints/checkpoint_best.pt (epoch 3 @ 1098 updates, score 0.633056) (writing took 0.570543 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 20:40:37]    INFO >> epoch 004 | loss 0.463 | mrr 0.923484 | sample_size 450 | wps 1284.4 | ups 2.85 | wpb 450 | bsz 450 | num_updates 1464 | lr 0.0005 | gnorm 5.311 | clip 100 | train_wall 110 | wall 505 (progress_bar.py:269, print())
[2021-04-20 20:40:45]    INFO >> epoch 004 | valid on 'valid' subset | loss 2.317 | mrr 0.647925 | sample_size 1000 | wps 3614.2 | wpb 1000 | bsz 1000 | num_updates 1464 | best_mrr 647.925 (progress_bar.py:269, print())
[2021-04-20 20:40:46]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/self_attn/checkpoints/checkpoint_best.pt (epoch 4 @ 1464 updates, score 0.647925) (writing took 0.470560 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 20:42:45]    INFO >> epoch 005 | loss 0.35 | mrr 0.942379 | sample_size 450 | wps 1285.3 | ups 2.86 | wpb 450 | bsz 450 | num_updates 1830 | lr 0.0005 | gnorm 4.778 | clip 100 | train_wall 110 | wall 633 (progress_bar.py:269, print())
[2021-04-20 20:42:54]    INFO >> epoch 005 | valid on 'valid' subset | loss 2.318 | mrr 0.651083 | sample_size 1000 | wps 3602.3 | wpb 1000 | bsz 1000 | num_updates 1830 | best_mrr 651.083 (progress_bar.py:269, print())
[2021-04-20 20:42:55]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/self_attn/checkpoints/checkpoint_best.pt (epoch 5 @ 1830 updates, score 0.651083) (writing took 0.435927 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 20:43:53]    INFO >> epoch 006:    171 / 367 loss=0.404, mrr=420.013, sample_size=450, wps=1266.6, ups=2.81, wpb=450, bsz=450, num_updates=2000, lr=0.0005, gnorm=4.986, clip=100, train_wall=301, wall=702 (progress_bar.py:262, log())
[2021-04-20 20:44:54]    INFO >> epoch 006 | loss 0.274 | mrr 0.954253 | sample_size 450 | wps 1278.5 | ups 2.84 | wpb 450 | bsz 450 | num_updates 2196 | lr 0.0005 | gnorm 4.381 | clip 100 | train_wall 110 | wall 762 (progress_bar.py:269, print())
[2021-04-20 20:45:02]    INFO >> epoch 006 | valid on 'valid' subset | loss 2.443 | mrr 0.64957 | sample_size 1000 | wps 3510.9 | wpb 1000 | bsz 1000 | num_updates 2196 | best_mrr 649.57 (progress_bar.py:269, print())
[2021-04-20 20:45:03]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/self_attn/checkpoints/checkpoint_last.pt (epoch 6 @ 2196 updates, score 0.64957) (writing took 0.319729 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 20:47:03]    INFO >> epoch 007 | loss 0.225 | mrr 0.962882 | sample_size 450 | wps 1271.3 | ups 2.83 | wpb 450 | bsz 450 | num_updates 2562 | lr 0.0005 | gnorm 4.061 | clip 100 | train_wall 110 | wall 891 (progress_bar.py:269, print())
[2021-04-20 20:47:12]    INFO >> epoch 007 | valid on 'valid' subset | loss 2.485 | mrr 0.652235 | sample_size 1000 | wps 3646.9 | wpb 1000 | bsz 1000 | num_updates 2562 | best_mrr 652.235 (progress_bar.py:269, print())
[2021-04-20 20:47:13]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/self_attn/checkpoints/checkpoint_best.pt (epoch 7 @ 2562 updates, score 0.652235) (writing took 0.411034 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 20:49:12]    INFO >> epoch 008 | loss 0.187 | mrr 0.968771 | sample_size 450 | wps 1282.3 | ups 2.85 | wpb 450 | bsz 450 | num_updates 2928 | lr 0.0005 | gnorm 3.771 | clip 100 | train_wall 110 | wall 1020 (progress_bar.py:269, print())
[2021-04-20 20:49:21]    INFO >> epoch 008 | valid on 'valid' subset | loss 2.584 | mrr 0.65595 | sample_size 1000 | wps 3487.5 | wpb 1000 | bsz 1000 | num_updates 2928 | best_mrr 655.95 (progress_bar.py:269, print())
[2021-04-20 20:49:21]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/self_attn/checkpoints/checkpoint_best.pt (epoch 8 @ 2928 updates, score 0.65595) (writing took 0.478581 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 20:49:50]    INFO >> epoch 009:     73 / 367 loss=0.219, mrr=433.619, sample_size=450, wps=1262.2, ups=2.8, wpb=450, bsz=450, num_updates=3000, lr=0.0005, gnorm=3.991, clip=100, train_wall=301, wall=1058 (progress_bar.py:262, log())
[2021-04-20 20:51:20]    INFO >> epoch 009 | loss 0.165 | mrr 0.972401 | sample_size 450 | wps 1282.1 | ups 2.85 | wpb 450 | bsz 450 | num_updates 3294 | lr 0.0005 | gnorm 3.588 | clip 100 | train_wall 110 | wall 1148 (progress_bar.py:269, print())
[2021-04-20 20:51:29]    INFO >> epoch 009 | valid on 'valid' subset | loss 2.581 | mrr 0.656609 | sample_size 1000 | wps 3383.1 | wpb 1000 | bsz 1000 | num_updates 3294 | best_mrr 656.609 (progress_bar.py:269, print())
[2021-04-20 20:51:30]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/self_attn/checkpoints/checkpoint_best.pt (epoch 9 @ 3294 updates, score 0.656609) (writing took 0.583612 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 20:53:29]    INFO >> epoch 010 | loss 0.146 | mrr 0.975503 | sample_size 450 | wps 1279.9 | ups 2.84 | wpb 450 | bsz 450 | num_updates 3660 | lr 0.0005 | gnorm 3.375 | clip 100 | train_wall 110 | wall 1277 (progress_bar.py:269, print())
[2021-04-20 20:53:37]    INFO >> epoch 010 | valid on 'valid' subset | loss 2.626 | mrr 0.661432 | sample_size 1000 | wps 3639.2 | wpb 1000 | bsz 1000 | num_updates 3660 | best_mrr 661.432 (progress_bar.py:269, print())
[2021-04-20 20:53:38]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/self_attn/checkpoints/checkpoint_best.pt (epoch 10 @ 3660 updates, score 0.661432) (writing took 0.516715 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 20:55:29]    INFO >> epoch 011:    341 / 367 loss=0.147, mrr=438.939, sample_size=450, wps=1327.2, ups=2.95, wpb=450, bsz=450, num_updates=4000, lr=0.0005, gnorm=3.388, clip=100, train_wall=301, wall=1397 (progress_bar.py:262, log())
[2021-04-20 20:55:37]    INFO >> epoch 011 | loss 0.129 | mrr 0.978355 | sample_size 450 | wps 1281.2 | ups 2.85 | wpb 450 | bsz 450 | num_updates 4026 | lr 0.0005 | gnorm 3.194 | clip 100 | train_wall 110 | wall 1405 (progress_bar.py:269, print())
[2021-04-20 20:55:47]    INFO >> epoch 011 | valid on 'valid' subset | loss 2.698 | mrr 0.656251 | sample_size 1000 | wps 3356.3 | wpb 1000 | bsz 1000 | num_updates 4026 | best_mrr 656.251 (progress_bar.py:269, print())
[2021-04-20 20:55:47]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/self_attn/checkpoints/checkpoint_last.pt (epoch 11 @ 4026 updates, score 0.656251) (writing took 0.278719 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 20:57:46]    INFO >> epoch 012 | loss 0.116 | mrr 0.98042 | sample_size 450 | wps 1279.8 | ups 2.84 | wpb 450 | bsz 450 | num_updates 4392 | lr 0.0005 | gnorm 3.052 | clip 100 | train_wall 110 | wall 1534 (progress_bar.py:269, print())
[2021-04-20 20:57:56]    INFO >> epoch 012 | valid on 'valid' subset | loss 2.725 | mrr 0.660999 | sample_size 1000 | wps 3311.8 | wpb 1000 | bsz 1000 | num_updates 4392 | best_mrr 660.999 (progress_bar.py:269, print())
[2021-04-20 20:57:56]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/self_attn/checkpoints/checkpoint_last.pt (epoch 12 @ 4392 updates, score 0.660999) (writing took 0.269700 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 20:59:56]    INFO >> epoch 013 | loss 0.11 | mrr 0.981469 | sample_size 450 | wps 1270.7 | ups 2.82 | wpb 450 | bsz 450 | num_updates 4758 | lr 0.0005 | gnorm 2.939 | clip 100 | train_wall 110 | wall 1664 (progress_bar.py:269, print())
[2021-04-20 21:00:05]    INFO >> epoch 013 | valid on 'valid' subset | loss 2.689 | mrr 0.660753 | sample_size 1000 | wps 3387.7 | wpb 1000 | bsz 1000 | num_updates 4758 | best_mrr 660.753 (progress_bar.py:269, print())
[2021-04-20 21:00:06]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/self_attn/checkpoints/checkpoint_last.pt (epoch 13 @ 4758 updates, score 0.660753) (writing took 0.702226 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 21:01:28]    INFO >> epoch 014:    243 / 367 loss=0.11, mrr=441.688, sample_size=450, wps=1253.3, ups=2.79, wpb=450, bsz=450, num_updates=5000, lr=0.0005, gnorm=2.943, clip=100, train_wall=301, wall=1756 (progress_bar.py:262, log())
[2021-04-20 21:02:06]    INFO >> epoch 014 | loss 0.101 | mrr 0.983113 | sample_size 450 | wps 1260.6 | ups 2.8 | wpb 450 | bsz 450 | num_updates 5124 | lr 0.0005 | gnorm 2.796 | clip 100 | train_wall 110 | wall 1794 (progress_bar.py:269, print())
[2021-04-20 21:02:16]    INFO >> epoch 014 | valid on 'valid' subset | loss 2.771 | mrr 0.663982 | sample_size 1000 | wps 3576 | wpb 1000 | bsz 1000 | num_updates 5124 | best_mrr 663.982 (progress_bar.py:269, print())
[2021-04-20 21:02:17]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/self_attn/checkpoints/checkpoint_best.pt (epoch 14 @ 5124 updates, score 0.663982) (writing took 0.857741 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 21:04:16]    INFO >> epoch 015 | loss 0.093 | mrr 0.984132 | sample_size 450 | wps 1272.3 | ups 2.83 | wpb 450 | bsz 450 | num_updates 5490 | lr 0.0005 | gnorm 2.714 | clip 100 | train_wall 110 | wall 1924 (progress_bar.py:269, print())
[2021-04-20 21:04:25]    INFO >> epoch 015 | valid on 'valid' subset | loss 2.838 | mrr 0.661433 | sample_size 1000 | wps 3700.3 | wpb 1000 | bsz 1000 | num_updates 5490 | best_mrr 661.433 (progress_bar.py:269, print())
[2021-04-20 21:04:25]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/self_attn/checkpoints/checkpoint_last.pt (epoch 15 @ 5490 updates, score 0.661433) (writing took 0.481476 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 21:06:24]    INFO >> epoch 016 | loss 0.086 | mrr 0.985596 | sample_size 450 | wps 1283.7 | ups 2.85 | wpb 450 | bsz 450 | num_updates 5856 | lr 0.0005 | gnorm 2.566 | clip 100 | train_wall 110 | wall 2052 (progress_bar.py:269, print())
[2021-04-20 21:06:33]    INFO >> epoch 016 | valid on 'valid' subset | loss 2.691 | mrr 0.67402 | sample_size 1000 | wps 3606.5 | wpb 1000 | bsz 1000 | num_updates 5856 | best_mrr 674.02 (progress_bar.py:269, print())
[2021-04-20 21:06:33]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/self_attn/checkpoints/checkpoint_best.pt (epoch 16 @ 5856 updates, score 0.67402) (writing took 0.405356 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 21:07:24]    INFO >> epoch 017:    145 / 367 loss=0.091, mrr=443.118, sample_size=450, wps=1264.5, ups=2.81, wpb=450, bsz=450, num_updates=6000, lr=0.0005, gnorm=2.65, clip=100, train_wall=301, wall=2112 (progress_bar.py:262, log())
[2021-04-20 21:08:32]    INFO >> epoch 017 | loss 0.083 | mrr 0.986154 | sample_size 450 | wps 1286.8 | ups 2.86 | wpb 450 | bsz 450 | num_updates 6222 | lr 0.0005 | gnorm 2.548 | clip 100 | train_wall 110 | wall 2180 (progress_bar.py:269, print())
[2021-04-20 21:08:41]    INFO >> epoch 017 | valid on 'valid' subset | loss 2.839 | mrr 0.666338 | sample_size 1000 | wps 3598.1 | wpb 1000 | bsz 1000 | num_updates 6222 | best_mrr 666.338 (progress_bar.py:269, print())
[2021-04-20 21:08:41]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/self_attn/checkpoints/checkpoint_last.pt (epoch 17 @ 6222 updates, score 0.666338) (writing took 0.237626 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 21:10:40]    INFO >> epoch 018 | loss 0.079 | mrr 0.986686 | sample_size 450 | wps 1283.6 | ups 2.85 | wpb 450 | bsz 450 | num_updates 6588 | lr 0.0005 | gnorm 2.455 | clip 100 | train_wall 110 | wall 2308 (progress_bar.py:269, print())
[2021-04-20 21:10:49]    INFO >> epoch 018 | valid on 'valid' subset | loss 3.043 | mrr 0.665808 | sample_size 1000 | wps 3641.2 | wpb 1000 | bsz 1000 | num_updates 6588 | best_mrr 665.808 (progress_bar.py:269, print())
[2021-04-20 21:10:50]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/self_attn/checkpoints/checkpoint_last.pt (epoch 18 @ 6588 updates, score 0.665808) (writing took 0.276025 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 21:12:49]    INFO >> epoch 019 | loss 0.074 | mrr 0.987662 | sample_size 450 | wps 1277.8 | ups 2.84 | wpb 450 | bsz 450 | num_updates 6954 | lr 0.0005 | gnorm 2.35 | clip 100 | train_wall 110 | wall 2437 (progress_bar.py:269, print())
[2021-04-20 21:12:58]    INFO >> epoch 019 | valid on 'valid' subset | loss 2.922 | mrr 0.66314 | sample_size 1000 | wps 3517.3 | wpb 1000 | bsz 1000 | num_updates 6954 | best_mrr 663.14 (progress_bar.py:269, print())
[2021-04-20 21:12:59]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/self_attn/checkpoints/checkpoint_last.pt (epoch 19 @ 6954 updates, score 0.66314) (writing took 0.378073 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 21:13:20]    INFO >> epoch 020:     47 / 367 loss=0.077, mrr=444.156, sample_size=450, wps=1263.7, ups=2.81, wpb=450, bsz=450, num_updates=7000, lr=0.0005, gnorm=2.43, clip=100, train_wall=301, wall=2468 (progress_bar.py:262, log())
[2021-04-20 21:14:58]    INFO >> epoch 020 | loss 0.067 | mrr 0.988584 | sample_size 450 | wps 1279.3 | ups 2.84 | wpb 450 | bsz 450 | num_updates 7320 | lr 0.0005 | gnorm 2.223 | clip 99.7 | train_wall 110 | wall 2566 (progress_bar.py:269, print())
[2021-04-20 21:15:07]    INFO >> epoch 020 | valid on 'valid' subset | loss 2.949 | mrr 0.665507 | sample_size 1000 | wps 3658.9 | wpb 1000 | bsz 1000 | num_updates 7320 | best_mrr 665.507 (progress_bar.py:269, print())
[2021-04-20 21:15:07]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/self_attn/checkpoints/checkpoint_last.pt (epoch 20 @ 7320 updates, score 0.665507) (writing took 0.252516 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 21:17:07]    INFO >> epoch 021 | loss 0.066 | mrr 0.98876 | sample_size 450 | wps 1279.3 | ups 2.84 | wpb 450 | bsz 450 | num_updates 7686 | lr 0.0005 | gnorm 2.226 | clip 100 | train_wall 110 | wall 2695 (progress_bar.py:269, print())
[2021-04-20 21:17:16]    INFO >> epoch 021 | valid on 'valid' subset | loss 3.103 | mrr 0.663743 | sample_size 1000 | wps 3285.3 | wpb 1000 | bsz 1000 | num_updates 7686 | best_mrr 663.743 (progress_bar.py:269, print())
[2021-04-20 21:17:16]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/self_attn/checkpoints/checkpoint_last.pt (epoch 21 @ 7686 updates, score 0.663743) (writing took 0.314822 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 21:18:59]    INFO >> epoch 022:    315 / 367 loss=0.066, mrr=444.93, sample_size=450, wps=1327.6, ups=2.95, wpb=450, bsz=450, num_updates=8000, lr=0.0005, gnorm=2.213, clip=99.9, train_wall=301, wall=2807 (progress_bar.py:262, log())
[2021-04-20 21:19:15]    INFO >> epoch 022 | loss 0.066 | mrr 0.988903 | sample_size 450 | wps 1281.8 | ups 2.85 | wpb 450 | bsz 450 | num_updates 8052 | lr 0.0005 | gnorm 2.186 | clip 100 | train_wall 110 | wall 2823 (progress_bar.py:269, print())
[2021-04-20 21:19:26]    INFO >> epoch 022 | valid on 'valid' subset | loss 2.991 | mrr 0.668977 | sample_size 1000 | wps 3493.1 | wpb 1000 | bsz 1000 | num_updates 8052 | best_mrr 668.977 (progress_bar.py:269, print())
[2021-04-20 21:19:26]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/self_attn/checkpoints/checkpoint_last.pt (epoch 22 @ 8052 updates, score 0.668977) (writing took 0.276552 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 21:21:25]    INFO >> epoch 023 | loss 0.06 | mrr 0.989884 | sample_size 450 | wps 1265.3 | ups 2.81 | wpb 450 | bsz 450 | num_updates 8418 | lr 0.0005 | gnorm 2.085 | clip 100 | train_wall 110 | wall 2953 (progress_bar.py:269, print())
[2021-04-20 21:21:34]    INFO >> epoch 023 | valid on 'valid' subset | loss 3.035 | mrr 0.665942 | sample_size 1000 | wps 3638.2 | wpb 1000 | bsz 1000 | num_updates 8418 | best_mrr 665.942 (progress_bar.py:269, print())
[2021-04-20 21:21:35]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/self_attn/checkpoints/checkpoint_last.pt (epoch 23 @ 8418 updates, score 0.665942) (writing took 0.371219 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 21:23:33]    INFO >> epoch 024 | loss 0.06 | mrr 0.989823 | sample_size 450 | wps 1284.5 | ups 2.85 | wpb 450 | bsz 450 | num_updates 8784 | lr 0.0005 | gnorm 2.08 | clip 100 | train_wall 110 | wall 3082 (progress_bar.py:269, print())
[2021-04-20 21:23:43]    INFO >> epoch 024 | valid on 'valid' subset | loss 2.954 | mrr 0.669929 | sample_size 1000 | wps 3655.3 | wpb 1000 | bsz 1000 | num_updates 8784 | best_mrr 669.929 (progress_bar.py:269, print())
[2021-04-20 21:23:43]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/self_attn/checkpoints/checkpoint_last.pt (epoch 24 @ 8784 updates, score 0.669929) (writing took 0.286910 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 21:24:56]    INFO >> epoch 025:    217 / 367 loss=0.06, mrr=445.454, sample_size=450, wps=1259.7, ups=2.8, wpb=450, bsz=450, num_updates=9000, lr=0.0005, gnorm=2.069, clip=99.9, train_wall=301, wall=3164 (progress_bar.py:262, log())
[2021-04-20 21:25:42]    INFO >> epoch 025 | loss 0.057 | mrr 0.990327 | sample_size 450 | wps 1278.9 | ups 2.84 | wpb 450 | bsz 450 | num_updates 9150 | lr 0.0005 | gnorm 1.999 | clip 99.7 | train_wall 110 | wall 3210 (progress_bar.py:269, print())
[2021-04-20 21:25:52]    INFO >> epoch 025 | valid on 'valid' subset | loss 2.99 | mrr 0.666024 | sample_size 1000 | wps 3627 | wpb 1000 | bsz 1000 | num_updates 9150 | best_mrr 666.024 (progress_bar.py:269, print())
[2021-04-20 21:25:52]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/self_attn/checkpoints/checkpoint_last.pt (epoch 25 @ 9150 updates, score 0.666024) (writing took 0.265426 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 21:27:51]    INFO >> epoch 026 | loss 0.054 | mrr 0.990929 | sample_size 450 | wps 1276.7 | ups 2.84 | wpb 450 | bsz 450 | num_updates 9516 | lr 0.0005 | gnorm 1.959 | clip 100 | train_wall 110 | wall 3339 (progress_bar.py:269, print())
[2021-04-20 21:28:00]    INFO >> epoch 026 | valid on 'valid' subset | loss 2.982 | mrr 0.67046 | sample_size 1000 | wps 3621.3 | wpb 1000 | bsz 1000 | num_updates 9516 | best_mrr 670.46 (progress_bar.py:269, print())
[2021-04-20 21:28:01]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/java/self_attn/checkpoints/checkpoint_last.pt (epoch 26 @ 9516 updates, score 0.67046) (writing took 0.299848 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 21:28:01]    INFO >> early stop since valid performance hasn't improved for last 10 runs (train.py:191, should_stop_early())
[2021-04-20 21:28:01]    INFO >> early stop since valid performance hasn't improved for last 10 runs (train.py:272, single_main())
[2021-04-20 21:28:01]    INFO >> done training in 3348.5 seconds (train.py:283, single_main())
