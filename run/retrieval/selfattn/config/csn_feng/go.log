nohup: 忽略输入
[2021-04-20 21:21:15]    INFO >> Load arguments in /home/yanghe/Documents/naturalcc-dev/run/retrieval/selfattn/config/csn_feng/go.yml (train.py:302, cli_main())
[2021-04-20 21:21:15]    INFO >> {'criterion': 'retrieval_softmax', 'optimizer': 'torch_adam', 'lr_scheduler': 'fixed', 'tokenizer': None, 'bpe': None, 'common': {'no_progress_bar': 0, 'log_interval': 1000, 'log_format': 'simple', 'tensorboard_logdir': '', 'seed': 0, 'cpu': 0, 'fp16': 0, 'memory_efficient_fp16': 0, 'fp16_no_flatten_grads': 0, 'fp16_init_scale': 128, 'fp16_scale_window': None, 'fp16_scale_tolerance': 0.0, 'min_loss_scale': 0.0001, 'threshold_loss_scale': None, 'user_dir': None, 'empty_cache_freq': 0, 'all_gather_list_size': 16384, 'task': 'hybrid_retrieval'}, 'dataset': {'num_workers': 3, 'skip_invalid_size_inputs_valid_test': 0, 'max_tokens': None, 'max_sentences': 450, 'code_max_tokens': 200, 'query_max_tokens': 30, 'required_batch_size_multiple': 1, 'dataset_impl': 'mmap', 'train_subset': 'train', 'valid_subset': 'valid', 'validate_interval': 1, 'fixed_validation_seed': None, 'disable_validation': None, 'max_tokens_valid': None, 'max_sentences_valid': 1000, 'curriculum': 0, 'gen_subset': 'test', 'num_shards': 1, 'shard_id': 0, 'joined_dictionary': 0, 'langs': ['go']}, 'distributed_training': {'distributed_world_size': 1, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': None, 'distributed_port': -1, 'device_id': 0, 'distributed_no_spawn': 0, 'ddp_backend': 'c10d', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': None, 'find_unused_parameters': 0, 'fast_stat_sync': 0, 'broadcast_buffers': 0, 'global_sync_iter': 50, 'warmup_iterations': 500, 'local_rank': -1, 'block_momentum': 0.875, 'block_lr': 1, 'use_nbm': 0, 'average_sync': 0}, 'task': {'data': '/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all', 'sample_break_mode': 'complete', 'tokens_per_sample': 512, 'mask_prob': 0.15, 'leave_unmasked_prob': 0.1, 'random_token_prob': 0.1, 'freq_weighted_replacement': 0, 'mask_whole_words': 0, 'pooler_activation_fn': 'tanh', 'source_lang': 'code_tokens', 'target_lang': 'docstring_tokens', 'source_aux_lang': 'code_tokens.wo_func', 'target_aux_lang': 'func_name', 'fraction_using_func_name': 0.3, 'load_alignments': 0, 'left_pad_source': 1, 'left_pad_target': 0, 'upsample_primary': 1, 'truncate_source': 0, 'eval_mrr': 1}, 'model': {'arch': 'self_attn', 'code_embed_dim': 128, 'code_token_types': 1, 'code_max_tokens': 200, 'code_position_encoding': 'learned', 'code_dropout': 0.1, 'code_pooling': 'weighted_mean', 'query_embed_dim': 128, 'query_token_types': 1, 'query_max_tokens': 30, 'query_self_attn_layers': 3, 'query_pooling': 'weighted_mean', 'query_position_encoding': 'learned', 'query_dropout': 0.1, 'self_attn_layers': 3, 'attention_heads': 8, 'ffn_embed_dim': 512, 'activation_fn': 'gelu'}, 'optimization': {'max_epoch': 300, 'max_update': 0, 'clip_norm': 1, 'sentence_avg': 0, 'update_freq': [1], 'lrs': [0.0005], 'min_lr': -1, 'use_bmuf': 0, 'lr_shrink': 1.0, 'force_anneal': 0, 'warmup_updates': 0, 'end_learning_rate': 0.0, 'power': 1.0, 'total_num_update': 1000000, 'adam': {'adam_betas': '(0.9, 0.999)', 'adam_eps': 1e-08, 'weight_decay': 0, 'use_old_adam': 1}, 'margin': 1, 'clip_norm_version': 'tf_clip_by_global_norm'}, 'checkpoint': {'save_dir': '/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/self_attn/checkpoints', 'restore_file': 'checkpoint_last.pt', 'reset_dataloader': None, 'reset_lr_scheduler': None, 'reset_meters': None, 'reset_optimizer': None, 'optimizer_overrides': '{}', 'save_interval': 1, 'save_interval_updates': 0, 'keep_interval_updates': 0, 'keep_last_epochs': -1, 'keep_best_checkpoints': -1, 'no_save': 0, 'no_epoch_checkpoints': 1, 'no_last_checkpoints': 0, 'no_save_optimizer_state': None, 'best_checkpoint_metric': 'mrr', 'maximize_best_checkpoint_metric': 1, 'patience': 10}, 'eval': {'path': '/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/self_attn/checkpoints/checkpoint_best.pt', 'quiet': 1, 'max_sentences': 450, 'model_overrides': '{}', 'eval_size': -1}} (train.py:304, cli_main())
[2021-04-20 21:21:15]    INFO >> single GPU training... (train.py:333, cli_main())
[2021-04-20 21:21:15]    INFO >> loaded 7325 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/valid.go.code_tokens'] (hybrid_retrieval.py:54, load_tokens_dataset())
[2021-04-20 21:21:15]    INFO >> loaded 7325 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/valid.go.docstring_tokens'] (hybrid_retrieval.py:55, load_tokens_dataset())
[2021-04-20 21:21:15]    INFO >> SelfAttn(
  (src_encoders): ModuleDict(
    (go): SelfAttnEncoder(
      (embed): Embedding(10000, 128, padding_idx=0)
      (type_embed): Embedding(1, 128)
      (embed_layer_norm): LayerNorm((128,), eps=1e-08, elementwise_affine=True)
      (layers): ModuleList(
        (0): TransformerEncoderLayer(
          (self_attn): MultiheadAttention(
            (k_proj): Linear(in_features=128, out_features=128, bias=True)
            (v_proj): Linear(in_features=128, out_features=128, bias=True)
            (q_proj): Linear(in_features=128, out_features=128, bias=True)
            (out_proj): Linear(in_features=128, out_features=128, bias=True)
          )
          (self_attn_layer_norm): LayerNorm((128,), eps=1e-08, elementwise_affine=True)
          (fc1): Linear(in_features=128, out_features=512, bias=True)
          (fc2): Linear(in_features=512, out_features=128, bias=True)
          (ff_layer_norm): LayerNorm((128,), eps=1e-08, elementwise_affine=True)
        )
        (1): TransformerEncoderLayer(
          (self_attn): MultiheadAttention(
            (k_proj): Linear(in_features=128, out_features=128, bias=True)
            (v_proj): Linear(in_features=128, out_features=128, bias=True)
            (q_proj): Linear(in_features=128, out_features=128, bias=True)
            (out_proj): Linear(in_features=128, out_features=128, bias=True)
          )
          (self_attn_layer_norm): LayerNorm((128,), eps=1e-08, elementwise_affine=True)
          (fc1): Linear(in_features=128, out_features=512, bias=True)
          (fc2): Linear(in_features=512, out_features=128, bias=True)
          (ff_layer_norm): LayerNorm((128,), eps=1e-08, elementwise_affine=True)
        )
        (2): TransformerEncoderLayer(
          (self_attn): MultiheadAttention(
            (k_proj): Linear(in_features=128, out_features=128, bias=True)
            (v_proj): Linear(in_features=128, out_features=128, bias=True)
            (q_proj): Linear(in_features=128, out_features=128, bias=True)
            (out_proj): Linear(in_features=128, out_features=128, bias=True)
          )
          (self_attn_layer_norm): LayerNorm((128,), eps=1e-08, elementwise_affine=True)
          (fc1): Linear(in_features=128, out_features=512, bias=True)
          (fc2): Linear(in_features=512, out_features=128, bias=True)
          (ff_layer_norm): LayerNorm((128,), eps=1e-08, elementwise_affine=True)
        )
      )
      (weight_layer): Linear(in_features=128, out_features=1, bias=False)
    )
  )
  (tgt_encoders): SelfAttnEncoder(
    (embed): Embedding(10000, 128, padding_idx=0)
    (type_embed): Embedding(1, 128)
    (embed_layer_norm): LayerNorm((128,), eps=1e-08, elementwise_affine=True)
    (layers): ModuleList(
      (0): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (k_proj): Linear(in_features=128, out_features=128, bias=True)
          (v_proj): Linear(in_features=128, out_features=128, bias=True)
          (q_proj): Linear(in_features=128, out_features=128, bias=True)
          (out_proj): Linear(in_features=128, out_features=128, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((128,), eps=1e-08, elementwise_affine=True)
        (fc1): Linear(in_features=128, out_features=512, bias=True)
        (fc2): Linear(in_features=512, out_features=128, bias=True)
        (ff_layer_norm): LayerNorm((128,), eps=1e-08, elementwise_affine=True)
      )
      (1): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (k_proj): Linear(in_features=128, out_features=128, bias=True)
          (v_proj): Linear(in_features=128, out_features=128, bias=True)
          (q_proj): Linear(in_features=128, out_features=128, bias=True)
          (out_proj): Linear(in_features=128, out_features=128, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((128,), eps=1e-08, elementwise_affine=True)
        (fc1): Linear(in_features=128, out_features=512, bias=True)
        (fc2): Linear(in_features=512, out_features=128, bias=True)
        (ff_layer_norm): LayerNorm((128,), eps=1e-08, elementwise_affine=True)
      )
      (2): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (k_proj): Linear(in_features=128, out_features=128, bias=True)
          (v_proj): Linear(in_features=128, out_features=128, bias=True)
          (q_proj): Linear(in_features=128, out_features=128, bias=True)
          (out_proj): Linear(in_features=128, out_features=128, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((128,), eps=1e-08, elementwise_affine=True)
        (fc1): Linear(in_features=128, out_features=512, bias=True)
        (fc2): Linear(in_features=512, out_features=128, bias=True)
        (ff_layer_norm): LayerNorm((128,), eps=1e-08, elementwise_affine=True)
      )
    )
    (weight_layer): Linear(in_features=128, out_features=1, bias=False)
  )
) (train.py:223, single_main())
[2021-04-20 21:21:15]    INFO >> model self_attn, criterion SearchSoftmaxCriterion (train.py:224, single_main())
[2021-04-20 21:21:15]    INFO >> num. model params: 3780096 (num. trained: 3780096) (train.py:227, single_main())
[2021-04-20 21:21:17]    INFO >> training on 1 GPUs (train.py:233, single_main())
[2021-04-20 21:21:17]    INFO >> max tokens per GPU = None and max sentences per GPU = 450 (train.py:236, single_main())
[2021-04-20 21:21:17]    INFO >> no existing checkpoint found /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/self_attn/checkpoints/checkpoint_last.pt (ncc_trainers.py:270, load_checkpoint())
[2021-04-20 21:21:17]    INFO >> loading train data for epoch 1 (ncc_trainers.py:285, get_train_iterator())
[2021-04-20 21:21:17]    INFO >> loaded 167288 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.go.code_tokens'] (hybrid_retrieval.py:54, load_tokens_dataset())
[2021-04-20 21:21:17]    INFO >> loaded 167288 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.go.docstring_tokens'] (hybrid_retrieval.py:55, load_tokens_dataset())
[2021-04-20 21:21:17]    INFO >> loaded 167288 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.go.code_tokens.wo_func'] (hybrid_retrieval.py:67, load_tokens_dataset())
[2021-04-20 21:21:17]    INFO >> loaded 167288 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.go.func_name'] (hybrid_retrieval.py:81, load_tokens_dataset())
[2021-04-20 21:21:18]    INFO >> NOTE: your device may support faster training with fp16 (ncc_trainers.py:155, _setup_optimizer())
[2021-04-20 21:23:17]    INFO >> epoch 001 | loss 2.389 | mrr 0.598676 | sample_size 450 | wps 1480.6 | ups 3.29 | wpb 450 | bsz 450 | num_updates 371 | lr 0.0005 | gnorm 6.915 | clip 99.2 | train_wall 111 | wall 120 (progress_bar.py:269, print())
[2021-04-20 21:23:26]    INFO >> epoch 001 | valid on 'valid' subset | loss 1.661 | mrr 0.70682 | sample_size 1000 | wps 3956.8 | wpb 1000 | bsz 1000 | num_updates 371 (progress_bar.py:269, print())
[2021-04-20 21:23:26]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/self_attn/checkpoints/checkpoint_best.pt (epoch 1 @ 371 updates, score 0.70682) (writing took 0.433967 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 21:25:26]    INFO >> epoch 002 | loss 0.557 | mrr 0.906514 | sample_size 450 | wps 1297 | ups 2.88 | wpb 450 | bsz 450 | num_updates 742 | lr 0.0005 | gnorm 5.55 | clip 100 | train_wall 111 | wall 248 (progress_bar.py:269, print())
[2021-04-20 21:25:35]    INFO >> epoch 002 | valid on 'valid' subset | loss 1.317 | mrr 0.76627 | sample_size 1000 | wps 3936.1 | wpb 1000 | bsz 1000 | num_updates 742 | best_mrr 766.27 (progress_bar.py:269, print())
[2021-04-20 21:25:35]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/self_attn/checkpoints/checkpoint_best.pt (epoch 2 @ 742 updates, score 0.76627) (writing took 0.546473 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 21:27:00]    INFO >> epoch 003:    259 / 372 loss=1.171, mrr=361.523, sample_size=450, wps=1340.6, ups=2.98, wpb=450, bsz=450, num_updates=1000, lr=0.0005, gnorm=5.724, clip=99.7, train_wall=300, wall=343 (progress_bar.py:262, log())
[2021-04-20 21:27:35]    INFO >> epoch 003 | loss 0.306 | mrr 0.94872 | sample_size 450 | wps 1295.2 | ups 2.88 | wpb 450 | bsz 450 | num_updates 1113 | lr 0.0005 | gnorm 4.29 | clip 100 | train_wall 111 | wall 377 (progress_bar.py:269, print())
[2021-04-20 21:27:44]    INFO >> epoch 003 | valid on 'valid' subset | loss 1.294 | mrr 0.776648 | sample_size 1000 | wps 4074.4 | wpb 1000 | bsz 1000 | num_updates 1113 | best_mrr 776.648 (progress_bar.py:269, print())
[2021-04-20 21:27:44]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/self_attn/checkpoints/checkpoint_best.pt (epoch 3 @ 1113 updates, score 0.776648) (writing took 0.470043 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 21:29:43]    INFO >> epoch 004 | loss 0.213 | mrr 0.964752 | sample_size 450 | wps 1295.5 | ups 2.88 | wpb 450 | bsz 450 | num_updates 1484 | lr 0.0005 | gnorm 3.61 | clip 100 | train_wall 111 | wall 506 (progress_bar.py:269, print())
[2021-04-20 21:29:52]    INFO >> epoch 004 | valid on 'valid' subset | loss 1.221 | mrr 0.787546 | sample_size 1000 | wps 4003.6 | wpb 1000 | bsz 1000 | num_updates 1484 | best_mrr 787.546 (progress_bar.py:269, print())
[2021-04-20 21:29:53]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/self_attn/checkpoints/checkpoint_best.pt (epoch 4 @ 1484 updates, score 0.787546) (writing took 0.503146 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 21:31:52]    INFO >> epoch 005 | loss 0.163 | mrr 0.972708 | sample_size 450 | wps 1294.5 | ups 2.88 | wpb 450 | bsz 450 | num_updates 1855 | lr 0.0005 | gnorm 3.14 | clip 100 | train_wall 111 | wall 635 (progress_bar.py:269, print())
[2021-04-20 21:32:02]    INFO >> epoch 005 | valid on 'valid' subset | loss 1.25 | mrr 0.789811 | sample_size 1000 | wps 3941.1 | wpb 1000 | bsz 1000 | num_updates 1855 | best_mrr 789.811 (progress_bar.py:269, print())
[2021-04-20 21:32:02]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/self_attn/checkpoints/checkpoint_best.pt (epoch 5 @ 1855 updates, score 0.789811) (writing took 0.710561 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 21:32:53]    INFO >> epoch 006:    145 / 372 loss=0.194, mrr=435.449, sample_size=450, wps=1275.4, ups=2.83, wpb=450, bsz=450, num_updates=2000, lr=0.0005, gnorm=3.396, clip=100, train_wall=300, wall=695 (progress_bar.py:262, log())
[2021-04-20 21:34:02]    INFO >> epoch 006 | loss 0.136 | mrr 0.977331 | sample_size 450 | wps 1290.4 | ups 2.87 | wpb 450 | bsz 450 | num_updates 2226 | lr 0.0005 | gnorm 2.845 | clip 100 | train_wall 111 | wall 765 (progress_bar.py:269, print())
[2021-04-20 21:34:11]    INFO >> epoch 006 | valid on 'valid' subset | loss 1.216 | mrr 0.800696 | sample_size 1000 | wps 4028.3 | wpb 1000 | bsz 1000 | num_updates 2226 | best_mrr 800.696 (progress_bar.py:269, print())
[2021-04-20 21:34:11]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/self_attn/checkpoints/checkpoint_best.pt (epoch 6 @ 2226 updates, score 0.800696) (writing took 0.588293 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 21:36:11]    INFO >> epoch 007 | loss 0.115 | mrr 0.980731 | sample_size 450 | wps 1294.5 | ups 2.88 | wpb 450 | bsz 450 | num_updates 2597 | lr 0.0005 | gnorm 2.606 | clip 100 | train_wall 111 | wall 893 (progress_bar.py:269, print())
[2021-04-20 21:36:20]    INFO >> epoch 007 | valid on 'valid' subset | loss 1.289 | mrr 0.791902 | sample_size 1000 | wps 3983.6 | wpb 1000 | bsz 1000 | num_updates 2597 | best_mrr 791.902 (progress_bar.py:269, print())
[2021-04-20 21:36:20]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/self_attn/checkpoints/checkpoint_last.pt (epoch 7 @ 2597 updates, score 0.791902) (writing took 0.242484 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 21:38:19]    INFO >> epoch 008 | loss 0.099 | mrr 0.983326 | sample_size 450 | wps 1298.3 | ups 2.89 | wpb 450 | bsz 450 | num_updates 2968 | lr 0.0005 | gnorm 2.408 | clip 100 | train_wall 111 | wall 1022 (progress_bar.py:269, print())
[2021-04-20 21:38:28]    INFO >> epoch 008 | valid on 'valid' subset | loss 1.22 | mrr 0.802523 | sample_size 1000 | wps 4032 | wpb 1000 | bsz 1000 | num_updates 2968 | best_mrr 802.523 (progress_bar.py:269, print())
[2021-04-20 21:38:29]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/self_attn/checkpoints/checkpoint_best.pt (epoch 8 @ 2968 updates, score 0.802523) (writing took 0.544098 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 21:38:45]    INFO >> epoch 009:     32 / 372 loss=0.114, mrr=441.441, sample_size=450, wps=1278, ups=2.84, wpb=450, bsz=450, num_updates=3000, lr=0.0005, gnorm=2.581, clip=100, train_wall=300, wall=1047 (progress_bar.py:262, log())
[2021-04-20 21:40:28]    INFO >> epoch 009 | loss 0.09 | mrr 0.985118 | sample_size 450 | wps 1295.2 | ups 2.88 | wpb 450 | bsz 450 | num_updates 3339 | lr 0.0005 | gnorm 2.271 | clip 100 | train_wall 111 | wall 1151 (progress_bar.py:269, print())
[2021-04-20 21:40:37]    INFO >> epoch 009 | valid on 'valid' subset | loss 1.253 | mrr 0.804744 | sample_size 1000 | wps 4057.5 | wpb 1000 | bsz 1000 | num_updates 3339 | best_mrr 804.744 (progress_bar.py:269, print())
[2021-04-20 21:40:38]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/self_attn/checkpoints/checkpoint_best.pt (epoch 9 @ 3339 updates, score 0.804744) (writing took 0.710141 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 21:42:37]    INFO >> epoch 010 | loss 0.08 | mrr 0.986831 | sample_size 450 | wps 1292.9 | ups 2.87 | wpb 450 | bsz 450 | num_updates 3710 | lr 0.0005 | gnorm 2.133 | clip 100 | train_wall 111 | wall 1280 (progress_bar.py:269, print())
[2021-04-20 21:42:47]    INFO >> epoch 010 | valid on 'valid' subset | loss 1.259 | mrr 0.798339 | sample_size 1000 | wps 4014.8 | wpb 1000 | bsz 1000 | num_updates 3710 | best_mrr 798.339 (progress_bar.py:269, print())
[2021-04-20 21:42:47]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/self_attn/checkpoints/checkpoint_last.pt (epoch 10 @ 3710 updates, score 0.798339) (writing took 0.337172 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 21:44:21]    INFO >> epoch 011:    291 / 372 loss=0.081, mrr=444.015, sample_size=450, wps=1337.2, ups=2.97, wpb=450, bsz=450, num_updates=4000, lr=0.0005, gnorm=2.13, clip=100, train_wall=300, wall=1384 (progress_bar.py:262, log())
[2021-04-20 21:44:46]    INFO >> epoch 011 | loss 0.073 | mrr 0.988197 | sample_size 450 | wps 1295.5 | ups 2.88 | wpb 450 | bsz 450 | num_updates 4081 | lr 0.0005 | gnorm 1.963 | clip 100 | train_wall 111 | wall 1409 (progress_bar.py:269, print())
[2021-04-20 21:44:55]    INFO >> epoch 011 | valid on 'valid' subset | loss 1.291 | mrr 0.804068 | sample_size 1000 | wps 3961.2 | wpb 1000 | bsz 1000 | num_updates 4081 | best_mrr 804.068 (progress_bar.py:269, print())
[2021-04-20 21:44:55]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/self_attn/checkpoints/checkpoint_last.pt (epoch 11 @ 4081 updates, score 0.804068) (writing took 0.231594 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 21:46:55]    INFO >> epoch 012 | loss 0.068 | mrr 0.988704 | sample_size 450 | wps 1297.9 | ups 2.88 | wpb 450 | bsz 450 | num_updates 4452 | lr 0.0005 | gnorm 1.888 | clip 98.9 | train_wall 111 | wall 1538 (progress_bar.py:269, print())
[2021-04-20 21:47:04]    INFO >> epoch 012 | valid on 'valid' subset | loss 1.177 | mrr 0.81282 | sample_size 1000 | wps 4050 | wpb 1000 | bsz 1000 | num_updates 4452 | best_mrr 812.82 (progress_bar.py:269, print())
[2021-04-20 21:47:04]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/self_attn/checkpoints/checkpoint_best.pt (epoch 12 @ 4452 updates, score 0.81282) (writing took 0.540170 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 21:49:04]    INFO >> epoch 013 | loss 0.062 | mrr 0.989687 | sample_size 450 | wps 1294.6 | ups 2.88 | wpb 450 | bsz 450 | num_updates 4823 | lr 0.0005 | gnorm 1.823 | clip 99.5 | train_wall 111 | wall 1667 (progress_bar.py:269, print())
[2021-04-20 21:49:13]    INFO >> epoch 013 | valid on 'valid' subset | loss 1.242 | mrr 0.805413 | sample_size 1000 | wps 3952 | wpb 1000 | bsz 1000 | num_updates 4823 | best_mrr 805.413 (progress_bar.py:269, print())
[2021-04-20 21:49:13]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/self_attn/checkpoints/checkpoint_last.pt (epoch 13 @ 4823 updates, score 0.805413) (writing took 0.301851 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 21:50:14]    INFO >> epoch 014:    177 / 372 loss=0.065, mrr=445.16, sample_size=450, wps=1277.6, ups=2.84, wpb=450, bsz=450, num_updates=5000, lr=0.0005, gnorm=1.846, clip=99.3, train_wall=300, wall=1736 (progress_bar.py:262, log())
[2021-04-20 21:51:13]    INFO >> epoch 014 | loss 0.059 | mrr 0.990181 | sample_size 450 | wps 1293.6 | ups 2.87 | wpb 450 | bsz 450 | num_updates 5194 | lr 0.0005 | gnorm 1.72 | clip 99.5 | train_wall 111 | wall 1796 (progress_bar.py:269, print())
[2021-04-20 21:51:22]    INFO >> epoch 014 | valid on 'valid' subset | loss 1.227 | mrr 0.813232 | sample_size 1000 | wps 4019.2 | wpb 1000 | bsz 1000 | num_updates 5194 | best_mrr 813.232 (progress_bar.py:269, print())
[2021-04-20 21:51:23]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/self_attn/checkpoints/checkpoint_best.pt (epoch 14 @ 5194 updates, score 0.813232) (writing took 0.538273 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 21:53:22]    INFO >> epoch 015 | loss 0.054 | mrr 0.990926 | sample_size 450 | wps 1291.7 | ups 2.87 | wpb 450 | bsz 450 | num_updates 5565 | lr 0.0005 | gnorm 1.666 | clip 97.3 | train_wall 111 | wall 1925 (progress_bar.py:269, print())
[2021-04-20 21:53:31]    INFO >> epoch 015 | valid on 'valid' subset | loss 1.177 | mrr 0.816503 | sample_size 1000 | wps 4008.4 | wpb 1000 | bsz 1000 | num_updates 5565 | best_mrr 816.503 (progress_bar.py:269, print())
[2021-04-20 21:53:32]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/self_attn/checkpoints/checkpoint_best.pt (epoch 15 @ 5565 updates, score 0.816503) (writing took 0.491180 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 21:55:31]    INFO >> epoch 016 | loss 0.05 | mrr 0.991812 | sample_size 450 | wps 1295.7 | ups 2.88 | wpb 450 | bsz 450 | num_updates 5936 | lr 0.0005 | gnorm 1.568 | clip 97 | train_wall 111 | wall 2054 (progress_bar.py:269, print())
[2021-04-20 21:55:40]    INFO >> epoch 016 | valid on 'valid' subset | loss 1.185 | mrr 0.818612 | sample_size 1000 | wps 4016.6 | wpb 1000 | bsz 1000 | num_updates 5936 | best_mrr 818.612 (progress_bar.py:269, print())
[2021-04-20 21:55:41]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/self_attn/checkpoints/checkpoint_best.pt (epoch 16 @ 5936 updates, score 0.818612) (writing took 0.608444 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 21:56:06]    INFO >> epoch 017:     64 / 372 loss=0.054, mrr=446.007, sample_size=450, wps=1275.4, ups=2.83, wpb=450, bsz=450, num_updates=6000, lr=0.0005, gnorm=1.628, clip=97.6, train_wall=300, wall=2089 (progress_bar.py:262, log())
[2021-04-20 21:57:40]    INFO >> epoch 017 | loss 0.049 | mrr 0.991905 | sample_size 450 | wps 1293.5 | ups 2.87 | wpb 450 | bsz 450 | num_updates 6307 | lr 0.0005 | gnorm 1.513 | clip 94.3 | train_wall 111 | wall 2183 (progress_bar.py:269, print())
[2021-04-20 21:57:49]    INFO >> epoch 017 | valid on 'valid' subset | loss 1.169 | mrr 0.81921 | sample_size 1000 | wps 4000.4 | wpb 1000 | bsz 1000 | num_updates 6307 | best_mrr 819.21 (progress_bar.py:269, print())
[2021-04-20 21:57:49]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/self_attn/checkpoints/checkpoint_best.pt (epoch 17 @ 6307 updates, score 0.81921) (writing took 0.429191 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 21:59:49]    INFO >> epoch 018 | loss 0.047 | mrr 0.992601 | sample_size 450 | wps 1296.6 | ups 2.88 | wpb 450 | bsz 450 | num_updates 6678 | lr 0.0005 | gnorm 1.476 | clip 94.1 | train_wall 111 | wall 2312 (progress_bar.py:269, print())
[2021-04-20 21:59:58]    INFO >> epoch 018 | valid on 'valid' subset | loss 1.248 | mrr 0.81594 | sample_size 1000 | wps 3987.9 | wpb 1000 | bsz 1000 | num_updates 6678 | best_mrr 815.94 (progress_bar.py:269, print())
[2021-04-20 21:59:58]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/self_attn/checkpoints/checkpoint_last.pt (epoch 18 @ 6678 updates, score 0.81594) (writing took 0.276558 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 22:01:42]    INFO >> epoch 019:    323 / 372 loss=0.046, mrr=446.586, sample_size=450, wps=1339.3, ups=2.98, wpb=450, bsz=450, num_updates=7000, lr=0.0005, gnorm=1.469, clip=92.7, train_wall=300, wall=2425 (progress_bar.py:262, log())
[2021-04-20 22:01:58]    INFO >> epoch 019 | loss 0.045 | mrr 0.992678 | sample_size 450 | wps 1297.2 | ups 2.88 | wpb 450 | bsz 450 | num_updates 7049 | lr 0.0005 | gnorm 1.42 | clip 90.6 | train_wall 111 | wall 2440 (progress_bar.py:269, print())
[2021-04-20 22:02:06]    INFO >> epoch 019 | valid on 'valid' subset | loss 1.157 | mrr 0.820941 | sample_size 1000 | wps 3998.7 | wpb 1000 | bsz 1000 | num_updates 7049 | best_mrr 820.941 (progress_bar.py:269, print())
[2021-04-20 22:02:07]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/self_attn/checkpoints/checkpoint_best.pt (epoch 19 @ 7049 updates, score 0.820941) (writing took 0.579397 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 22:04:07]    INFO >> epoch 020 | loss 0.042 | mrr 0.993278 | sample_size 450 | wps 1294.9 | ups 2.88 | wpb 450 | bsz 450 | num_updates 7420 | lr 0.0005 | gnorm 1.373 | clip 88.7 | train_wall 111 | wall 2569 (progress_bar.py:269, print())
[2021-04-20 22:04:16]    INFO >> epoch 020 | valid on 'valid' subset | loss 1.226 | mrr 0.816935 | sample_size 1000 | wps 3967.7 | wpb 1000 | bsz 1000 | num_updates 7420 | best_mrr 816.935 (progress_bar.py:269, print())
[2021-04-20 22:04:16]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/self_attn/checkpoints/checkpoint_last.pt (epoch 20 @ 7420 updates, score 0.816935) (writing took 0.367540 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 22:06:15]    INFO >> epoch 021 | loss 0.04 | mrr 0.993345 | sample_size 450 | wps 1295.4 | ups 2.88 | wpb 450 | bsz 450 | num_updates 7791 | lr 0.0005 | gnorm 1.356 | clip 89.2 | train_wall 111 | wall 2698 (progress_bar.py:269, print())
[2021-04-20 22:06:24]    INFO >> epoch 021 | valid on 'valid' subset | loss 1.184 | mrr 0.820521 | sample_size 1000 | wps 3996.5 | wpb 1000 | bsz 1000 | num_updates 7791 | best_mrr 820.521 (progress_bar.py:269, print())
[2021-04-20 22:06:25]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/self_attn/checkpoints/checkpoint_last.pt (epoch 21 @ 7791 updates, score 0.820521) (writing took 0.427130 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 22:07:35]    INFO >> epoch 022:    210 / 372 loss=0.04, mrr=447.027, sample_size=450, wps=1277.3, ups=2.84, wpb=450, bsz=450, num_updates=8000, lr=0.0005, gnorm=1.353, clip=87.1, train_wall=300, wall=2777 (progress_bar.py:262, log())
[2021-04-20 22:08:24]    INFO >> epoch 022 | loss 0.038 | mrr 0.993846 | sample_size 450 | wps 1295.6 | ups 2.88 | wpb 450 | bsz 450 | num_updates 8162 | lr 0.0005 | gnorm 1.285 | clip 80.1 | train_wall 111 | wall 2827 (progress_bar.py:269, print())
[2021-04-20 22:08:33]    INFO >> epoch 022 | valid on 'valid' subset | loss 1.25 | mrr 0.818135 | sample_size 1000 | wps 4021.4 | wpb 1000 | bsz 1000 | num_updates 8162 | best_mrr 818.135 (progress_bar.py:269, print())
[2021-04-20 22:08:34]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/self_attn/checkpoints/checkpoint_last.pt (epoch 22 @ 8162 updates, score 0.818135) (writing took 0.335456 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 22:10:33]    INFO >> epoch 023 | loss 0.036 | mrr 0.994273 | sample_size 450 | wps 1298.1 | ups 2.88 | wpb 450 | bsz 450 | num_updates 8533 | lr 0.0005 | gnorm 1.253 | clip 77.9 | train_wall 111 | wall 2956 (progress_bar.py:269, print())
[2021-04-20 22:10:42]    INFO >> epoch 023 | valid on 'valid' subset | loss 1.245 | mrr 0.815306 | sample_size 1000 | wps 4001.2 | wpb 1000 | bsz 1000 | num_updates 8533 | best_mrr 815.306 (progress_bar.py:269, print())
[2021-04-20 22:10:42]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/self_attn/checkpoints/checkpoint_last.pt (epoch 23 @ 8533 updates, score 0.815306) (writing took 0.445830 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 22:12:42]    INFO >> epoch 024 | loss 0.036 | mrr 0.993961 | sample_size 450 | wps 1295.6 | ups 2.88 | wpb 450 | bsz 450 | num_updates 8904 | lr 0.0005 | gnorm 1.262 | clip 81.7 | train_wall 111 | wall 3084 (progress_bar.py:269, print())
[2021-04-20 22:12:51]    INFO >> epoch 024 | valid on 'valid' subset | loss 1.222 | mrr 0.820059 | sample_size 1000 | wps 3992.7 | wpb 1000 | bsz 1000 | num_updates 8904 | best_mrr 820.059 (progress_bar.py:269, print())
[2021-04-20 22:12:51]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/self_attn/checkpoints/checkpoint_last.pt (epoch 24 @ 8904 updates, score 0.820059) (writing took 0.293379 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 22:13:26]    INFO >> epoch 025:     96 / 372 loss=0.036, mrr=447.334, sample_size=450, wps=1279.6, ups=2.84, wpb=450, bsz=450, num_updates=9000, lr=0.0005, gnorm=1.258, clip=79.7, train_wall=300, wall=3129 (progress_bar.py:262, log())
[2021-04-20 22:14:50]    INFO >> epoch 025 | loss 0.035 | mrr 0.994285 | sample_size 450 | wps 1299.2 | ups 2.89 | wpb 450 | bsz 450 | num_updates 9275 | lr 0.0005 | gnorm 1.221 | clip 76.5 | train_wall 111 | wall 3213 (progress_bar.py:269, print())
[2021-04-20 22:14:59]    INFO >> epoch 025 | valid on 'valid' subset | loss 1.192 | mrr 0.824694 | sample_size 1000 | wps 4066.8 | wpb 1000 | bsz 1000 | num_updates 9275 | best_mrr 824.694 (progress_bar.py:269, print())
[2021-04-20 22:15:00]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/self_attn/checkpoints/checkpoint_best.pt (epoch 25 @ 9275 updates, score 0.824694) (writing took 0.845097 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 22:16:59]    INFO >> epoch 026 | loss 0.031 | mrr 0.99499 | sample_size 450 | wps 1292.5 | ups 2.87 | wpb 450 | bsz 450 | num_updates 9646 | lr 0.0005 | gnorm 1.153 | clip 70.6 | train_wall 111 | wall 3342 (progress_bar.py:269, print())
[2021-04-20 22:17:07]    INFO >> epoch 026 | valid on 'valid' subset | loss 1.241 | mrr 0.820765 | sample_size 1000 | wps 4014.2 | wpb 1000 | bsz 1000 | num_updates 9646 | best_mrr 820.765 (progress_bar.py:269, print())
[2021-04-20 22:17:08]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/self_attn/checkpoints/checkpoint_last.pt (epoch 26 @ 9646 updates, score 0.820765) (writing took 0.278673 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 22:19:02]    INFO >> epoch 027:    355 / 372 loss=0.032, mrr=447.669, sample_size=450, wps=1341.5, ups=2.98, wpb=450, bsz=450, num_updates=10000, lr=0.0005, gnorm=1.17, clip=70.9, train_wall=300, wall=3464 (progress_bar.py:262, log())
[2021-04-20 22:19:07]    INFO >> epoch 027 | loss 0.03 | mrr 0.995045 | sample_size 450 | wps 1305.9 | ups 2.9 | wpb 450 | bsz 450 | num_updates 10017 | lr 0.0005 | gnorm 1.146 | clip 66.6 | train_wall 111 | wall 3470 (progress_bar.py:269, print())
[2021-04-20 22:19:15]    INFO >> epoch 027 | valid on 'valid' subset | loss 1.239 | mrr 0.820973 | sample_size 1000 | wps 4047.5 | wpb 1000 | bsz 1000 | num_updates 10017 | best_mrr 820.973 (progress_bar.py:269, print())
[2021-04-20 22:19:16]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/self_attn/checkpoints/checkpoint_last.pt (epoch 27 @ 10017 updates, score 0.820973) (writing took 0.277628 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 22:21:16]    INFO >> epoch 028 | loss 0.031 | mrr 0.99489 | sample_size 450 | wps 1298.9 | ups 2.89 | wpb 450 | bsz 450 | num_updates 10388 | lr 0.0005 | gnorm 1.136 | clip 66.3 | train_wall 111 | wall 3598 (progress_bar.py:269, print())
[2021-04-20 22:21:24]    INFO >> epoch 028 | valid on 'valid' subset | loss 1.222 | mrr 0.824602 | sample_size 1000 | wps 4051.8 | wpb 1000 | bsz 1000 | num_updates 10388 | best_mrr 824.602 (progress_bar.py:269, print())
[2021-04-20 22:21:24]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/self_attn/checkpoints/checkpoint_last.pt (epoch 28 @ 10388 updates, score 0.824602) (writing took 0.272907 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 22:23:24]    INFO >> epoch 029 | loss 0.029 | mrr 0.995222 | sample_size 450 | wps 1302.2 | ups 2.89 | wpb 450 | bsz 450 | num_updates 10759 | lr 0.0005 | gnorm 1.097 | clip 62.8 | train_wall 111 | wall 3727 (progress_bar.py:269, print())
[2021-04-20 22:23:34]    INFO >> epoch 029 | valid on 'valid' subset | loss 1.213 | mrr 0.824091 | sample_size 1000 | wps 4017 | wpb 1000 | bsz 1000 | num_updates 10759 | best_mrr 824.091 (progress_bar.py:269, print())
[2021-04-20 22:23:34]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/self_attn/checkpoints/checkpoint_last.pt (epoch 29 @ 10759 updates, score 0.824091) (writing took 0.369355 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 22:24:54]    INFO >> epoch 030:    242 / 372 loss=0.03, mrr=447.818, sample_size=450, wps=1279, ups=2.84, wpb=450, bsz=450, num_updates=11000, lr=0.0005, gnorm=1.099, clip=62.5, train_wall=300, wall=3816 (progress_bar.py:262, log())
[2021-04-20 22:25:33]    INFO >> epoch 030 | loss 0.028 | mrr 0.995238 | sample_size 450 | wps 1289.1 | ups 2.86 | wpb 450 | bsz 450 | num_updates 11130 | lr 0.0005 | gnorm 1.065 | clip 59.3 | train_wall 111 | wall 3856 (progress_bar.py:269, print())
[2021-04-20 22:25:42]    INFO >> epoch 030 | valid on 'valid' subset | loss 1.209 | mrr 0.82788 | sample_size 1000 | wps 3982.5 | wpb 1000 | bsz 1000 | num_updates 11130 | best_mrr 827.88 (progress_bar.py:269, print())
[2021-04-20 22:25:43]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/self_attn/checkpoints/checkpoint_best.pt (epoch 30 @ 11130 updates, score 0.82788) (writing took 0.547645 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 22:27:42]    INFO >> epoch 031 | loss 0.027 | mrr 0.995619 | sample_size 450 | wps 1296.6 | ups 2.88 | wpb 450 | bsz 450 | num_updates 11501 | lr 0.0005 | gnorm 1.05 | clip 57.7 | train_wall 111 | wall 3985 (progress_bar.py:269, print())
[2021-04-20 22:27:51]    INFO >> epoch 031 | valid on 'valid' subset | loss 1.225 | mrr 0.824556 | sample_size 1000 | wps 3779.4 | wpb 1000 | bsz 1000 | num_updates 11501 | best_mrr 824.556 (progress_bar.py:269, print())
[2021-04-20 22:27:52]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/self_attn/checkpoints/checkpoint_last.pt (epoch 31 @ 11501 updates, score 0.824556) (writing took 0.278767 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 22:29:51]    INFO >> epoch 032 | loss 0.027 | mrr 0.995489 | sample_size 450 | wps 1296.1 | ups 2.88 | wpb 450 | bsz 450 | num_updates 11872 | lr 0.0005 | gnorm 1.035 | clip 55 | train_wall 111 | wall 4114 (progress_bar.py:269, print())
[2021-04-20 22:30:00]    INFO >> epoch 032 | valid on 'valid' subset | loss 1.19 | mrr 0.830902 | sample_size 1000 | wps 4001.4 | wpb 1000 | bsz 1000 | num_updates 11872 | best_mrr 830.902 (progress_bar.py:269, print())
[2021-04-20 22:30:00]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/self_attn/checkpoints/checkpoint_best.pt (epoch 32 @ 11872 updates, score 0.830902) (writing took 0.399813 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 22:30:45]    INFO >> epoch 033:    129 / 372 loss=0.027, mrr=447.963, sample_size=450, wps=1278.9, ups=2.84, wpb=450, bsz=450, num_updates=12000, lr=0.0005, gnorm=1.045, clip=56.5, train_wall=300, wall=4168 (progress_bar.py:262, log())
[2021-04-20 22:32:00]    INFO >> epoch 033 | loss 0.026 | mrr 0.995671 | sample_size 450 | wps 1297.9 | ups 2.88 | wpb 450 | bsz 450 | num_updates 12243 | lr 0.0005 | gnorm 1.01 | clip 50.1 | train_wall 111 | wall 4242 (progress_bar.py:269, print())
[2021-04-20 22:32:09]    INFO >> epoch 033 | valid on 'valid' subset | loss 1.221 | mrr 0.824672 | sample_size 1000 | wps 3983.5 | wpb 1000 | bsz 1000 | num_updates 12243 | best_mrr 824.672 (progress_bar.py:269, print())
[2021-04-20 22:32:11]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/self_attn/checkpoints/checkpoint_last.pt (epoch 33 @ 12243 updates, score 0.824672) (writing took 2.362019 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 22:34:10]    INFO >> epoch 034 | loss 0.025 | mrr 0.995878 | sample_size 450 | wps 1279.2 | ups 2.84 | wpb 450 | bsz 450 | num_updates 12614 | lr 0.0005 | gnorm 0.974 | clip 43.7 | train_wall 111 | wall 4373 (progress_bar.py:269, print())
[2021-04-20 22:34:19]    INFO >> epoch 034 | valid on 'valid' subset | loss 1.196 | mrr 0.826921 | sample_size 1000 | wps 4022.6 | wpb 1000 | bsz 1000 | num_updates 12614 | best_mrr 826.921 (progress_bar.py:269, print())
[2021-04-20 22:34:19]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/self_attn/checkpoints/checkpoint_last.pt (epoch 34 @ 12614 updates, score 0.826921) (writing took 0.294994 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 22:36:19]    INFO >> epoch 035 | loss 0.026 | mrr 0.995877 | sample_size 450 | wps 1299.8 | ups 2.89 | wpb 450 | bsz 450 | num_updates 12985 | lr 0.0005 | gnorm 0.974 | clip 44.5 | train_wall 111 | wall 4501 (progress_bar.py:269, print())
[2021-04-20 22:36:28]    INFO >> epoch 035 | valid on 'valid' subset | loss 1.153 | mrr 0.834707 | sample_size 1000 | wps 3991.5 | wpb 1000 | bsz 1000 | num_updates 12985 | best_mrr 834.707 (progress_bar.py:269, print())
[2021-04-20 22:36:28]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/self_attn/checkpoints/checkpoint_best.pt (epoch 35 @ 12985 updates, score 0.834707) (writing took 0.601669 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 22:36:39]    INFO >> epoch 036:     15 / 372 loss=0.025, mrr=448.122, sample_size=450, wps=1272.9, ups=2.83, wpb=450, bsz=450, num_updates=13000, lr=0.0005, gnorm=0.986, clip=45.6, train_wall=300, wall=4522 (progress_bar.py:262, log())
[2021-04-20 22:38:27]    INFO >> epoch 036 | loss 0.024 | mrr 0.995982 | sample_size 450 | wps 1296.5 | ups 2.88 | wpb 450 | bsz 450 | num_updates 13356 | lr 0.0005 | gnorm 0.955 | clip 41.8 | train_wall 111 | wall 4630 (progress_bar.py:269, print())
[2021-04-20 22:38:36]    INFO >> epoch 036 | valid on 'valid' subset | loss 1.168 | mrr 0.831906 | sample_size 1000 | wps 3991.8 | wpb 1000 | bsz 1000 | num_updates 13356 | best_mrr 831.906 (progress_bar.py:269, print())
[2021-04-20 22:38:37]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/self_attn/checkpoints/checkpoint_last.pt (epoch 36 @ 13356 updates, score 0.831906) (writing took 0.208046 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 22:40:36]    INFO >> epoch 037 | loss 0.024 | mrr 0.996111 | sample_size 450 | wps 1301.4 | ups 2.89 | wpb 450 | bsz 450 | num_updates 13727 | lr 0.0005 | gnorm 0.938 | clip 42.6 | train_wall 111 | wall 4758 (progress_bar.py:269, print())
[2021-04-20 22:40:45]    INFO >> epoch 037 | valid on 'valid' subset | loss 1.183 | mrr 0.827497 | sample_size 1000 | wps 3950.7 | wpb 1000 | bsz 1000 | num_updates 13727 | best_mrr 827.497 (progress_bar.py:269, print())
[2021-04-20 22:40:45]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/self_attn/checkpoints/checkpoint_last.pt (epoch 37 @ 13727 updates, score 0.827497) (writing took 0.250571 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 22:42:14]    INFO >> epoch 038:    274 / 372 loss=0.023, mrr=448.275, sample_size=450, wps=1343.1, ups=2.98, wpb=450, bsz=450, num_updates=14000, lr=0.0005, gnorm=0.927, clip=39.6, train_wall=300, wall=4857 (progress_bar.py:262, log())
[2021-04-20 22:42:44]    INFO >> epoch 038 | loss 0.023 | mrr 0.996324 | sample_size 450 | wps 1299.6 | ups 2.89 | wpb 450 | bsz 450 | num_updates 14098 | lr 0.0005 | gnorm 0.894 | clip 35.6 | train_wall 111 | wall 4887 (progress_bar.py:269, print())
[2021-04-20 22:42:53]    INFO >> epoch 038 | valid on 'valid' subset | loss 1.2 | mrr 0.827649 | sample_size 1000 | wps 3940.8 | wpb 1000 | bsz 1000 | num_updates 14098 | best_mrr 827.649 (progress_bar.py:269, print())
[2021-04-20 22:42:53]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/self_attn/checkpoints/checkpoint_last.pt (epoch 38 @ 14098 updates, score 0.827649) (writing took 0.227077 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 22:44:53]    INFO >> epoch 039 | loss 0.022 | mrr 0.996437 | sample_size 450 | wps 1299.6 | ups 2.89 | wpb 450 | bsz 450 | num_updates 14469 | lr 0.0005 | gnorm 0.905 | clip 38.3 | train_wall 111 | wall 5015 (progress_bar.py:269, print())
[2021-04-20 22:45:02]    INFO >> epoch 039 | valid on 'valid' subset | loss 1.173 | mrr 0.83101 | sample_size 1000 | wps 3971.2 | wpb 1000 | bsz 1000 | num_updates 14469 | best_mrr 831.01 (progress_bar.py:269, print())
[2021-04-20 22:45:02]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/self_attn/checkpoints/checkpoint_last.pt (epoch 39 @ 14469 updates, score 0.83101) (writing took 0.337008 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 22:47:01]    INFO >> epoch 040 | loss 0.022 | mrr 0.996531 | sample_size 450 | wps 1296.5 | ups 2.88 | wpb 450 | bsz 450 | num_updates 14840 | lr 0.0005 | gnorm 0.877 | clip 32.3 | train_wall 111 | wall 5144 (progress_bar.py:269, print())
[2021-04-20 22:47:10]    INFO >> epoch 040 | valid on 'valid' subset | loss 1.165 | mrr 0.828733 | sample_size 1000 | wps 4017 | wpb 1000 | bsz 1000 | num_updates 14840 | best_mrr 828.733 (progress_bar.py:269, print())
[2021-04-20 22:47:11]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/self_attn/checkpoints/checkpoint_last.pt (epoch 40 @ 14840 updates, score 0.828733) (writing took 0.250380 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 22:48:05]    INFO >> epoch 041:    161 / 372 loss=0.022, mrr=448.416, sample_size=450, wps=1281.2, ups=2.85, wpb=450, bsz=450, num_updates=15000, lr=0.0005, gnorm=0.885, clip=34.3, train_wall=300, wall=5208 (progress_bar.py:262, log())
[2021-04-20 22:49:10]    INFO >> epoch 041 | loss 0.021 | mrr 0.99665 | sample_size 450 | wps 1300.7 | ups 2.89 | wpb 450 | bsz 450 | num_updates 15211 | lr 0.0005 | gnorm 0.853 | clip 27.5 | train_wall 111 | wall 5272 (progress_bar.py:269, print())
[2021-04-20 22:49:19]    INFO >> epoch 041 | valid on 'valid' subset | loss 1.205 | mrr 0.830895 | sample_size 1000 | wps 3992.4 | wpb 1000 | bsz 1000 | num_updates 15211 | best_mrr 830.895 (progress_bar.py:269, print())
[2021-04-20 22:49:19]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/self_attn/checkpoints/checkpoint_last.pt (epoch 41 @ 15211 updates, score 0.830895) (writing took 0.260251 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 22:51:18]    INFO >> epoch 042 | loss 0.021 | mrr 0.996477 | sample_size 450 | wps 1298.7 | ups 2.89 | wpb 450 | bsz 450 | num_updates 15582 | lr 0.0005 | gnorm 0.874 | clip 31.5 | train_wall 111 | wall 5401 (progress_bar.py:269, print())
[2021-04-20 22:51:27]    INFO >> epoch 042 | valid on 'valid' subset | loss 1.195 | mrr 0.828958 | sample_size 1000 | wps 3908.5 | wpb 1000 | bsz 1000 | num_updates 15582 | best_mrr 828.958 (progress_bar.py:269, print())
[2021-04-20 22:51:27]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/self_attn/checkpoints/checkpoint_last.pt (epoch 42 @ 15582 updates, score 0.828958) (writing took 0.267696 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 22:53:27]    INFO >> epoch 043 | loss 0.019 | mrr 0.996777 | sample_size 450 | wps 1300 | ups 2.89 | wpb 450 | bsz 450 | num_updates 15953 | lr 0.0005 | gnorm 0.834 | clip 27.5 | train_wall 111 | wall 5529 (progress_bar.py:269, print())
[2021-04-20 22:53:36]    INFO >> epoch 043 | valid on 'valid' subset | loss 1.269 | mrr 0.822608 | sample_size 1000 | wps 4005.1 | wpb 1000 | bsz 1000 | num_updates 15953 | best_mrr 822.608 (progress_bar.py:269, print())
[2021-04-20 22:53:36]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/self_attn/checkpoints/checkpoint_last.pt (epoch 43 @ 15953 updates, score 0.822608) (writing took 0.845026 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 22:53:57]    INFO >> epoch 044:     47 / 372 loss=0.021, mrr=448.483, sample_size=450, wps=1279.7, ups=2.84, wpb=450, bsz=450, num_updates=16000, lr=0.0005, gnorm=0.856, clip=29, train_wall=300, wall=5560 (progress_bar.py:262, log())
[2021-04-20 22:55:36]    INFO >> epoch 044 | loss 0.021 | mrr 0.996704 | sample_size 450 | wps 1294.9 | ups 2.88 | wpb 450 | bsz 450 | num_updates 16324 | lr 0.0005 | gnorm 0.869 | clip 30.7 | train_wall 111 | wall 5658 (progress_bar.py:269, print())
[2021-04-20 22:55:45]    INFO >> epoch 044 | valid on 'valid' subset | loss 1.192 | mrr 0.8304 | sample_size 1000 | wps 4039.5 | wpb 1000 | bsz 1000 | num_updates 16324 | best_mrr 830.4 (progress_bar.py:269, print())
[2021-04-20 22:55:45]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/self_attn/checkpoints/checkpoint_last.pt (epoch 44 @ 16324 updates, score 0.8304) (writing took 0.219276 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 22:57:44]    INFO >> epoch 045 | loss 0.021 | mrr 0.996576 | sample_size 450 | wps 1300 | ups 2.89 | wpb 450 | bsz 450 | num_updates 16695 | lr 0.0005 | gnorm 0.844 | clip 28.3 | train_wall 111 | wall 5787 (progress_bar.py:269, print())
[2021-04-20 22:57:53]    INFO >> epoch 045 | valid on 'valid' subset | loss 1.25 | mrr 0.825906 | sample_size 1000 | wps 4039.8 | wpb 1000 | bsz 1000 | num_updates 16695 | best_mrr 825.906 (progress_bar.py:269, print())
[2021-04-20 22:57:53]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/go/self_attn/checkpoints/checkpoint_last.pt (epoch 45 @ 16695 updates, score 0.825906) (writing took 0.183158 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 22:57:53]    INFO >> early stop since valid performance hasn't improved for last 10 runs (train.py:191, should_stop_early())
[2021-04-20 22:57:53]    INFO >> early stop since valid performance hasn't improved for last 10 runs (train.py:272, single_main())
[2021-04-20 22:57:53]    INFO >> done training in 5795.7 seconds (train.py:283, single_main())
