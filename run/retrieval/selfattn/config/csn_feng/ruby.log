nohup: 忽略输入
[2021-04-20 15:43:17]    INFO >> Load arguments in /home/yanghe/Documents/naturalcc-dev/run/retrieval/selfattn/config/csn_feng/ruby.yml (train.py:302, cli_main())
[2021-04-20 15:43:17]    INFO >> {'criterion': 'retrieval_softmax', 'optimizer': 'torch_adam', 'lr_scheduler': 'fixed', 'tokenizer': None, 'bpe': None, 'common': {'no_progress_bar': 0, 'log_interval': 1000, 'log_format': 'simple', 'tensorboard_logdir': '', 'seed': 0, 'cpu': 0, 'fp16': 0, 'memory_efficient_fp16': 0, 'fp16_no_flatten_grads': 0, 'fp16_init_scale': 128, 'fp16_scale_window': None, 'fp16_scale_tolerance': 0.0, 'min_loss_scale': 0.0001, 'threshold_loss_scale': None, 'user_dir': None, 'empty_cache_freq': 0, 'all_gather_list_size': 16384, 'task': 'hybrid_retrieval'}, 'dataset': {'num_workers': 3, 'skip_invalid_size_inputs_valid_test': 0, 'max_tokens': None, 'max_sentences': 450, 'code_max_tokens': 200, 'query_max_tokens': 30, 'required_batch_size_multiple': 1, 'dataset_impl': 'mmap', 'train_subset': 'train', 'valid_subset': 'valid', 'validate_interval': 1, 'fixed_validation_seed': None, 'disable_validation': None, 'max_tokens_valid': None, 'max_sentences_valid': 1000, 'curriculum': 0, 'gen_subset': 'test', 'num_shards': 1, 'shard_id': 0, 'joined_dictionary': 0, 'langs': ['ruby']}, 'distributed_training': {'distributed_world_size': 1, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': None, 'distributed_port': -1, 'device_id': 0, 'distributed_no_spawn': 0, 'ddp_backend': 'c10d', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': None, 'find_unused_parameters': 0, 'fast_stat_sync': 0, 'broadcast_buffers': 0, 'global_sync_iter': 50, 'warmup_iterations': 500, 'local_rank': -1, 'block_momentum': 0.875, 'block_lr': 1, 'use_nbm': 0, 'average_sync': 0}, 'task': {'data': '/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all', 'sample_break_mode': 'complete', 'tokens_per_sample': 512, 'mask_prob': 0.15, 'leave_unmasked_prob': 0.1, 'random_token_prob': 0.1, 'freq_weighted_replacement': 0, 'mask_whole_words': 0, 'pooler_activation_fn': 'tanh', 'source_lang': 'code_tokens', 'target_lang': 'docstring_tokens', 'source_aux_lang': 'code_tokens.wo_func', 'target_aux_lang': 'func_name', 'fraction_using_func_name': 0.3, 'load_alignments': 0, 'left_pad_source': 1, 'left_pad_target': 0, 'upsample_primary': 1, 'truncate_source': 0, 'eval_mrr': 1}, 'model': {'arch': 'self_attn', 'code_embed_dim': 128, 'code_token_types': 1, 'code_max_tokens': 200, 'code_position_encoding': 'learned', 'code_dropout': 0.1, 'code_pooling': 'weighted_mean', 'query_embed_dim': 128, 'query_token_types': 1, 'query_max_tokens': 30, 'query_self_attn_layers': 3, 'query_pooling': 'weighted_mean', 'query_position_encoding': 'learned', 'query_dropout': 0.1, 'self_attn_layers': 3, 'attention_heads': 8, 'ffn_embed_dim': 512, 'activation_fn': 'gelu'}, 'optimization': {'max_epoch': 300, 'max_update': 0, 'clip_norm': 1, 'sentence_avg': 0, 'update_freq': [1], 'lrs': [0.0005], 'min_lr': -1, 'use_bmuf': 0, 'lr_shrink': 1.0, 'force_anneal': 0, 'warmup_updates': 0, 'end_learning_rate': 0.0, 'power': 1.0, 'total_num_update': 1000000, 'adam': {'adam_betas': '(0.9, 0.999)', 'adam_eps': 1e-08, 'weight_decay': 0, 'use_old_adam': 1}, 'margin': 1, 'clip_norm_version': 'tf_clip_by_global_norm'}, 'checkpoint': {'save_dir': '/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/self_attn/checkpoints', 'restore_file': 'checkpoint_last.pt', 'reset_dataloader': None, 'reset_lr_scheduler': None, 'reset_meters': None, 'reset_optimizer': None, 'optimizer_overrides': '{}', 'save_interval': 1, 'save_interval_updates': 0, 'keep_interval_updates': 0, 'keep_last_epochs': -1, 'keep_best_checkpoints': -1, 'no_save': 0, 'no_epoch_checkpoints': 1, 'no_last_checkpoints': 0, 'no_save_optimizer_state': None, 'best_checkpoint_metric': 'mrr', 'maximize_best_checkpoint_metric': 1, 'patience': 10}, 'eval': {'path': '/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/self_attn/checkpoints/checkpoint_best.pt', 'quiet': 1, 'max_sentences': 450, 'model_overrides': '{}', 'eval_size': -1}} (train.py:304, cli_main())
[2021-04-20 15:43:17]    INFO >> single GPU training... (train.py:333, cli_main())
[2021-04-20 15:43:17]    INFO >> loaded 1400 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/valid.ruby.code_tokens'] (hybrid_retrieval.py:54, load_tokens_dataset())
[2021-04-20 15:43:17]    INFO >> loaded 1400 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/valid.ruby.docstring_tokens'] (hybrid_retrieval.py:55, load_tokens_dataset())
[2021-04-20 15:43:18]    INFO >> SelfAttn(
  (src_encoders): ModuleDict(
    (ruby): SelfAttnEncoder(
      (embed): Embedding(10000, 128, padding_idx=0)
      (type_embed): Embedding(1, 128)
      (embed_layer_norm): LayerNorm((128,), eps=1e-08, elementwise_affine=True)
      (layers): ModuleList(
        (0): TransformerEncoderLayer(
          (self_attn): MultiheadAttention(
            (k_proj): Linear(in_features=128, out_features=128, bias=True)
            (v_proj): Linear(in_features=128, out_features=128, bias=True)
            (q_proj): Linear(in_features=128, out_features=128, bias=True)
            (out_proj): Linear(in_features=128, out_features=128, bias=True)
          )
          (self_attn_layer_norm): LayerNorm((128,), eps=1e-08, elementwise_affine=True)
          (fc1): Linear(in_features=128, out_features=512, bias=True)
          (fc2): Linear(in_features=512, out_features=128, bias=True)
          (ff_layer_norm): LayerNorm((128,), eps=1e-08, elementwise_affine=True)
        )
        (1): TransformerEncoderLayer(
          (self_attn): MultiheadAttention(
            (k_proj): Linear(in_features=128, out_features=128, bias=True)
            (v_proj): Linear(in_features=128, out_features=128, bias=True)
            (q_proj): Linear(in_features=128, out_features=128, bias=True)
            (out_proj): Linear(in_features=128, out_features=128, bias=True)
          )
          (self_attn_layer_norm): LayerNorm((128,), eps=1e-08, elementwise_affine=True)
          (fc1): Linear(in_features=128, out_features=512, bias=True)
          (fc2): Linear(in_features=512, out_features=128, bias=True)
          (ff_layer_norm): LayerNorm((128,), eps=1e-08, elementwise_affine=True)
        )
        (2): TransformerEncoderLayer(
          (self_attn): MultiheadAttention(
            (k_proj): Linear(in_features=128, out_features=128, bias=True)
            (v_proj): Linear(in_features=128, out_features=128, bias=True)
            (q_proj): Linear(in_features=128, out_features=128, bias=True)
            (out_proj): Linear(in_features=128, out_features=128, bias=True)
          )
          (self_attn_layer_norm): LayerNorm((128,), eps=1e-08, elementwise_affine=True)
          (fc1): Linear(in_features=128, out_features=512, bias=True)
          (fc2): Linear(in_features=512, out_features=128, bias=True)
          (ff_layer_norm): LayerNorm((128,), eps=1e-08, elementwise_affine=True)
        )
      )
      (weight_layer): Linear(in_features=128, out_features=1, bias=False)
    )
  )
  (tgt_encoders): SelfAttnEncoder(
    (embed): Embedding(10000, 128, padding_idx=0)
    (type_embed): Embedding(1, 128)
    (embed_layer_norm): LayerNorm((128,), eps=1e-08, elementwise_affine=True)
    (layers): ModuleList(
      (0): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (k_proj): Linear(in_features=128, out_features=128, bias=True)
          (v_proj): Linear(in_features=128, out_features=128, bias=True)
          (q_proj): Linear(in_features=128, out_features=128, bias=True)
          (out_proj): Linear(in_features=128, out_features=128, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((128,), eps=1e-08, elementwise_affine=True)
        (fc1): Linear(in_features=128, out_features=512, bias=True)
        (fc2): Linear(in_features=512, out_features=128, bias=True)
        (ff_layer_norm): LayerNorm((128,), eps=1e-08, elementwise_affine=True)
      )
      (1): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (k_proj): Linear(in_features=128, out_features=128, bias=True)
          (v_proj): Linear(in_features=128, out_features=128, bias=True)
          (q_proj): Linear(in_features=128, out_features=128, bias=True)
          (out_proj): Linear(in_features=128, out_features=128, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((128,), eps=1e-08, elementwise_affine=True)
        (fc1): Linear(in_features=128, out_features=512, bias=True)
        (fc2): Linear(in_features=512, out_features=128, bias=True)
        (ff_layer_norm): LayerNorm((128,), eps=1e-08, elementwise_affine=True)
      )
      (2): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (k_proj): Linear(in_features=128, out_features=128, bias=True)
          (v_proj): Linear(in_features=128, out_features=128, bias=True)
          (q_proj): Linear(in_features=128, out_features=128, bias=True)
          (out_proj): Linear(in_features=128, out_features=128, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((128,), eps=1e-08, elementwise_affine=True)
        (fc1): Linear(in_features=128, out_features=512, bias=True)
        (fc2): Linear(in_features=512, out_features=128, bias=True)
        (ff_layer_norm): LayerNorm((128,), eps=1e-08, elementwise_affine=True)
      )
    )
    (weight_layer): Linear(in_features=128, out_features=1, bias=False)
  )
) (train.py:223, single_main())
[2021-04-20 15:43:18]    INFO >> model self_attn, criterion SearchSoftmaxCriterion (train.py:224, single_main())
[2021-04-20 15:43:18]    INFO >> num. model params: 3780096 (num. trained: 3780096) (train.py:227, single_main())
[2021-04-20 15:43:20]    INFO >> training on 1 GPUs (train.py:233, single_main())
[2021-04-20 15:43:20]    INFO >> max tokens per GPU = None and max sentences per GPU = 450 (train.py:236, single_main())
[2021-04-20 15:43:20]    INFO >> no existing checkpoint found /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/self_attn/checkpoints/checkpoint_last.pt (ncc_trainers.py:270, load_checkpoint())
[2021-04-20 15:43:20]    INFO >> loading train data for epoch 1 (ncc_trainers.py:285, get_train_iterator())
[2021-04-20 15:43:20]    INFO >> loaded 24927 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.ruby.code_tokens'] (hybrid_retrieval.py:54, load_tokens_dataset())
[2021-04-20 15:43:20]    INFO >> loaded 24927 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.ruby.docstring_tokens'] (hybrid_retrieval.py:55, load_tokens_dataset())
[2021-04-20 15:43:20]    INFO >> loaded 24927 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.ruby.code_tokens.wo_func'] (hybrid_retrieval.py:67, load_tokens_dataset())
[2021-04-20 15:43:20]    INFO >> loaded 24927 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.ruby.func_name'] (hybrid_retrieval.py:81, load_tokens_dataset())
[2021-04-20 15:43:20]    INFO >> NOTE: your device may support faster training with fp16 (ncc_trainers.py:155, _setup_optimizer())
[2021-04-20 15:43:43]    INFO >> epoch 001 | loss 5.889 | mrr 0.048297 | sample_size 450 | wps 1457.1 | ups 3.24 | wpb 450 | bsz 450 | num_updates 55 | lr 0.0005 | gnorm 1.832 | clip 76.4 | train_wall 17 | wall 24 (progress_bar.py:269, print())
[2021-04-20 15:43:51]    INFO >> epoch 001 | valid on 'valid' subset | loss 6.391 | mrr 0.050269 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 55 (progress_bar.py:269, print())
[2021-04-20 15:43:51]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/self_attn/checkpoints/checkpoint_best.pt (epoch 1 @ 55 updates, score 0.050269) (writing took 0.428591 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 15:44:19]    INFO >> epoch 002 | loss 4.672 | mrr 0.217715 | sample_size 450 | wps 696.5 | ups 1.55 | wpb 450 | bsz 450 | num_updates 110 | lr 0.0005 | gnorm 5.205 | clip 100 | train_wall 20 | wall 59 (progress_bar.py:269, print())
[2021-04-20 15:44:26]    INFO >> epoch 002 | valid on 'valid' subset | loss 5.541 | mrr 0.151627 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 110 | best_mrr 151.627 (progress_bar.py:269, print())
[2021-04-20 15:44:26]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/self_attn/checkpoints/checkpoint_best.pt (epoch 2 @ 110 updates, score 0.151627) (writing took 0.416703 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 15:44:50]    INFO >> epoch 003 | loss 3.096 | mrr 0.468076 | sample_size 450 | wps 805.8 | ups 1.79 | wpb 450 | bsz 450 | num_updates 165 | lr 0.0005 | gnorm 8.73 | clip 100 | train_wall 16 | wall 90 (progress_bar.py:269, print())
[2021-04-20 15:44:56]    INFO >> epoch 003 | valid on 'valid' subset | loss 4.946 | mrr 0.244003 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 165 | best_mrr 244.003 (progress_bar.py:269, print())
[2021-04-20 15:44:57]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/self_attn/checkpoints/checkpoint_best.pt (epoch 3 @ 165 updates, score 0.244003) (writing took 0.544600 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 15:45:22]    INFO >> epoch 004 | loss 1.983 | mrr 0.660781 | sample_size 450 | wps 765.7 | ups 1.7 | wpb 450 | bsz 450 | num_updates 220 | lr 0.0005 | gnorm 9.048 | clip 100 | train_wall 18 | wall 122 (progress_bar.py:269, print())
[2021-04-20 15:45:30]    INFO >> epoch 004 | valid on 'valid' subset | loss 4.726 | mrr 0.29506 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 220 | best_mrr 295.06 (progress_bar.py:269, print())
[2021-04-20 15:45:30]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/self_attn/checkpoints/checkpoint_best.pt (epoch 4 @ 220 updates, score 0.29506) (writing took 0.575478 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 15:45:54]    INFO >> epoch 005 | loss 1.276 | mrr 0.785272 | sample_size 450 | wps 785.7 | ups 1.75 | wpb 450 | bsz 450 | num_updates 275 | lr 0.0005 | gnorm 8.563 | clip 100 | train_wall 16 | wall 154 (progress_bar.py:269, print())
[2021-04-20 15:46:00]    INFO >> epoch 005 | valid on 'valid' subset | loss 4.715 | mrr 0.315937 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 275 | best_mrr 315.937 (progress_bar.py:269, print())
[2021-04-20 15:46:01]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/self_attn/checkpoints/checkpoint_best.pt (epoch 5 @ 275 updates, score 0.315937) (writing took 0.436191 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 15:46:24]    INFO >> epoch 006 | loss 0.837 | mrr 0.862008 | sample_size 450 | wps 817.1 | ups 1.82 | wpb 450 | bsz 450 | num_updates 330 | lr 0.0005 | gnorm 7.503 | clip 100 | train_wall 16 | wall 184 (progress_bar.py:269, print())
[2021-04-20 15:46:31]    INFO >> epoch 006 | valid on 'valid' subset | loss 4.855 | mrr 0.349503 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 330 | best_mrr 349.503 (progress_bar.py:269, print())
[2021-04-20 15:46:32]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/self_attn/checkpoints/checkpoint_best.pt (epoch 6 @ 330 updates, score 0.349503) (writing took 0.447671 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 15:46:55]    INFO >> epoch 007 | loss 0.56 | mrr 0.908995 | sample_size 450 | wps 794.1 | ups 1.76 | wpb 450 | bsz 450 | num_updates 385 | lr 0.0005 | gnorm 6.786 | clip 100 | train_wall 16 | wall 215 (progress_bar.py:269, print())
[2021-04-20 15:47:02]    INFO >> epoch 007 | valid on 'valid' subset | loss 5.088 | mrr 0.348581 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 385 | best_mrr 348.581 (progress_bar.py:269, print())
[2021-04-20 15:47:02]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/self_attn/checkpoints/checkpoint_last.pt (epoch 7 @ 385 updates, score 0.348581) (writing took 0.243219 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 15:47:25]    INFO >> epoch 008 | loss 0.404 | mrr 0.935778 | sample_size 450 | wps 815.3 | ups 1.81 | wpb 450 | bsz 450 | num_updates 440 | lr 0.0005 | gnorm 6.151 | clip 100 | train_wall 16 | wall 245 (progress_bar.py:269, print())
[2021-04-20 15:47:33]    INFO >> epoch 008 | valid on 'valid' subset | loss 5.204 | mrr 0.350043 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 440 | best_mrr 350.043 (progress_bar.py:269, print())
[2021-04-20 15:47:34]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/self_attn/checkpoints/checkpoint_best.pt (epoch 8 @ 440 updates, score 0.350043) (writing took 1.234396 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 15:47:57]    INFO >> epoch 009 | loss 0.292 | mrr 0.953708 | sample_size 450 | wps 774.5 | ups 1.72 | wpb 450 | bsz 450 | num_updates 495 | lr 0.0005 | gnorm 5.637 | clip 100 | train_wall 17 | wall 277 (progress_bar.py:269, print())
[2021-04-20 15:48:04]    INFO >> epoch 009 | valid on 'valid' subset | loss 5.255 | mrr 0.371805 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 495 | best_mrr 371.805 (progress_bar.py:269, print())
[2021-04-20 15:48:04]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/self_attn/checkpoints/checkpoint_best.pt (epoch 9 @ 495 updates, score 0.371805) (writing took 0.383695 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 15:48:28]    INFO >> epoch 010 | loss 0.234 | mrr 0.96352 | sample_size 450 | wps 813.2 | ups 1.81 | wpb 450 | bsz 450 | num_updates 550 | lr 0.0005 | gnorm 5.041 | clip 100 | train_wall 16 | wall 308 (progress_bar.py:269, print())
[2021-04-20 15:48:35]    INFO >> epoch 010 | valid on 'valid' subset | loss 5.366 | mrr 0.360868 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 550 | best_mrr 360.868 (progress_bar.py:269, print())
[2021-04-20 15:48:36]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/self_attn/checkpoints/checkpoint_last.pt (epoch 10 @ 550 updates, score 0.360868) (writing took 0.288314 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 15:48:59]    INFO >> epoch 011 | loss 0.189 | mrr 0.97086 | sample_size 450 | wps 798.5 | ups 1.77 | wpb 450 | bsz 450 | num_updates 605 | lr 0.0005 | gnorm 4.733 | clip 100 | train_wall 16 | wall 339 (progress_bar.py:269, print())
[2021-04-20 15:49:05]    INFO >> epoch 011 | valid on 'valid' subset | loss 5.615 | mrr 0.362396 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 605 | best_mrr 362.396 (progress_bar.py:269, print())
[2021-04-20 15:49:06]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/self_attn/checkpoints/checkpoint_last.pt (epoch 11 @ 605 updates, score 0.362396) (writing took 0.203655 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 15:49:29]    INFO >> epoch 012 | loss 0.165 | mrr 0.974735 | sample_size 450 | wps 814.2 | ups 1.81 | wpb 450 | bsz 450 | num_updates 660 | lr 0.0005 | gnorm 4.566 | clip 100 | train_wall 16 | wall 369 (progress_bar.py:269, print())
[2021-04-20 15:49:37]    INFO >> epoch 012 | valid on 'valid' subset | loss 5.601 | mrr 0.357355 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 660 | best_mrr 357.355 (progress_bar.py:269, print())
[2021-04-20 15:49:37]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/self_attn/checkpoints/checkpoint_last.pt (epoch 12 @ 660 updates, score 0.357355) (writing took 0.287347 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 15:50:00]    INFO >> epoch 013 | loss 0.136 | mrr 0.978647 | sample_size 450 | wps 789.8 | ups 1.76 | wpb 450 | bsz 450 | num_updates 715 | lr 0.0005 | gnorm 4.076 | clip 100 | train_wall 16 | wall 401 (progress_bar.py:269, print())
[2021-04-20 15:50:07]    INFO >> epoch 013 | valid on 'valid' subset | loss 5.644 | mrr 0.377473 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 715 | best_mrr 377.473 (progress_bar.py:269, print())
[2021-04-20 15:50:08]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/self_attn/checkpoints/checkpoint_best.pt (epoch 13 @ 715 updates, score 0.377473) (writing took 0.391148 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 15:50:31]    INFO >> epoch 014 | loss 0.128 | mrr 0.981023 | sample_size 450 | wps 805.1 | ups 1.79 | wpb 450 | bsz 450 | num_updates 770 | lr 0.0005 | gnorm 3.976 | clip 100 | train_wall 16 | wall 431 (progress_bar.py:269, print())
[2021-04-20 15:50:39]    INFO >> epoch 014 | valid on 'valid' subset | loss 5.873 | mrr 0.364787 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 770 | best_mrr 364.787 (progress_bar.py:269, print())
[2021-04-20 15:50:39]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/self_attn/checkpoints/checkpoint_last.pt (epoch 14 @ 770 updates, score 0.364787) (writing took 0.192694 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 15:51:03]    INFO >> epoch 015 | loss 0.11 | mrr 0.982934 | sample_size 450 | wps 790.9 | ups 1.76 | wpb 450 | bsz 450 | num_updates 825 | lr 0.0005 | gnorm 3.77 | clip 100 | train_wall 16 | wall 463 (progress_bar.py:269, print())
[2021-04-20 15:51:10]    INFO >> epoch 015 | valid on 'valid' subset | loss 5.899 | mrr 0.374172 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 825 | best_mrr 374.172 (progress_bar.py:269, print())
[2021-04-20 15:51:10]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/self_attn/checkpoints/checkpoint_last.pt (epoch 15 @ 825 updates, score 0.374172) (writing took 0.213546 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 15:51:33]    INFO >> epoch 016 | loss 0.104 | mrr 0.984519 | sample_size 450 | wps 802.8 | ups 1.78 | wpb 450 | bsz 450 | num_updates 880 | lr 0.0005 | gnorm 3.657 | clip 100 | train_wall 16 | wall 493 (progress_bar.py:269, print())
[2021-04-20 15:51:41]    INFO >> epoch 016 | valid on 'valid' subset | loss 5.896 | mrr 0.384994 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 880 | best_mrr 384.994 (progress_bar.py:269, print())
[2021-04-20 15:51:41]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/self_attn/checkpoints/checkpoint_best.pt (epoch 16 @ 880 updates, score 0.384994) (writing took 0.473557 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 15:52:06]    INFO >> epoch 017 | loss 0.091 | mrr 0.985968 | sample_size 450 | wps 759.1 | ups 1.69 | wpb 450 | bsz 450 | num_updates 935 | lr 0.0005 | gnorm 3.478 | clip 100 | train_wall 16 | wall 526 (progress_bar.py:269, print())
[2021-04-20 15:52:13]    INFO >> epoch 017 | valid on 'valid' subset | loss 6.004 | mrr 0.38654 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 935 | best_mrr 386.54 (progress_bar.py:269, print())
[2021-04-20 15:52:13]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/self_attn/checkpoints/checkpoint_best.pt (epoch 17 @ 935 updates, score 0.38654) (writing took 0.367628 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 15:52:38]    INFO >> epoch 018 | loss 0.085 | mrr 0.987042 | sample_size 450 | wps 783.3 | ups 1.74 | wpb 450 | bsz 450 | num_updates 990 | lr 0.0005 | gnorm 3.282 | clip 100 | train_wall 16 | wall 558 (progress_bar.py:269, print())
[2021-04-20 15:52:47]    INFO >> epoch 018 | valid on 'valid' subset | loss 5.977 | mrr 0.375346 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 990 | best_mrr 375.346 (progress_bar.py:269, print())
[2021-04-20 15:52:48]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/self_attn/checkpoints/checkpoint_last.pt (epoch 18 @ 990 updates, score 0.375346) (writing took 0.294919 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 15:53:00]    INFO >> epoch 019:     10 / 56 loss=1.115, mrr=367.039, sample_size=450, wps=784.9, ups=1.74, wpb=450, bsz=450, num_updates=1000, lr=0.0005, gnorm=5.311, clip=98.7, train_wall=305, wall=580 (progress_bar.py:262, log())
[2021-04-20 15:53:14]    INFO >> epoch 019 | loss 0.083 | mrr 0.987352 | sample_size 450 | wps 687.6 | ups 1.53 | wpb 450 | bsz 450 | num_updates 1045 | lr 0.0005 | gnorm 3.199 | clip 100 | train_wall 16 | wall 594 (progress_bar.py:269, print())
[2021-04-20 15:53:21]    INFO >> epoch 019 | valid on 'valid' subset | loss 6.194 | mrr 0.386347 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 1045 | best_mrr 386.347 (progress_bar.py:269, print())
[2021-04-20 15:53:21]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/self_attn/checkpoints/checkpoint_last.pt (epoch 19 @ 1045 updates, score 0.386347) (writing took 0.205786 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 15:53:44]    INFO >> epoch 020 | loss 0.074 | mrr 0.988573 | sample_size 450 | wps 809.3 | ups 1.8 | wpb 450 | bsz 450 | num_updates 1100 | lr 0.0005 | gnorm 3.03 | clip 100 | train_wall 16 | wall 624 (progress_bar.py:269, print())
[2021-04-20 15:53:52]    INFO >> epoch 020 | valid on 'valid' subset | loss 6.199 | mrr 0.38427 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 1100 | best_mrr 384.27 (progress_bar.py:269, print())
[2021-04-20 15:53:53]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/self_attn/checkpoints/checkpoint_last.pt (epoch 20 @ 1100 updates, score 0.38427) (writing took 0.246884 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 15:54:16]    INFO >> epoch 021 | loss 0.072 | mrr 0.989088 | sample_size 450 | wps 775.4 | ups 1.72 | wpb 450 | bsz 450 | num_updates 1155 | lr 0.0005 | gnorm 3.052 | clip 100 | train_wall 17 | wall 656 (progress_bar.py:269, print())
[2021-04-20 15:54:23]    INFO >> epoch 021 | valid on 'valid' subset | loss 6.197 | mrr 0.384979 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 1155 | best_mrr 384.979 (progress_bar.py:269, print())
[2021-04-20 15:54:23]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/self_attn/checkpoints/checkpoint_last.pt (epoch 21 @ 1155 updates, score 0.384979) (writing took 0.202259 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 15:54:46]    INFO >> epoch 022 | loss 0.07 | mrr 0.989337 | sample_size 450 | wps 816.8 | ups 1.82 | wpb 450 | bsz 450 | num_updates 1210 | lr 0.0005 | gnorm 2.926 | clip 100 | train_wall 16 | wall 687 (progress_bar.py:269, print())
[2021-04-20 15:54:54]    INFO >> epoch 022 | valid on 'valid' subset | loss 6.39 | mrr 0.38335 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 1210 | best_mrr 383.35 (progress_bar.py:269, print())
[2021-04-20 15:54:54]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/self_attn/checkpoints/checkpoint_last.pt (epoch 22 @ 1210 updates, score 0.38335) (writing took 0.203221 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 15:55:18]    INFO >> epoch 023 | loss 0.068 | mrr 0.990025 | sample_size 450 | wps 780.3 | ups 1.73 | wpb 450 | bsz 450 | num_updates 1265 | lr 0.0005 | gnorm 2.831 | clip 100 | train_wall 16 | wall 718 (progress_bar.py:269, print())
[2021-04-20 15:55:25]    INFO >> epoch 023 | valid on 'valid' subset | loss 6.102 | mrr 0.384088 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 1265 | best_mrr 384.088 (progress_bar.py:269, print())
[2021-04-20 15:55:25]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/self_attn/checkpoints/checkpoint_last.pt (epoch 23 @ 1265 updates, score 0.384088) (writing took 0.252965 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 15:55:48]    INFO >> epoch 024 | loss 0.058 | mrr 0.991152 | sample_size 450 | wps 817.3 | ups 1.82 | wpb 450 | bsz 450 | num_updates 1320 | lr 0.0005 | gnorm 2.724 | clip 100 | train_wall 16 | wall 749 (progress_bar.py:269, print())
[2021-04-20 15:55:56]    INFO >> epoch 024 | valid on 'valid' subset | loss 6.208 | mrr 0.39061 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 1320 | best_mrr 390.61 (progress_bar.py:269, print())
[2021-04-20 15:55:57]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/self_attn/checkpoints/checkpoint_best.pt (epoch 24 @ 1320 updates, score 0.39061) (writing took 0.471434 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 15:56:20]    INFO >> epoch 025 | loss 0.062 | mrr 0.990807 | sample_size 450 | wps 786.2 | ups 1.75 | wpb 450 | bsz 450 | num_updates 1375 | lr 0.0005 | gnorm 2.85 | clip 100 | train_wall 16 | wall 780 (progress_bar.py:269, print())
[2021-04-20 15:56:27]    INFO >> epoch 025 | valid on 'valid' subset | loss 6.164 | mrr 0.390843 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 1375 | best_mrr 390.843 (progress_bar.py:269, print())
[2021-04-20 15:56:27]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/self_attn/checkpoints/checkpoint_best.pt (epoch 25 @ 1375 updates, score 0.390843) (writing took 0.411179 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 15:56:50]    INFO >> epoch 026 | loss 0.054 | mrr 0.991645 | sample_size 450 | wps 811.8 | ups 1.8 | wpb 450 | bsz 450 | num_updates 1430 | lr 0.0005 | gnorm 2.573 | clip 100 | train_wall 16 | wall 810 (progress_bar.py:269, print())
[2021-04-20 15:56:58]    INFO >> epoch 026 | valid on 'valid' subset | loss 6.359 | mrr 0.383959 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 1430 | best_mrr 383.959 (progress_bar.py:269, print())
[2021-04-20 15:56:58]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/self_attn/checkpoints/checkpoint_last.pt (epoch 26 @ 1430 updates, score 0.383959) (writing took 0.292035 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 15:57:21]    INFO >> epoch 027 | loss 0.054 | mrr 0.99154 | sample_size 450 | wps 796.1 | ups 1.77 | wpb 450 | bsz 450 | num_updates 1485 | lr 0.0005 | gnorm 2.618 | clip 100 | train_wall 16 | wall 842 (progress_bar.py:269, print())
[2021-04-20 15:57:28]    INFO >> epoch 027 | valid on 'valid' subset | loss 6.446 | mrr 0.385129 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 1485 | best_mrr 385.129 (progress_bar.py:269, print())
[2021-04-20 15:57:28]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/self_attn/checkpoints/checkpoint_last.pt (epoch 27 @ 1485 updates, score 0.385129) (writing took 0.241108 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 15:57:52]    INFO >> epoch 028 | loss 0.052 | mrr 0.992277 | sample_size 450 | wps 819.9 | ups 1.82 | wpb 450 | bsz 450 | num_updates 1540 | lr 0.0005 | gnorm 2.607 | clip 100 | train_wall 16 | wall 872 (progress_bar.py:269, print())
[2021-04-20 15:57:59]    INFO >> epoch 028 | valid on 'valid' subset | loss 6.591 | mrr 0.386407 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 1540 | best_mrr 386.407 (progress_bar.py:269, print())
[2021-04-20 15:58:00]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/self_attn/checkpoints/checkpoint_last.pt (epoch 28 @ 1540 updates, score 0.386407) (writing took 0.459335 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 15:58:23]    INFO >> epoch 029 | loss 0.053 | mrr 0.99221 | sample_size 450 | wps 795.2 | ups 1.77 | wpb 450 | bsz 450 | num_updates 1595 | lr 0.0005 | gnorm 2.52 | clip 100 | train_wall 16 | wall 903 (progress_bar.py:269, print())
[2021-04-20 15:58:29]    INFO >> epoch 029 | valid on 'valid' subset | loss 6.446 | mrr 0.387463 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 1595 | best_mrr 387.463 (progress_bar.py:269, print())
[2021-04-20 15:58:30]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/self_attn/checkpoints/checkpoint_last.pt (epoch 29 @ 1595 updates, score 0.387463) (writing took 0.370841 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 15:58:53]    INFO >> epoch 030 | loss 0.052 | mrr 0.992094 | sample_size 450 | wps 809.9 | ups 1.8 | wpb 450 | bsz 450 | num_updates 1650 | lr 0.0005 | gnorm 2.446 | clip 100 | train_wall 16 | wall 933 (progress_bar.py:269, print())
[2021-04-20 15:59:01]    INFO >> epoch 030 | valid on 'valid' subset | loss 6.446 | mrr 0.387671 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 1650 | best_mrr 387.671 (progress_bar.py:269, print())
[2021-04-20 15:59:01]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/self_attn/checkpoints/checkpoint_last.pt (epoch 30 @ 1650 updates, score 0.387671) (writing took 0.210568 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 15:59:25]    INFO >> epoch 031 | loss 0.047 | mrr 0.9927 | sample_size 450 | wps 792.7 | ups 1.76 | wpb 450 | bsz 450 | num_updates 1705 | lr 0.0005 | gnorm 2.453 | clip 100 | train_wall 17 | wall 965 (progress_bar.py:269, print())
[2021-04-20 15:59:31]    INFO >> epoch 031 | valid on 'valid' subset | loss 6.38 | mrr 0.393196 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 1705 | best_mrr 393.196 (progress_bar.py:269, print())
[2021-04-20 15:59:32]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/self_attn/checkpoints/checkpoint_best.pt (epoch 31 @ 1705 updates, score 0.393196) (writing took 0.782467 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 15:59:55]    INFO >> epoch 032 | loss 0.047 | mrr 0.992918 | sample_size 450 | wps 800.4 | ups 1.78 | wpb 450 | bsz 450 | num_updates 1760 | lr 0.0005 | gnorm 2.38 | clip 100 | train_wall 16 | wall 996 (progress_bar.py:269, print())
[2021-04-20 16:00:03]    INFO >> epoch 032 | valid on 'valid' subset | loss 6.191 | mrr 0.405122 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 1760 | best_mrr 405.122 (progress_bar.py:269, print())
[2021-04-20 16:00:04]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/self_attn/checkpoints/checkpoint_best.pt (epoch 32 @ 1760 updates, score 0.405122) (writing took 1.038306 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 16:00:27]    INFO >> epoch 033 | loss 0.044 | mrr 0.993689 | sample_size 450 | wps 776.8 | ups 1.73 | wpb 450 | bsz 450 | num_updates 1815 | lr 0.0005 | gnorm 2.194 | clip 100 | train_wall 16 | wall 1027 (progress_bar.py:269, print())
[2021-04-20 16:00:34]    INFO >> epoch 033 | valid on 'valid' subset | loss 6.394 | mrr 0.407865 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 1815 | best_mrr 407.865 (progress_bar.py:269, print())
[2021-04-20 16:00:35]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/self_attn/checkpoints/checkpoint_best.pt (epoch 33 @ 1815 updates, score 0.407865) (writing took 0.511792 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 16:00:58]    INFO >> epoch 034 | loss 0.045 | mrr 0.992972 | sample_size 450 | wps 810.2 | ups 1.8 | wpb 450 | bsz 450 | num_updates 1870 | lr 0.0005 | gnorm 2.379 | clip 100 | train_wall 16 | wall 1058 (progress_bar.py:269, print())
[2021-04-20 16:01:05]    INFO >> epoch 034 | valid on 'valid' subset | loss 6.641 | mrr 0.395564 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 1870 | best_mrr 395.564 (progress_bar.py:269, print())
[2021-04-20 16:01:06]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/self_attn/checkpoints/checkpoint_last.pt (epoch 34 @ 1870 updates, score 0.395564) (writing took 0.248636 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 16:01:29]    INFO >> epoch 035 | loss 0.041 | mrr 0.993988 | sample_size 450 | wps 790.1 | ups 1.76 | wpb 450 | bsz 450 | num_updates 1925 | lr 0.0005 | gnorm 2.133 | clip 100 | train_wall 16 | wall 1089 (progress_bar.py:269, print())
[2021-04-20 16:01:36]    INFO >> epoch 035 | valid on 'valid' subset | loss 6.803 | mrr 0.392919 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 1925 | best_mrr 392.919 (progress_bar.py:269, print())
[2021-04-20 16:01:36]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/self_attn/checkpoints/checkpoint_last.pt (epoch 35 @ 1925 updates, score 0.392919) (writing took 0.434898 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 16:02:00]    INFO >> epoch 036 | loss 0.039 | mrr 0.994188 | sample_size 450 | wps 812.7 | ups 1.81 | wpb 450 | bsz 450 | num_updates 1980 | lr 0.0005 | gnorm 2.122 | clip 98.2 | train_wall 16 | wall 1120 (progress_bar.py:269, print())
[2021-04-20 16:02:07]    INFO >> epoch 036 | valid on 'valid' subset | loss 6.794 | mrr 0.393096 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 1980 | best_mrr 393.096 (progress_bar.py:269, print())
[2021-04-20 16:02:07]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/self_attn/checkpoints/checkpoint_last.pt (epoch 36 @ 1980 updates, score 0.393096) (writing took 0.225395 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 16:02:20]    INFO >> epoch 037:     21 / 56 loss=0.056, mrr=446.201, sample_size=450, wps=803, ups=1.78, wpb=450, bsz=450, num_updates=2000, lr=0.0005, gnorm=2.597, clip=99.9, train_wall=300, wall=1140 (progress_bar.py:262, log())
[2021-04-20 16:02:31]    INFO >> epoch 037 | loss 0.038 | mrr 0.994017 | sample_size 450 | wps 790 | ups 1.76 | wpb 450 | bsz 450 | num_updates 2035 | lr 0.0005 | gnorm 2.129 | clip 98.2 | train_wall 16 | wall 1151 (progress_bar.py:269, print())
[2021-04-20 16:02:38]    INFO >> epoch 037 | valid on 'valid' subset | loss 6.645 | mrr 0.390497 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 2035 | best_mrr 390.497 (progress_bar.py:269, print())
[2021-04-20 16:02:38]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/self_attn/checkpoints/checkpoint_last.pt (epoch 37 @ 2035 updates, score 0.390497) (writing took 0.234945 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 16:03:01]    INFO >> epoch 038 | loss 0.041 | mrr 0.99412 | sample_size 450 | wps 816.8 | ups 1.82 | wpb 450 | bsz 450 | num_updates 2090 | lr 0.0005 | gnorm 2.031 | clip 98.2 | train_wall 16 | wall 1181 (progress_bar.py:269, print())
[2021-04-20 16:03:09]    INFO >> epoch 038 | valid on 'valid' subset | loss 6.501 | mrr 0.396009 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 2090 | best_mrr 396.009 (progress_bar.py:269, print())
[2021-04-20 16:03:09]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/self_attn/checkpoints/checkpoint_last.pt (epoch 38 @ 2090 updates, score 0.396009) (writing took 0.217777 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 16:03:32]    INFO >> epoch 039 | loss 0.038 | mrr 0.994404 | sample_size 450 | wps 794.5 | ups 1.77 | wpb 450 | bsz 450 | num_updates 2145 | lr 0.0005 | gnorm 2.058 | clip 100 | train_wall 16 | wall 1213 (progress_bar.py:269, print())
[2021-04-20 16:03:39]    INFO >> epoch 039 | valid on 'valid' subset | loss 6.929 | mrr 0.40667 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 2145 | best_mrr 406.67 (progress_bar.py:269, print())
[2021-04-20 16:03:39]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/self_attn/checkpoints/checkpoint_last.pt (epoch 39 @ 2145 updates, score 0.40667) (writing took 0.239947 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 16:04:03]    INFO >> epoch 040 | loss 0.041 | mrr 0.993895 | sample_size 450 | wps 801.4 | ups 1.78 | wpb 450 | bsz 450 | num_updates 2200 | lr 0.0005 | gnorm 2.219 | clip 100 | train_wall 17 | wall 1243 (progress_bar.py:269, print())
[2021-04-20 16:04:11]    INFO >> epoch 040 | valid on 'valid' subset | loss 6.69 | mrr 0.391511 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 2200 | best_mrr 391.511 (progress_bar.py:269, print())
[2021-04-20 16:04:11]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/self_attn/checkpoints/checkpoint_last.pt (epoch 40 @ 2200 updates, score 0.391511) (writing took 0.247456 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 16:04:35]    INFO >> epoch 041 | loss 0.036 | mrr 0.994446 | sample_size 450 | wps 786 | ups 1.75 | wpb 450 | bsz 450 | num_updates 2255 | lr 0.0005 | gnorm 2.029 | clip 98.2 | train_wall 16 | wall 1275 (progress_bar.py:269, print())
[2021-04-20 16:04:42]    INFO >> epoch 041 | valid on 'valid' subset | loss 6.663 | mrr 0.397383 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 2255 | best_mrr 397.383 (progress_bar.py:269, print())
[2021-04-20 16:04:42]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/self_attn/checkpoints/checkpoint_last.pt (epoch 41 @ 2255 updates, score 0.397383) (writing took 0.219712 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 16:05:06]    INFO >> epoch 042 | loss 0.036 | mrr 0.99434 | sample_size 450 | wps 791.9 | ups 1.76 | wpb 450 | bsz 450 | num_updates 2310 | lr 0.0005 | gnorm 2.006 | clip 100 | train_wall 16 | wall 1306 (progress_bar.py:269, print())
[2021-04-20 16:05:14]    INFO >> epoch 042 | valid on 'valid' subset | loss 6.52 | mrr 0.404255 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 2310 | best_mrr 404.255 (progress_bar.py:269, print())
[2021-04-20 16:05:14]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/self_attn/checkpoints/checkpoint_last.pt (epoch 42 @ 2310 updates, score 0.404255) (writing took 0.235535 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 16:05:38]    INFO >> epoch 043 | loss 0.034 | mrr 0.994811 | sample_size 450 | wps 771.6 | ups 1.71 | wpb 450 | bsz 450 | num_updates 2365 | lr 0.0005 | gnorm 1.972 | clip 98.2 | train_wall 16 | wall 1338 (progress_bar.py:269, print())
[2021-04-20 16:05:45]    INFO >> epoch 043 | valid on 'valid' subset | loss 6.706 | mrr 0.394798 | sample_size 1000 | wps 0 | wpb 1000 | bsz 1000 | num_updates 2365 | best_mrr 394.798 (progress_bar.py:269, print())
[2021-04-20 16:05:45]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/ruby/self_attn/checkpoints/checkpoint_last.pt (epoch 43 @ 2365 updates, score 0.394798) (writing took 0.292805 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 16:05:45]    INFO >> early stop since valid performance hasn't improved for last 10 runs (train.py:191, should_stop_early())
[2021-04-20 16:05:45]    INFO >> early stop since valid performance hasn't improved for last 10 runs (train.py:272, single_main())
[2021-04-20 16:05:45]    INFO >> done training in 1345.4 seconds (train.py:283, single_main())
