nohup: 忽略输入
[2021-04-20 18:12:52]    INFO >> Load arguments in /home/yanghe/Documents/naturalcc-dev/run/retrieval/selfattn/config/csn_feng/php.yml (train.py:302, cli_main())
[2021-04-20 18:12:52]    INFO >> {'criterion': 'retrieval_softmax', 'optimizer': 'torch_adam', 'lr_scheduler': 'fixed', 'tokenizer': None, 'bpe': None, 'common': {'no_progress_bar': 0, 'log_interval': 1000, 'log_format': 'simple', 'tensorboard_logdir': '', 'seed': 0, 'cpu': 0, 'fp16': 0, 'memory_efficient_fp16': 0, 'fp16_no_flatten_grads': 0, 'fp16_init_scale': 128, 'fp16_scale_window': None, 'fp16_scale_tolerance': 0.0, 'min_loss_scale': 0.0001, 'threshold_loss_scale': None, 'user_dir': None, 'empty_cache_freq': 0, 'all_gather_list_size': 16384, 'task': 'hybrid_retrieval'}, 'dataset': {'num_workers': 3, 'skip_invalid_size_inputs_valid_test': 0, 'max_tokens': None, 'max_sentences': 450, 'code_max_tokens': 200, 'query_max_tokens': 30, 'required_batch_size_multiple': 1, 'dataset_impl': 'mmap', 'train_subset': 'train', 'valid_subset': 'valid', 'validate_interval': 1, 'fixed_validation_seed': None, 'disable_validation': None, 'max_tokens_valid': None, 'max_sentences_valid': 1000, 'curriculum': 0, 'gen_subset': 'test', 'num_shards': 1, 'shard_id': 0, 'joined_dictionary': 0, 'langs': ['php']}, 'distributed_training': {'distributed_world_size': 1, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': None, 'distributed_port': -1, 'device_id': 0, 'distributed_no_spawn': 0, 'ddp_backend': 'c10d', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': None, 'find_unused_parameters': 0, 'fast_stat_sync': 0, 'broadcast_buffers': 0, 'global_sync_iter': 50, 'warmup_iterations': 500, 'local_rank': -1, 'block_momentum': 0.875, 'block_lr': 1, 'use_nbm': 0, 'average_sync': 0}, 'task': {'data': '/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all', 'sample_break_mode': 'complete', 'tokens_per_sample': 512, 'mask_prob': 0.15, 'leave_unmasked_prob': 0.1, 'random_token_prob': 0.1, 'freq_weighted_replacement': 0, 'mask_whole_words': 0, 'pooler_activation_fn': 'tanh', 'source_lang': 'code_tokens', 'target_lang': 'docstring_tokens', 'source_aux_lang': 'code_tokens.wo_func', 'target_aux_lang': 'func_name', 'fraction_using_func_name': 0.3, 'load_alignments': 0, 'left_pad_source': 1, 'left_pad_target': 0, 'upsample_primary': 1, 'truncate_source': 0, 'eval_mrr': 1}, 'model': {'arch': 'self_attn', 'code_embed_dim': 128, 'code_token_types': 1, 'code_max_tokens': 200, 'code_position_encoding': 'learned', 'code_dropout': 0.1, 'code_pooling': 'weighted_mean', 'query_embed_dim': 128, 'query_token_types': 1, 'query_max_tokens': 30, 'query_self_attn_layers': 3, 'query_pooling': 'weighted_mean', 'query_position_encoding': 'learned', 'query_dropout': 0.1, 'self_attn_layers': 3, 'attention_heads': 8, 'ffn_embed_dim': 512, 'activation_fn': 'gelu'}, 'optimization': {'max_epoch': 300, 'max_update': 0, 'clip_norm': 1, 'sentence_avg': 0, 'update_freq': [1], 'lrs': [0.0005], 'min_lr': -1, 'use_bmuf': 0, 'lr_shrink': 1.0, 'force_anneal': 0, 'warmup_updates': 0, 'end_learning_rate': 0.0, 'power': 1.0, 'total_num_update': 1000000, 'adam': {'adam_betas': '(0.9, 0.999)', 'adam_eps': 1e-08, 'weight_decay': 0, 'use_old_adam': 1}, 'margin': 1, 'clip_norm_version': 'tf_clip_by_global_norm'}, 'checkpoint': {'save_dir': '/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/self_attn/checkpoints', 'restore_file': 'checkpoint_last.pt', 'reset_dataloader': None, 'reset_lr_scheduler': None, 'reset_meters': None, 'reset_optimizer': None, 'optimizer_overrides': '{}', 'save_interval': 1, 'save_interval_updates': 0, 'keep_interval_updates': 0, 'keep_last_epochs': -1, 'keep_best_checkpoints': -1, 'no_save': 0, 'no_epoch_checkpoints': 1, 'no_last_checkpoints': 0, 'no_save_optimizer_state': None, 'best_checkpoint_metric': 'mrr', 'maximize_best_checkpoint_metric': 1, 'patience': 10}, 'eval': {'path': '/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/self_attn/checkpoints/checkpoint_best.pt', 'quiet': 1, 'max_sentences': 450, 'model_overrides': '{}', 'eval_size': -1}} (train.py:304, cli_main())
[2021-04-20 18:12:52]    INFO >> single GPU training... (train.py:333, cli_main())
[2021-04-20 18:12:52]    INFO >> loaded 12982 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/valid.php.code_tokens'] (hybrid_retrieval.py:54, load_tokens_dataset())
[2021-04-20 18:12:52]    INFO >> loaded 12982 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/valid.php.docstring_tokens'] (hybrid_retrieval.py:55, load_tokens_dataset())
[2021-04-20 18:12:53]    INFO >> SelfAttn(
  (src_encoders): ModuleDict(
    (php): SelfAttnEncoder(
      (embed): Embedding(10000, 128, padding_idx=0)
      (type_embed): Embedding(1, 128)
      (embed_layer_norm): LayerNorm((128,), eps=1e-08, elementwise_affine=True)
      (layers): ModuleList(
        (0): TransformerEncoderLayer(
          (self_attn): MultiheadAttention(
            (k_proj): Linear(in_features=128, out_features=128, bias=True)
            (v_proj): Linear(in_features=128, out_features=128, bias=True)
            (q_proj): Linear(in_features=128, out_features=128, bias=True)
            (out_proj): Linear(in_features=128, out_features=128, bias=True)
          )
          (self_attn_layer_norm): LayerNorm((128,), eps=1e-08, elementwise_affine=True)
          (fc1): Linear(in_features=128, out_features=512, bias=True)
          (fc2): Linear(in_features=512, out_features=128, bias=True)
          (ff_layer_norm): LayerNorm((128,), eps=1e-08, elementwise_affine=True)
        )
        (1): TransformerEncoderLayer(
          (self_attn): MultiheadAttention(
            (k_proj): Linear(in_features=128, out_features=128, bias=True)
            (v_proj): Linear(in_features=128, out_features=128, bias=True)
            (q_proj): Linear(in_features=128, out_features=128, bias=True)
            (out_proj): Linear(in_features=128, out_features=128, bias=True)
          )
          (self_attn_layer_norm): LayerNorm((128,), eps=1e-08, elementwise_affine=True)
          (fc1): Linear(in_features=128, out_features=512, bias=True)
          (fc2): Linear(in_features=512, out_features=128, bias=True)
          (ff_layer_norm): LayerNorm((128,), eps=1e-08, elementwise_affine=True)
        )
        (2): TransformerEncoderLayer(
          (self_attn): MultiheadAttention(
            (k_proj): Linear(in_features=128, out_features=128, bias=True)
            (v_proj): Linear(in_features=128, out_features=128, bias=True)
            (q_proj): Linear(in_features=128, out_features=128, bias=True)
            (out_proj): Linear(in_features=128, out_features=128, bias=True)
          )
          (self_attn_layer_norm): LayerNorm((128,), eps=1e-08, elementwise_affine=True)
          (fc1): Linear(in_features=128, out_features=512, bias=True)
          (fc2): Linear(in_features=512, out_features=128, bias=True)
          (ff_layer_norm): LayerNorm((128,), eps=1e-08, elementwise_affine=True)
        )
      )
      (weight_layer): Linear(in_features=128, out_features=1, bias=False)
    )
  )
  (tgt_encoders): SelfAttnEncoder(
    (embed): Embedding(10000, 128, padding_idx=0)
    (type_embed): Embedding(1, 128)
    (embed_layer_norm): LayerNorm((128,), eps=1e-08, elementwise_affine=True)
    (layers): ModuleList(
      (0): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (k_proj): Linear(in_features=128, out_features=128, bias=True)
          (v_proj): Linear(in_features=128, out_features=128, bias=True)
          (q_proj): Linear(in_features=128, out_features=128, bias=True)
          (out_proj): Linear(in_features=128, out_features=128, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((128,), eps=1e-08, elementwise_affine=True)
        (fc1): Linear(in_features=128, out_features=512, bias=True)
        (fc2): Linear(in_features=512, out_features=128, bias=True)
        (ff_layer_norm): LayerNorm((128,), eps=1e-08, elementwise_affine=True)
      )
      (1): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (k_proj): Linear(in_features=128, out_features=128, bias=True)
          (v_proj): Linear(in_features=128, out_features=128, bias=True)
          (q_proj): Linear(in_features=128, out_features=128, bias=True)
          (out_proj): Linear(in_features=128, out_features=128, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((128,), eps=1e-08, elementwise_affine=True)
        (fc1): Linear(in_features=128, out_features=512, bias=True)
        (fc2): Linear(in_features=512, out_features=128, bias=True)
        (ff_layer_norm): LayerNorm((128,), eps=1e-08, elementwise_affine=True)
      )
      (2): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (k_proj): Linear(in_features=128, out_features=128, bias=True)
          (v_proj): Linear(in_features=128, out_features=128, bias=True)
          (q_proj): Linear(in_features=128, out_features=128, bias=True)
          (out_proj): Linear(in_features=128, out_features=128, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((128,), eps=1e-08, elementwise_affine=True)
        (fc1): Linear(in_features=128, out_features=512, bias=True)
        (fc2): Linear(in_features=512, out_features=128, bias=True)
        (ff_layer_norm): LayerNorm((128,), eps=1e-08, elementwise_affine=True)
      )
    )
    (weight_layer): Linear(in_features=128, out_features=1, bias=False)
  )
) (train.py:223, single_main())
[2021-04-20 18:12:53]    INFO >> model self_attn, criterion SearchSoftmaxCriterion (train.py:224, single_main())
[2021-04-20 18:12:53]    INFO >> num. model params: 3780096 (num. trained: 3780096) (train.py:227, single_main())
[2021-04-20 18:12:55]    INFO >> training on 1 GPUs (train.py:233, single_main())
[2021-04-20 18:12:55]    INFO >> max tokens per GPU = None and max sentences per GPU = 450 (train.py:236, single_main())
[2021-04-20 18:12:55]    INFO >> no existing checkpoint found /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/self_attn/checkpoints/checkpoint_last.pt (ncc_trainers.py:270, load_checkpoint())
[2021-04-20 18:12:55]    INFO >> loading train data for epoch 1 (ncc_trainers.py:285, get_train_iterator())
[2021-04-20 18:12:56]    INFO >> loaded 241241 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.php.code_tokens'] (hybrid_retrieval.py:54, load_tokens_dataset())
[2021-04-20 18:12:56]    INFO >> loaded 241241 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.php.docstring_tokens'] (hybrid_retrieval.py:55, load_tokens_dataset())
[2021-04-20 18:12:56]    INFO >> loaded 241241 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.php.code_tokens.wo_func'] (hybrid_retrieval.py:67, load_tokens_dataset())
[2021-04-20 18:12:56]    INFO >> loaded 241241 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.php.func_name'] (hybrid_retrieval.py:81, load_tokens_dataset())
[2021-04-20 18:12:56]    INFO >> NOTE: your device may support faster training with fp16 (ncc_trainers.py:155, _setup_optimizer())
[2021-04-20 18:15:46]    INFO >> epoch 001 | loss 2.445 | mrr 0.593687 | sample_size 450 | wps 1475.1 | ups 3.28 | wpb 450 | bsz 450 | num_updates 536 | lr 0.0005 | gnorm 6.704 | clip 97.6 | train_wall 161 | wall 171 (progress_bar.py:269, print())
[2021-04-20 18:15:57]    INFO >> epoch 001 | valid on 'valid' subset | loss 2.219 | mrr 0.63461 | sample_size 1000 | wps 4156.1 | wpb 1000 | bsz 1000 | num_updates 536 (progress_bar.py:269, print())
[2021-04-20 18:15:58]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/self_attn/checkpoints/checkpoint_best.pt (epoch 1 @ 536 updates, score 0.63461) (writing took 0.502176 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 18:18:26]    INFO >> epoch 002:    465 / 537 loss=1.705, mrr=322.173, sample_size=450, wps=1393.3, ups=3.1, wpb=450, bsz=450, num_updates=1000, lr=0.0005, gnorm=6.392, clip=98.7, train_wall=301, wall=330 (progress_bar.py:262, log())
[2021-04-20 18:18:48]    INFO >> epoch 002 | loss 0.84 | mrr 0.858755 | sample_size 450 | wps 1326.9 | ups 2.95 | wpb 450 | bsz 450 | num_updates 1072 | lr 0.0005 | gnorm 5.989 | clip 100 | train_wall 161 | wall 353 (progress_bar.py:269, print())
[2021-04-20 18:18:59]    INFO >> epoch 002 | valid on 'valid' subset | loss 1.936 | mrr 0.687633 | sample_size 1000 | wps 4253.2 | wpb 1000 | bsz 1000 | num_updates 1072 | best_mrr 687.633 (progress_bar.py:269, print())
[2021-04-20 18:18:59]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/self_attn/checkpoints/checkpoint_best.pt (epoch 2 @ 1072 updates, score 0.687633) (writing took 0.456345 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 18:21:50]    INFO >> epoch 003 | loss 0.556 | mrr 0.906578 | sample_size 450 | wps 1327.8 | ups 2.95 | wpb 450 | bsz 450 | num_updates 1608 | lr 0.0005 | gnorm 5.081 | clip 100 | train_wall 162 | wall 534 (progress_bar.py:269, print())
[2021-04-20 18:22:00]    INFO >> epoch 003 | valid on 'valid' subset | loss 1.906 | mrr 0.69563 | sample_size 1000 | wps 4271.3 | wpb 1000 | bsz 1000 | num_updates 1608 | best_mrr 695.63 (progress_bar.py:269, print())
[2021-04-20 18:22:01]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/self_attn/checkpoints/checkpoint_best.pt (epoch 3 @ 1608 updates, score 0.69563) (writing took 0.516326 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 18:24:07]    INFO >> epoch 004:    393 / 537 loss=0.517, mrr=410.932, sample_size=450, wps=1318.4, ups=2.93, wpb=450, bsz=450, num_updates=2000, lr=0.0005, gnorm=4.905, clip=100, train_wall=301, wall=672 (progress_bar.py:262, log())
[2021-04-20 18:24:52]    INFO >> epoch 004 | loss 0.423 | mrr 0.92887 | sample_size 450 | wps 1327.1 | ups 2.95 | wpb 450 | bsz 450 | num_updates 2144 | lr 0.0005 | gnorm 4.513 | clip 100 | train_wall 162 | wall 716 (progress_bar.py:269, print())
[2021-04-20 18:25:02]    INFO >> epoch 004 | valid on 'valid' subset | loss 1.913 | mrr 0.708045 | sample_size 1000 | wps 4241.2 | wpb 1000 | bsz 1000 | num_updates 2144 | best_mrr 708.045 (progress_bar.py:269, print())
[2021-04-20 18:25:02]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/self_attn/checkpoints/checkpoint_best.pt (epoch 4 @ 2144 updates, score 0.708045) (writing took 0.450535 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 18:27:54]    INFO >> epoch 005 | loss 0.335 | mrr 0.942897 | sample_size 450 | wps 1325 | ups 2.94 | wpb 450 | bsz 450 | num_updates 2680 | lr 0.0005 | gnorm 4.09 | clip 100 | train_wall 162 | wall 898 (progress_bar.py:269, print())
[2021-04-20 18:28:04]    INFO >> epoch 005 | valid on 'valid' subset | loss 1.92 | mrr 0.708883 | sample_size 1000 | wps 4224.8 | wpb 1000 | bsz 1000 | num_updates 2680 | best_mrr 708.883 (progress_bar.py:269, print())
[2021-04-20 18:28:05]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/self_attn/checkpoints/checkpoint_best.pt (epoch 5 @ 2680 updates, score 0.708883) (writing took 0.520225 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 18:29:49]    INFO >> epoch 006:    321 / 537 loss=0.33, mrr=424.77, sample_size=450, wps=1315.9, ups=2.92, wpb=450, bsz=450, num_updates=3000, lr=0.0005, gnorm=4.033, clip=100, train_wall=301, wall=1014 (progress_bar.py:262, log())
[2021-04-20 18:30:56]    INFO >> epoch 006 | loss 0.279 | mrr 0.952277 | sample_size 450 | wps 1325.7 | ups 2.95 | wpb 450 | bsz 450 | num_updates 3216 | lr 0.0005 | gnorm 3.771 | clip 100 | train_wall 162 | wall 1080 (progress_bar.py:269, print())
[2021-04-20 18:31:06]    INFO >> epoch 006 | valid on 'valid' subset | loss 2.039 | mrr 0.708524 | sample_size 1000 | wps 4196.7 | wpb 1000 | bsz 1000 | num_updates 3216 | best_mrr 708.524 (progress_bar.py:269, print())
[2021-04-20 18:31:06]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/self_attn/checkpoints/checkpoint_last.pt (epoch 6 @ 3216 updates, score 0.708524) (writing took 0.244343 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 18:33:57]    INFO >> epoch 007 | loss 0.237 | mrr 0.959439 | sample_size 450 | wps 1328.5 | ups 2.95 | wpb 450 | bsz 450 | num_updates 3752 | lr 0.0005 | gnorm 3.51 | clip 100 | train_wall 162 | wall 1262 (progress_bar.py:269, print())
[2021-04-20 18:34:08]    INFO >> epoch 007 | valid on 'valid' subset | loss 2.078 | mrr 0.716414 | sample_size 1000 | wps 4244.7 | wpb 1000 | bsz 1000 | num_updates 3752 | best_mrr 716.414 (progress_bar.py:269, print())
[2021-04-20 18:34:08]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/self_attn/checkpoints/checkpoint_best.pt (epoch 7 @ 3752 updates, score 0.716414) (writing took 0.511262 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 18:35:31]    INFO >> epoch 008:    249 / 537 loss=0.238, mrr=431.67, sample_size=450, wps=1317.1, ups=2.93, wpb=450, bsz=450, num_updates=4000, lr=0.0005, gnorm=3.513, clip=100, train_wall=301, wall=1355 (progress_bar.py:262, log())
[2021-04-20 18:36:59]    INFO >> epoch 008 | loss 0.207 | mrr 0.964677 | sample_size 450 | wps 1324.9 | ups 2.94 | wpb 450 | bsz 450 | num_updates 4288 | lr 0.0005 | gnorm 3.309 | clip 100 | train_wall 161 | wall 1444 (progress_bar.py:269, print())
[2021-04-20 18:37:10]    INFO >> epoch 008 | valid on 'valid' subset | loss 2.067 | mrr 0.720531 | sample_size 1000 | wps 4199.7 | wpb 1000 | bsz 1000 | num_updates 4288 | best_mrr 720.531 (progress_bar.py:269, print())
[2021-04-20 18:37:10]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/self_attn/checkpoints/checkpoint_best.pt (epoch 8 @ 4288 updates, score 0.720531) (writing took 0.721120 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 18:40:01]    INFO >> epoch 009 | loss 0.181 | mrr 0.968851 | sample_size 450 | wps 1324.1 | ups 2.94 | wpb 450 | bsz 450 | num_updates 4824 | lr 0.0005 | gnorm 3.108 | clip 100 | train_wall 162 | wall 1626 (progress_bar.py:269, print())
[2021-04-20 18:40:12]    INFO >> epoch 009 | valid on 'valid' subset | loss 2.139 | mrr 0.717059 | sample_size 1000 | wps 4329.4 | wpb 1000 | bsz 1000 | num_updates 4824 | best_mrr 717.059 (progress_bar.py:269, print())
[2021-04-20 18:40:12]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/self_attn/checkpoints/checkpoint_last.pt (epoch 9 @ 4824 updates, score 0.717059) (writing took 0.327312 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 18:41:13]    INFO >> epoch 010:    176 / 537 loss=0.187, mrr=435.543, sample_size=450, wps=1316.9, ups=2.93, wpb=450, bsz=450, num_updates=5000, lr=0.0005, gnorm=3.138, clip=100, train_wall=301, wall=1697 (progress_bar.py:262, log())
[2021-04-20 18:43:03]    INFO >> epoch 010 | loss 0.166 | mrr 0.971294 | sample_size 450 | wps 1328.3 | ups 2.95 | wpb 450 | bsz 450 | num_updates 5360 | lr 0.0005 | gnorm 2.95 | clip 100 | train_wall 162 | wall 1808 (progress_bar.py:269, print())
[2021-04-20 18:43:13]    INFO >> epoch 010 | valid on 'valid' subset | loss 2.171 | mrr 0.715231 | sample_size 1000 | wps 4321.6 | wpb 1000 | bsz 1000 | num_updates 5360 | best_mrr 715.231 (progress_bar.py:269, print())
[2021-04-20 18:43:14]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/self_attn/checkpoints/checkpoint_last.pt (epoch 10 @ 5360 updates, score 0.715231) (writing took 0.199138 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 18:46:05]    INFO >> epoch 011 | loss 0.149 | mrr 0.97395 | sample_size 450 | wps 1327.5 | ups 2.95 | wpb 450 | bsz 450 | num_updates 5896 | lr 0.0005 | gnorm 2.821 | clip 100 | train_wall 162 | wall 1989 (progress_bar.py:269, print())
[2021-04-20 18:46:15]    INFO >> epoch 011 | valid on 'valid' subset | loss 2.144 | mrr 0.713878 | sample_size 1000 | wps 4213 | wpb 1000 | bsz 1000 | num_updates 5896 | best_mrr 713.878 (progress_bar.py:269, print())
[2021-04-20 18:46:15]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/self_attn/checkpoints/checkpoint_last.pt (epoch 11 @ 5896 updates, score 0.713878) (writing took 0.211306 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 18:46:54]    INFO >> epoch 012:    104 / 537 loss=0.155, mrr=437.902, sample_size=450, wps=1318.7, ups=2.93, wpb=450, bsz=450, num_updates=6000, lr=0.0005, gnorm=2.855, clip=100, train_wall=301, wall=2038 (progress_bar.py:262, log())
[2021-04-20 18:49:06]    INFO >> epoch 012 | loss 0.136 | mrr 0.976592 | sample_size 450 | wps 1329.2 | ups 2.95 | wpb 450 | bsz 450 | num_updates 6432 | lr 0.0005 | gnorm 2.683 | clip 100 | train_wall 161 | wall 2171 (progress_bar.py:269, print())
[2021-04-20 18:49:17]    INFO >> epoch 012 | valid on 'valid' subset | loss 2.237 | mrr 0.720901 | sample_size 1000 | wps 4295.3 | wpb 1000 | bsz 1000 | num_updates 6432 | best_mrr 720.901 (progress_bar.py:269, print())
[2021-04-20 18:49:17]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/self_attn/checkpoints/checkpoint_best.pt (epoch 12 @ 6432 updates, score 0.720901) (writing took 0.553292 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 18:52:08]    INFO >> epoch 013 | loss 0.126 | mrr 0.978249 | sample_size 450 | wps 1326.5 | ups 2.95 | wpb 450 | bsz 450 | num_updates 6968 | lr 0.0005 | gnorm 2.572 | clip 100 | train_wall 161 | wall 2353 (progress_bar.py:269, print())
[2021-04-20 18:52:19]    INFO >> epoch 013 | valid on 'valid' subset | loss 2.339 | mrr 0.71797 | sample_size 1000 | wps 4193.2 | wpb 1000 | bsz 1000 | num_updates 6968 | best_mrr 717.97 (progress_bar.py:269, print())
[2021-04-20 18:52:19]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/self_attn/checkpoints/checkpoint_last.pt (epoch 13 @ 6968 updates, score 0.71797) (writing took 0.360008 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 18:52:36]    INFO >> epoch 014:     32 / 537 loss=0.131, mrr=439.791, sample_size=450, wps=1316.6, ups=2.93, wpb=450, bsz=450, num_updates=7000, lr=0.0005, gnorm=2.629, clip=100, train_wall=301, wall=2380 (progress_bar.py:262, log())
[2021-04-20 18:55:10]    INFO >> epoch 014 | loss 0.117 | mrr 0.979682 | sample_size 450 | wps 1325.5 | ups 2.95 | wpb 450 | bsz 450 | num_updates 7504 | lr 0.0005 | gnorm 2.467 | clip 100 | train_wall 162 | wall 2535 (progress_bar.py:269, print())
[2021-04-20 18:55:20]    INFO >> epoch 014 | valid on 'valid' subset | loss 2.305 | mrr 0.719355 | sample_size 1000 | wps 4295.3 | wpb 1000 | bsz 1000 | num_updates 7504 | best_mrr 719.355 (progress_bar.py:269, print())
[2021-04-20 18:55:21]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/self_attn/checkpoints/checkpoint_last.pt (epoch 14 @ 7504 updates, score 0.719355) (writing took 0.266776 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 18:57:59]    INFO >> epoch 015:    497 / 537 loss=0.113, mrr=441.202, sample_size=450, wps=1392, ups=3.09, wpb=450, bsz=450, num_updates=8000, lr=0.0005, gnorm=2.412, clip=100, train_wall=301, wall=2703 (progress_bar.py:262, log())
[2021-04-20 18:58:12]    INFO >> epoch 015 | loss 0.109 | mrr 0.981167 | sample_size 450 | wps 1328.6 | ups 2.95 | wpb 450 | bsz 450 | num_updates 8040 | lr 0.0005 | gnorm 2.359 | clip 100 | train_wall 161 | wall 2716 (progress_bar.py:269, print())
[2021-04-20 18:58:22]    INFO >> epoch 015 | valid on 'valid' subset | loss 2.367 | mrr 0.72098 | sample_size 1000 | wps 4311.5 | wpb 1000 | bsz 1000 | num_updates 8040 | best_mrr 720.98 (progress_bar.py:269, print())
[2021-04-20 18:58:23]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/self_attn/checkpoints/checkpoint_best.pt (epoch 15 @ 8040 updates, score 0.72098) (writing took 0.541418 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 19:01:14]    INFO >> epoch 016 | loss 0.101 | mrr 0.982588 | sample_size 450 | wps 1325.3 | ups 2.95 | wpb 450 | bsz 450 | num_updates 8576 | lr 0.0005 | gnorm 2.263 | clip 100 | train_wall 162 | wall 2898 (progress_bar.py:269, print())
[2021-04-20 19:01:24]    INFO >> epoch 016 | valid on 'valid' subset | loss 2.376 | mrr 0.718758 | sample_size 1000 | wps 4296.4 | wpb 1000 | bsz 1000 | num_updates 8576 | best_mrr 718.758 (progress_bar.py:269, print())
[2021-04-20 19:01:25]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/self_attn/checkpoints/checkpoint_last.pt (epoch 16 @ 8576 updates, score 0.718758) (writing took 0.442220 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 19:03:41]    INFO >> epoch 017:    424 / 537 loss=0.098, mrr=442.312, sample_size=450, wps=1316.1, ups=2.92, wpb=450, bsz=450, num_updates=9000, lr=0.0005, gnorm=2.242, clip=100, train_wall=301, wall=3045 (progress_bar.py:262, log())
[2021-04-20 19:04:15]    INFO >> epoch 017 | loss 0.095 | mrr 0.983415 | sample_size 450 | wps 1325.9 | ups 2.95 | wpb 450 | bsz 450 | num_updates 9112 | lr 0.0005 | gnorm 2.21 | clip 100 | train_wall 162 | wall 3080 (progress_bar.py:269, print())
[2021-04-20 19:04:26]    INFO >> epoch 017 | valid on 'valid' subset | loss 2.4 | mrr 0.723519 | sample_size 1000 | wps 4182.7 | wpb 1000 | bsz 1000 | num_updates 9112 | best_mrr 723.519 (progress_bar.py:269, print())
[2021-04-20 19:04:27]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/self_attn/checkpoints/checkpoint_best.pt (epoch 17 @ 9112 updates, score 0.723519) (writing took 0.463006 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 19:07:17]    INFO >> epoch 018 | loss 0.09 | mrr 0.984387 | sample_size 450 | wps 1326.5 | ups 2.95 | wpb 450 | bsz 450 | num_updates 9648 | lr 0.0005 | gnorm 2.131 | clip 100 | train_wall 161 | wall 3262 (progress_bar.py:269, print())
[2021-04-20 19:07:28]    INFO >> epoch 018 | valid on 'valid' subset | loss 2.478 | mrr 0.722076 | sample_size 1000 | wps 4237.9 | wpb 1000 | bsz 1000 | num_updates 9648 | best_mrr 722.076 (progress_bar.py:269, print())
[2021-04-20 19:07:28]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/self_attn/checkpoints/checkpoint_last.pt (epoch 18 @ 9648 updates, score 0.722076) (writing took 0.300968 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 19:09:22]    INFO >> epoch 019:    353 / 537 loss=0.088, mrr=443.061, sample_size=450, wps=1318.2, ups=2.93, wpb=450, bsz=450, num_updates=10000, lr=0.0005, gnorm=2.114, clip=100, train_wall=301, wall=3387 (progress_bar.py:262, log())
[2021-04-20 19:10:19]    INFO >> epoch 019 | loss 0.085 | mrr 0.985061 | sample_size 450 | wps 1328.7 | ups 2.95 | wpb 450 | bsz 450 | num_updates 10184 | lr 0.0005 | gnorm 2.073 | clip 100 | train_wall 161 | wall 3443 (progress_bar.py:269, print())
[2021-04-20 19:10:29]    INFO >> epoch 019 | valid on 'valid' subset | loss 2.4 | mrr 0.719164 | sample_size 1000 | wps 4197.2 | wpb 1000 | bsz 1000 | num_updates 10184 | best_mrr 719.164 (progress_bar.py:269, print())
[2021-04-20 19:10:29]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/self_attn/checkpoints/checkpoint_last.pt (epoch 19 @ 10184 updates, score 0.719164) (writing took 0.193591 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 19:13:20]    INFO >> epoch 020 | loss 0.081 | mrr 0.985872 | sample_size 450 | wps 1328.4 | ups 2.95 | wpb 450 | bsz 450 | num_updates 10720 | lr 0.0005 | gnorm 2.021 | clip 100 | train_wall 162 | wall 3625 (progress_bar.py:269, print())
[2021-04-20 19:13:31]    INFO >> epoch 020 | valid on 'valid' subset | loss 2.45 | mrr 0.722624 | sample_size 1000 | wps 4219.1 | wpb 1000 | bsz 1000 | num_updates 10720 | best_mrr 722.624 (progress_bar.py:269, print())
[2021-04-20 19:13:31]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/self_attn/checkpoints/checkpoint_last.pt (epoch 20 @ 10720 updates, score 0.722624) (writing took 0.200661 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 19:15:03]    INFO >> epoch 021:    280 / 537 loss=0.081, mrr=443.651, sample_size=450, wps=1318.9, ups=2.93, wpb=450, bsz=450, num_updates=11000, lr=0.0005, gnorm=2.004, clip=99.9, train_wall=301, wall=3728 (progress_bar.py:262, log())
[2021-04-20 19:16:22]    INFO >> epoch 021 | loss 0.078 | mrr 0.986364 | sample_size 450 | wps 1327.1 | ups 2.95 | wpb 450 | bsz 450 | num_updates 11256 | lr 0.0005 | gnorm 1.94 | clip 99.8 | train_wall 162 | wall 3807 (progress_bar.py:269, print())
[2021-04-20 19:16:32]    INFO >> epoch 021 | valid on 'valid' subset | loss 2.513 | mrr 0.722135 | sample_size 1000 | wps 4304.8 | wpb 1000 | bsz 1000 | num_updates 11256 | best_mrr 722.135 (progress_bar.py:269, print())
[2021-04-20 19:16:33]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/self_attn/checkpoints/checkpoint_last.pt (epoch 21 @ 11256 updates, score 0.722135) (writing took 0.282795 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 19:19:24]    INFO >> epoch 022 | loss 0.074 | mrr 0.987138 | sample_size 450 | wps 1329.5 | ups 2.95 | wpb 450 | bsz 450 | num_updates 11792 | lr 0.0005 | gnorm 1.896 | clip 100 | train_wall 162 | wall 3988 (progress_bar.py:269, print())
[2021-04-20 19:19:34]    INFO >> epoch 022 | valid on 'valid' subset | loss 2.527 | mrr 0.717831 | sample_size 1000 | wps 4217.9 | wpb 1000 | bsz 1000 | num_updates 11792 | best_mrr 717.831 (progress_bar.py:269, print())
[2021-04-20 19:19:34]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/self_attn/checkpoints/checkpoint_last.pt (epoch 22 @ 11792 updates, score 0.717831) (writing took 0.283287 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 19:20:44]    INFO >> epoch 023:    208 / 537 loss=0.075, mrr=444.1, sample_size=450, wps=1319.7, ups=2.93, wpb=450, bsz=450, num_updates=12000, lr=0.0005, gnorm=1.909, clip=100, train_wall=301, wall=4069 (progress_bar.py:262, log())
[2021-04-20 19:22:25]    INFO >> epoch 023 | loss 0.072 | mrr 0.987553 | sample_size 450 | wps 1328.4 | ups 2.95 | wpb 450 | bsz 450 | num_updates 12328 | lr 0.0005 | gnorm 1.868 | clip 100 | train_wall 162 | wall 4170 (progress_bar.py:269, print())
[2021-04-20 19:22:35]    INFO >> epoch 023 | valid on 'valid' subset | loss 2.54 | mrr 0.721345 | sample_size 1000 | wps 4274.2 | wpb 1000 | bsz 1000 | num_updates 12328 | best_mrr 721.345 (progress_bar.py:269, print())
[2021-04-20 19:22:36]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/self_attn/checkpoints/checkpoint_last.pt (epoch 23 @ 12328 updates, score 0.721345) (writing took 0.245135 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 19:25:27]    INFO >> epoch 024 | loss 0.07 | mrr 0.987915 | sample_size 450 | wps 1329.1 | ups 2.95 | wpb 450 | bsz 450 | num_updates 12864 | lr 0.0005 | gnorm 1.817 | clip 99.3 | train_wall 162 | wall 4351 (progress_bar.py:269, print())
[2021-04-20 19:25:37]    INFO >> epoch 024 | valid on 'valid' subset | loss 2.545 | mrr 0.724256 | sample_size 1000 | wps 4277.5 | wpb 1000 | bsz 1000 | num_updates 12864 | best_mrr 724.256 (progress_bar.py:269, print())
[2021-04-20 19:25:37]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/self_attn/checkpoints/checkpoint_best.pt (epoch 24 @ 12864 updates, score 0.724256) (writing took 0.463022 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 19:26:26]    INFO >> epoch 025:    136 / 537 loss=0.071, mrr=444.504, sample_size=450, wps=1319.4, ups=2.93, wpb=450, bsz=450, num_updates=13000, lr=0.0005, gnorm=1.833, clip=99.6, train_wall=301, wall=4410 (progress_bar.py:262, log())
[2021-04-20 19:28:28]    INFO >> epoch 025 | loss 0.069 | mrr 0.988069 | sample_size 450 | wps 1329 | ups 2.95 | wpb 450 | bsz 450 | num_updates 13400 | lr 0.0005 | gnorm 1.787 | clip 99.8 | train_wall 162 | wall 4533 (progress_bar.py:269, print())
[2021-04-20 19:28:38]    INFO >> epoch 025 | valid on 'valid' subset | loss 2.545 | mrr 0.723632 | sample_size 1000 | wps 4303.7 | wpb 1000 | bsz 1000 | num_updates 13400 | best_mrr 723.632 (progress_bar.py:269, print())
[2021-04-20 19:28:39]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/self_attn/checkpoints/checkpoint_last.pt (epoch 25 @ 13400 updates, score 0.723632) (writing took 0.260300 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 19:31:30]    INFO >> epoch 026 | loss 0.064 | mrr 0.988867 | sample_size 450 | wps 1328.2 | ups 2.95 | wpb 450 | bsz 450 | num_updates 13936 | lr 0.0005 | gnorm 1.727 | clip 99.1 | train_wall 161 | wall 4714 (progress_bar.py:269, print())
[2021-04-20 19:31:40]    INFO >> epoch 026 | valid on 'valid' subset | loss 2.618 | mrr 0.724052 | sample_size 1000 | wps 4236.7 | wpb 1000 | bsz 1000 | num_updates 13936 | best_mrr 724.052 (progress_bar.py:269, print())
[2021-04-20 19:31:40]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/self_attn/checkpoints/checkpoint_last.pt (epoch 26 @ 13936 updates, score 0.724052) (writing took 0.235352 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 19:32:07]    INFO >> epoch 027:     64 / 537 loss=0.066, mrr=444.848, sample_size=450, wps=1318.6, ups=2.93, wpb=450, bsz=450, num_updates=14000, lr=0.0005, gnorm=1.75, clip=99.2, train_wall=301, wall=4751 (progress_bar.py:262, log())
[2021-04-20 19:34:31]    INFO >> epoch 027 | loss 0.064 | mrr 0.988832 | sample_size 450 | wps 1328 | ups 2.95 | wpb 450 | bsz 450 | num_updates 14472 | lr 0.0005 | gnorm 1.711 | clip 99.3 | train_wall 162 | wall 4896 (progress_bar.py:269, print())
[2021-04-20 19:34:42]    INFO >> epoch 027 | valid on 'valid' subset | loss 2.613 | mrr 0.723647 | sample_size 1000 | wps 4291.6 | wpb 1000 | bsz 1000 | num_updates 14472 | best_mrr 723.647 (progress_bar.py:269, print())
[2021-04-20 19:34:42]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/self_attn/checkpoints/checkpoint_last.pt (epoch 27 @ 14472 updates, score 0.723647) (writing took 0.221239 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 19:37:30]    INFO >> epoch 028:    529 / 537 loss=0.063, mrr=445.043, sample_size=450, wps=1390.2, ups=3.09, wpb=450, bsz=450, num_updates=15000, lr=0.0005, gnorm=1.692, clip=99.1, train_wall=301, wall=5075 (progress_bar.py:262, log())
[2021-04-20 19:37:33]    INFO >> epoch 028 | loss 0.061 | mrr 0.989205 | sample_size 450 | wps 1325.8 | ups 2.95 | wpb 450 | bsz 450 | num_updates 15008 | lr 0.0005 | gnorm 1.67 | clip 98.7 | train_wall 162 | wall 5078 (progress_bar.py:269, print())
[2021-04-20 19:37:44]    INFO >> epoch 028 | valid on 'valid' subset | loss 2.603 | mrr 0.723184 | sample_size 1000 | wps 4193.3 | wpb 1000 | bsz 1000 | num_updates 15008 | best_mrr 723.184 (progress_bar.py:269, print())
[2021-04-20 19:37:44]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/self_attn/checkpoints/checkpoint_last.pt (epoch 28 @ 15008 updates, score 0.723184) (writing took 0.218907 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 19:40:35]    INFO >> epoch 029 | loss 0.059 | mrr 0.989837 | sample_size 450 | wps 1327 | ups 2.95 | wpb 450 | bsz 450 | num_updates 15544 | lr 0.0005 | gnorm 1.631 | clip 98.5 | train_wall 161 | wall 5260 (progress_bar.py:269, print())
[2021-04-20 19:40:45]    INFO >> epoch 029 | valid on 'valid' subset | loss 2.671 | mrr 0.723282 | sample_size 1000 | wps 4180.7 | wpb 1000 | bsz 1000 | num_updates 15544 | best_mrr 723.282 (progress_bar.py:269, print())
[2021-04-20 19:40:46]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/self_attn/checkpoints/checkpoint_last.pt (epoch 29 @ 15544 updates, score 0.723282) (writing took 0.264089 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 19:43:12]    INFO >> epoch 030:    456 / 537 loss=0.059, mrr=445.46, sample_size=450, wps=1318.5, ups=2.93, wpb=450, bsz=450, num_updates=16000, lr=0.0005, gnorm=1.617, clip=98.3, train_wall=301, wall=5416 (progress_bar.py:262, log())
[2021-04-20 19:43:37]    INFO >> epoch 030 | loss 0.058 | mrr 0.990013 | sample_size 450 | wps 1328.6 | ups 2.95 | wpb 450 | bsz 450 | num_updates 16080 | lr 0.0005 | gnorm 1.598 | clip 98.1 | train_wall 161 | wall 5441 (progress_bar.py:269, print())
[2021-04-20 19:43:47]    INFO >> epoch 030 | valid on 'valid' subset | loss 2.644 | mrr 0.726555 | sample_size 1000 | wps 4300.6 | wpb 1000 | bsz 1000 | num_updates 16080 | best_mrr 726.555 (progress_bar.py:269, print())
[2021-04-20 19:43:47]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/self_attn/checkpoints/checkpoint_best.pt (epoch 30 @ 16080 updates, score 0.726555) (writing took 0.483866 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 19:46:38]    INFO >> epoch 031 | loss 0.057 | mrr 0.990105 | sample_size 450 | wps 1326.8 | ups 2.95 | wpb 450 | bsz 450 | num_updates 16616 | lr 0.0005 | gnorm 1.588 | clip 98.5 | train_wall 162 | wall 5623 (progress_bar.py:269, print())
[2021-04-20 19:46:49]    INFO >> epoch 031 | valid on 'valid' subset | loss 2.686 | mrr 0.722893 | sample_size 1000 | wps 4206 | wpb 1000 | bsz 1000 | num_updates 16616 | best_mrr 722.893 (progress_bar.py:269, print())
[2021-04-20 19:46:49]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/self_attn/checkpoints/checkpoint_last.pt (epoch 31 @ 16616 updates, score 0.722893) (writing took 0.369411 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 19:48:53]    INFO >> epoch 032:    385 / 537 loss=0.056, mrr=445.653, sample_size=450, wps=1317.3, ups=2.93, wpb=450, bsz=450, num_updates=17000, lr=0.0005, gnorm=1.563, clip=97.9, train_wall=301, wall=5758 (progress_bar.py:262, log())
[2021-04-20 19:49:40]    INFO >> epoch 032 | loss 0.054 | mrr 0.990604 | sample_size 450 | wps 1326.7 | ups 2.95 | wpb 450 | bsz 450 | num_updates 17152 | lr 0.0005 | gnorm 1.524 | clip 97 | train_wall 161 | wall 5805 (progress_bar.py:269, print())
[2021-04-20 19:49:51]    INFO >> epoch 032 | valid on 'valid' subset | loss 2.69 | mrr 0.725379 | sample_size 1000 | wps 4132.6 | wpb 1000 | bsz 1000 | num_updates 17152 | best_mrr 725.379 (progress_bar.py:269, print())
[2021-04-20 19:49:51]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/self_attn/checkpoints/checkpoint_last.pt (epoch 32 @ 17152 updates, score 0.725379) (writing took 0.191343 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 19:52:42]    INFO >> epoch 033 | loss 0.053 | mrr 0.990662 | sample_size 450 | wps 1327.5 | ups 2.95 | wpb 450 | bsz 450 | num_updates 17688 | lr 0.0005 | gnorm 1.517 | clip 96.8 | train_wall 161 | wall 5986 (progress_bar.py:269, print())
[2021-04-20 19:52:53]    INFO >> epoch 033 | valid on 'valid' subset | loss 2.64 | mrr 0.725699 | sample_size 1000 | wps 4163.2 | wpb 1000 | bsz 1000 | num_updates 17688 | best_mrr 725.699 (progress_bar.py:269, print())
[2021-04-20 19:52:53]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/self_attn/checkpoints/checkpoint_last.pt (epoch 33 @ 17688 updates, score 0.725699) (writing took 0.379498 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 19:54:35]    INFO >> epoch 034:    313 / 537 loss=0.053, mrr=445.846, sample_size=450, wps=1316.5, ups=2.93, wpb=450, bsz=450, num_updates=18000, lr=0.0005, gnorm=1.5, clip=96.5, train_wall=301, wall=6100 (progress_bar.py:262, log())
[2021-04-20 19:55:44]    INFO >> epoch 034 | loss 0.052 | mrr 0.990989 | sample_size 450 | wps 1323.7 | ups 2.94 | wpb 450 | bsz 450 | num_updates 18224 | lr 0.0005 | gnorm 1.478 | clip 95.7 | train_wall 162 | wall 6169 (progress_bar.py:269, print())
[2021-04-20 19:55:55]    INFO >> epoch 034 | valid on 'valid' subset | loss 2.688 | mrr 0.723425 | sample_size 1000 | wps 4312.6 | wpb 1000 | bsz 1000 | num_updates 18224 | best_mrr 723.425 (progress_bar.py:269, print())
[2021-04-20 19:55:55]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/self_attn/checkpoints/checkpoint_last.pt (epoch 34 @ 18224 updates, score 0.723425) (writing took 0.256171 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 19:58:46]    INFO >> epoch 035 | loss 0.051 | mrr 0.99103 | sample_size 450 | wps 1326.8 | ups 2.95 | wpb 450 | bsz 450 | num_updates 18760 | lr 0.0005 | gnorm 1.469 | clip 96.3 | train_wall 161 | wall 6350 (progress_bar.py:269, print())
[2021-04-20 19:58:57]    INFO >> epoch 035 | valid on 'valid' subset | loss 2.715 | mrr 0.722442 | sample_size 1000 | wps 4119.6 | wpb 1000 | bsz 1000 | num_updates 18760 | best_mrr 722.442 (progress_bar.py:269, print())
[2021-04-20 19:58:57]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/self_attn/checkpoints/checkpoint_last.pt (epoch 35 @ 18760 updates, score 0.722442) (writing took 0.308017 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 20:00:17]    INFO >> epoch 036:    240 / 537 loss=0.051, mrr=446.031, sample_size=450, wps=1316.7, ups=2.93, wpb=450, bsz=450, num_updates=19000, lr=0.0005, gnorm=1.463, clip=94.7, train_wall=301, wall=6442 (progress_bar.py:262, log())
[2021-04-20 20:01:48]    INFO >> epoch 036 | loss 0.049 | mrr 0.9915 | sample_size 450 | wps 1326 | ups 2.95 | wpb 450 | bsz 450 | num_updates 19296 | lr 0.0005 | gnorm 1.439 | clip 92.9 | train_wall 161 | wall 6532 (progress_bar.py:269, print())
[2021-04-20 20:01:59]    INFO >> epoch 036 | valid on 'valid' subset | loss 2.746 | mrr 0.721458 | sample_size 1000 | wps 4246.2 | wpb 1000 | bsz 1000 | num_updates 19296 | best_mrr 721.458 (progress_bar.py:269, print())
[2021-04-20 20:01:59]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/self_attn/checkpoints/checkpoint_last.pt (epoch 36 @ 19296 updates, score 0.721458) (writing took 0.296791 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 20:04:50]    INFO >> epoch 037 | loss 0.049 | mrr 0.991474 | sample_size 450 | wps 1324.7 | ups 2.94 | wpb 450 | bsz 450 | num_updates 19832 | lr 0.0005 | gnorm 1.431 | clip 93.5 | train_wall 161 | wall 6714 (progress_bar.py:269, print())
[2021-04-20 20:05:00]    INFO >> epoch 037 | valid on 'valid' subset | loss 2.795 | mrr 0.722946 | sample_size 1000 | wps 4238.7 | wpb 1000 | bsz 1000 | num_updates 19832 | best_mrr 722.946 (progress_bar.py:269, print())
[2021-04-20 20:05:01]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/self_attn/checkpoints/checkpoint_last.pt (epoch 37 @ 19832 updates, score 0.722946) (writing took 0.292192 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 20:05:59]    INFO >> epoch 038:    169 / 537 loss=0.049, mrr=446.163, sample_size=450, wps=1317.1, ups=2.93, wpb=450, bsz=450, num_updates=20000, lr=0.0005, gnorm=1.432, clip=93.3, train_wall=301, wall=6783 (progress_bar.py:262, log())
[2021-04-20 20:07:51]    INFO >> epoch 038 | loss 0.048 | mrr 0.991682 | sample_size 450 | wps 1328.5 | ups 2.95 | wpb 450 | bsz 450 | num_updates 20368 | lr 0.0005 | gnorm 1.411 | clip 92.4 | train_wall 161 | wall 6896 (progress_bar.py:269, print())
[2021-04-20 20:08:02]    INFO >> epoch 038 | valid on 'valid' subset | loss 2.796 | mrr 0.724046 | sample_size 1000 | wps 4233.1 | wpb 1000 | bsz 1000 | num_updates 20368 | best_mrr 724.046 (progress_bar.py:269, print())
[2021-04-20 20:08:02]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/self_attn/checkpoints/checkpoint_last.pt (epoch 38 @ 20368 updates, score 0.724046) (writing took 0.217302 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 20:10:53]    INFO >> epoch 039 | loss 0.047 | mrr 0.992059 | sample_size 450 | wps 1331.4 | ups 2.96 | wpb 450 | bsz 450 | num_updates 20904 | lr 0.0005 | gnorm 1.374 | clip 92 | train_wall 161 | wall 7077 (progress_bar.py:269, print())
[2021-04-20 20:11:03]    INFO >> epoch 039 | valid on 'valid' subset | loss 2.728 | mrr 0.723381 | sample_size 1000 | wps 4157.6 | wpb 1000 | bsz 1000 | num_updates 20904 | best_mrr 723.381 (progress_bar.py:269, print())
[2021-04-20 20:11:03]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/self_attn/checkpoints/checkpoint_last.pt (epoch 39 @ 20904 updates, score 0.723381) (writing took 0.324425 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 20:11:39]    INFO >> epoch 040:     96 / 537 loss=0.047, mrr=446.347, sample_size=450, wps=1320.2, ups=2.93, wpb=450, bsz=450, num_updates=21000, lr=0.0005, gnorm=1.386, clip=92.3, train_wall=301, wall=7124 (progress_bar.py:262, log())
[2021-04-20 20:13:54]    INFO >> epoch 040 | loss 0.046 | mrr 0.991969 | sample_size 450 | wps 1328.2 | ups 2.95 | wpb 450 | bsz 450 | num_updates 21440 | lr 0.0005 | gnorm 1.36 | clip 90.7 | train_wall 161 | wall 7259 (progress_bar.py:269, print())
[2021-04-20 20:14:05]    INFO >> epoch 040 | valid on 'valid' subset | loss 2.766 | mrr 0.722296 | sample_size 1000 | wps 4165.7 | wpb 1000 | bsz 1000 | num_updates 21440 | best_mrr 722.296 (progress_bar.py:269, print())
[2021-04-20 20:14:05]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/php/self_attn/checkpoints/checkpoint_last.pt (epoch 40 @ 21440 updates, score 0.722296) (writing took 0.266226 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 20:14:05]    INFO >> early stop since valid performance hasn't improved for last 10 runs (train.py:191, should_stop_early())
[2021-04-20 20:14:05]    INFO >> early stop since valid performance hasn't improved for last 10 runs (train.py:272, single_main())
[2021-04-20 20:14:05]    INFO >> done training in 7269.0 seconds (train.py:283, single_main())
