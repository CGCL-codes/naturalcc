nohup: å¿½ç•¥è¾“å…¥
[2021-04-20 18:12:42]    INFO >> Load arguments in /home/yanghe/Documents/naturalcc-dev/run/retrieval/selfattn/config/csn_feng/python.yml (train.py:302, cli_main())
[2021-04-20 18:12:42]    INFO >> {'criterion': 'retrieval_softmax', 'optimizer': 'torch_adam', 'lr_scheduler': 'fixed', 'tokenizer': None, 'bpe': None, 'common': {'no_progress_bar': 0, 'log_interval': 1000, 'log_format': 'simple', 'tensorboard_logdir': '', 'seed': 0, 'cpu': 0, 'fp16': 0, 'memory_efficient_fp16': 0, 'fp16_no_flatten_grads': 0, 'fp16_init_scale': 128, 'fp16_scale_window': None, 'fp16_scale_tolerance': 0.0, 'min_loss_scale': 0.0001, 'threshold_loss_scale': None, 'user_dir': None, 'empty_cache_freq': 0, 'all_gather_list_size': 16384, 'task': 'hybrid_retrieval'}, 'dataset': {'num_workers': 3, 'skip_invalid_size_inputs_valid_test': 0, 'max_tokens': None, 'max_sentences': 450, 'code_max_tokens': 200, 'query_max_tokens': 30, 'required_batch_size_multiple': 1, 'dataset_impl': 'mmap', 'train_subset': 'train', 'valid_subset': 'valid', 'validate_interval': 1, 'fixed_validation_seed': None, 'disable_validation': None, 'max_tokens_valid': None, 'max_sentences_valid': 1000, 'curriculum': 0, 'gen_subset': 'test', 'num_shards': 1, 'shard_id': 0, 'joined_dictionary': 0, 'langs': ['python']}, 'distributed_training': {'distributed_world_size': 1, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': None, 'distributed_port': -1, 'device_id': 0, 'distributed_no_spawn': 0, 'ddp_backend': 'c10d', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': None, 'find_unused_parameters': 0, 'fast_stat_sync': 0, 'broadcast_buffers': 0, 'global_sync_iter': 50, 'warmup_iterations': 500, 'local_rank': -1, 'block_momentum': 0.875, 'block_lr': 1, 'use_nbm': 0, 'average_sync': 0}, 'task': {'data': '/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all', 'sample_break_mode': 'complete', 'tokens_per_sample': 512, 'mask_prob': 0.15, 'leave_unmasked_prob': 0.1, 'random_token_prob': 0.1, 'freq_weighted_replacement': 0, 'mask_whole_words': 0, 'pooler_activation_fn': 'tanh', 'source_lang': 'code_tokens', 'target_lang': 'docstring_tokens', 'source_aux_lang': 'code_tokens.wo_func', 'target_aux_lang': 'func_name', 'fraction_using_func_name': 0.3, 'load_alignments': 0, 'left_pad_source': 1, 'left_pad_target': 0, 'upsample_primary': 1, 'truncate_source': 0, 'eval_mrr': 1}, 'model': {'arch': 'self_attn', 'code_embed_dim': 128, 'code_token_types': 1, 'code_max_tokens': 200, 'code_position_encoding': 'learned', 'code_dropout': 0.1, 'code_pooling': 'weighted_mean', 'query_embed_dim': 128, 'query_token_types': 1, 'query_max_tokens': 30, 'query_self_attn_layers': 3, 'query_pooling': 'weighted_mean', 'query_position_encoding': 'learned', 'query_dropout': 0.1, 'self_attn_layers': 3, 'attention_heads': 8, 'ffn_embed_dim': 512, 'activation_fn': 'gelu'}, 'optimization': {'max_epoch': 300, 'max_update': 0, 'clip_norm': 1, 'sentence_avg': 0, 'update_freq': [1], 'lrs': [0.0005], 'min_lr': -1, 'use_bmuf': 0, 'lr_shrink': 1.0, 'force_anneal': 0, 'warmup_updates': 0, 'end_learning_rate': 0.0, 'power': 1.0, 'total_num_update': 1000000, 'adam': {'adam_betas': '(0.9, 0.999)', 'adam_eps': 1e-08, 'weight_decay': 0, 'use_old_adam': 1}, 'margin': 1, 'clip_norm_version': 'tf_clip_by_global_norm'}, 'checkpoint': {'save_dir': '/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/python/self_attn/checkpoints', 'restore_file': 'checkpoint_last.pt', 'reset_dataloader': None, 'reset_lr_scheduler': None, 'reset_meters': None, 'reset_optimizer': None, 'optimizer_overrides': '{}', 'save_interval': 1, 'save_interval_updates': 0, 'keep_interval_updates': 0, 'keep_last_epochs': -1, 'keep_best_checkpoints': -1, 'no_save': 0, 'no_epoch_checkpoints': 1, 'no_last_checkpoints': 0, 'no_save_optimizer_state': None, 'best_checkpoint_metric': 'mrr', 'maximize_best_checkpoint_metric': 1, 'patience': 10}, 'eval': {'path': '/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/python/self_attn/checkpoints/checkpoint_best.pt', 'quiet': 1, 'max_sentences': 450, 'model_overrides': '{}', 'eval_size': -1}} (train.py:304, cli_main())
[2021-04-20 18:12:42]    INFO >> single GPU training... (train.py:333, cli_main())
[2021-04-20 18:12:42]    INFO >> loaded 13914 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/valid.python.code_tokens'] (hybrid_retrieval.py:54, load_tokens_dataset())
[2021-04-20 18:12:42]    INFO >> loaded 13914 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/valid.python.docstring_tokens'] (hybrid_retrieval.py:55, load_tokens_dataset())
[2021-04-20 18:12:43]    INFO >> SelfAttn(
  (src_encoders): ModuleDict(
    (python): SelfAttnEncoder(
      (embed): Embedding(10000, 128, padding_idx=0)
      (type_embed): Embedding(1, 128)
      (embed_layer_norm): LayerNorm((128,), eps=1e-08, elementwise_affine=True)
      (layers): ModuleList(
        (0): TransformerEncoderLayer(
          (self_attn): MultiheadAttention(
            (k_proj): Linear(in_features=128, out_features=128, bias=True)
            (v_proj): Linear(in_features=128, out_features=128, bias=True)
            (q_proj): Linear(in_features=128, out_features=128, bias=True)
            (out_proj): Linear(in_features=128, out_features=128, bias=True)
          )
          (self_attn_layer_norm): LayerNorm((128,), eps=1e-08, elementwise_affine=True)
          (fc1): Linear(in_features=128, out_features=512, bias=True)
          (fc2): Linear(in_features=512, out_features=128, bias=True)
          (ff_layer_norm): LayerNorm((128,), eps=1e-08, elementwise_affine=True)
        )
        (1): TransformerEncoderLayer(
          (self_attn): MultiheadAttention(
            (k_proj): Linear(in_features=128, out_features=128, bias=True)
            (v_proj): Linear(in_features=128, out_features=128, bias=True)
            (q_proj): Linear(in_features=128, out_features=128, bias=True)
            (out_proj): Linear(in_features=128, out_features=128, bias=True)
          )
          (self_attn_layer_norm): LayerNorm((128,), eps=1e-08, elementwise_affine=True)
          (fc1): Linear(in_features=128, out_features=512, bias=True)
          (fc2): Linear(in_features=512, out_features=128, bias=True)
          (ff_layer_norm): LayerNorm((128,), eps=1e-08, elementwise_affine=True)
        )
        (2): TransformerEncoderLayer(
          (self_attn): MultiheadAttention(
            (k_proj): Linear(in_features=128, out_features=128, bias=True)
            (v_proj): Linear(in_features=128, out_features=128, bias=True)
            (q_proj): Linear(in_features=128, out_features=128, bias=True)
            (out_proj): Linear(in_features=128, out_features=128, bias=True)
          )
          (self_attn_layer_norm): LayerNorm((128,), eps=1e-08, elementwise_affine=True)
          (fc1): Linear(in_features=128, out_features=512, bias=True)
          (fc2): Linear(in_features=512, out_features=128, bias=True)
          (ff_layer_norm): LayerNorm((128,), eps=1e-08, elementwise_affine=True)
        )
      )
      (weight_layer): Linear(in_features=128, out_features=1, bias=False)
    )
  )
  (tgt_encoders): SelfAttnEncoder(
    (embed): Embedding(10000, 128, padding_idx=0)
    (type_embed): Embedding(1, 128)
    (embed_layer_norm): LayerNorm((128,), eps=1e-08, elementwise_affine=True)
    (layers): ModuleList(
      (0): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (k_proj): Linear(in_features=128, out_features=128, bias=True)
          (v_proj): Linear(in_features=128, out_features=128, bias=True)
          (q_proj): Linear(in_features=128, out_features=128, bias=True)
          (out_proj): Linear(in_features=128, out_features=128, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((128,), eps=1e-08, elementwise_affine=True)
        (fc1): Linear(in_features=128, out_features=512, bias=True)
        (fc2): Linear(in_features=512, out_features=128, bias=True)
        (ff_layer_norm): LayerNorm((128,), eps=1e-08, elementwise_affine=True)
      )
      (1): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (k_proj): Linear(in_features=128, out_features=128, bias=True)
          (v_proj): Linear(in_features=128, out_features=128, bias=True)
          (q_proj): Linear(in_features=128, out_features=128, bias=True)
          (out_proj): Linear(in_features=128, out_features=128, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((128,), eps=1e-08, elementwise_affine=True)
        (fc1): Linear(in_features=128, out_features=512, bias=True)
        (fc2): Linear(in_features=512, out_features=128, bias=True)
        (ff_layer_norm): LayerNorm((128,), eps=1e-08, elementwise_affine=True)
      )
      (2): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (k_proj): Linear(in_features=128, out_features=128, bias=True)
          (v_proj): Linear(in_features=128, out_features=128, bias=True)
          (q_proj): Linear(in_features=128, out_features=128, bias=True)
          (out_proj): Linear(in_features=128, out_features=128, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((128,), eps=1e-08, elementwise_affine=True)
        (fc1): Linear(in_features=128, out_features=512, bias=True)
        (fc2): Linear(in_features=512, out_features=128, bias=True)
        (ff_layer_norm): LayerNorm((128,), eps=1e-08, elementwise_affine=True)
      )
    )
    (weight_layer): Linear(in_features=128, out_features=1, bias=False)
  )
) (train.py:223, single_main())
[2021-04-20 18:12:43]    INFO >> model self_attn, criterion SearchSoftmaxCriterion (train.py:224, single_main())
[2021-04-20 18:12:43]    INFO >> num. model params: 3780096 (num. trained: 3780096) (train.py:227, single_main())
[2021-04-20 18:12:45]    INFO >> training on 1 GPUs (train.py:233, single_main())
[2021-04-20 18:12:45]    INFO >> max tokens per GPU = None and max sentences per GPU = 450 (train.py:236, single_main())
[2021-04-20 18:12:45]    INFO >> no existing checkpoint found /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/python/self_attn/checkpoints/checkpoint_last.pt (ncc_trainers.py:270, load_checkpoint())
[2021-04-20 18:12:45]    INFO >> loading train data for epoch 1 (ncc_trainers.py:285, get_train_iterator())
[2021-04-20 18:12:45]    INFO >> loaded 251820 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.python.code_tokens'] (hybrid_retrieval.py:54, load_tokens_dataset())
[2021-04-20 18:12:45]    INFO >> loaded 251820 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.python.docstring_tokens'] (hybrid_retrieval.py:55, load_tokens_dataset())
[2021-04-20 18:12:45]    INFO >> loaded 251820 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.python.code_tokens.wo_func'] (hybrid_retrieval.py:67, load_tokens_dataset())
[2021-04-20 18:12:45]    INFO >> loaded 251820 examples from: ['/data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/all/train.python.func_name'] (hybrid_retrieval.py:81, load_tokens_dataset())
[2021-04-20 18:12:45]    INFO >> NOTE: your device may support faster training with fp16 (ncc_trainers.py:155, _setup_optimizer())
[2021-04-20 18:15:42]    INFO >> epoch 001 | loss 3.112 | mrr 0.469285 | sample_size 450 | wps 1478.3 | ups 3.29 | wpb 450 | bsz 450 | num_updates 559 | lr 0.0005 | gnorm 7.157 | clip 96.4 | train_wall 168 | wall 177 (progress_bar.py:269, print())
[2021-04-20 18:15:53]    INFO >> epoch 001 | valid on 'valid' subset | loss 2.966 | mrr 0.512362 | sample_size 1000 | wps 4365 | wpb 1000 | bsz 1000 | num_updates 559 (progress_bar.py:269, print())
[2021-04-20 18:15:53]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/python/self_attn/checkpoints/checkpoint_best.pt (epoch 1 @ 559 updates, score 0.512362) (writing took 0.459984 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 18:18:14]    INFO >> epoch 002:    441 / 560 loss=2.268, mrr=275.815, sample_size=450, wps=1399.2, ups=3.11, wpb=450, bsz=450, num_updates=1000, lr=0.0005, gnorm=7.262, clip=98, train_wall=300, wall=329 (progress_bar.py:262, log())
[2021-04-20 18:18:50]    INFO >> epoch 002 | loss 1.17 | mrr 0.799827 | sample_size 450 | wps 1340.2 | ups 2.98 | wpb 450 | bsz 450 | num_updates 1118 | lr 0.0005 | gnorm 7.286 | clip 100 | train_wall 168 | wall 365 (progress_bar.py:269, print())
[2021-04-20 18:19:00]    INFO >> epoch 002 | valid on 'valid' subset | loss 2.578 | mrr 0.58845 | sample_size 1000 | wps 4350.9 | wpb 1000 | bsz 1000 | num_updates 1118 | best_mrr 588.45 (progress_bar.py:269, print())
[2021-04-20 18:19:01]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/python/self_attn/checkpoints/checkpoint_best.pt (epoch 2 @ 1118 updates, score 0.58845) (writing took 0.567328 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 18:21:58]    INFO >> epoch 003 | loss 0.744 | mrr 0.873027 | sample_size 450 | wps 1339.1 | ups 2.98 | wpb 450 | bsz 450 | num_updates 1677 | lr 0.0005 | gnorm 6.19 | clip 100 | train_wall 168 | wall 553 (progress_bar.py:269, print())
[2021-04-20 18:22:08]    INFO >> epoch 003 | valid on 'valid' subset | loss 2.479 | mrr 0.612478 | sample_size 1000 | wps 4349.5 | wpb 1000 | bsz 1000 | num_updates 1677 | best_mrr 612.478 (progress_bar.py:269, print())
[2021-04-20 18:22:09]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/python/self_attn/checkpoints/checkpoint_best.pt (epoch 3 @ 1677 updates, score 0.612478) (writing took 0.403680 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 18:23:53]    INFO >> epoch 004:    324 / 560 loss=0.715, mrr=395.094, sample_size=450, wps=1324.9, ups=2.94, wpb=450, bsz=450, num_updates=2000, lr=0.0005, gnorm=6.025, clip=100, train_wall=300, wall=669 (progress_bar.py:262, log())
[2021-04-20 18:25:06]    INFO >> epoch 004 | loss 0.548 | mrr 0.906395 | sample_size 450 | wps 1338.9 | ups 2.98 | wpb 450 | bsz 450 | num_updates 2236 | lr 0.0005 | gnorm 5.414 | clip 100 | train_wall 168 | wall 741 (progress_bar.py:269, print())
[2021-04-20 18:25:16]    INFO >> epoch 004 | valid on 'valid' subset | loss 2.511 | mrr 0.617682 | sample_size 1000 | wps 4337.4 | wpb 1000 | bsz 1000 | num_updates 2236 | best_mrr 617.682 (progress_bar.py:269, print())
[2021-04-20 18:25:17]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/python/self_attn/checkpoints/checkpoint_best.pt (epoch 4 @ 2236 updates, score 0.617682) (writing took 0.407784 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 18:28:14]    INFO >> epoch 005 | loss 0.425 | mrr 0.927716 | sample_size 450 | wps 1337.3 | ups 2.97 | wpb 450 | bsz 450 | num_updates 2795 | lr 0.0005 | gnorm 4.908 | clip 100 | train_wall 168 | wall 929 (progress_bar.py:269, print())
[2021-04-20 18:28:24]    INFO >> epoch 005 | valid on 'valid' subset | loss 2.665 | mrr 0.621932 | sample_size 1000 | wps 4321.6 | wpb 1000 | bsz 1000 | num_updates 2795 | best_mrr 621.932 (progress_bar.py:269, print())
[2021-04-20 18:28:25]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/python/self_attn/checkpoints/checkpoint_best.pt (epoch 5 @ 2795 updates, score 0.621932) (writing took 0.604882 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 18:29:34]    INFO >> epoch 006:    205 / 560 loss=0.436, mrr=416.51, sample_size=450, wps=1322.4, ups=2.94, wpb=450, bsz=450, num_updates=3000, lr=0.0005, gnorm=4.912, clip=100, train_wall=301, wall=1009 (progress_bar.py:262, log())
[2021-04-20 18:31:22]    INFO >> epoch 006 | loss 0.35 | mrr 0.940176 | sample_size 450 | wps 1338 | ups 2.97 | wpb 450 | bsz 450 | num_updates 3354 | lr 0.0005 | gnorm 4.516 | clip 100 | train_wall 168 | wall 1117 (progress_bar.py:269, print())
[2021-04-20 18:31:32]    INFO >> epoch 006 | valid on 'valid' subset | loss 2.766 | mrr 0.621736 | sample_size 1000 | wps 4349.2 | wpb 1000 | bsz 1000 | num_updates 3354 | best_mrr 621.736 (progress_bar.py:269, print())
[2021-04-20 18:31:33]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/python/self_attn/checkpoints/checkpoint_last.pt (epoch 6 @ 3354 updates, score 0.621736) (writing took 0.405627 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 18:34:30]    INFO >> epoch 007 | loss 0.299 | mrr 0.948421 | sample_size 450 | wps 1339.1 | ups 2.98 | wpb 450 | bsz 450 | num_updates 3913 | lr 0.0005 | gnorm 4.194 | clip 100 | train_wall 168 | wall 1305 (progress_bar.py:269, print())
[2021-04-20 18:34:40]    INFO >> epoch 007 | valid on 'valid' subset | loss 2.778 | mrr 0.626415 | sample_size 1000 | wps 4333.1 | wpb 1000 | bsz 1000 | num_updates 3913 | best_mrr 626.415 (progress_bar.py:269, print())
[2021-04-20 18:34:41]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/python/self_attn/checkpoints/checkpoint_best.pt (epoch 7 @ 3913 updates, score 0.626415) (writing took 0.814735 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 18:35:14]    INFO >> epoch 008:     88 / 560 loss=0.317, mrr=425.529, sample_size=450, wps=1323.2, ups=2.94, wpb=450, bsz=450, num_updates=4000, lr=0.0005, gnorm=4.29, clip=100, train_wall=301, wall=1349 (progress_bar.py:262, log())
[2021-04-20 18:37:38]    INFO >> epoch 008 | loss 0.26 | mrr 0.955114 | sample_size 450 | wps 1336.8 | ups 2.97 | wpb 450 | bsz 450 | num_updates 4472 | lr 0.0005 | gnorm 3.93 | clip 100 | train_wall 168 | wall 1493 (progress_bar.py:269, print())
[2021-04-20 18:37:48]    INFO >> epoch 008 | valid on 'valid' subset | loss 2.838 | mrr 0.627087 | sample_size 1000 | wps 4352.2 | wpb 1000 | bsz 1000 | num_updates 4472 | best_mrr 627.087 (progress_bar.py:269, print())
[2021-04-20 18:37:49]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/python/self_attn/checkpoints/checkpoint_best.pt (epoch 8 @ 4472 updates, score 0.627087) (writing took 0.518283 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 18:40:36]    INFO >> epoch 009:    529 / 560 loss=0.246, mrr=430.927, sample_size=450, wps=1396.9, ups=3.1, wpb=450, bsz=450, num_updates=5000, lr=0.0005, gnorm=3.822, clip=100, train_wall=300, wall=1671 (progress_bar.py:262, log())
[2021-04-20 18:40:46]    INFO >> epoch 009 | loss 0.23 | mrr 0.960619 | sample_size 450 | wps 1339.2 | ups 2.98 | wpb 450 | bsz 450 | num_updates 5031 | lr 0.0005 | gnorm 3.684 | clip 100 | train_wall 168 | wall 1681 (progress_bar.py:269, print())
[2021-04-20 18:40:56]    INFO >> epoch 009 | valid on 'valid' subset | loss 2.97 | mrr 0.624234 | sample_size 1000 | wps 4341.4 | wpb 1000 | bsz 1000 | num_updates 5031 | best_mrr 624.234 (progress_bar.py:269, print())
[2021-04-20 18:40:57]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/python/self_attn/checkpoints/checkpoint_last.pt (epoch 9 @ 5031 updates, score 0.624234) (writing took 0.482509 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 18:43:54]    INFO >> epoch 010 | loss 0.204 | mrr 0.964841 | sample_size 450 | wps 1337.7 | ups 2.97 | wpb 450 | bsz 450 | num_updates 5590 | lr 0.0005 | gnorm 3.479 | clip 100 | train_wall 168 | wall 1869 (progress_bar.py:269, print())
[2021-04-20 18:44:04]    INFO >> epoch 010 | valid on 'valid' subset | loss 3.017 | mrr 0.624411 | sample_size 1000 | wps 4357.8 | wpb 1000 | bsz 1000 | num_updates 5590 | best_mrr 624.411 (progress_bar.py:269, print())
[2021-04-20 18:44:04]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/python/self_attn/checkpoints/checkpoint_last.pt (epoch 10 @ 5590 updates, score 0.624411) (writing took 0.320347 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 18:46:16]    INFO >> epoch 011:    411 / 560 loss=0.197, mrr=434.751, sample_size=450, wps=1324.3, ups=2.94, wpb=450, bsz=450, num_updates=6000, lr=0.0005, gnorm=3.425, clip=100, train_wall=300, wall=2011 (progress_bar.py:262, log())
[2021-04-20 18:47:02]    INFO >> epoch 011 | loss 0.188 | mrr 0.967561 | sample_size 450 | wps 1340.4 | ups 2.98 | wpb 450 | bsz 450 | num_updates 6149 | lr 0.0005 | gnorm 3.345 | clip 100 | train_wall 168 | wall 2057 (progress_bar.py:269, print())
[2021-04-20 18:47:12]    INFO >> epoch 011 | valid on 'valid' subset | loss 3.111 | mrr 0.623992 | sample_size 1000 | wps 4354.4 | wpb 1000 | bsz 1000 | num_updates 6149 | best_mrr 623.992 (progress_bar.py:269, print())
[2021-04-20 18:47:12]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/python/self_attn/checkpoints/checkpoint_last.pt (epoch 11 @ 6149 updates, score 0.623992) (writing took 0.292033 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 18:50:09]    INFO >> epoch 012 | loss 0.172 | mrr 0.97017 | sample_size 450 | wps 1341 | ups 2.98 | wpb 450 | bsz 450 | num_updates 6708 | lr 0.0005 | gnorm 3.183 | clip 100 | train_wall 168 | wall 2244 (progress_bar.py:269, print())
[2021-04-20 18:50:19]    INFO >> epoch 012 | valid on 'valid' subset | loss 3.167 | mrr 0.625527 | sample_size 1000 | wps 4340.6 | wpb 1000 | bsz 1000 | num_updates 6708 | best_mrr 625.527 (progress_bar.py:269, print())
[2021-04-20 18:50:20]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/python/self_attn/checkpoints/checkpoint_last.pt (epoch 12 @ 6708 updates, score 0.625527) (writing took 0.252311 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 18:51:55]    INFO >> epoch 013:    293 / 560 loss=0.17, mrr=436.769, sample_size=450, wps=1326.7, ups=2.95, wpb=450, bsz=450, num_updates=7000, lr=0.0005, gnorm=3.154, clip=100, train_wall=300, wall=2350 (progress_bar.py:262, log())
[2021-04-20 18:53:17]    INFO >> epoch 013 | loss 0.159 | mrr 0.972652 | sample_size 450 | wps 1341.7 | ups 2.98 | wpb 450 | bsz 450 | num_updates 7267 | lr 0.0005 | gnorm 3.031 | clip 100 | train_wall 168 | wall 2432 (progress_bar.py:269, print())
[2021-04-20 18:53:27]    INFO >> epoch 013 | valid on 'valid' subset | loss 3.216 | mrr 0.624259 | sample_size 1000 | wps 4372.5 | wpb 1000 | bsz 1000 | num_updates 7267 | best_mrr 624.259 (progress_bar.py:269, print())
[2021-04-20 18:53:27]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/python/self_attn/checkpoints/checkpoint_last.pt (epoch 13 @ 7267 updates, score 0.624259) (writing took 0.187166 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 18:56:24]    INFO >> epoch 014 | loss 0.15 | mrr 0.97415 | sample_size 450 | wps 1341.7 | ups 2.98 | wpb 450 | bsz 450 | num_updates 7826 | lr 0.0005 | gnorm 2.93 | clip 100 | train_wall 168 | wall 2619 (progress_bar.py:269, print())
[2021-04-20 18:56:34]    INFO >> epoch 014 | valid on 'valid' subset | loss 3.24 | mrr 0.623473 | sample_size 1000 | wps 4337.7 | wpb 1000 | bsz 1000 | num_updates 7826 | best_mrr 623.473 (progress_bar.py:269, print())
[2021-04-20 18:56:35]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/python/self_attn/checkpoints/checkpoint_last.pt (epoch 14 @ 7826 updates, score 0.623473) (writing took 0.297923 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 18:57:34]    INFO >> epoch 015:    175 / 560 loss=0.15, mrr=438.317, sample_size=450, wps=1326.7, ups=2.95, wpb=450, bsz=450, num_updates=8000, lr=0.0005, gnorm=2.935, clip=100, train_wall=300, wall=2689 (progress_bar.py:262, log())
[2021-04-20 18:59:32]    INFO >> epoch 015 | loss 0.138 | mrr 0.976445 | sample_size 450 | wps 1340.6 | ups 2.98 | wpb 450 | bsz 450 | num_updates 8385 | lr 0.0005 | gnorm 2.803 | clip 100 | train_wall 168 | wall 2807 (progress_bar.py:269, print())
[2021-04-20 18:59:42]    INFO >> epoch 015 | valid on 'valid' subset | loss 3.213 | mrr 0.628487 | sample_size 1000 | wps 4369.6 | wpb 1000 | bsz 1000 | num_updates 8385 | best_mrr 628.487 (progress_bar.py:269, print())
[2021-04-20 18:59:43]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/python/self_attn/checkpoints/checkpoint_best.pt (epoch 15 @ 8385 updates, score 0.628487) (writing took 0.639283 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 19:02:40]    INFO >> epoch 016 | loss 0.13 | mrr 0.977354 | sample_size 450 | wps 1338.1 | ups 2.97 | wpb 450 | bsz 450 | num_updates 8944 | lr 0.0005 | gnorm 2.703 | clip 100 | train_wall 168 | wall 2995 (progress_bar.py:269, print())
[2021-04-20 19:02:50]    INFO >> epoch 016 | valid on 'valid' subset | loss 3.252 | mrr 0.630185 | sample_size 1000 | wps 4339.5 | wpb 1000 | bsz 1000 | num_updates 8944 | best_mrr 630.185 (progress_bar.py:269, print())
[2021-04-20 19:02:51]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/python/self_attn/checkpoints/checkpoint_best.pt (epoch 16 @ 8944 updates, score 0.630185) (writing took 0.755316 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 19:03:14]    INFO >> epoch 017:     56 / 560 loss=0.134, mrr=439.603, sample_size=450, wps=1322.9, ups=2.94, wpb=450, bsz=450, num_updates=9000, lr=0.0005, gnorm=2.741, clip=100, train_wall=300, wall=3029 (progress_bar.py:262, log())
[2021-04-20 19:05:48]    INFO >> epoch 017 | loss 0.122 | mrr 0.978973 | sample_size 450 | wps 1337.2 | ups 2.97 | wpb 450 | bsz 450 | num_updates 9503 | lr 0.0005 | gnorm 2.606 | clip 100 | train_wall 168 | wall 3183 (progress_bar.py:269, print())
[2021-04-20 19:05:58]    INFO >> epoch 017 | valid on 'valid' subset | loss 3.442 | mrr 0.62645 | sample_size 1000 | wps 4358 | wpb 1000 | bsz 1000 | num_updates 9503 | best_mrr 626.45 (progress_bar.py:269, print())
[2021-04-20 19:05:59]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/python/self_attn/checkpoints/checkpoint_last.pt (epoch 17 @ 9503 updates, score 0.62645) (writing took 0.437162 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 19:08:36]    INFO >> epoch 018:    498 / 560 loss=0.121, mrr=440.603, sample_size=450, wps=1397.5, ups=3.11, wpb=450, bsz=450, num_updates=10000, lr=0.0005, gnorm=2.586, clip=100, train_wall=300, wall=3351 (progress_bar.py:262, log())
[2021-04-20 19:08:56]    INFO >> epoch 018 | loss 0.118 | mrr 0.979469 | sample_size 450 | wps 1340.1 | ups 2.98 | wpb 450 | bsz 450 | num_updates 10062 | lr 0.0005 | gnorm 2.547 | clip 100 | train_wall 168 | wall 3371 (progress_bar.py:269, print())
[2021-04-20 19:09:06]    INFO >> epoch 018 | valid on 'valid' subset | loss 3.38 | mrr 0.629821 | sample_size 1000 | wps 4350.3 | wpb 1000 | bsz 1000 | num_updates 10062 | best_mrr 629.821 (progress_bar.py:269, print())
[2021-04-20 19:09:06]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/python/self_attn/checkpoints/checkpoint_last.pt (epoch 18 @ 10062 updates, score 0.629821) (writing took 0.402821 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 19:12:03]    INFO >> epoch 019 | loss 0.112 | mrr 0.980917 | sample_size 450 | wps 1341 | ups 2.98 | wpb 450 | bsz 450 | num_updates 10621 | lr 0.0005 | gnorm 2.44 | clip 100 | train_wall 168 | wall 3558 (progress_bar.py:269, print())
[2021-04-20 19:12:13]    INFO >> epoch 019 | valid on 'valid' subset | loss 3.404 | mrr 0.624471 | sample_size 1000 | wps 4367.8 | wpb 1000 | bsz 1000 | num_updates 10621 | best_mrr 624.471 (progress_bar.py:269, print())
[2021-04-20 19:12:14]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/python/self_attn/checkpoints/checkpoint_last.pt (epoch 19 @ 10621 updates, score 0.624471) (writing took 0.540353 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 19:14:16]    INFO >> epoch 020:    380 / 560 loss=0.109, mrr=441.568, sample_size=450, wps=1325.4, ups=2.95, wpb=450, bsz=450, num_updates=11000, lr=0.0005, gnorm=2.42, clip=100, train_wall=300, wall=3691 (progress_bar.py:262, log())
[2021-04-20 19:15:11]    INFO >> epoch 020 | loss 0.107 | mrr 0.981542 | sample_size 450 | wps 1339 | ups 2.98 | wpb 450 | bsz 450 | num_updates 11180 | lr 0.0005 | gnorm 2.387 | clip 100 | train_wall 168 | wall 3746 (progress_bar.py:269, print())
[2021-04-20 19:15:21]    INFO >> epoch 020 | valid on 'valid' subset | loss 3.474 | mrr 0.625102 | sample_size 1000 | wps 4345.9 | wpb 1000 | bsz 1000 | num_updates 11180 | best_mrr 625.102 (progress_bar.py:269, print())
[2021-04-20 19:15:22]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/python/self_attn/checkpoints/checkpoint_last.pt (epoch 20 @ 11180 updates, score 0.625102) (writing took 0.300863 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 19:18:19]    INFO >> epoch 021 | loss 0.104 | mrr 0.982228 | sample_size 450 | wps 1340.9 | ups 2.98 | wpb 450 | bsz 450 | num_updates 11739 | lr 0.0005 | gnorm 2.328 | clip 100 | train_wall 168 | wall 3934 (progress_bar.py:269, print())
[2021-04-20 19:18:29]    INFO >> epoch 021 | valid on 'valid' subset | loss 3.556 | mrr 0.621902 | sample_size 1000 | wps 4350.5 | wpb 1000 | bsz 1000 | num_updates 11739 | best_mrr 621.902 (progress_bar.py:269, print())
[2021-04-20 19:18:29]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/python/self_attn/checkpoints/checkpoint_last.pt (epoch 21 @ 11739 updates, score 0.621902) (writing took 0.323067 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 19:19:55]    INFO >> epoch 022:    262 / 560 loss=0.104, mrr=442.014, sample_size=450, wps=1326.1, ups=2.95, wpb=450, bsz=450, num_updates=12000, lr=0.0005, gnorm=2.323, clip=100, train_wall=300, wall=4030 (progress_bar.py:262, log())
[2021-04-20 19:21:26]    INFO >> epoch 022 | loss 0.1 | mrr 0.982923 | sample_size 450 | wps 1340.5 | ups 2.98 | wpb 450 | bsz 450 | num_updates 12298 | lr 0.0005 | gnorm 2.277 | clip 100 | train_wall 168 | wall 4121 (progress_bar.py:269, print())
[2021-04-20 19:21:37]    INFO >> epoch 022 | valid on 'valid' subset | loss 3.496 | mrr 0.625802 | sample_size 1000 | wps 4364.7 | wpb 1000 | bsz 1000 | num_updates 12298 | best_mrr 625.802 (progress_bar.py:269, print())
[2021-04-20 19:21:37]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/python/self_attn/checkpoints/checkpoint_last.pt (epoch 22 @ 12298 updates, score 0.625802) (writing took 0.289740 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 19:24:34]    INFO >> epoch 023 | loss 0.095 | mrr 0.983765 | sample_size 450 | wps 1339.9 | ups 2.98 | wpb 450 | bsz 450 | num_updates 12857 | lr 0.0005 | gnorm 2.191 | clip 100 | train_wall 168 | wall 4309 (progress_bar.py:269, print())
[2021-04-20 19:24:44]    INFO >> epoch 023 | valid on 'valid' subset | loss 3.481 | mrr 0.631675 | sample_size 1000 | wps 4368.7 | wpb 1000 | bsz 1000 | num_updates 12857 | best_mrr 631.675 (progress_bar.py:269, print())
[2021-04-20 19:24:45]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/python/self_attn/checkpoints/checkpoint_best.pt (epoch 23 @ 12857 updates, score 0.631675) (writing took 0.759856 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 19:25:35]    INFO >> epoch 024:    144 / 560 loss=0.096, mrr=442.609, sample_size=450, wps=1323.8, ups=2.94, wpb=450, bsz=450, num_updates=13000, lr=0.0005, gnorm=2.214, clip=100, train_wall=300, wall=4370 (progress_bar.py:262, log())
[2021-04-20 19:27:42]    INFO >> epoch 024 | loss 0.092 | mrr 0.98409 | sample_size 450 | wps 1337.5 | ups 2.97 | wpb 450 | bsz 450 | num_updates 13416 | lr 0.0005 | gnorm 2.167 | clip 100 | train_wall 168 | wall 4497 (progress_bar.py:269, print())
[2021-04-20 19:27:52]    INFO >> epoch 024 | valid on 'valid' subset | loss 3.552 | mrr 0.62863 | sample_size 1000 | wps 4341.7 | wpb 1000 | bsz 1000 | num_updates 13416 | best_mrr 628.63 (progress_bar.py:269, print())
[2021-04-20 19:27:53]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/python/self_attn/checkpoints/checkpoint_last.pt (epoch 24 @ 13416 updates, score 0.62863) (writing took 0.281247 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 19:30:50]    INFO >> epoch 025 | loss 0.089 | mrr 0.984582 | sample_size 450 | wps 1340.8 | ups 2.98 | wpb 450 | bsz 450 | num_updates 13975 | lr 0.0005 | gnorm 2.102 | clip 100 | train_wall 168 | wall 4685 (progress_bar.py:269, print())
[2021-04-20 19:31:00]    INFO >> epoch 025 | valid on 'valid' subset | loss 3.531 | mrr 0.629261 | sample_size 1000 | wps 4329.2 | wpb 1000 | bsz 1000 | num_updates 13975 | best_mrr 629.261 (progress_bar.py:269, print())
[2021-04-20 19:31:00]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/python/self_attn/checkpoints/checkpoint_last.pt (epoch 25 @ 13975 updates, score 0.629261) (writing took 0.320291 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 19:31:14]    INFO >> epoch 026:     25 / 560 loss=0.092, mrr=442.857, sample_size=450, wps=1326.6, ups=2.95, wpb=450, bsz=450, num_updates=14000, lr=0.0005, gnorm=2.139, clip=100, train_wall=300, wall=4709 (progress_bar.py:262, log())
[2021-04-20 19:33:57]    INFO >> epoch 026 | loss 0.085 | mrr 0.985529 | sample_size 450 | wps 1341.7 | ups 2.98 | wpb 450 | bsz 450 | num_updates 14534 | lr 0.0005 | gnorm 2.036 | clip 100 | train_wall 168 | wall 4872 (progress_bar.py:269, print())
[2021-04-20 19:34:07]    INFO >> epoch 026 | valid on 'valid' subset | loss 3.572 | mrr 0.630681 | sample_size 1000 | wps 4342.3 | wpb 1000 | bsz 1000 | num_updates 14534 | best_mrr 630.681 (progress_bar.py:269, print())
[2021-04-20 19:34:08]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/python/self_attn/checkpoints/checkpoint_last.pt (epoch 26 @ 14534 updates, score 0.630681) (writing took 0.396823 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 19:36:36]    INFO >> epoch 027:    466 / 560 loss=0.083, mrr=443.611, sample_size=450, wps=1397.5, ups=3.11, wpb=450, bsz=450, num_updates=15000, lr=0.0005, gnorm=2.025, clip=99.9, train_wall=300, wall=5031 (progress_bar.py:262, log())
[2021-04-20 19:37:05]    INFO >> epoch 027 | loss 0.083 | mrr 0.98586 | sample_size 450 | wps 1339.3 | ups 2.98 | wpb 450 | bsz 450 | num_updates 15093 | lr 0.0005 | gnorm 2.025 | clip 99.8 | train_wall 168 | wall 5060 (progress_bar.py:269, print())
[2021-04-20 19:37:15]    INFO >> epoch 027 | valid on 'valid' subset | loss 3.654 | mrr 0.629699 | sample_size 1000 | wps 4361.7 | wpb 1000 | bsz 1000 | num_updates 15093 | best_mrr 629.699 (progress_bar.py:269, print())
[2021-04-20 19:37:16]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/python/self_attn/checkpoints/checkpoint_last.pt (epoch 27 @ 15093 updates, score 0.629699) (writing took 0.440587 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 19:40:13]    INFO >> epoch 028 | loss 0.082 | mrr 0.985994 | sample_size 450 | wps 1341.1 | ups 2.98 | wpb 450 | bsz 450 | num_updates 15652 | lr 0.0005 | gnorm 1.996 | clip 100 | train_wall 168 | wall 5248 (progress_bar.py:269, print())
[2021-04-20 19:40:23]    INFO >> epoch 028 | valid on 'valid' subset | loss 3.574 | mrr 0.627118 | sample_size 1000 | wps 4362.1 | wpb 1000 | bsz 1000 | num_updates 15652 | best_mrr 627.118 (progress_bar.py:269, print())
[2021-04-20 19:40:23]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/python/self_attn/checkpoints/checkpoint_last.pt (epoch 28 @ 15652 updates, score 0.627118) (writing took 0.213033 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 19:42:16]    INFO >> epoch 029:    349 / 560 loss=0.081, mrr=443.762, sample_size=450, wps=1326.6, ups=2.95, wpb=450, bsz=450, num_updates=16000, lr=0.0005, gnorm=1.979, clip=100, train_wall=300, wall=5371 (progress_bar.py:262, log())
[2021-04-20 19:43:20]    INFO >> epoch 029 | loss 0.079 | mrr 0.986397 | sample_size 450 | wps 1340.9 | ups 2.98 | wpb 450 | bsz 450 | num_updates 16211 | lr 0.0005 | gnorm 1.952 | clip 100 | train_wall 168 | wall 5435 (progress_bar.py:269, print())
[2021-04-20 19:43:30]    INFO >> epoch 029 | valid on 'valid' subset | loss 3.479 | mrr 0.634782 | sample_size 1000 | wps 4344 | wpb 1000 | bsz 1000 | num_updates 16211 | best_mrr 634.782 (progress_bar.py:269, print())
[2021-04-20 19:43:31]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/python/self_attn/checkpoints/checkpoint_best.pt (epoch 29 @ 16211 updates, score 0.634782) (writing took 0.638020 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 19:46:28]    INFO >> epoch 030 | loss 0.077 | mrr 0.98685 | sample_size 450 | wps 1339.1 | ups 2.98 | wpb 450 | bsz 450 | num_updates 16770 | lr 0.0005 | gnorm 1.918 | clip 100 | train_wall 168 | wall 5623 (progress_bar.py:269, print())
[2021-04-20 19:46:38]    INFO >> epoch 030 | valid on 'valid' subset | loss 3.683 | mrr 0.629515 | sample_size 1000 | wps 4335.1 | wpb 1000 | bsz 1000 | num_updates 16770 | best_mrr 629.515 (progress_bar.py:269, print())
[2021-04-20 19:46:39]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/python/self_attn/checkpoints/checkpoint_last.pt (epoch 30 @ 16770 updates, score 0.629515) (writing took 0.422014 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 19:47:55]    INFO >> epoch 031:    230 / 560 loss=0.076, mrr=444.104, sample_size=450, wps=1324.4, ups=2.94, wpb=450, bsz=450, num_updates=17000, lr=0.0005, gnorm=1.911, clip=100, train_wall=300, wall=5710 (progress_bar.py:262, log())
[2021-04-20 19:49:36]    INFO >> epoch 031 | loss 0.075 | mrr 0.987347 | sample_size 450 | wps 1339.6 | ups 2.98 | wpb 450 | bsz 450 | num_updates 17329 | lr 0.0005 | gnorm 1.866 | clip 100 | train_wall 168 | wall 5811 (progress_bar.py:269, print())
[2021-04-20 19:49:46]    INFO >> epoch 031 | valid on 'valid' subset | loss 3.53 | mrr 0.630626 | sample_size 1000 | wps 4331.3 | wpb 1000 | bsz 1000 | num_updates 17329 | best_mrr 630.626 (progress_bar.py:269, print())
[2021-04-20 19:49:46]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/python/self_attn/checkpoints/checkpoint_last.pt (epoch 31 @ 17329 updates, score 0.630626) (writing took 0.288701 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 19:52:43]    INFO >> epoch 032 | loss 0.072 | mrr 0.987528 | sample_size 450 | wps 1342.4 | ups 2.98 | wpb 450 | bsz 450 | num_updates 17888 | lr 0.0005 | gnorm 1.84 | clip 100 | train_wall 168 | wall 5998 (progress_bar.py:269, print())
[2021-04-20 19:52:53]    INFO >> epoch 032 | valid on 'valid' subset | loss 3.572 | mrr 0.636787 | sample_size 1000 | wps 4356 | wpb 1000 | bsz 1000 | num_updates 17888 | best_mrr 636.787 (progress_bar.py:269, print())
[2021-04-20 19:52:54]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/python/self_attn/checkpoints/checkpoint_best.pt (epoch 32 @ 17888 updates, score 0.636787) (writing took 0.771454 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 19:53:35]    INFO >> epoch 033:    113 / 560 loss=0.073, mrr=444.328, sample_size=450, wps=1324.8, ups=2.94, wpb=450, bsz=450, num_updates=18000, lr=0.0005, gnorm=1.853, clip=100, train_wall=300, wall=6050 (progress_bar.py:262, log())
[2021-04-20 19:55:52]    INFO >> epoch 033 | loss 0.07 | mrr 0.987842 | sample_size 450 | wps 1333.9 | ups 2.96 | wpb 450 | bsz 450 | num_updates 18447 | lr 0.0005 | gnorm 1.807 | clip 99.5 | train_wall 168 | wall 6187 (progress_bar.py:269, print())
[2021-04-20 19:56:01]    INFO >> epoch 033 | valid on 'valid' subset | loss 3.568 | mrr 0.635922 | sample_size 1000 | wps 4367.8 | wpb 1000 | bsz 1000 | num_updates 18447 | best_mrr 635.922 (progress_bar.py:269, print())
[2021-04-20 19:56:01]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/python/self_attn/checkpoints/checkpoint_last.pt (epoch 33 @ 18447 updates, score 0.635922) (writing took 0.313529 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 19:58:56]    INFO >> epoch 034:    554 / 560 loss=0.07, mrr=444.606, sample_size=450, wps=1402.7, ups=3.12, wpb=450, bsz=450, num_updates=19000, lr=0.0005, gnorm=1.797, clip=99.7, train_wall=301, wall=6371 (progress_bar.py:262, log())
[2021-04-20 19:58:58]    INFO >> epoch 034 | loss 0.068 | mrr 0.988289 | sample_size 450 | wps 1351 | ups 3 | wpb 450 | bsz 450 | num_updates 19006 | lr 0.0005 | gnorm 1.778 | clip 100 | train_wall 168 | wall 6373 (progress_bar.py:269, print())
[2021-04-20 19:59:08]    INFO >> epoch 034 | valid on 'valid' subset | loss 3.625 | mrr 0.630763 | sample_size 1000 | wps 4371.1 | wpb 1000 | bsz 1000 | num_updates 19006 | best_mrr 630.763 (progress_bar.py:269, print())
[2021-04-20 19:59:08]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/python/self_attn/checkpoints/checkpoint_last.pt (epoch 34 @ 19006 updates, score 0.630763) (writing took 0.363656 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 20:02:05]    INFO >> epoch 035 | loss 0.068 | mrr 0.988318 | sample_size 450 | wps 1344 | ups 2.99 | wpb 450 | bsz 450 | num_updates 19565 | lr 0.0005 | gnorm 1.758 | clip 99.5 | train_wall 168 | wall 6560 (progress_bar.py:269, print())
[2021-04-20 20:02:15]    INFO >> epoch 035 | valid on 'valid' subset | loss 3.704 | mrr 0.632783 | sample_size 1000 | wps 4364.7 | wpb 1000 | bsz 1000 | num_updates 19565 | best_mrr 632.783 (progress_bar.py:269, print())
[2021-04-20 20:02:16]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/python/self_attn/checkpoints/checkpoint_last.pt (epoch 35 @ 19565 updates, score 0.632783) (writing took 0.400795 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 20:04:35]    INFO >> epoch 036:    436 / 560 loss=0.066, mrr=444.893, sample_size=450, wps=1328.5, ups=2.95, wpb=450, bsz=450, num_updates=20000, lr=0.0005, gnorm=1.736, clip=99.5, train_wall=300, wall=6710 (progress_bar.py:262, log())
[2021-04-20 20:05:13]    INFO >> epoch 036 | loss 0.066 | mrr 0.988821 | sample_size 450 | wps 1342 | ups 2.98 | wpb 450 | bsz 450 | num_updates 20124 | lr 0.0005 | gnorm 1.726 | clip 99.6 | train_wall 168 | wall 6748 (progress_bar.py:269, print())
[2021-04-20 20:05:23]    INFO >> epoch 036 | valid on 'valid' subset | loss 3.581 | mrr 0.634411 | sample_size 1000 | wps 4257.3 | wpb 1000 | bsz 1000 | num_updates 20124 | best_mrr 634.411 (progress_bar.py:269, print())
[2021-04-20 20:05:23]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/python/self_attn/checkpoints/checkpoint_last.pt (epoch 36 @ 20124 updates, score 0.634411) (writing took 0.422027 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 20:08:20]    INFO >> epoch 037 | loss 0.064 | mrr 0.989018 | sample_size 450 | wps 1341.4 | ups 2.98 | wpb 450 | bsz 450 | num_updates 20683 | lr 0.0005 | gnorm 1.681 | clip 99.6 | train_wall 168 | wall 6935 (progress_bar.py:269, print())
[2021-04-20 20:08:30]    INFO >> epoch 037 | valid on 'valid' subset | loss 3.718 | mrr 0.631548 | sample_size 1000 | wps 4370.2 | wpb 1000 | bsz 1000 | num_updates 20683 | best_mrr 631.548 (progress_bar.py:269, print())
[2021-04-20 20:08:31]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/python/self_attn/checkpoints/checkpoint_last.pt (epoch 37 @ 20683 updates, score 0.631548) (writing took 0.259575 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 20:10:13]    INFO >> epoch 038:    318 / 560 loss=0.064, mrr=445.106, sample_size=450, wps=1327.9, ups=2.95, wpb=450, bsz=450, num_updates=21000, lr=0.0005, gnorm=1.681, clip=99.8, train_wall=300, wall=7048 (progress_bar.py:262, log())
[2021-04-20 20:11:27]    INFO >> epoch 038 | loss 0.063 | mrr 0.989347 | sample_size 450 | wps 1343.4 | ups 2.99 | wpb 450 | bsz 450 | num_updates 21242 | lr 0.0005 | gnorm 1.678 | clip 100 | train_wall 168 | wall 7122 (progress_bar.py:269, print())
[2021-04-20 20:11:37]    INFO >> epoch 038 | valid on 'valid' subset | loss 3.721 | mrr 0.636933 | sample_size 1000 | wps 4389.6 | wpb 1000 | bsz 1000 | num_updates 21242 | best_mrr 636.933 (progress_bar.py:269, print())
[2021-04-20 20:11:38]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/python/self_attn/checkpoints/checkpoint_best.pt (epoch 38 @ 21242 updates, score 0.636933) (writing took 0.489659 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 20:14:35]    INFO >> epoch 039 | loss 0.061 | mrr 0.989383 | sample_size 450 | wps 1342.9 | ups 2.98 | wpb 450 | bsz 450 | num_updates 21801 | lr 0.0005 | gnorm 1.651 | clip 99.3 | train_wall 168 | wall 7310 (progress_bar.py:269, print())
[2021-04-20 20:14:45]    INFO >> epoch 039 | valid on 'valid' subset | loss 3.668 | mrr 0.636294 | sample_size 1000 | wps 4322.3 | wpb 1000 | bsz 1000 | num_updates 21801 | best_mrr 636.294 (progress_bar.py:269, print())
[2021-04-20 20:14:45]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/python/self_attn/checkpoints/checkpoint_last.pt (epoch 39 @ 21801 updates, score 0.636294) (writing took 0.361784 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 20:15:52]    INFO >> epoch 040:    199 / 560 loss=0.062, mrr=445.23, sample_size=450, wps=1328, ups=2.95, wpb=450, bsz=450, num_updates=22000, lr=0.0005, gnorm=1.659, clip=99.1, train_wall=300, wall=7387 (progress_bar.py:262, log())
[2021-04-20 20:17:42]    INFO >> epoch 040 | loss 0.061 | mrr 0.989674 | sample_size 450 | wps 1342.1 | ups 2.98 | wpb 450 | bsz 450 | num_updates 22360 | lr 0.0005 | gnorm 1.635 | clip 98 | train_wall 168 | wall 7497 (progress_bar.py:269, print())
[2021-04-20 20:17:52]    INFO >> epoch 040 | valid on 'valid' subset | loss 3.756 | mrr 0.629992 | sample_size 1000 | wps 4381.2 | wpb 1000 | bsz 1000 | num_updates 22360 | best_mrr 629.992 (progress_bar.py:269, print())
[2021-04-20 20:17:53]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/python/self_attn/checkpoints/checkpoint_last.pt (epoch 40 @ 22360 updates, score 0.629992) (writing took 0.289679 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 20:20:49]    INFO >> epoch 041 | loss 0.061 | mrr 0.989579 | sample_size 450 | wps 1342.6 | ups 2.98 | wpb 450 | bsz 450 | num_updates 22919 | lr 0.0005 | gnorm 1.627 | clip 98.7 | train_wall 168 | wall 7684 (progress_bar.py:269, print())
[2021-04-20 20:21:00]    INFO >> epoch 041 | valid on 'valid' subset | loss 3.719 | mrr 0.632858 | sample_size 1000 | wps 4353.6 | wpb 1000 | bsz 1000 | num_updates 22919 | best_mrr 632.858 (progress_bar.py:269, print())
[2021-04-20 20:21:00]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/python/self_attn/checkpoints/checkpoint_last.pt (epoch 41 @ 22919 updates, score 0.632858) (writing took 0.354133 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 20:21:31]    INFO >> epoch 042:     81 / 560 loss=0.061, mrr=445.349, sample_size=450, wps=1327.3, ups=2.95, wpb=450, bsz=450, num_updates=23000, lr=0.0005, gnorm=1.625, clip=98.2, train_wall=300, wall=7726 (progress_bar.py:262, log())
[2021-04-20 20:23:57]    INFO >> epoch 042 | loss 0.058 | mrr 0.990123 | sample_size 450 | wps 1340.8 | ups 2.98 | wpb 450 | bsz 450 | num_updates 23478 | lr 0.0005 | gnorm 1.573 | clip 97.5 | train_wall 168 | wall 7872 (progress_bar.py:269, print())
[2021-04-20 20:24:07]    INFO >> epoch 042 | valid on 'valid' subset | loss 3.769 | mrr 0.632545 | sample_size 1000 | wps 4379.1 | wpb 1000 | bsz 1000 | num_updates 23478 | best_mrr 632.545 (progress_bar.py:269, print())
[2021-04-20 20:24:08]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/python/self_attn/checkpoints/checkpoint_last.pt (epoch 42 @ 23478 updates, score 0.632545) (writing took 0.287317 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 20:26:53]    INFO >> epoch 043:    522 / 560 loss=0.058, mrr=445.557, sample_size=450, wps=1399.9, ups=3.11, wpb=450, bsz=450, num_updates=24000, lr=0.0005, gnorm=1.58, clip=98.4, train_wall=300, wall=8048 (progress_bar.py:262, log())
[2021-04-20 20:27:04]    INFO >> epoch 043 | loss 0.058 | mrr 0.990223 | sample_size 450 | wps 1342.9 | ups 2.98 | wpb 450 | bsz 450 | num_updates 24037 | lr 0.0005 | gnorm 1.575 | clip 98.7 | train_wall 168 | wall 8059 (progress_bar.py:269, print())
[2021-04-20 20:27:15]    INFO >> epoch 043 | valid on 'valid' subset | loss 3.723 | mrr 0.634619 | sample_size 1000 | wps 4335.4 | wpb 1000 | bsz 1000 | num_updates 24037 | best_mrr 634.619 (progress_bar.py:269, print())
[2021-04-20 20:27:15]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/python/self_attn/checkpoints/checkpoint_last.pt (epoch 43 @ 24037 updates, score 0.634619) (writing took 0.258454 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 20:30:12]    INFO >> epoch 044 | loss 0.055 | mrr 0.990382 | sample_size 450 | wps 1342.1 | ups 2.98 | wpb 450 | bsz 450 | num_updates 24596 | lr 0.0005 | gnorm 1.552 | clip 96.6 | train_wall 168 | wall 8247 (progress_bar.py:269, print())
[2021-04-20 20:30:22]    INFO >> epoch 044 | valid on 'valid' subset | loss 3.724 | mrr 0.636179 | sample_size 1000 | wps 4390 | wpb 1000 | bsz 1000 | num_updates 24596 | best_mrr 636.179 (progress_bar.py:269, print())
[2021-04-20 20:30:23]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/python/self_attn/checkpoints/checkpoint_last.pt (epoch 44 @ 24596 updates, score 0.636179) (writing took 0.249153 seconds) (checkpoint_utils.py:81, save_checkpoint())
[2021-04-20 20:32:32]    INFO >> epoch 045:    404 / 560 loss=0.056, mrr=445.682, sample_size=450, wps=1326.5, ups=2.95, wpb=450, bsz=450, num_updates=25000, lr=0.0005, gnorm=1.546, clip=96.8, train_wall=300, wall=8387 (progress_bar.py:262, log())
[2021-04-20 20:33:19]    INFO >> epoch 045 | loss 0.057 | mrr 0.99045 | sample_size 450 | wps 1340.7 | ups 2.98 | wpb 450 | bsz 450 | num_updates 25155 | lr 0.0005 | gnorm 1.54 | clip 96.8 | train_wall 168 | wall 8434 (progress_bar.py:269, print())
[2021-04-20 20:33:30]    INFO >> epoch 045 | valid on 'valid' subset | loss 3.669 | mrr 0.63199 | sample_size 1000 | wps 4343.6 | wpb 1000 | bsz 1000 | num_updates 25155 | best_mrr 631.99 (progress_bar.py:269, print())
[2021-04-20 20:33:30]    INFO >> saved checkpoint /data/yanghe/ncc_data/codexglue/code_to_text/retrieval/data-mmap/python/self_attn/checkpoints/checkpoint_last.pt (epoch 45 @ 25155 updates, score 0.63199) (writing took 0.413798 seconds) (checkpoint_utils.py:81, save_checkpoint())
